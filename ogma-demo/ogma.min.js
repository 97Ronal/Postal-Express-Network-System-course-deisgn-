/**
 * Ogma
 * @description Graph visualization library
 * @version 2.5.5 (built on Tue Dec 11 2018 15:04:57 GMT+0100 (Central European Standard Time))
 * @author Linkurious SAS
 * @license (c) Linkurious 2018. All rights reserved.
 * @preserve
 */
(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):e.Ogma=t()})(this,function(){"use strict";if(!Array.prototype.fill){Object.defineProperty(Array.prototype,"fill",{value:function(value){if(this==null){throw new TypeError("this is null or not defined")}var e=Object(this);var t=e.length>>>0;var r=arguments[1];var n=r>>0;var i=n<0?Math.max(t+n,0):Math.min(n,t);var a=arguments[2];var o=a===undefined?t:a>>0;var s=o<0?Math.max(t+o,0):Math.min(o,t);while(i<s){e[i]=value;i++}return e}})}if(!Array.prototype.copyWithin){Array.prototype.copyWithin=function(e,t){if(this==null){throw new TypeError("this is null or not defined")}var r=Object(this);var n=r.length>>>0;var i=e>>0;var a=i<0?Math.max(n+i,0):Math.min(i,n);var o=t>>0;var s=o<0?Math.max(n+o,0):Math.min(o,n);var u=arguments[2];var l=u===undefined?n:u>>0;var d=l<0?Math.max(n+l,0):Math.min(l,n);var f=Math.min(d-s,n-a);var h=1;if(s<a&&a<s+f){h=-1;s+=f-1;a+=f-1}while(f>0){if(s in r){r[a]=r[s]}else{delete r[a]}s+=h;a+=h;f--}return r}}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(e){if(this===void 0||this===null){throw new TypeError}var t,r,n=Object(this),i=n.length>>>0;if(i===0){return-1}t=i-1;if(arguments.length>1){t=Number(arguments[1]);if(t!=t){t=0}else if(t!=0&&t!=1/0&&t!=-(1/0)){t=(t>0||-1)*Math.floor(Math.abs(t))}}for(r=t>=0?Math.min(t,i-1):i-Math.abs(t);r>=0;r--){if(r in n&&n[r]===e){return r}}return-1}}if(!Array.from){Array.from=function(){var e=Object.prototype.toString;var t=function(t){return typeof t==="function"||e.call(t)==="[object Function]"};var r=function(value){var e=Number(value);if(isNaN(e)){return 0}if(e===0||!isFinite(e)){return e}return(e>0?1:-1)*Math.floor(Math.abs(e))};var n=Math.pow(2,53)-1;var i=function(value){var e=r(value);return Math.min(Math.max(e,0),n)};return function e(r){var n=this;var a=Object(r);if(r==null){throw new TypeError("Array.from requires an array-like object - not null or undefined")}var o=arguments.length>1?arguments[1]:void undefined;var s;if(typeof o!=="undefined"){if(!t(o)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){s=arguments[2]}}var u=i(a.length);var l=t(n)?Object(new n(u)):new Array(u);var d=0;var f;while(d<u){f=a[d];if(o){l[d]=typeof s==="undefined"?o(f,d):o.call(s,f,d)}else{l[d]=f}d+=1}l.length=u;return l}}()}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var r=Object(this);var n=r.length>>>0;if(n===0){return false}var i=t|0;var a=Math.max(i>=0?i:n-Math.abs(i),0);function o(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(a<n){if(o(r[a],e)){return true}a++}return false}})}if(!Array.prototype.find){Object.defineProperty(Array.prototype,"find",{value:function(e){if(this==null){throw new TypeError('"this" is null or not defined')}var t=Object(this);var r=t.length>>>0;if(typeof e!=="function"){throw new TypeError("predicate must be a function")}var n=arguments[1];var i=0;while(i<r){var a=t[i];if(e.call(n,a,i,t)){return a}i++}return undefined},configurable:true,writable:true})}var e=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array];var t=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];if(!ArrayBuffer.isView){ArrayBuffer.isView=function(t){for(var r=0;r<e.length;++r){if(t instanceof e[r]){return true}}return false}}var r=function(){var e=i[n];for(var r=0,a=t;r<a.length;r+=1){var o=a[r];if(!e.prototype[o]){e.prototype[o]=Array.prototype[o]}}if(!e.from){(function(){e.from=function(t,r,n){var i=e.__proto__;if(typeof this!=="function"){throw new TypeError("# is not a constructor")}if(this.__proto__!==i){throw new TypeError("this is not a typed array.")}r=r||function(e){return e};if(typeof r!=="function"){throw new TypeError("specified argument is not a function")}t=Object(t);if(!t["length"]){return new this(0)}var a=[];for(var o=0;o<t.length;o++){a.push(t[o])}a=a.map(r,n);var s=new this(a.length);for(var o=0;o<s.length;o++){s[o]=a[o]}return s}})()}};for(var n=0,i=e;n<i.length;n+=1)r();if(typeof CanvasRenderingContext2D!=="undefined"&&!CanvasRenderingContext2D.prototype.setLineDash){CanvasRenderingContext2D.prototype.setLineDash=function(){}}if(!Math.log2){Math.log2=function(e){return Math.log(e)*Math.LOG2E}}if(!Math.sign){Math.sign=function(e){return(e>0)-(e<0)||+e}}if(!Number.isNaN){Number.isNaN=function(value){return typeof value==="number"&&isNaN(value)}}if(!Number.MAX_SAFE_INTEGER){Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:false,configurable:false,writable:false,value:Math.pow(2,53)-1})}var a=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(){var e=setTimeout;function t(){}function r(e,t){return function(){e.apply(t,arguments)}}function n(e){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof e!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];d(e,this)}function i(e,t){while(e._state===3){e=e._value}if(e._state===0){e._deferreds.push(t);return}e._handled=true;n._immediateFn(function(){var r=e._state===1?t.onFulfilled:t.onRejected;if(r===null){(e._state===1?o:s)(t.promise,e._value);return}var n;try{n=r(e._value)}catch(e){s(t.promise,e);return}o(t.promise,n)})}function o(e,t){try{if(t===e){throw new TypeError("A promise cannot be resolved with itself.")}if(t&&(typeof t==="object"||typeof t==="function")){var i=t.then;if(t instanceof n){e._state=3;e._value=t;u(e);return}else if(typeof i==="function"){d(r(i,t),e);return}}e._state=1;e._value=t;u(e)}catch(t){s(e,t)}}function s(e,t){e._state=2;e._value=t;u(e)}function u(e){if(e._state===2&&e._deferreds.length===0){n._immediateFn(function(){if(!e._handled){n._unhandledRejectionFn(e._value)}})}for(var t=0,r=e._deferreds.length;t<r;t++){i(e,e._deferreds[t])}e._deferreds=null}function l(e,t,r){this.onFulfilled=typeof e==="function"?e:null;this.onRejected=typeof t==="function"?t:null;this.promise=r}function d(e,t){var r=false;try{e(function(value){if(r){return}r=true;o(t,value)},function(e){if(r){return}r=true;s(t,e)})}catch(e){if(r){return}r=true;s(t,e)}}n.prototype.catch=function(e){return this.then(null,e)};n.prototype.then=function(e,r){var n=new this.constructor(t);i(this,new l(e,r,n));return n};n.all=function(e){var t=Array.prototype.slice.call(e);return new n(function(e,r){if(t.length===0){return e([])}var n=t.length;function i(a,o){try{if(o&&(typeof o==="object"||typeof o==="function")){var s=o.then;if(typeof s==="function"){s.call(o,function(e){i(a,e)},r);return}}t[a]=o;if(--n===0){e(t)}}catch(e){r(e)}}for(var a=0;a<t.length;a++){i(a,t[a])}})};n.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===n){return value}return new n(function(e){e(value)})};n.reject=function(value){return new n(function(e,t){t(value)})};n.race=function(e){return new n(function(t,r){for(var n=0,i=e.length;n<i;n++){e[n].then(t,r)}})};n._immediateFn=typeof a.setImmediate==="function"&&function(e){a.setImmediate(e)}||function(t){e(t,0)};n._unhandledRejectionFn=function e(t){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",t)}};n._setImmediateFn=function e(t){n._immediateFn=t};n._setUnhandledRejectionFn=function e(t){n._unhandledRejectionFn=t};if(typeof a==="object"&&!a.Promise){a.exports=n}if(typeof window==="object"&&!window.Promise){window.Promise=n}})(a);if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){var r=this.toString();if(typeof t!=="number"||!isFinite(t)||Math.floor(t)!==t||t>r.length){t=r.length}t-=e.length;var n=r.lastIndexOf(e,t);return n!==-1&&n===t}}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}}if(!String.prototype.includes){String.prototype.includes=function(e,t){if(typeof t!=="number"){t=0}if(t+e.length>this.length){return false}else{return this.indexOf(e,t)!==-1}}}if(typeof Object.assign!=="function"){Object.defineProperty(Object,"assign",{value:function e(t){var r=arguments;if(t==null){throw new TypeError("Cannot convert undefined or null to object")}var n=Object(t);for(var i=1;i<arguments.length;i++){var a=r[i];if(a!=null){for(var o in a){if(Object.prototype.hasOwnProperty.call(a,o)){n[o]=a[o]}}}}return n},writable:true,configurable:true})}var s=1;var u=[];var l=[];var d=[];var f=[];var h=[];var c=false;var Ogma=function Ogma(e){if(e===void 0)e={};if(this===undefined||this===null||this.constructor!==Ogma){return new Ogma(e)}if(!c){c=true;for(var t=0;t<f.length;++t){f[t]()}}this._init(e)};Ogma.prototype._init=function e(t){var r=this;this._initParameters=t;this._debug=!!t.debug;this._token=s++;this.modules={};this.events={};this.view={};this.styles={};this.transformations={};this.parse={};this.export={};this.tools={};this.utils={};this.algorithms={};l.forEach(function(e){return e(r,t)});u.forEach(function(e){return e(r,t)});d.forEach(function(e){return e(r,t)})};Ogma.prototype._destroy=function e(){var t=this;if(!this._token){throw new Error('"destroy" called twice on the same instance of Ogma')}h.forEach(function(e){return e(t)});Object.keys(this).forEach(function(e){t[e]=undefined})};Ogma.prototype.destroy=function e(){this._destroy()};Ogma.prototype.reset=function e(){var t=this._initParameters;this._destroy();this._init(t)};function g(e,t){if(typeof t!=="function"){throw new TypeError("expected function")}e.push(t)}Ogma.extend=function(e){g(u,e)};Ogma.beforeInit=function(e){g(l,e)};Ogma.afterInit=function(e){g(d,e)};Ogma.beforeFirstInstanceCreated=function(e){g(f,e)};Ogma.onDestroy=function(e){g(h,e)};Ogma.build={version:"2.5.5",commit:"020164cb",date:"Tue Dec 11 2018 15:04:58 GMT+0100 (Central European Standard Time)"};var v=function(){var e=0;return typeof requestAnimationFrame!=="undefined"?requestAnimationFrame:function(t){var r=Date.now();var n=Math.min(16,Math.max(0,16-(r-e)));var i=e=r+n;return setTimeout(function(){return t(i)},n)}}();var p=typeof cancelAnimationFrame!=="undefined"?cancelAnimationFrame:function(e){return clearTimeout(e)};function _(e,t){return v(function(r){e.call(t,r)})}function m(e){if(e){p(e)}}var y=typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};Ogma.libraries=Object.create(null);var b={};var x={};var S=function(){return null};if(typeof y==="object"){b=y}if(typeof window==="object"){x=window}if(typeof module==="object"&&typeof module.require==="function"){S=function(e){try{return module.require(e)}catch(e){return null}}}else if(typeof b.require==="function"){S=function(e){try{return b.require(e)}catch(e){return null}}}function A(e,t){if(t===void 0)t={};var r=t.throwOnError;var n=null;if(!n&&e){n=Ogma.libraries[e]}if(!n&&e){n=S(e)}if(!n&&e){n=x[e]}if(!n&&e){n=b[e]}if(!n&&r){var i=['unable to find module "'+e+'"; make sure one of these statements is true:',"- Ogma.libraries['"+e+"'] is set to the right library","- require('"+e+"') returns the right library","- window['"+e+"'] is set to the right library"].join("\n");throw new Error(i)}return n}function E(e,t){for(var r=1,n=e.length;r<n;r++){var i=e[r];var a=r;while(a>0&&t.get(e[a-1])>t.get(i)){e[a]=e[a-1];--a}e[a]=i}return e}function w(e,t){for(var r=1,n=e.length;r<n;r++){var i=e[r];var a=r;while(a>0&&t.get(e[a-1])<t.get(i)){e[a]=e[a-1];--a}e[a]=i}return e}function k(e,t){for(var r=0;r<t.length;++r){e.push(t[r])}}function C(value){return Array.isArray(value)||ArrayBuffer.isView(value)}function T(value){return Array.isArray(value)?value:[value]}function L(e,t,r){for(var n=0;n<t.length;++n){e[n+r]=t[n]}}function M(e){var t=[];for(var r=0;r<e.length;++r){var n=e[r];if(Array.isArray(n)){for(var i=0;i<n.length;++i){t.push(n[i])}}else{t.push(n)}}return t}function I(){var e=[],t=arguments.length;while(t--)e[t]=arguments[t];if(e.length===0){return[]}var r=e[0].constructor;var n=0;for(var i=0,a=e;i<a.length;i+=1){var o=a[i];n+=o.length}var s=new r(n);var u=0;for(var l=0,d=e;l<d.length;l+=1){var f=d[l];for(var h=0;h<f.length;h++){s[u+h]=f[h]}u+=f.length}return s}function F(e,t){var r=e.indexOf(t);if(r!==-1){e.splice(r,1);return true}return false}function N(e){return typeof e==="number"&&e%1===0}function z(e){if(!e){return[]}else if(typeof e==="string"){return e.split(".")}else if(Array.isArray(e)){for(var t=0;t<e.length;++t){if(typeof e[t]!=="string"){throw new TypeError(e[t]+" is not a string")}}return e.slice()}else{throw new TypeError('invalid property path "'+e+'": expected string or array of strings')}}function R(e,t,r){var n,i,a,o;if(t===0){return function(){e.apply(r,arguments)}}o=function(){n=false;if(i){a.apply(r,i);i=false}};a=function(){var a;if(n){i=arguments}else{a=e.apply(r,arguments);setTimeout(o,t);n=true}return a};return a}function P(e,t,r){var n,i,a,o,s;if(t==null){t=100}function u(){var l=Date.now()-o;if(l<t&&l>=0){n=setTimeout(u,t-l)}else{n=null;if(!r){s=e.apply(a,i);a=i=null}}}var l=function(){a=this;i=arguments;o=Date.now();var l=r&&!n;if(!n){n=setTimeout(u,t)}if(l){s=e.apply(a,i);a=i=null}return s};l.clear=function(){if(n){clearTimeout(n);n=null}};l.flush=function(){if(n){s=e.apply(a,i);a=i=null;clearTimeout(n);n=null}};return l}function D(e,t,r,n,i){r(e[t],t,e,n,i).then(function(a){if(t===e.length-1){n(a)}else{D(e,t+1,r,n,i)}}).catch(i)}function O(e,t){return new Promise(function(r,n){D(e,0,t,r,n)})}function B(){return new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120}function j(e){return e!==null&&typeof e==="object"&&!C(e)&&!(e instanceof RegExp)&&(typeof HTMLElement==="undefined"||!(e instanceof HTMLElement))}function V(e){var t=Object.keys(e);var r=new Array(t.length);for(var n=0;n<t.length;++n){r[n]=e[t[n]]}return r}function U(e,t,r){if(Array.isArray(e)){e.forEach(t,r)}else if(j(e)){var n=Object.keys(e);if(r!==undefined){for(var i=0;i<n.length;++i){var a=n[i];t.call(r,e[a],a)}}else{for(var o=0;o<n.length;++o){var s=n[o];t(e[s],s)}}}else{throw new Error("forEach: invalid argument "+JSON.stringify(e))}}function G(e){if(Array.isArray(e)){var t=new Array(e.length);for(var r=0;r<e.length;++r){t[r]=G(e[r])}return t}else if(ee(e)){var n={};var i=Object.keys(e);for(var a=0;a<i.length;++a){var o=i[a];n[o]=G(e[o])}return n}else{return e}}function W(e,t){U(t,function(t,value){if(typeof value==="object"&&value!==null){if(typeof e[t]!=="object"||e[t]===null){e[t]={}}W(e[t],value)}else{e[t]=value}})}function H(e,t){t.forEach(function(t){if(e.indexOf(t)===-1){e.push(t)}})}function X(e,t,value){var r=typeof t==="string"?t.split("."):t;for(var n=0;n<r.length-1;++n){var i=r[n];var a=e[i];if(!a){a={};e[i]=a}e=a}e[r[r.length-1]]=value}function q(e,t){var r=z(t);if(!r.length){return e}if(!e){return undefined}for(var n=0;n<r.length-1;++n){var i=r[n];var a=e[i];if(!a){return undefined}e=a}return e[r[r.length-1]]}function Y(e,t,r){if(r===void 0)r=".";if(!t){t=function(e){return!j(e)}}var n={};var i=Object.keys(e);for(var a=0;a<i.length;++a){var o=i[a];var value=e[o];if(!t(value)){var s=Y(value,t);var u=Object.keys(s);for(var l=0;l<u.length;l++){var d=u[l];n[""+o+r+d]=s[d]}}else{n[o]=value}}return n}function Z(e){var t={};var r=Object.keys(e);for(var n=0;n<r.length;++n){var i=r[n];X(t,i,e[i])}return t}function K(e,t,r){if(r===void 0)r=[];var n=Object.keys(e);for(var i=0;i<n.length;++i){var a=n[i];var value=e[a];var o=t?t+a:a;if(!ee(value)){r.push(o)}else{K(value,o+".",r)}}return r}function Q(e,t){if(t===void 0)t=[];if(!ee(e)){t.push(e)}else{var r=Object.keys(e);for(var n=0,i=r;n<i.length;n+=1){var a=i[n];Q(e[a],t)}}return t}function J(e){if(e===void 0)e={};for(var t in e){if(typeof e[t]==="function"){delete e[t]}}return e}function $(value,e,t){if(value===undefined){return G(e)}if(!j(value)&&t){value={};value[t]=value}if(j(e)){var r={};var n=Object.keys(e);for(var i=0,a=n;i<a.length;i+=1){var o=a[i];var s=e[o];var u=value[o];if(j(s)){r[o]=$(u,s)}else if(u===undefined){r[o]=G(s)}else{r[o]=u}}return r}else{return value}}function ee(value){return value&&(value.constructor===Object||!value.constructor)}function te(e,t){if(!ee(t)||!ee(e)){return t}var r=Object.assign({},e);var n=Object.keys(t);for(var i=0;i<n.length;++i){var a=n[i];r[a]=te(r[a],t[a])}return r}var re=300;var ne=150;var ie;var ae;var oe;var se;var ue;var le;Ogma.beforeFirstInstanceCreated(function(){ie=A("xmldom");ae=A("canvas")||A("canvas-prebuilt");if(typeof XMLSerializer!=="undefined"){oe=XMLSerializer}else if(ie){oe=ie.XMLSerializer}else{oe=null}if(typeof document!=="undefined"){se=document}else if(ie){se=(new ie.DOMImplementation).createDocument()}else{se=null}if(typeof XMLHttpRequest!=="undefined"){ue=XMLHttpRequest}else{ue=ge}if(typeof FileReader!=="undefined"){le=FileReader}else{le=ve}});function de(){if(se){return se}else{return{createElementNS:function e(){return null},createElement:function e(){return null},implementation:{createDocument:function e(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}}function fe(e,t){var value=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!value||value==="auto")&&de().defaultView){var r=document.defaultView.getComputedStyle(e,null);value=r?r[t]:null}return value==="auto"?null:value}function he(){return ce(we(),{})!==null}function ce(e,t){var r=e.getContext("webgl",t);if(!r){r=e.getContext("experimental-webgl",t)}return r||null}var ge=function e(){if(e.onCreate){e.onCreate(this)}};ge.prototype.open=function e(t,r){this.method=t;this.url=r;if(ge.onSend){ge.onSend(this)}};ge.prototype.respond=function e(t,r,n){this.readyState=4;this.status=t;this.headers=r;this.responseText=n;this.response=n;this.onreadystatechange()};ge.prototype.send=function e(){this.readyState=4};var ve=function e(){if(e.onCreate){e.onCreate(this)}};ve.prototype.readAsDataURL=function e(t){this._blob=t;if(ve.onRead){ve.onRead(this)}};ve.prototype.load=function e(t){if(typeof t==="function"){this.result=t(this._blob)}else{this.result=t}if(this.onload){this.onload()}};var pe=function e(){this.__dummy=true;this.style={width:"0px",height:"0px"}};var _e={offsetWidth:{configurable:true},offsetHeight:{configurable:true},firstChild:{configurable:true}};_e.offsetWidth.get=function(){return parseFloat(this.style.width)};_e.offsetHeight.get=function(){return parseFloat(this.style.height)};_e.firstChild.get=function(){return null};pe.prototype.appendChild=function e(){};pe.prototype.removeChild=function e(){};pe.prototype.addEventListener=function e(){};pe.prototype.removeEventListener=function e(){};Object.defineProperties(pe.prototype,_e);var me=function e(){this.__context=new be;this.style={};this.width=re;this.height=ne};var ye={__dummy:{configurable:true}};ye.__dummy.get=function(){return true};me.prototype.getContext=function e(t){return t==="2d"?this.__context:null};me.prototype.toDataURL=function e(){return"data:image/png;base64,"};me.prototype.addEventListener=function e(){};me.prototype.removeEventListener=function e(){};me.prototype.getBoundingClientRect=function e(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}};Object.defineProperties(me.prototype,ye);var be=function e(){this._fontSize=10};var xe={font:{configurable:true}};xe.font.set=function(e){var t=e.match(/\d+/);if(t){this._fontSize=parseFloat(t[0])}};be.prototype.fill=function e(){};be.prototype.stroke=function e(){};be.prototype.clearRect=function e(){};be.prototype.fillRect=function e(){};be.prototype.strokeRect=function e(){};be.prototype.beginPath=function e(){};be.prototype.closePath=function e(){};be.prototype.moveTo=function e(){};be.prototype.lineTo=function e(){};be.prototype.rect=function e(){};be.prototype.arc=function e(){};be.prototype.save=function e(){};be.prototype.restore=function e(){};be.prototype.clip=function e(){};be.prototype.translate=function e(){};be.prototype.rotate=function e(){};be.prototype.fillText=function e(){};be.prototype.setLineDash=function e(){};be.prototype.quadraticCurveTo=function e(){};be.prototype.bezierCurveTo=function e(){};be.prototype.drawImage=function e(){};be.prototype.measureText=function e(t){return{width:t.length*Math.ceil(this._fontSize*.625)}};be.prototype.getImageData=function e(){return{width:0,height:0,data:new Uint8ClampedArray(0)}};Object.defineProperties(be.prototype,xe);function Se(){return new pe}function Ae(){return se.implementation.createDocument("","",null)}function Ee(e){return(new oe).serializeToString(e)}function we(){var e=null;if(typeof document!=="undefined"){e=document.createElement("canvas")}else if(ae){if(ae.createCanvas){e=ae.createCanvas(re,ne)}else{e=new ae(re,ne)}e.style={}}else{e=new me}return e}function ke(){return typeof window!=="undefined"&&window.devicePixelRatio||1}function Ce(e){var t=";base64,";var r,n,i;if(e.indexOf(t)===-1){r=e.split(",");n=r[0].split(":")[1];i=decodeURIComponent(r[1]);return Le(i,n)}r=e.split(t);n=r[0].split(":")[1];i=window.atob(r[1]);var a=i.length;var o=new Uint8Array(a);for(var s=0;s<a;++s){o[s]=i.charCodeAt(s)}return Le([o],n)}function Te(e,t){this.data=e;this.type=t}function Le(e,t){if(typeof Blob!=="undefined"){return new Blob(e,{type:t})}else{return new Te(e,t)}}function Me(e){if(typeof Blob!=="undefined"){return e instanceof Blob||e instanceof Te}else{return e instanceof Te}}function Ie(e,t,r){if(typeof window==="undefined"||window["__OGMA_HEADLESS"]){return e}var n=null;var i=null;var a=null;if(window.Blob){if(r==="blob"){n=e}else if(r==="dataURL"){n=Ce(e)}else{n=Le([e],"text/xml")}i=window.URL.createObjectURL(n)}else{a="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(e)}if(navigator.msSaveBlob){navigator.msSaveBlob(n,t)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(n,t)}else{var o=document.createElement("a");o.setAttribute("href",window.Blob?i:a);o.setAttribute("download",t);document.body.appendChild(o);o.click();document.body.removeChild(o)}if(i){setTimeout(function(){window.URL.revokeObjectURL(i)},0)}return e}function Fe(e,t,r,n){if(!n){n=ke()}e.style.width=t+"px";e.style.height=r+"px";e.width=t*n;e.height=r*n}function Ne(e,t){U(t,function(value,t){if(value!==undefined){e.setAttribute(t,value)}})}function ze(e,t){var r=se.createElementNS("http://www.w3.org/2000/svg",e);if(!r.style){r.style={}}if(t){Ne(r,t)}return r}function Re(e){return se.createTextNode(e)}function Pe(e){if(typeof Image==="undefined"){return Promise.resolve(null)}return new Promise(function(t){var r=new Image;r.src=e;r.onload=function(){return t(r)};r.onerror=function(){return t(null)}})}function De(e){if(e.indexOf("http://")===0||e.indexOf("https://")===0){return e}var t=window.location.origin;var r=window.location.pathname;var n=r.lastIndexOf("/");if(n===-1){return t+"/"+e}else{return t+r.substr(0,n)+"/"+e}}function Oe(e){return new Promise(function(t,r){var n=new ue;n.open("GET",De(e),true);n.onreadystatechange=function(){if(n.readyState===4){var i=n.status;if(i===200){t(n.responseText)}else if(i!==0){r(new Error('cannot retrieve file at url "'+e+'"; the server responded with status code '+i+"."))}else{r(new Error('cannot send XMLHttpRequest to url "'+e+"\"; if you're using the local file protocol this is most likely the cause."))}}};n.onerror=function(){r(new Error('cannot retrieve file at url "'+e+'"; the XMLHttpRequest failed.'))};n.send()})}function Be(e){return typeof HTMLElement!=="undefined"?e instanceof HTMLElement:false}function je(e,t){e.style.cursor=t;if(e.style.cursor!==t){e.style.cursor="-webkit-"+t}}function Ve(e){if(!e.getBoundingClientRect){return null}try{return e.getBoundingClientRect()}catch(e){return null}}function Ue(e){return new Promise(function(t,r){var n=new ue;n.responseType="blob";n.open("GET",De(e),true);n.onreadystatechange=function(){if(n.readyState===4){if(n.status===200){t(n.response)}else{r(n.status)}}};n.onerror=function(e){return r(e)};n.send()})}function Ge(e){return Ue(e).then(function(e){return new Promise(function(t,r){var n=new le;n.onerror=r;n.onload=function(){return t(n.result)};n.readAsDataURL(e)})})}function We(e,t,r,n){if(n===void 0)n="";e.font=n+" "+r+"px "+t}function He(e,t){if(t===void 0)t=true;var r=t?"&#13;":"\n";return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,r).replace(/[\r\n]/g,r)}function Xe(){var e=de();var t=e.styleSheets;if(!t||!e.location){return Promise.resolve([])}var r=e.location.href;var n=[],i=[];for(var a=0;a<t.length;a++){var o=t[a];if(o.href===null){n.push({href:r,content:o.ownerNode.textContent})}else{i.push(o.href)}}var s=/@font-face\s*\{[^}]+\}/g;return Promise.all(i.map(function(e){return Oe(e).then(function(t){return{href:e,content:t}}).catch(function(){return null})})).then(function(e){return e.concat(n)}).then(function(e){var t=[];for(var r=0;r<e.length;r++){var n=e[r];if(n!==null){var i=n.href;var a=n.content;var o=a.match(s);if(o){var u=Ze(o,i);t.push.apply(t,u)}}}return t})}function qe(e,t){return Promise.all(e.map(function(e){var r=e.formats;var n=e.originalRule;return Promise.all(r.map(function(e){var r=e.format;var n=e.url;if(t){return Ge(n).then(function(e){return{format:r,src:e}}).catch(function(){return null})}else{return{format:r,src:n}}})).then(function(e){var t=[];for(var r=0;r<e.length;r++){var i=e[r];if(i!==null){t.push("url('"+i.src+"') format('"+i.format+"')")}}if(t.length!==0){var a="src: "+t.join(",")+";";return n.replace(/src\s*:[^;]+;/g,a)}return n})}))}var Ye={"embedded-opentype":true,svg:true};function Ze(e,t){var r=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g;var n=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/;var i=[];for(var a=0;a<e.length;a++){var o=e[a];var s=o.match(n)[1];var u=[];var l=void 0;while(l=r.exec(o)){var d=l[1];var f=l[2];if(!Ye[f.toLowerCase()]){u.push({format:f,url:Ke(d,t)})}}i.push({name:s,formats:u,originalRule:o})}return i}function Ke(e,t){if(/^http(s)?:/.test(e)){return e}if(e[0]==="/"){var r=t.match(/((\w+:\/\/)([^/]+))/);if(r){return r[1]+e}else{return e}}var n=e.split("/");var i=t.split("/");if(t[t.length-1]!=="/"){i.pop()}while(n[0]===".."){n.shift();i.pop()}return i.concat(n).join("/").replace(/[\w](\/{2,})/g,function(e){return e[0]+"/"})}function Qe(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function Je(e){var t=0;for(var r=0;r<e.length;++r){t+=e[r]}return t}function $e(value,e,t){return Math.max(e,Math.min(t,value))}function et(e,t,r){return e+(t-e)*r}function tt(e,t,r){return e*(1-r)+t*r}function rt(e){if(!e.length){return-Infinity}var t=e[0];for(var r=1,n=e.length;r<n;++r){var i=e[r];if(i>t){t=i}}return t}function nt(e){if(!e.length){return Infinity}var t=e[0];for(var r=1,n=e.length;r<n;++r){var i=e[r];if(i<t){t=i}}return t}function it(e,t){return Math.log(e)/Math.log(t)}var at=4;var ot=function e(){this._buffer=new Uint32Array(at);this._capacity=at;this._size=0;this._busy=false};ot.prototype.isBusy=function e(){return this._busy};ot.prototype.markBusy=function e(){this._busy=true};ot.prototype.sliceAndReset=function e(){this._busy=false;var t=this.slice();this.reset();return t};ot.prototype.reset=function e(){this._size=0};ot.prototype.reserve=function e(value){if(value>this._capacity){this._setCapacity(Qe(value))}};ot.prototype._setCapacity=function e(t){var r=new Uint32Array(t);r.set(this._buffer);this._buffer=r;this._capacity=t};ot.prototype.push=function e(value){if(this._size===this._capacity){this._setCapacity(this._capacity*2)}this._buffer[this._size++]=value};ot.prototype.pushUnchecked=function e(value){this._buffer[this._size++]=value};ot.prototype.slice=function e(t,r){var n=t===undefined?0:t;var i=r===undefined?this._size:r;return this._buffer.slice(n,i)};ot.prototype.getBuffer=function e(){return this._buffer};ot.prototype.getLength=function e(){return this._size};ot.prototype.setLength=function e(value){this._size=value};ot.prototype.isEmpty=function e(){return this._size===0};var st={};function ut(e){return typeof e==="number"&&isNaN(e)}var lt=function e(){this._keys=[];this._values=[]};lt.prototype.set=function e(t,value){var r=this._getIndex(t);if(r===-1){this._keys.push(t.slice());this._values.push(value);return true}else{this._values[r]=value;return false}};lt.prototype.get=function e(t){var r=this._getIndex(t);return r===-1?undefined:this._values[r]};lt.prototype.has=function e(t){return this._getIndex(t)!==-1};lt.prototype.delete=function e(t){var r=this._getIndex(t);if(r!==-1){this._keys.splice(r,1);this._values.splice(r,1);return true}else{return false}};lt.prototype.keys=function e(){return this._keys.map(function(e){return e.slice()})};lt.prototype.values=function e(){return this._values.slice()};lt.prototype._getIndex=function e(t){for(var r=0;r<this._keys.length;++r){var n=this._keys[r];if(n.length===t.length){var i=true;for(var a=0;a<t.length;++a){var o=n[a],s=t[a];if(o!==s&&(!ut(o)||!ut(s))){i=false;break}}if(i){return r}}}return-1};var dt=function e(){this.clear()};var ft={size:{configurable:true}};dt.prototype.clear=function e(){this._keys=[];this._values=[];this._arrays=new lt;this._size=0};ft.size.get=function(){return this._size};dt.prototype.delete=function e(t){if(C(t)){if(this._arrays.delete(t)){this._size-=1;return true}else{return false}}else{var r=ht(this,t);if(r===-1){return false}else{this._keys.splice(r,1);this._values.splice(r,1);this._size-=1;return true}}};dt.prototype.get=function e(t){if(C(t)){return this._arrays.get(t)}else{var r=ht(this,t),value=r===-1?undefined:this._values[r];return value}};dt.prototype.has=function e(t){return C(t)?ht(this,t)!==-1:this._arrays.has(t)};dt.prototype.set=function e(t,value){if(C(t)){if(this._arrays.set(t,value)){this._size+=1}}else{var r=ht(this,t);if(r===-1){this._size+=1;this._keys.push(ut(t)?st:t);this._values.push(value)}else{this._values[r]=value}}return this};dt.prototype.keys=function e(){var e=this._keys.slice();for(var t=0;t<e.length;++t){if(e[t]===st){e[t]=NaN}}return e.concat(this._arrays.keys())};dt.prototype.values=function e(){return this._values.slice().concat(this._arrays.values())};Object.defineProperties(dt.prototype,ft);function ht(e,t){if(ut(t)){return e._keys.indexOf(st)}else{return e._keys.indexOf(t)}}var ct=function e(){this._map=new Map;this._arrays=new lt};var gt={size:{configurable:true}};ct.prototype.clear=function e(){this._arrays=new lt;return this._map.clear()};ct.prototype.delete=function e(t){return C(t)?this._arrays.delete(t):this._map.delete(t)};ct.prototype.get=function e(t){return C(t)?this._arrays.get(t):this._map.get(t)};ct.prototype.set=function e(t,value){if(C(t)){this._arrays.set(t,value)}else{this._map.set(t,value)}return this};ct.prototype.keys=function e(){return Array.from(this._map.keys()).concat(this._arrays.keys())};ct.prototype.values=function e(){return Array.from(this._map.values()).concat(this._arrays.values())};gt.size.get=function(){return this._map.size+this._arrays._keys.length};Object.defineProperties(ct.prototype,gt);var vt=dt;if(typeof Map!=="undefined"&&typeof Map.prototype.keys!=="undefined"&&typeof Map.prototype.values!=="undefined"){try{(new Map).keys().next();(new Map).values().next();vt=ct}catch(e){}}var pt=vt;var _t=8;var mt=function e(t){this._constructor=t;this._array=new t(_t);this._capacity=_t;this.length=0};mt.prototype.reserve=function e(t){if(this._capacity<t){t=Math.pow(2,Math.ceil(Math.log2(t+1)));var r=new this._constructor(t);r.set(this._array);this._capacity=t;this._array=r}};mt.prototype.has=function e(value){var t=yt(this._array,value,0,this.length);return t<this.length&&this._array[t]===value};mt.prototype.add=function e(value){var t=yt(this._array,value,0,this.length),r=t<this.length&&this._array[t]===value;if(!r){if(this.length===this._capacity){this.reserve(this.length+1)}this._array.copyWithin(t+1,t,this.length);this._array[t]=value;this.length+=1}return!r};mt.prototype.remove=function e(value){var t=yt(this._array,value,0,this.length),r=t<this.length&&this._array[t]===value;if(r){this._array.copyWithin(t,t+1,this.length);this.length-=1}return r};mt.prototype.removeByPosition=function e(t){if(t>=this.length){return false}this._array.copyWithin(t,t+1,this.length);this.length-=1;return true};mt.prototype.get=function e(t){return this._array[t]};mt.prototype.clear=function e(){this.length=0};mt.prototype.slice=function e(){return this._array.slice(0,this.length)};function yt(e,t,r,n){if(r===n){return r}else{var i=r+((n-r)/2|0),value=e[i],a=t-value;if(a===0){return i}else if(a<0){return yt(e,t,r,i)}else{return yt(e,t,i+1,n)}}}var bt=[];var xt=[RegExp,Date];if(typeof HTMLElement!=="undefined"){bt.push(HTMLElement)}function St(e,t){for(var r=0;r<t.length;++r){if(e instanceof t[r]){return true}}return false}var At=function(e){return typeof e!=="object"||e===null||C(e)||St(e,xt)};function Et(e,t,r,n){if(t===void 0)t=At;if(r===void 0)r=[];if(n===void 0)n=[];if(St(e,bt)){return}if(t(e)){r.push({path:n.slice(),value:e})}else{var i=Object.keys(e);for(var a=0;a<i.length;++a){var o=i[a],s=n.slice();s.push(o);Et(e[o],t,r,s)}}return r}var wt=function e(){this._keys=[];this._values=[];this._size=0;this._cachedPath=[];this._cachedIndex=-1};var kt={size:{configurable:true}};kt.size.get=function(){return this._size};wt.prototype.set=function e(t,value){var r=Ct(this,t);if(r!==-1){this._values=value}else{if(Tt(this._cachedPath,t)){this._cachedIndex=this._keys.length}this._keys.push(t);this._values.push(value);this._size+=1}};wt.prototype.get=function e(t){var r=Ct(this,t);if(r!==-1){return this._values[r]}else{return undefined}};wt.prototype.has=function e(t){return Ct(this,t)!==-1};wt.prototype.keys=function e(){return this._keys.slice()};Object.defineProperties(wt.prototype,kt);function Ct(e,t){if(Tt(t,e._cachedPath)){return e._cachedIndex}e._cachedPath=t.slice();for(var r=0;r<e._keys.length;++r){if(Tt(e._keys[r],t)){e._cachedIndex=r;return r}}e._cachedIndex=-1;return-1}function Tt(e,t){if(e.length!==t.length){return false}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return false}}return true}var Lt=function e(){this._values=[]};var Mt={size:{configurable:true}};Mt.size.get=function(){return this._values.length};Lt.prototype.clear=function e(){this._values=[]};Lt.prototype.add=function e(value){if(this._getIndex(value)===-1){this._values.push(value);return true}return false};Lt.prototype.addMultiple=function e(t){for(var r=0;r<t.length;++r){this.add(t[r])}};Lt.prototype.remove=function e(value){var t=this._getIndex(value);if(t!==-1){this._values.splice(t,1);return true}return false};Lt.prototype.has=function e(value){return this._getIndex(value)!==-1};Lt.prototype.values=function e(){return this._values.slice()};Lt.prototype.keys=function e(){return this._values};Lt.prototype._getIndex=function e(value){return this._values.indexOf(value)};Object.defineProperties(Lt.prototype,Mt);var It=function e(){this._set=new Set};var Ft={size:{configurable:true}};Ft.size.get=function(){return this._set.size};It.prototype.clear=function e(){this._set.clear()};It.prototype.add=function e(value){var t=this._set.size;this._set.add(value);var r=this._set.size;return r!==t};It.prototype.addMultiple=function e(t){for(var r=0;r<t.length;++r){this.add(t[r])}};It.prototype.remove=function e(value){return this._set.delete(value)};It.prototype.has=function e(value){return this._set.has(value)};It.prototype.values=function e(){return Array.from(this._set.values())};It.prototype.keys=function e(){return Array.from(this._set.keys())};Object.defineProperties(It.prototype,Ft);var Nt=Lt;if(typeof Set!=="undefined"){Nt=It;if(!Set.prototype.values){Nt.prototype.values=function(){var e=new Array(this._set.size);var t=0;this._set.forEach(function(value){return e[t++]=value});return e}}}var zt=Nt;var Rt={1:Bt(1),2:Bt(2),4:Bt(4),8:Dt(),16:Dt(),32:Dt(),int8:Dt(),int16:Dt(),int32:Dt(),float:Dt(),any:Dt()};var Pt={1:jt(1),2:jt(2),4:jt(4),8:Ot(),16:Ot(),32:Ot(),int8:Ot(),int16:Ot(),int32:Ot(),float:Ot(),any:Ot()};function Dt(){return new Function("array","index","return array[index];")}function Ot(){return new Function("array","index","value","array[index] = value;")}function Bt(e){var t=8/e;var r="return (array[index / "+t+" | 0] >> ((index % "+t+") * "+e+")) & "+((1<<e)-1)+";";return new Function("array","index",r)}function jt(e){return new Function("array","index","value","\n    var offset = (index % "+8/e+") * "+e+";\n    var finalIndex = index / "+8/e+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,e)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}function Vt(e,t){if(e===undefined&&t!=="any"&&t!=="resource"){return 0}else{return e}}var Ut=function e(t){var r=t.name;var n=t.storage;var i=t.size||0;var a=Vt(t.default,n);var o=Math.max(8,Ht(i+1));var s=n==="resource"?1:n;this._name=r;this._storage=n;this._getArrayElt=Rt[s];this._setArrayElt=Pt[s];this._elementSize=s;this._nbElements=o;this._fallback=null;this._byName=undefined;this._byIndex=undefined;this._nextIndex=undefined;this._defaultValue=a;this._BASE_VALUE=n==="any"?undefined:0;this._methods=Gt;this._initialized=false;this._buffer=null;if(n==="resource"){this._methods=Wt;this._byName={};this._byIndex=[];this._nextIndex=1;this._byName[a]=0;this._byIndex.push(a)}};Ut.prototype.getValues=function e(){return Object.keys(this._byName)};Ut.prototype.getName=function e(){return this._name};Ut.prototype.get=function e(t){return this._get(t)};Ut.prototype.set=function e(t,value){this._set(t,value)};Ut.prototype._get=function e(){return this._defaultValue};Ut.prototype._set=function e(t,value){if(value===this._defaultValue){return}this._initialize();this._set(t,value)};Ut.prototype.setFallback=function e(t){this._fallback=t;this.get=this._getWithFallback};Ut.prototype._getWithFallback=function e(t){var value=this._get(t);if(value===undefined){return this._fallback.get(t)}return value};Ut.prototype._initialize=function e(){this._initialized=true;this._buffer=Xt(this._nbElements,this._elementSize);this._get=this._methods.get;this._set=this._methods.set;if(this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE){this._reset(0)}};Ut.prototype.increaseNbElements=function e(t){var r=Ht(t+1);if(r<=this._nbElements){return}if(this._initialized){if(this._elementSize==="any"){for(var n=this._nbElements;n<r;++n){this._buffer.push(this._defaultValue)}}else{var i=Xt(r,this._elementSize);i.set(this._buffer);this._buffer=i;if(this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE){this._reset(this._nbElements)}}}this._nbElements=r};Ut.prototype.increaseElementSize=function e(){var t=this._elementSize;if(typeof t!=="number"||t===32){throw new Error("FlexArray: cannot increase element size")}var r=t*2;var n=Rt[r];var i=Pt[r];if(this._initialized){var a=this._nbElements;var o=this._getArrayElt;var s=this._buffer;var u=Xt(a,r);if(t>=8){u.set(s)}else{for(var l=0;l<a;++l){i(u,l,o(s,l))}}this._buffer=u}this._elementSize=r;this._getArrayElt=n;this._setArrayElt=i};Ut.prototype.buffer=function e(){if(!this._buffer){throw new Error("FlexArray: buffer not instantiated")}return this._buffer};Ut.prototype.elementBitSize=function e(){return this._elementSize};Ut.prototype.capacity=function e(){return this._nbElements};Ut.prototype.byteSize=function e(){return this._nbElements*this._elementSize/8};Ut.prototype.isInitialized=function e(){return this._initialized||this._fallback&&this._fallback.isInitialized()};Ut.prototype.getMultiple=function e(t,r){var n=t.length;if(r===undefined){r=new Array(n)}for(var i=0,a=n;i<a;++i){r[i]=this.get(t[i])}return r};Ut.prototype.fill=function e(t,value){for(var r=0,n=t.length;r<n;++r){this.set(t[r],value)}};Ut.prototype.setMultiple=function e(t,r,n){if(!n&&(Array.isArray(r)||ArrayBuffer.isView(r))){for(var i=0,a=t.length;i<a;++i){this.set(t[i],r[i])}}else{for(var o=0,s=t.length;o<s;++o){this.set(t[o],r)}}};Ut.prototype.reset=function e(){if(this._initialized){this._reset(0)}};Ut.prototype._reset=function e(t){var value=this._storage==="resource"?0:this._defaultValue;if(typeof this._elementSize!=="number"||this._elementSize>=8){this._buffer.fill(value,t)}else{var r=8/this._elementSize;var n=0;for(var i=0;i<r;++i){n=n<<this._elementSize;n+=value}if(t===undefined){this._buffer.fill(n)}else{var a=8-t%8;var o=t+a;for(var s=t;s<o;++s){this._setArrayElt(this._buffer,s,value)}this._buffer.fill(n,o/8)}}};Ut.prototype._getElementBitSize=function e(){return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))};var Gt={get:function e(t){return this._getArrayElt(this._buffer,t)},set:function e(t,value){this._setArrayElt(this._buffer,t,value)}};var Wt={get:function e(t){return this._byIndex[this._getArrayElt(this._buffer,t)]},set:function e(t,value){var r=this._byName[value];if(r===undefined){r=this._nextIndex++;this._byIndex.push(value);var n=this._getElementBitSize();if(n>this._elementSize){this.increaseElementSize()}this._byName[value]=r}this._setArrayElt(this._buffer,t,r)}};function Ht(e){var t=2;while(t<e){t*=2}return t}function Xt(e,t){if(t==="any"){return new Array(e)}else if(t==="float"){return new Float32Array(e)}else if(t==="int8"){return new Int8Array(e)}else if(t==="int16"){return new Int16Array(e)}else if(t==="int32"){return new Int32Array(e)}else if(t===32){return new Uint32Array(e)}else if(t===16){return new Uint16Array(e)}else{return new Uint8Array(Math.ceil(e/8*t))}}var qt=function e(t){this._name=t?"node":"edge";this._nextIndex=1;this._freeIndexes=[];this._indexesToBeFreed=[];this._idToIndex=Object.create(null);this._indexToId=[undefined];this._flexArrays=[];this._defaultValues=[];this._flexArraysByName={};this._indexLists=[];this._idFlexArray={_self:this,get:function e(t){return this._self._indexToId[t]},getMultiple:function e(t){var r=new Array(t.length);for(var n=0;n<t.length;++n){r[n]=this._self._indexToId[t[n]]}return r}}};qt.prototype.addElements=function e(t){var r=[];for(var n=0,i=t.length;n<i;++n){var a=t[n];var o=this._idToIndex[a];if(o===undefined){o=this._getNextIndex();this._idToIndex[a]=o;this._indexToId[o]=a}r.push(o)}for(var s=0,u=this._flexArrays;s<u.length;s+=1){var l=u[s];l.increaseNbElements(this._nextIndex)}for(var d=0,f=this._indexLists;d<f.length;d+=1){var h=f[d];h.reserve(this._nextIndex)}return new Uint32Array(r)};qt.prototype.removeElements=function e(t){for(var r=0,n=t.length;r<n;++r){var i=t[r];var a=this._indexToId[i];if(a!==undefined){delete this._idToIndex[a];this._removeIndex(i)}}};qt.prototype.clear=function e(){this._idToIndex=Object.create(null);this._indexToId=[undefined];this._nextIndex=1;this._freeIndexes=[];for(var t=0,r=this._flexArrays;t<r.length;t+=1){var n=r[t];n.reset()}for(var i=0,a=this._indexLists;i<a.length;i+=1){var o=a[i];o.reset()}};qt.prototype.has=function e(t){return this._indexToId[t]!==undefined};qt.prototype.getIndex=function e(t,r){if(r===void 0)r=false;var n=this._idToIndex[t];if(n===undefined&&r){throw new Error(this._name+' id "'+t+'" not found')}return n};qt.prototype.createFlexArray=function e(t){var r=t.name;if(r&&this._flexArraysByName[r]){throw new Error(this._name+' flexArray "'+r+'" already exists')}var n=t.default;if(n===undefined&&t.storage!=="any"&&t.storage!=="resource"){n=0}var i=this._nextIndex;var a=new Ut({storage:t.storage,size:i,default:n,name:r});this._flexArrays.push(a);this._defaultValues.push(t.default);if(r){this._flexArraysByName[r]=a}return a};qt.prototype.getFlexArray=function e(t){if(t==="id"){return this._idFlexArray}return this._flexArraysByName[t]||null};qt.prototype.getAllFlexArrays=function e(){return this._flexArrays.slice()};qt.prototype.createIndexList=function e(){var t=new ot;t.reserve(this._nextIndex);this._indexLists.push(t);return t};qt.prototype.getId=function e(t){return this._indexToId[t]};qt.prototype.getMaxIndex=function e(){return this._nextIndex-1};qt.prototype._removeIndex=function e(t){this._indexesToBeFreed.push(t)};qt.prototype._getNextIndex=function e(){var t=this._freeIndexes.pop();if(t===undefined){t=this._nextIndex++}return t};qt.prototype.freeIndexes=function e(){for(var t=0,r=this._indexesToBeFreed;t<r.length;t+=1){var n=r[t];this._indexToId[n]=undefined;this._freeIndexes.push(n)}for(var i=0;i<this._flexArrays.length;++i){var a=this._flexArrays[i];var o=this._defaultValues[i];for(var s=0,u=this._indexesToBeFreed;s<u.length;s+=1){var l=u[s];a.set(l,o)}}this._indexesToBeFreed=[]};var Yt=8;var Zt=function e(){this._BIG_LIST=new Uint8Array([-1])[0];this._MAX_LIST_SIZE=8;this._capacity=Yt;this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE);this._sizes=new Uint8Array(this._capacity);this._bigLists=[];this._nextIndex=0;this._constList=new Array(this._MAX_LIST_SIZE)};Zt.prototype.addEntry=function e(t){if(t===undefined){t=this._nextIndex++}if(t>=this._capacity){this._reserve(t+1)}this._sizes[t]=0;return t};Zt.prototype.get=function e(t){var r=this._sizes[t];var n=this._MAX_LIST_SIZE*t;if(r<=this._MAX_LIST_SIZE){this._constList.length=r;for(var i=0,a=r;i<a;++i){this._constList[i]=this._buffer[n+i]}return this._constList}else if(r===this._BIG_LIST){var o=this._buffer[n];return this._bigLists[o]}};Zt.prototype.size=function e(t){var e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length};Zt.prototype.sizes=function e(t){var e=this._sizes;var r=this._bigLists;var n=this._buffer;var i=this._MAX_LIST_SIZE;var a=t.length;var o=new Array(a);for(var s=0;s<a;s++){var u=t[s];var l=e[u];o[s]=l<=i?l:r[n[u*i]].length}return o};Zt.prototype.addTo=function e(t,value){var r=this._sizes[t];var n=t*this._MAX_LIST_SIZE;if(r<this._MAX_LIST_SIZE){this._buffer[n+r]=value;this._sizes[t]=r+1}else if(r===this._BIG_LIST){var i=this._buffer[n];this._bigLists[i].push(value)}else{var a=new Array(this._MAX_LIST_SIZE);for(var o=0;o<this._MAX_LIST_SIZE;++o){a[o]=this._buffer[n+o]}a.push(value);this._bigLists.push(a);this._sizes[t]=this._BIG_LIST;this._buffer[n]=this._bigLists.length-1}};Zt.prototype.removeFrom=function e(t,value){this.removeFromAndGetSize(t,value)};Zt.prototype.removeFromAndGetSize=function e(t,value){var r=this._MAX_LIST_SIZE*t;var n=this._sizes[t];if(n<=this._MAX_LIST_SIZE){for(var i=r,a=r+n;i<a;++i){if(this._buffer[i]===value){n-=1;this._buffer[i]=this._buffer[a-1];this._sizes[t]=n;return n}}}else if(n===this._BIG_LIST){var o=this._buffer[r];var s=this._bigLists[o];var u=s.indexOf(value);if(u!==-1){s.splice(u,1);return s.length}}throw new Error('topology: Table: "removeFrom" failed, should not happen')};Zt.prototype.reserve=function e(t){if(this._capacity<t){this._reserve(t)}};Zt.prototype._reserve=function e(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t)));this._buffer=Kt(this._buffer,this._capacity*this._MAX_LIST_SIZE);this._sizes=Kt(this._sizes,this._capacity)};function Kt(e,t){var r=new e.constructor(t);r.set(e);return r}var Qt=typeof performance!=="undefined"&&performance.now?function(){return performance.now()|0}:function(){return Date.now()};var Jt=Qt();function $t(){return Qt()-Jt}function er(){var e=new Date;var t=e.getDate();var r=e.getMonth()+1;var n=e.getFullYear();if(t<10){t="0"+t}if(r<10){r="0"+r}return n+"-"+r+"-"+t}function tr(){var e=new Date;var t=rr((e.getUTCHours()-(e.getTimezoneOffset()/60|0))%24);var r=rr(e.getUTCMinutes());var n=rr(e.getUTCSeconds());var i=rr(e.getUTCMilliseconds(),3);return"["+t+":"+r+":"+n+":"+i+"]"}function rr(e,t){t=t||2;var r=Math.pow(10,t-1);var n=e;while(r>1){if(e<r){n="0"+n}r/=10}return n}var nr=A("webworker-threads");var ir=nr?nr.Worker:null;function ar(e){if(ir){return or(e)}else{return e}}function or(e){if(ArrayBuffer.isView(e)){return Array.from(e)}else if(Array.isArray(e)){for(var t=0;t<e.length;++t){e[t]=or(e[t])}return e}else if(ee(e)){var r=Object.keys(e);for(var n=0,i=r;n<i.length;n+=1){var a=i[n];e[a]=or(e[a])}return e}else{return e}}function sr(e){if(ir){return dr(e)}else if(typeof URL==="undefined"||navigator.appVersion.indexOf("MSIE 10")!==-1){return lr(e)}else{return ur(e)}}function ur(e){try{var t=new Blob([e],{type:"application/javascript"});var r=URL.createObjectURL(t);var n=new Worker(r);return n}catch(t){return new fr(e)}}function lr(e){return new fr(e)}function dr(e){return new ir(new Function(e))}var fr=function e(t){this._f=new Function("self",t);this._main=true;this._listeners=[];this._terminated=false;this._otherSide=new hr(this);this._f(this._otherSide)};fr.prototype.terminate=function e(){this._terminated=false;this._otherSide._terminated=true};fr.prototype.addEventListener=cr;fr.prototype.postMessage=gr;var hr=function e(t){this._main=false;this._listeners=[];this._terminated=false;this._otherSide=t};hr.prototype.addEventListener=cr;hr.prototype.postMessage=gr;function cr(e,t){this._listeners.push(t)}function gr(e){setTimeout(vr,0,this._otherSide,{data:e})}function vr(e,t){if(e._terminated){return}for(var r=0;r<e._listeners.length;++r){e._listeners[r](t)}}var pr=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function _r(e,t){if(t===void 0)t=[];var r=pr.exec(e);if(r){t[0]=parseInt(r[1])/255;t[1]=parseInt(r[2])/255;t[2]=parseInt(r[3])/255;t[3]=r[4]===undefined?1:parseFloat(r[4]);return t}else{return null}}function mr(e){if(e<16){return"0"+e.toString(16)}else{return e.toString(16)}}function yr(e){var t=e[0];var r=e[1];var n=e[2];var i=e[3];if(i===void 0)i=1;return"rgba("+(t*256|0)+","+(r*256|0)+","+(n*256|0)+","+i+")"}function br(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,r,n){return t+t+r+r+n+n});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(r){return[parseInt(r[1],16)/255,parseInt(r[2],16)/255,parseInt(r[3],16)/255,1]}else{return null}}var xr=function e(t){this._name=t;this._attributes={};this._children=[]};var Sr={tagName:{configurable:true},children:{configurable:true},childNodes:{configurable:true},firstChild:{configurable:true}};xr.prototype.setAttribute=function e(t,value){this._attributes[t]=value};xr.prototype.appendChild=function e(t){this._children.push(t)};Sr.tagName.get=function(){return this._name};Sr.children.get=function(){return this._children};Sr.childNodes.get=function(){return this._children};Sr.firstChild.get=function(){return this._children[0]||null};xr.prototype.serialize=function e(){var t=this._name;var r=this._attributes;var n=this._children;var i=Object.keys(r).filter(function(e){return r[e]!==undefined});var a=i.map(function(e){return" "+e+'="'+(""+r[e])+'"'}).join("");var o=n.map(function(e){return e.serialize()}).join("");if(!o.length){return"<"+t+a+"/>"}else{return"<"+t+a+">"+o+"</"+t+">"}};xr.prototype.cloneNode=function e(t){var r=new xr(this._name);var n=Object.keys(this._attributes);for(var i=0,a=n;i<a.length;i+=1){var o=a[i];r.setAttribute(o,this._attributes[o])}if(t){for(var s=0;s<this._children.length;s++){r.appendChild(this._children[s].cloneNode(t))}}return r};Object.defineProperties(xr.prototype,Sr);var Ar=function e(t){this._text=t};Ar.prototype.serialize=function e(){return this._text};Ar.prototype.cloneNode=function e(){return new Ar(this._text)};var Er=function e(){this._children=[];this._meta=[]};Er.prototype.appendChild=function e(t){this._children.push(t)};Er.prototype.serialize=function e(){return this._meta.concat(this._children.map(function(e){return e.serialize()})).join("")};Er.prototype.createElement=function e(t){return new xr(t)};Er.prototype.createTextNode=function e(t){return new Ar(t)};function wr(){return new Er}var kr=function e(t){this._keyToValue=t;this._keyToIndex=new Int32Array(t.length);this._heap=[];this._size=0;this._keyToIndex.fill(-1)};kr.prototype.add=function e(t){var r=this._keyToIndex[t];if(r===-1){r=this._size++;this._heap[r]=t}this._keyToIndex[t]=this._bubble(r)};kr.prototype.removeMin=function e(){if(this._size===0){return NaN}var t=this._heap[0];this._heap[0]=this._heap[--this._size];this._bubble(0);return t};kr.prototype.isEmpty=function e(){return this._size===0};kr.prototype.has=function e(t){return this._keyToIndex[t]!==-1};kr.prototype._bubble=function e(t){var value=this._indexToValue(t);var r=this._getParentIndex(t);var n=this._indexToValue(r);var i=t;if(t!==0&&n>value){i=this._swap(t,r)}else{var a=this._getLeftChildIndex(t);var o=this._getRightChildIndex(t);var s=this._indexToValue(a);var u=this._indexToValue(o);var l=Math.min(value,s,u);if(l===value);else if(l===s){i=this._swap(t,a)}else{i=this._swap(t,o)}}if(i===t){return t}else{return this._bubble(i)}};kr.prototype._indexToValue=function e(t){if(t>=this._size){return Infinity}else{return this._keyToValue[this._heap[t]]}};kr.prototype._getParentIndex=function e(t){return(t-1)/2|0};kr.prototype._getLeftChildIndex=function e(t){return t*2+1};kr.prototype._getRightChildIndex=function e(t){return t*2+2};kr.prototype._swap=function e(t,r){var n=this._heap[t];var i=this._heap[r];this._heap[t]=i;this._heap[r]=n;this._keyToIndex[n]=r;this._keyToIndex[i]=t;return r};var Cr=function e(t,r){this._graph=t.modules.graph;this._nodes={ElementList:t.NodeList,flexArray:this._graph.createNodeAttribute({storage:1,name:r}),indexList:this._graph.createIndexList(true)};this._edges={ElementList:t.EdgeList,flexArray:this._graph.createEdgeAttribute({storage:1,name:r}),indexList:this._graph.createIndexList(false)}};Cr.prototype._get=function e(t){return t.isNode?this._nodes:this._edges};Cr.prototype.addOrRemoveElements=function e(t,r){return r?this.addElements(t):this.removeElements(t)};Cr.prototype.addElements=function e(t){var r=this._get(t);var n=r.ElementList;var i=r.flexArray;var a=r.indexList;var o=a.getLength();for(var s=0,u=t._indexes;s<u.length;s+=1){var l=u[s];if(i.get(l)!==1){i.set(l,1);a.pushUnchecked(l)}}var d=a.slice(o);return new n(d)};Cr.prototype.removeElements=function e(t){var r=this._get(t);var n=r.ElementList;var i=r.flexArray;var a=r.indexList;var o=a.getLength();var s=a.getBuffer();var u=0;for(var l=0,d=t._indexes;l<d.length;l+=1){var f=d[l];if(i.get(f)!==0){i.set(f,0);u+=1}}if(u===o){return new n(a.sliceAndReset())}else if(u===0){return new n}else{var h=this._graph.acquireTemporaryIndexList(t);var c=0;for(var g=0;g<o;++g){var v=s[g];if(i.get(v)===0){c+=1;h.pushUnchecked(v)}else{s[g-c]=v}}a.setLength(o-u);return new n(h.sliceAndReset())}};Cr.prototype.hasElement=function e(t){return!!this._get(t).flexArray.get(t._index)};Cr.prototype.clear=function e(){if(!this._nodes.indexList.isEmpty()){this._nodes.indexList.reset();this._nodes.flexArray.reset()}if(!this._edges.indexList.isEmpty()){this._edges.indexList.reset();this._edges.flexArray.reset()}};Cr.prototype.isEmpty=function e(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()};Cr.prototype.getElements=function e(){return{nodes:new this._nodes.ElementList(this._nodes.indexList.slice()),edges:new this._edges.ElementList(this._edges.indexList.slice())}};function Tr(e,t,r,n){if(n===void 0)n=0;if(t===undefined){t=r=Math.sqrt(e.length/4)}if(r===undefined){r=t}var i=document.createElement("canvas");var a=i.getContext("2d");var o=a.createImageData(t,r);i.style.imageRendering="pixelated";i.style.border="1px solid black";i.style.margin="2px";i.width=t;i.height=r;o.data.set(e);a.putImageData(o,0,0);var s=document.getElementById("graph-container");if(s){s.style.position="static"}setTimeout(function(){return document.body.appendChild(i)},n)}function Lr(e,t,r){if(!r){r=t;t=undefined}console.time(e);var n=r(t);console.timeEnd(e);return n}var Mr=function e(t){this._values=t;this._list=new Array(t.length*3);this._idToIndex={};var r=this._list;for(var n=0,i=-1;n<t.length;n++){this._idToIndex[t[n]]=n;r[n*3]=n;r[n*3+1]=i;r[n*3+2]=n+1;i=n}r[r.length-1]=-1;this._end=t.length-1;this._begin=0;this._size=t.length};var Ir={size:{configurable:true}};Mr.prototype.pop=function e(){if(this._size===0){return undefined}var t=this._list;var r=this._end*3;var n=t[r+1];var i=this._values[t[r]];t[r]=-1;t[r+1]=-1;t[r+2]=-1;this._end=n;this._size--;return i};Mr.prototype.shift=function e(){if(this._size===0){return undefined}var t=this._list;var r=this._begin*3;var n=t[r+2];var i=this._values[t[r]];t[r]=-1;t[r+1]=-1;t[r+2]=-1;this._begin=n;this._size--;return i};Mr.prototype.has=function e(t){var r=this._idToIndex[t];return r!==undefined&&this._list[r*3]!==-1};Mr.prototype.remove=function e(t){var r=this._idToIndex[t];var n=r*3;var i=this._list;if(i[n]===-1){return undefined}var a=i[n+1];var o=i[n+2];if(o!==-1){i[o*3+1]=a}if(a!==-1){i[a*3+2]=o}if(r===this._begin){this._begin=o}if(r===this._end){this._end=a}var s=this._values[i[n]];i[n]=i[n+1]=i[n+2]=-1;this._size--;return s};Ir.size.get=function(){return this._size};Mr.prototype.begin=function e(){return this._values[this._list[this._begin*3]]};Mr.prototype.end=function e(){return this._values[this._list[this._end*3]]};Object.defineProperties(Mr.prototype,Ir);var Fr=function e(t){if(t===void 0)t={};var r=t.xValues;if(r===void 0)r=[];var n=t.yValues;if(n===void 0)n=[];var i=t.scaledSizeValues;if(i===void 0)i=[];var a=t.fixedSizeValues;if(a===void 0)a=[];this.minX=nt(r);this.minY=nt(n);this.maxX=rt(r);this.maxY=rt(n);this.minScaledSize=nt(i);this.maxScaledSize=rt(i);this.minFixedSize=nt(a);this.maxFixedSize=rt(a);this.cx=this.minX+(this.maxX-this.minX)/2;this.cy=this.minY+(this.maxY-this.minY)/2;this.width=this.maxX-this.minX;this.height=this.maxY-this.minY};Fr.prototype.reset=function e(){this.minX=Infinity;this.minY=Infinity;this.maxX=-Infinity;this.maxY=-Infinity;this.minScaledSize=Infinity;this.maxScaledSize=-Infinity;this.minFixedSize=Infinity;this.maxFixedSize=-Infinity;this.width=0;this.height=0;this.cx=0;this.cy=0;return this};Fr.prototype.addPoint=function e(t,r,n,i){this.minX=Math.min(this.minX,t);this.minY=Math.min(this.minY,r);this.maxX=Math.max(this.maxX,t);this.maxY=Math.max(this.maxY,r);if(n!==undefined&&i!==undefined){if(i==="scaled"){this.minScaledSize=Math.min(this.minScaledSize,n);this.maxScaledSize=Math.max(this.maxScaledSize,n)}else{this.minFixedSize=Math.min(this.minFixedSize,n);this.maxFixedSize=Math.max(this.maxFixedSize,n)}}this.cx=this.minX+(this.maxX-this.minX)/2;this.cy=this.minY+(this.maxY-this.minY)/2;this.width=this.maxX-this.minX;this.height=this.maxY-this.minY;return this};Fr.prototype.computeForZoom=function e(t){var r=Math.max(this.maxScaledSize,this.maxFixedSize/t);return Fr.from({minX:this.minX-r/2,minY:this.minY-r/2,maxX:this.maxX+r/2,maxY:this.maxY+r/2,width:this.width+r,height:this.height+r})};Fr.from=function e(t){if(t===void 0)t={};var r=t.minX;var n=t.minY;var i=t.maxX;var a=t.maxY;var o=t.width;var s=t.height;var u=new Fr;u.minX=r;u.minY=n;u.maxX=i;u.maxY=a;u.width=o||(i-r)/2;u.height=s||(a-n)/2;u.cx=(r+i)/2;u.cy=(n+a)/2;return u};Fr.fromValues=function e(t,r,n){var i=Infinity,a=Infinity;var o=-Infinity,s=-Infinity;var u=-Infinity;for(var l=0;l<t.length;l++){var d=t[l],f=r[l],h=n[l];if(d-h<i){i=d-h}if(f-h<a){a=f-h}if(d+h>o){o=d+h}if(f+h>s){s=f+h}if(h>u){u=h}}var c=Fr.from({minX:i,minY:a,maxX:o,maxY:s});c.maxScaledSize=u;return c};Fr.prototype.pad=function e(value){this.minX-=value;this.minY-=value;this.maxX+=value;this.maxY+=value;this.width+=2*value;this.height+=2*value;return this};Fr.prototype.isValid=function e(){return isFinite(this.width)&&isFinite(this.height)};Fr.prototype.extend=function e(t){this.addPoint(t.minX,t.minY);this.addPoint(t.maxX,t.maxY);return this};Fr.prototype.bottomLeft=function e(){return{x:this.minX,y:this.minY}};Fr.prototype.topRight=function e(){return{x:this.maxX,y:this.maxY}};var Nr=Array.isArray;var zr=function e(){};zr.prototype.on=function e(t,r){if(typeof t!=="string"){throw new TypeError("Event name must be string")}if(typeof r!=="function"){throw new TypeError("Event handler must be function")}var n=this._events=this._events||{};var i=n[t]=n[t]||[];i.push(r);return this};zr.prototype.off=function e(t,r){if(typeof t!=="string"){throw new TypeError("Event name must be string")}var n=this._event=this._events||{};var i=n[t];if(Nr(i)){if(typeof r!=="function"){n[t]=null}else{var a=i.indexOf(r);if(a!==-1){i.splice(a,1)}if(i.length===0){n[t]=null}}}return this};zr.prototype.fire=function e(t){if(typeof t!=="string"){throw new TypeError("Event name must be string")}var r=this._event=this._events||{};var n=r[t],i;if(Nr(n)){var a=Array.prototype.slice.call(arguments,1);for(var o=0;o<n.length;o++){i=n[o];if(i){i.apply(this,a)}}}return this};zr.prototype.once=function e(t,r){var n=this;var i=function(){r.apply(n,Array.prototype.slice.call(arguments,0));n.off(t,i)};i.handler=r;return this.on(t,i)};zr.prototype.hasListener=function e(t,r){if(!t||!r){return false}var n=this._events=this._events||{};var i=n[t];if(Nr(i)){var a;for(var o=0,s=i.length;o<s;o++){a=i[o];if(a===r||a.handler===r){return true}}}return false};zr.prototype.getListeners=function e(t){var r=this._events=this._events||{};return r[t]};zr.mixin=function(e){var t=typeof e==="function"?e.prototype:e;var r=["addEventListener","removeEventListener","addOneTimeEventListener","dispatch","on","off","once","fire","trigger"];for(var n=0,i=r.length;n<i;n++){var a=r[n];t[a]=zr.prototype[a]}return e};zr.prototype.addEventListener=zr.prototype.on;zr.prototype.removeEventListener=zr.prototype.off;zr.prototype.addOneTimeEventListener=zr.prototype.once;zr.prototype.trigger=zr.prototype.dispatch=zr.prototype.fire;var Rr=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"];var Pr=function e(){this._colorByName={};this._colorByName["null"]=[0,0,0,0];this._colorByName["transparent"]=[0,0,0,0];this._temp=[0,0,0,0];for(var t=0;t<Rr.length;t+=2){var r=Rr[t].toLowerCase();var value=Rr[t+1];this._colorByName[r]=br(value)}};Pr.prototype.parseColor=function e(t){var r=this._colorByName[t];if(r===undefined){var n=t+"";r=n.charAt(0)==="#"?br(n):_r(n);this._colorByName[t]=r}return r};Pr.prototype.toHexa=function e(t){var r=this.parseColor(t);return"#"+mr(r[0])+mr(r[1])+mr(r[2])};Pr.prototype.rgbaToRgb=function e(t){var r=1;var n=t;if(n&&_r(t,this._temp)){n="rgb("+ +this._temp[0]*255+","+ +this._temp[1]*255+","+ +this._temp[2]*255+")";r=parseFloat(this._temp[3])}return{color:n,opacity:r}};var Dr=Object.freeze({HeapSet:Mr,BoundingBox:Fr,FlexArray:Ut,EventTarget:zr,ColorManager:Pr,requestAnimFrame:_,cancelAnimFrame:m,getDocument:de,getStyle:fe,isWebGLSupported:he,getWebglContext:ce,DummyXHR:ge,DummyFileReader:ve,DummyCanvas:me,createDummyDomElement:Se,createXmlDocument:Ae,serializeXMLDocument:Ee,createCanvas:we,getPixelRatio:ke,dataUrlToBlob:Ce,createBlob:Le,isBlob:Me,promptDownload:Ie,resizeElement:Fe,setAttributes:Ne,createSvgElement:ze,createTextNode:Re,getImage:Pe,fetch:Oe,isHTMLElement:Be,applyCursorStyle:je,getBoundingClientRect:Ve,fetchBinary:Ue,fetchBinaryAsBase64:Ge,setCtxFont:We,escapeDOMAttribute:He,getDocumentFontRules:Xe,getEmbeddedFontRules:qe,resolvePath:Ke,IndexList:ot,isInteger:N,toPropertyPath:z,throttle:R,debounce:P,processQueue:O,isLittleEndian:B,isRawObject:j,getValues:V,forEach:U,deepCopy:G,updateObject:W,extendList:H,setProperty:X,getProperty:q,flatten:Y,unflatten:Z,getFlattenedKeys:K,getLeafValues:Q,ensureTransferable:J,getOptions:$,isObject:ee,mergeValues:te,PathMap:wt,objToValueList:Et,smartRequire:A,getCurrentTime:$t,getDate:er,getTime:tr,formatWorkerMessage:ar,createWorker:sr,insertSortAsc:E,insertSortDesc:w,pushMultipleValues:k,isArray:C,toArray:T,writeSequenceAt:L,flattenArray:M,concatenateArrays:I,removeFromArray:F,parseColorRgba:_r,toHexa:mr,componentsToRGBA:yr,parseColorHex:br,createDummyXmlDocument:wr,PrioritySet:kr,nextPowerOfTwo:Qe,computeSum:Je,clamp:$e,mix:et,lerp:tt,computeMax:rt,computeMin:nt,getBaseLog:it,ElementSet:Cr,displayPixelsOnScreen:Tr,measure:Lr});function circleCircleIntersection(e,t,r,n,i,a){var o,s,u,l,d,f,h;var c,g;s=n-e;u=i-t;l=Math.sqrt(s*s+u*u);if(l>r+a){return null}if(l<Math.abs(r-a)){return null}o=(r*r-a*a+l*l)/(2*l);c=e+s*o/l;g=t+u*o/l;d=Math.sqrt(r*r-o*o);f=-u*(d/l);h=s*(d/l);return[[c+f,g+h],[c-f,g-h]]}function circleSortCompare(e,t,r,n,i,a){if(e-i>=0&&r-i<0){return 1}if(e-i<0&&r-i>=0){return-1}if(e-i===0&&r-i===0){return t-n>=0||n-a>=0?t-n:n-t}var o=(e-i)*(n-a)-(r-i)*(t-a);if(o<0){return 1}if(o>0){return-1}var s=(e-i)*(e-i)+(t-a)*(t-a);var u=(r-i)*(r-i)+(n-a)*(n-a);return s-u}function Or(e,t,r){var n=e[2];var i=Math.abs(e[0]-t),a=Math.abs(e[1]-r);if(i+a<=n){return true}if(i>n||a>n){return false}return Math.sqrt(i*i+a*a)<n+1e-12}function Br(e,t,r,n){var i=e[0]-t,a=e[1]-r,o=e[2]-n;return i*i+a*a<o*o+1e-6}function jr(e,t,r,n,i,a,o){var s=Math.max(n,Math.min(a,e));var u=Math.max(i,Math.min(o,t));var l=e-s;var d=t-u;return l*l+d*d<r*r}function Vr(e,t,r,n,i,a,o,s){var u=s||{x:0,y:0};var l,d,f,h;if(r===e){var c=e-i;var g=o*o-c*c;if(g<0){return null}var v=Math.sqrt(g);l=e;f=e;d=a+v;h=a-v}else{var p=(n-t)/(r-e);var _=t-p*e;var m=_-a;var y=p*p+1;var b=2*(p*m-i);var x=i*i+m*m-o*o;var S=b*b-4*y*x;if(S<0){return null}var A=-b;var E=Math.sqrt(S);var w=2*y;l=(A+E)/w;f=(A-E)/w;d=p*l+_;h=p*f+_}var k=e-l;var C=t-d;var T=e-f;var L=t-h;if(k*k+C*C<T*T+L*L){u.x=l;u.y=d}else{u.x=f;u.y=h}return u}function Ur(e,t,r,n,i,a){if(a===void 0)a={x:0,y:0};var o=Math.cos(i),s=Math.sin(i),u=e-r,l=t-n;a.x=o*u-s*l+r;a.y=s*u+o*l+n;return a}function Gr(e,t,r,n){if(r===void 0)r=0;if(n===void 0)n={};var i=e.x;var a=e.y;n.x=i+r*Math.sin(t);n.y=a+r*Math.cos(t);return n}function distance(e,t,r,n){return Math.sqrt((e-r)*(e-r)+(t-n)*(t-n))}function Wr(e,t,r,n){var i=e-r;var a=t-n;return i*i+a*a}function Hr(e){return e*180/Math.PI}function Xr(e,t){e.minX-=t;e.minY-=t;e.maxX+=t;e.maxY+=t;e.width+=2*t;e.height+=2*t;return e}function qr(e){var t=0;var r=0;for(var n=0;n<e.length;++n){var i=e[n];t+=i.x;r+=i.y}t/=e.length;r/=e.length;return{x:t,y:r}}function Yr(e,t,r,n,i,a,o,s,u){if(s===void 0)s=0;if(u===void 0)u=false;var l=distance(r,n,i,a),d=o/2*(u?distance(e,t,i,a)/l:1),f=(d+s)/l,h=(i-r)*f,c=(a-n)*f,g=r+c,v=n-h,p=r-c,_=n+h,m=i+c,y=a-h;var b=e-g,x=t-v,S=p-g,A=_-v,E=m-g,w=y-v;var k=b*S+x*A,C=S*S+A*A,T=b*E+x*w,L=E*E+w*w;return k>0&&k<C&&T>0&&T<L}function Zr(e,t,r,n,i){if(i&&(Kr(e,r)||Kr(e,n)||Kr(t,r)||Kr(t,n))){return false}var a=(e.y-r.y)*(n.x-r.x)-(e.x-r.x)*(n.y-r.y),o=(t.x-e.x)*(n.y-r.y)-(t.y-e.y)*(n.x-r.x);if(o===0){return false}var s=a/o;a=(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y);var u=a/o;return!(s<=0||s>=1||u<=0||u>=1)}function Kr(e,t){return e.x===t.x&&e.y===t.y}function Qr(e,t,r,n){return Math.atan2(n-t,r-e)}function Jr(e,t,r){var n=Qr(e.x,e.y,t.x,t.y)-Qr(r.x,r.y,t.x,t.y);if(n<0){n+=2*Math.PI}return n}function $r(e,t,r,n,i,a,o,s){var u,l,d;var f=(s-a)*(r-e)-(o-i)*(n-t);if(f===0){return null}u=t-a;l=e-i;d=(o-i)*u-(s-a)*l;u=d/f;return{x:e+u*(r-e),y:t+u*(n-t)}}function en(e,t,r,n,i,a,o,s){var u;var l=[];u=$r(e,t,r,n,i,a,i,s);if(u){l.push(u)}u=$r(e,t,r,n,i,s,o,s);if(u){l.push(u)}u=$r(e,t,r,n,o,s,o,a);if(u){l.push(u)}u=$r(e,t,r,n,o,a,i,a);if(u){l.push(u)}return l}function tn(e,t,r,n,i,a,o,s){var u=((o-i)*(t-a)-(s-a)*(e-i))/((s-a)*(r-e)-(o-i)*(n-t));var l=((r-e)*(t-a)-(n-t)*(e-i))/((s-a)*(r-e)-(o-i)*(n-t));if(u>=0&&u<=1&&l>=0&&l<=1){return true}return false}function rn(e,t,r,n,i,a,o,s){if(e>=i&&t>=a&&e<=o&&t<=s){return true}if(r>=i&&n>=a&&r<=o&&n<=s){return true}if(tn(e,t,r,n,i,a,i,s)){return true}if(tn(e,t,r,n,o,a,o,s)){return true}if(tn(e,t,r,n,i,a,o,a)){return true}if(tn(e,t,r,n,i,s,o,s)){return true}return false}function nn(e,t,r){return Math.sqrt(an(e.x,e.y,t.x,t.y,r.x,r.y))}function an(e,t,r,n,i,a){var o=on(r,n,i,a);if(o===0){return on(e,t,r,n)}var s=((e-r)*(i-r)+(t-n)*(a-n))/o;s=Math.max(0,Math.min(1,s));return on(e,t,r+s*(i-r),n+s*(a-n))}function on(e,t,r,n){return sn(e-r)+sn(t-n)}function sn(e){return e*e}function un(e,t,r,n,i,a){var o=i-r;var s=a-n;if(o===0&&s===0){return{x:r,y:n}}var u=((e-r)*o+(t-n)*s)/(o*o+s*s);if(u<0){return{x:r,y:n}}else if(u>1){return{x:i,y:a}}else{return{x:r+u*o,y:n+u*s}}}function ln(e,t,r,n,i,a){var o=e-r,s=t-n;var u=i-r,l=a-n;var d=u*u+l*l;var f=o*u+s*l;var h=f/d;return{x:r+u*h,y:n+l*h}}function dn(e,t,r,n){if(n===undefined){n=r.length}var i=n-1,a=false;for(var o=0;o<n;++o){if((r[o].y<t&&r[i].y>=t||r[i].y<t&&r[o].y>=t)&&(r[o].x<=e||r[i].x<=e)){a^=r[o].x+(t-r[o].y)/(r[i].y-r[o].y)*(r[i].x-r[o].x)<e}i=o}return a}function fn(e){var t=e.x*e.x+e.y*e.y;return{x:e.x/t,y:e.y/t}}function hn(e,t){var r=Infinity;var n=-Infinity;for(var i=0,a=e.length;i<a;i++){var o=e[i];var s=o.x*t.x+o.y*t.y;if(s<r){r=s}if(s>n){n=s}}return{x:r,y:n}}function cn(e,t){var r=new Array(4);var n,i,a,o;n=e[1],i=e[0];a=fn({x:n.x-i.x,y:n.y-i.y});o=a.x;a.x=-a.y;a.y=o;r[0]=a;n=e[2];i=e[1];a=fn({x:n.x-i.x,y:n.y-i.y});o=a.x;a.x=-a.y;a.y=o;r[1]=a;n=t[1];i=t[0];a=fn({x:n.x-i.x,y:n.y-i.y});o=a.x;a.x=-a.y;a.y=o;r[2]=a;n=t[2];i=t[1];a=fn({x:n.x-i.x,y:n.y-i.y});o=a.x;a.x=-a.y;a.y=o;r[3]=a;return r}function gn(e,t){var r=cn(e,t);for(var n=0,i=r.length;n<i;n++){var a=r[n];var o=hn(e,a);var s=hn(t,a);var u=o.x<=s.y&&o.y>=s.x?Math.min(o.y,s.y)-Math.max(o.x,s.x):0;if(u===0){return false}}return true}var vn=1e-6;var pn=1e-12;function _n(){var e=arguments;var t=e.length-1;var r=t;var n=[];for(var i=0;i<=t;i++){if(Math.abs(e[i])<=pn){t--}else{break}}switch(t){case 1:mn(e[r],e[r-1],n);break;case 2:yn(e[r],e[r-1],e[r-2],n);break;case 3:bn(e[r],e[r-1],e[r-2],e[r-3],n);break;default:break}return n}function mn(e,t,r){if(r===void 0)r=[];if(t!==0){r.push(-e/t)}return r}function yn(e,t,r,n){if(n===void 0)n=[];var i=r;var a=t/i;var o=e/i;var s=a*a-4*o;if(s>0){var u=Math.sqrt(s);n.push(.5*(-a+u));n.push(.5*(-a-u))}else if(s===0){n.push(.5*-a)}return n}function bn(e,t,r,n,i){if(i===void 0)i=[];var a=n;var o=r/a;var s=t/a;var u=e/a;var l=(3*s-o*o)/3;var d=(2*o*o*o-9*s*o+27*u)/27;var f=o/3;var h=d*d/4+l*l*l/27;var c=d/2;var g,v;if(Math.abs(h)<=vn){h=0}if(h>0){var p=Math.sqrt(h);g=-c+p;if(g>=0){v=Math.pow(g,1/3)}else{v=-Math.pow(-g,1/3)}g=-c-p;if(g>=0){v+=Math.pow(g,1/3)}else{v-=Math.pow(-g,1/3)}i.push(v-f)}else if(h<0){var distance=Math.sqrt(-l/3);var _=Math.atan2(Math.sqrt(-h),-c)/3;var m=Math.cos(_);var y=Math.sin(_);var b=Math.sqrt(3);i.push(2*distance*m-f);i.push(-distance*(m+b*y)-f);i.push(-distance*(m-b*y)-f)}else{if(c>=0){g=-Math.pow(c,1/3)}else{g=Math.pow(-c,1/3)}i.push(2*g-f);i.push(-g-f)}return i}function xn(e,t,r,n,i,a,o,s,u,l,d){var f,h,c,g;var v,p,_,m,y,b;var x;var S,A;var E=Math.min(o,u),w=Math.min(s,l),k=Math.max(o,u),C=Math.max(s,l);f=r*-2;h=n*-2;v=e+f+i;p=t+h+a;f=e*-2;h=t*-2;c=r*2;g=n*2;_=f+c;m=h+g;y=e;b=t;S=s-l;A=u-o;x=o*l-u*s;var T=_n(S*v+A*p,S*_+A*m,S*y+A*b+x);for(var L=0;L<T.length;L++){var M=T[L];if(0<=M&&M<=1){var I=e+(r-e)*M;var F=t+(n-t)*M;var N=r+(i-r)*M;var z=n+(a-n)*M;var R=I+(N-I)*M;var P=F+(z-F)*M;if(o===u){if(w<=P&&P<=C){if(d){d.push(R,P)}else{return 1}}}else if(s===l){if(E<=R&&R<=k){if(d){d.push(R,P)}else{return 1}}}else if(R>=E&&P>=w&&R<=k&&P<=C){if(d){d.push(R,P)}else{return 1}}}}return d?d.length/2:0}function Sn(e,t,r,n,i,a,o,s,u,l,d){if(d){xn(e,t,r,n,i,a,o,s,u,s,d);xn(e,t,r,n,i,a,u,s,u,l,d);xn(e,t,r,n,i,a,o,l,u,l,d);xn(e,t,r,n,i,a,o,s,o,l,d);return d.length/2}else{if(o<=e&&u>=e&&s<=t&&l>=t){return 1}if(o<=i&&u>=i&&s<=a&&l>=a){return 1}if(xn(e,t,r,n,i,a,o,s,u,s)){return 1}if(xn(e,t,r,n,i,a,u,s,u,l)){return 1}if(xn(e,t,r,n,i,a,o,l,u,l)){return 1}if(xn(e,t,r,n,i,a,o,s,o,l)){return 1}return 0}}function An(e,t,r,n,i,a,o,s,u,l,d,f,h){var c,g,v,p,_,m,y,b;var x,S,A,E,w,k,C,T;var L;var M,I;var F=Math.min(u,d),N=Math.min(l,f),z=Math.max(u,d),R=Math.max(l,f);c=e*-1;g=t*-1;v=r*3;p=n*3;_=i*-3;m=a*-3;y=c+v+_+o;b=g+p+m+s;x=y;S=b;c=e*3;g=t*3;v=r*-6;p=n*-6;_=i*3;m=a*3;y=c+v+_;b=g+p+m;A=y;E=b;c=e*-3;g=t*-3;v=r*3;p=n*3;_=c+v;m=g+p;w=_;k=m;C=e;T=t;M=l-f;I=d-u;L=u*f-d*l;var P=_n(M*x+I*S,M*A+I*E,M*w+I*k,M*C+I*T+L);for(var D=0;D<P.length;D++){var O=P[D];if(0<=O&&O<=1){var B=e+(r-e)*O;var j=t+(n-t)*O;var V=r+(i-r)*O;var U=n+(a-n)*O;var G=i+(o-i)*O;var W=a+(s-a)*O;var H=B+(V-B)*O;var X=j+(U-j)*O;var q=V+(G-V)*O;var Y=U+(W-U)*O;var Z=H+(q-H)*O;var K=X+(Y-X)*O;if(u===d){if(N<=K&&K<=R){if(h){h.push(Z,K)}else{return 1}}}else if(l===f){if(F<=Z&&Z<=z){if(h){h.push(Z,K)}else{return 1}}}else if(Z>=F&&K>=N&&Z<=z&&K<=R){if(h){h.push(Z,K)}else{return 1}}}}return h?h.length/2:0}function En(e,t,r,n,i,a,o,s,u,l,d,f,h){if(h){An(e,t,r,n,i,a,o,s,u,l,d,l,h);An(e,t,r,n,i,a,o,s,d,l,d,f,h);An(e,t,r,n,i,a,o,s,u,f,d,f,h);An(e,t,r,n,i,a,o,s,u,l,u,f,h);return h.length/2}else{if(u<=e&&d>=e&&l<=t&&f>=t){return 1}if(u<=o&&d>=o&&l<=s&&f>=s){return 1}if(An(e,t,r,n,i,a,o,s,u,l,d,l)){return 1}if(An(e,t,r,n,i,a,o,s,d,l,d,f)){return 1}if(An(e,t,r,n,i,a,o,s,u,f,d,f)){return 1}if(An(e,t,r,n,i,a,o,s,u,l,u,f)){return 1}return 0}}var wn=512;var kn=128;var Cn=Math.round(Math.log2(wn));var Tn=Math.round(Math.log2(kn));var Ln=Cn+Tn;var Mn=255;var In=32767;var Fn=65535;var Nn=15;var zn=3;var Rn=15;var Pn=32;var Dn=128;var On=8;var Bn=1/16;var jn=Math.round(Math.sqrt(Rn+1));var Vn=Dn*jn;var Un=16;var Gn=1;var Wn=256;var Hn=128;var Xn=128;var qn=1.5;var Yn=1.1;var Zn=52;var Kn=16;var Qn=Zn*2+Kn;var Jn=4;var $n=3;var ei=41;var ti=5;var ri=5;var ni=.9721;var ii=0;var ai=1;var oi=2;var si=3;var ui=4;var li=5;var di=6;var fi=7;var hi=8;var ci=9;var gi=10;var vi=0;var pi=1;var _i=2;var mi=3;var yi=0;var bi=1;var xi=2;var Si=3;var Ai=4;var Ei=5;var wi=6;var ki=1e-6;var Ci=Math.PI;var Ti=Math.PI*2;var Li=Ci*(5/4);var Mi=Ci*(7/4);var Ii=Ci*(3/4);var Fi=Ci*(1/4);var Ni=1.1;var zi=.07;var Ri=1;var Pi=1;var Di=.17;var Oi=1;var Bi=-Ci/2;var ji=Ci/2;var Vi=2/3;var Ui={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}};var Gi={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0};var Wi={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function Hi(e,t,r,n,i,a){var o=a||{x:0,y:0};var s=(e+r)/2;var u=(t+n)/2;var l=e-r;var d=t-n;var distance=Math.sqrt(l*l+d*d);var f=d/distance;var h=-l/distance;var c=-distance*i/ti;o.x=s+f*c;o.y=u+h*c;return o}function Xi(e,t,r,n,i,a){var o=a||{x1:0,y1:0,x2:0,y2:0};var distance=n+n/ri*r;var s=distance*ri;var u=-i+Ci;var l=-i+Ci/2;o.x1=e+Math.cos(u)*s;o.y1=t+Math.sin(u)*s;o.x2=e+Math.cos(l)*s;o.y2=t+Math.sin(l)*s;return o}function qi(e,t,r,n,i,a,o,s){s=s||{};s.x=(1-e)*(1-e)*t+2*(1-e)*e*a+e*e*n;s.y=(1-e)*(1-e)*r+2*(1-e)*e*o+e*e*i;return s}function Yi(e,t,r,n,i,a,o,s,u,l,d){if(l===void 0)l=0;if(d===void 0)d=false;var f=r-2*o+i;var h=2*o-2*r;var c=r-e;var g=n-2*s+a;var v=2*s-2*n;var p=n-t;var _=-(c*g-p*f)/(h*g-v*f);if(_<0||_>1){return false}var m=u/2;if(d){m*=1-_}m+=l;var y=Zi(r,o,i,_);var b=Zi(n,s,a,_);return distance(y,b,e,t)<=m}function Zi(e,t,r,n){var i=1-n;return i*i*e+2*i*n*t+n*n*r}function Ki(e,t,r,n,i,a,o,s,u,l){l=l||{};var d=(1-e)*(1-e)*(1-e),f=3*e*(1-e)*(1-e),h=3*e*e*(1-e),c=e*e*e;l.x=d*t+f*a+h*s+c*n;l.y=d*r+f*o+h*u+c*i;return l}function Qi(e,t,r,n,i,a,o,s,u,l,d,f){var h=distance(r,n,o,s);if(Math.abs(e-r)>h||Math.abs(t-n)>h){return false}var c=distance(e,t,r,n),g=distance(e,t,i,a),v=.5,p=c<g?-.01:.01,_=.001,m=100,y=Ki(v,r,n,i,a,o,s,u,l),b=distance(e,t,y.x,y.y),x;var S=d/2+f;while(m-- >0&&v>=0&&v<=1&&b>S&&(p>_||p<-_)){x=b;Ki(v,r,n,i,a,o,s,u,l,y);b=distance(e,t,y.x,y.y);if(b>x){p=-p/2;v+=p}else if(v+p<0||v+p>1){p=p/2;b=x}else{v+=p}}return b<S}function Ji(e,t,r,n,i,a,o){var s=e+2/3*(r-e);var u=t+2/3*(n-t);var l=s+1/3*(i-e);var d=u+1/3*(a-t);return $i(e,t,s,u,l,d,i,a,o)}function $i(e,t,r,n,i,a,o,s,u){if(u===void 0)u={};var l=Math.min;var d=Math.max;var f=Math.sqrt;var h,c,g,v,p;u.minX=l(e,o);u.maxX=d(e,o);u.minY=l(t,s);u.maxY=d(t,s);for(var _=void 0,m=void 0,y=void 0,b=void 0,x=void 0,S=void 0,A=void 0,E=0;E<2;++E){if(E===0){c=e;g=r;v=i;p=o}else{c=t;g=n;v=a;p=s}m=6*c-12*g+6*v;_=-3*c+9*g-9*v+3*p;y=3*g-3*c;m=m|0;_=_|0;y=y|0;if(_===0){if(m===0){continue}b=-y/m;if(b>0&&b<1){h=ea(b,c,g,v,p);if(E===0){u.minX=l(u.minX,h);u.maxX=d(u.maxX,h)}else{u.minY=l(u.minY,h);u.maxY=d(u.maxY,h)}}continue}x=m*m-4*y*_;if(x<0){continue}S=(-m+f(x))/(2*_);if(S>0&&S<1){h=ea(S,c,g,v,p);if(E===0){u.minX=l(u.minX,h);u.maxX=d(u.maxX,h)}else{u.minY=l(u.minY,h);u.maxY=d(u.maxY,h)}}A=(-m-f(x))/(2*_);if(A>0&&A<1){h=ea(A,c,g,v,p);if(E===0){u.minX=l(u.minX,h);u.maxX=d(u.maxX,h)}else{u.minY=l(u.minY,h);u.maxY=d(u.maxY,h)}}}return u}function ea(e,t,r,n,i){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*r+3*(1-e)*Math.pow(e,2)*n+Math.pow(e,3)*i}function ta(e,t,r,n,i){var a=1-i;var o=a*a*a;var s=3*i*a*a;var u=3*i*i*a;var l=i*i*i;return o*e+s*t+u*r+l*n}function ra(e,t,r,n,i,a,o,s){if(i===void 0)i=0;if(a===void 0)a=Math.sin(i);if(o===void 0)o=Math.cos(i);if(s===void 0)s=[];var u=r/2,l=n/2;var d=e+u,f=t+l;if(i===0){s[0]=e;s[1]=t;s[2]=e+r;s[3]=t+n;return s}var h,c,g,v;var p,_,m,y;g=-u;v=-l;h=d+g*o-v*a,c=f+g*a+v*o;p=m=h;_=y=c;g=-u;v=l;h=d+g*o-v*a;c=f+g*a+v*o;if(h<p){p=h}else if(h>m){m=h}if(c<_){_=c}else if(c>y){y=c}g=u;v=l;h=d+g*o-v*a;c=f+g*a+v*o;if(h<p){p=h}else if(h>m){m=h}if(c<_){_=c}else if(c>y){y=c}g=u;v=-l;h=d+g*o-v*a;c=f+g*a+v*o;if(h<p){p=h}else if(h>m){m=h}if(c<_){_=c}else if(c>y){y=c}s[0]=p;s[1]=_;s[2]=m;s[3]=y;return s}function na(e,t,r,n,i){if(i===void 0)i=0;var a=r/2,o=n/2;var s=e+a,u=t+o;if(i===0){return[{x:e,y:t},{x:e+r,y:t},{x:e+r,y:t+n},{x:e,y:t+n}]}var l=Math.sin(i);var d=Math.cos(i);var f,h,c,g;var v=new Array(4);c=-a;g=-o;f=s+c*d-g*l,h=u+c*l+g*d;v[0]={x:f,y:h};c=-a;g=o;f=s+c*d-g*l;h=u+c*l+g*d;v[1]={x:f,y:h};c=a;g=o;f=s+c*d-g*l;h=u+c*l+g*d;v[2]={x:f,y:h};c=a;g=-o;f=s+c*d-g*l;h=u+c*l+g*d;v[3]={x:f,y:h};return v}function ia(e,t,r,n){if(t===void 0)t=0;if(r===void 0)r=1;if(n===void 0)n=[];var i=r*Math.sin(t);var a=r*Math.cos(t);n[0]=e[0]+i;n[1]=e[1]+a;n[2]=e[2]+i;n[3]=e[3]+a;return n}function aa(e,t,r,n,i){if(i===void 0)i=[];var a=Math.sin(t),o=Math.cos(t);var s=(e[0]+e[2])/2;var u=(e[1]+e[3])/2;var l=(e[2]-e[0])/2;var d=(e[3]-e[1])/2;var f=l,h=-d;var c=l,g=d;var v=f*o-h*a;var p=f*a+h*o;var _=c*o-g*a;var m=c*a+g*o;var y=Math.max(Math.abs(v),Math.abs(_));var b=Math.max(Math.abs(p),Math.abs(m));i[0]=s-y;i[2]=s+y;i[1]=u-b;i[3]=u+b;return i}function oa(e,t){e.minX-=t;e.minY-=t;e.maxX+=t;e.maxY+=t;e.width+=2*t;e.height+=2*t;return e}function sa(e,t){return e[3]>=t[1]&&e[1]<=t[3]&&(e[2]>=t[0]&&e[0]<=t[2])}var ua=Object.freeze({circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,circleContainsPoint:Or,circleContainsCircle:Br,circleIntersectsBox:jr,circleLineIntersection:Vr,isPointInLine:Yr,twoSegmentsIntersect:Zr,lineAngle:Qr,angle:Jr,segmentIntersection:$r,lineRectangleIntersection:en,lineLine:tn,lineAABB:rn,distancePointSegment:nn,distToSegmentSquared:an,getClosestPointOnSegment:un,getClosestPointOnLine:ln,rotate:Ur,move:Gr,distance:distance,squaredDistance:Wr,radiansToDegrees:Hr,extendBounds:Xr,computeCentroid:qr,isPointInPolygon:dn,polygonsIntersect:gn,getPointOnQuadraticCurve:qi,isPointOnQuadraticCurve:Yi,quadraticEquation:Zi,getPointOnBezierCurve:Ki,isPointOnBezierCurve:Qi,getQuadraticCurveBoundingBox:Ji,getBezierCurveBoundingBox:$i,cubicEquation:ta,quadBezierAABB:Sn,cubicBezierAABB:En,getSelfLoopControlPoints:Xi,getQuadraticCurveControlPoint:Hi,getAABB:ra,getOBBPoints:na,moveAABB:ia,rotateAABB:aa,padBounds:oa,overlaps:sa});function weightedStress(e,t,r,n,i,a){var o=0,s,u,l,d,f,h;for(l=0;l<n;l++){for(d=0;d<n;d++){var c=a[l],g=a[d];if(c!==g){u=e[c][g];u*=i;s=1/(u*u);if(s){f=t[c]-t[g];h=r[c]-r[g];o+=s*Math.pow(u-Math.sqrt(f*f+h*h),2)}}}}return o}function distanceStress(e,t,r,n,i,a,o){var s=0,u,l,d,f,h,c;if(i===-1){return 0}for(u=0;u<n;u++){for(l=0;l<n;l++){var g=o[u],v=o[l];if(g!==v&&(g===i||v===i)){d=e[g][v];d*=a;f=1/(d*d);if(f){h=t[g]-t[v];c=r[g]-r[v];s+=f*Math.pow(d-Math.sqrt(h*h+c*c),2)}}}}return s}function constrainedStress(e,t,r,n,i,a,o,s){o=o||0;var weightedStress=0;var distanceStress=0;var u,l,d,f,h,c,g;for(u=0;u<n;u++){for(l=0;l<n;l++){var v=s[u],p=s[l];if(v!==p){d=e[v][p];d*=a;f=1/(d*d);if(f){h=t[v]-t[p];c=r[v]-r[p];g=f*Math.pow(d-Math.sqrt(h*h+c*c),2);weightedStress+=g;if(v===i||p===i){distanceStress+=g}}}}}return(1-o)*weightedStress+o*distanceStress}function stressMinimizationStep(e,t,r,n,i,a,o,s,u){var l=t,d=r;var f=1e-6;o=o||0;i=typeof i==="undefined"?-1:i;if(i===-1){o=0}var h,c,g,v,p;var _=t[i],m=r[i];for(var y=0;y<n;y++){var b=s[y];var x=u(e[i][y]);var S=o/(x*x);if(x===0){continue}var A=0,E=0,w=0,k;var C=t[b],T=r[b];for(k=0;k<n;k++){var L=s[k],M,I,F,N,z;if(L!==b){M=e[b][L]*a;I=1/(M*M);F=t[L];N=r[L];if(I!==0){c=C-F;g=T-N;v=c*c+g*g;z=v<f?0:1/Math.sqrt(v);E+=(1-o)*I*(F+M*(C-F)*z);w+=(1-o)*I*(N+M*(T-N)*z)}A+=I}}h=(1-o)*A+S;if(h!==0){c=C-_;g=T-m;v=c*c+g*g;v=v<f?0:1/Math.sqrt(v);p=x===0?0:S*(x*v);l[b]=(E+p*t[b])/h;d[b]=(w+p*r[b])/h}}return{X:l,Y:d}}function stressMinimizationStepGeneral(e,t,r,n,i,a,o,s){var u=t,l=r;var d=1e-6;o=o||0;i=typeof i==="undefined"?-1:i;if(i===-1){o=0}var f;for(var h=0;h<n;h++){var c=s[h];var g=0,v=0,p=0,_,m;var y=t[c],b=r[c];var x,S,A;for(_=0;_<n;_++){var E=s[_],w,k,C,T,L;var M=0;if(E!==c){m=e[c][E]*a;w=1/(m*m);if(c===i||E===i){M=w}L=(1-o)*w+o*M;g+=L;if(w!==0){k=t[E];C=r[E];x=y-k;S=b-C;A=x*x+S*S;if(A>d){T=1/Math.sqrt(A)}v+=L*(k+m*(y-k)*T);p+=L*(C+m*(b-C)*T)}}}f=g;if(f!==0){u[c]=v/f;l[c]=p/f}}return{X:u,Y:l}}function minHeap(e,t,r,n){if(e===void 0)e=function(e,t){return e-t};if(t===void 0)t=[];if(r===void 0)r={};if(n===void 0)n=function(e){return e};var i=t.length;function a(a){while(true){var o=2*a+1;var s=o+1;var u=a;if(o<i&&e(t[o],t[u])<0){u=o}if(s<i&&e(t[s],t[u])<0){u=s}if(u===a){return a}var l=t[u];t[u]=t[a];t[a]=l;r[n(t[u])]=u;r[n(l)]=a;a=u}}var o={heapify:a,pop:function e(){if(i<=0){return undefined}if(i===1){i--;return t[0]}var r=t[0];t[0]=t[i-1];i--;a(0);return r},decreaseKey:function i(a,value){if(value!==undefined){t[a]=value;r[n(value)]=a}while(a>0){var o=a-1>>1;if(e(t[o],t[a])>0){var s=t[a];t[a]=t[o];t[o]=s;r[n(t[a])]=a;r[n(s)]=o;a=o}else{break}}return a},min:function e(){return t[0]},remove:function e(t){this.decreaseKey(t,Number.NEGATIVE_INFINITY);return this.pop()},push:function a(o){i++;var s=i-1;t[s]=o;while(s>0){var u=s-1>>1;if(e(t[u],t[s])>0){var l=t[s];t[s]=t[u];t[u]=l;r[n(t[s])]=s;r[n(l)]=u;s=u}else{break}}return s},empty:function e(){return i<=0},toArray:function e(){return t.slice(0,i)}};Object.defineProperty(o,"keys",{get:function(){return r},enumerable:true});Object.defineProperty(o,"size",{get:function(){return i},enumerable:true});return o}function bellmanFord(e){var t=e.sources;var r=e.targets;var n=e.weights;var i=e.source;var a=e.target;var o=e.undirected;if(o===void 0)o=false;var s=e.indexes;var u=e.N;u=s?s.length:u;if(!isFinite(u)||u===0){throw new Error("Invalid number of nodes "+u)}var l=new Float32Array(u);var d=new Int32Array(u);var f={};var h=Number.POSITIVE_INFINITY;var c,g,v,p,_,m,y;var b,x,S,A;if(!n){for(c=0,n=new Uint8Array(u);c<u;c++){n[c]=1}}if(!s){for(c=0,s=new Uint32Array(u);c<u;c++){s[c]=c+1}}for(c=0;c<u;c++){l[c]=h;d[c]=-1;f[s[c]]=c}l[f[i]]=0;for(c=1,g=u;c<=g;c++){A=false;for(v=0,p=n.length;v<p;v++){b=t[v];x=r[v];m=f[b];y=f[x];if(m!==undefined&&y!==undefined){S=n[v];_=l[m]+S;if(l[m]!==h&&_<l[y]){l[y]=_;d[y]=b;A=true}if(o){_=l[y]+S;if(l[y]!==h&&_<l[m]){l[m]=_;d[m]=x;A=true}}}}if(!A){break}}if(A){for(c=0,g=n.length;c<g;c++){b=t[c];x=r[c];m=f[b];y=f[x];if(m!==undefined&&y!==undefined){S=n[c];if(l[m]+S<l[y]){return null}}}}var E=null;var w=null;if(a!==undefined){var k=f[a];if(k!==undefined&&l[k]!==h){for(c=a,E=[];c!==-1;c=d[f[c]]){E.push(c)}E=E.reverse();w=l[k]}}return{distances:l,path:E,pathLength:w}}function dijkstra(e,t,r,n,i,a,o){var s=n?n.length:e.length;var u=new Float32Array(s);var l=new Int32Array(s);var d=new Uint32Array(s);var f=Number.POSITIVE_INFINITY;var h={};var c,g;if(s===0){return{distances:u,path:null,pathLength:null}}if(!n){for(c=0,n=new Uint32Array(s);c<s;c++){n[c]=c+1}}if(!i){for(c=0,i={};c<s;c++){i[n[c]]=c}}for(c=0;c<s;c++){u[c]=f;l[c]=-1;d[c]=h[c]=c}var v=minHeap(function(e,t){return u[e]-u[t]},d,h);u[i[t]]=0;v.decreaseKey(h[i[t]]);while(v.size!==0){var p=v.pop();var _=u[p];var m=e[p];if(_===f){break}for(c=0,g=m.nodes.length;c<g;c++){var y=m.nodes[c];var b=a?1:o?o(n[p],y):m.weights[c];var x=i[y];if(x===undefined){continue}var S=_+b;if(S<u[x]){u[x]=S;l[x]=p;v.decreaseKey(h[x])}}}var A=null;var E=null;if(r!==undefined){var w=i[r];if(u[w]!==f){for(c=w,A=[];c!==-1;c=l[c]){A.push(n[c])}A=A.reverse();E=u[r]}}return{distances:u,path:A,pathLength:E}}function johnson(e){var t=e.sources;var r=e.targets;var n=e.weights;var i=e.indexes;var a=e.adjacency;var o=e.undirected;var s=e.ignoreWeights;var u=Number.POSITIVE_INFINITY;var l=i?i.length:a.length;var d,f,h,c,g,v;if(!i){for(d=0,i=new Uint32Array(l);d<l;d++){i[d]=d+1}}var p=new Array(l);var _={};for(d=0;d<l;d++){p[d]=new Float32Array(l);for(h=0;h<l;h++){p[d][h]=d===h?0:u}_[i[d]]=d}var m=l;var y=n.length;t=t.slice();r=r.slice();n=n.slice();for(d=0;d<l;d++){t[y+d]=m;r[y+d]=i[d];n[y+d]=0;if(s){n[d]=1}}var b=bellmanFord({sources:t,targets:r,weights:n,undirected:o,N:l+1,source:m});if(b===null){throw new Error("Graph has negative weight loops")}c=b.distances;for(d=0,f=n.length;d<f;d++){g=_[t[d]];v=_[r[d]];if(g!==undefined&&v!==undefined){n[d]=n[d]+c[g]-c[v]}}t=t.slice(0,y);r=r.slice(0,y);n=n.slice(0,y);for(d=0;d<l;d++){var x=i[d];g=_[x];c=dijkstra(a,x,undefined,i,_,s).distances;for(h=0;h<l;h++){p[d][h]=d===h?0:c[h]}}return p}var la=o(function(e){(function(){function t(e){if(!(this instanceof t)){return new t(e)}this.points=e||[]}t.prototype={triangulate:function(){var e=this.points;e.sort(function(e,t){if(e[0]===t[0]){return e[1]-t[1]}return e[0]-t[0]});for(var t=e.length-1;t>=1;t--){if(e[t][0]===e[t-1][0]&&e[t][1]===e[t-1][1]){e.splice(t,1)}}if(e.length<2){return{}}var r=h(e).le;var n=[];var a=0;var o=[r];while(i(r.onext.dest,r)){r=r.onext}var s=r;do{o.push(s.sym);s.mark=true;s=s.lnext}while(s!==r);do{var u=o[a++];if(!u.mark){s=u;do{n.push(s.orig);if(!s.sym.mark){o.push(s.sym)}s.mark=true;s=s.lnext}while(s!=u)}}while(a<o.length);return n}};function r(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])>0}function n(e,t){return r(e,t.dest,t.orig)}function i(e,t){return r(e,t.orig,t.dest)}function a(e,t){return n(e.dest,t)}function o(e,t,r,n){if(e[0]===n[0]&&e[1]===n[1]||t[0]===n[0]&&t[1]===n[1]||r[0]===n[0]&&r[1]===n[1]){return false}var i=e[0]*e[0]+e[1]*e[1],a=t[0]*t[0]+t[1]*t[1],o=r[0]*r[0]+r[1]*r[1],s=n[0]*n[0]+n[1]*n[1];var u=o-s,l=r[1]-n[1],d=r[1]*s-o*n[1],f=r[0]-n[0],h=r[0]*s-o*n[0],c=r[0]*n[1]-r[1]*n[0];return e[0]*(t[1]*u-a*l+d)-e[1]*(t[0]*u-a*f+h)+i*(t[0]*l-t[1]*f+c)-t[0]*d+t[1]*h-a*c>1}function s(e,t,r){this.onext=e;this.rot=t;this.orig=r;this.mark=false}s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}};function u(e,t){var r=new s(null,null,e),n=new s(null,null,null),i=new s(null,null,t),a=new s(null,null,null);r.onext=r;i.onext=i;n.onext=a;a.onext=n;r.rot=n;n.rot=i;i.rot=a;a.rot=r;return r}function l(e,t){var r=e.onext.rot,n=t.onext.rot;var i=e.onext,a=n.onext,o=r.onext;e.onext=t.onext;t.onext=i;r.onext=a;n.onext=o}function d(e,t){var r=u(e.dest,t.orig);l(r,e.lnext);l(r.sym,t);return r}function f(e){l(e,e.oprev);l(e.sym,e.sym.oprev)}function h(e){var t,s,c,g;if(e.length===2){t=u(e[0],e[1]);return{le:t,re:t.sym}}else if(e.length===3){t=u(e[0],e[1]);s=u(e[1],e[2]);l(t.sym,s);if(r(e[0],e[1],e[2])){c=d(s,t);return{le:t,re:s.sym}}else if(r(e[0],e[2],e[1])){c=d(s,t);return{le:c.sym,re:c}}else{return{le:t,re:s.sym}}}else{var v=Math.ceil(e.length/2);var p=h(e.slice(0,v));var _=h(e.slice(v));var m=p.le,y=p.re,b=_.le,x=_.re;do{if(i(b.orig,y)){y=y.lnext}else if(n(y.orig,b)){b=b.rprev}else{break}}while(true);var S=d(b.sym,y);if(y.orig===m.orig){m=S.sym}if(b.orig===x.orig){x=S}do{var A=S.sym.onext;if(a(A,S)){while(o(S.dest,S.orig,A.dest,A.onext.dest)){g=A.onext;f(A);A=g}}var E=S.oprev;if(a(E,S)){while(o(S.dest,S.orig,E.dest,E.oprev.dest)){g=E.oprev;f(E);E=g}}if(!a(A,S)&&!a(E,S)){break}if(!a(A,S)||a(E,S)&&o(A.dest,A.orig,E.orig,E.dest)){S=d(E,S.sym)}else{S=d(S.sym,A.sym)}}while(true);return{le:m,re:x}}}t.prototype.ccw=r;t.prototype.rightOf=n;t.prototype.leftOf=i;t.prototype.inCircle=o;if(typeof undefined==="function"&&undefined.amd){undefined("Delaunay",function(){return t})}else{e.exports=t}})()});function da(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function fa(e){var t=e.length;var r=[0,1];var n=2;for(var i=2;i<t;i++){while(n>1&&da(e[r[n-2]],e[r[n-1]],e[i])<=0){--n}r[n++]=i}return r.slice(0,n)}function ha(e){var t=e.length;if(t<3){return null}var r=new Array(t);var n=new Array(t);for(var i=0;i<t;i++){r[i]=[+e[i][0],+e[i][1],i]}r.sort(function(e,t){return e[0]-t[0]||e[1]-t[1]});for(var a=0;a<t;a++){n[a]=[r[a][0],-r[a][1]]}var o=fa(r);var s=fa(n);var u=s[s.length-1];var l=o[o.length-1];var d=s[0]===o[0];var f=u===l;var h=[];for(var c=o.length-1;c>=0;--c){h.push(e[r[o[c]][2]])}for(var g=+d;g<s.length-f;g++){h.push(e[r[s[g]][2]])}return h}function ca(e,t,r,n,convexhull){if(t===void 0)t=1;if(r===void 0)r=0;if(!n||!convexhull){e=e.map(function(e){return[e.x,e.y]});n=new la(e.slice()).triangulate();convexhull=ha(e)}var i=r*r;var a=[],o={},s,u,l,d,f;for(l=0,d=n.length;l<d;l+=3){u=_a(n[l],n[l+1],n[l+2]);if(ga(convexhull,u)){f=pa(n[l],n[l+1],n[l+2]);if(f>i){a.push(l);o[l]=f}}}if(a.length===0){return a}a.sort(function(e,t){return o[e]-o[t]});var h=a[0];var c=o[h];var g=[];for(l=0,d=a.length;l<d;l++){s=a[l];f=o[s];if(f>c&&f>i){h=s;c=f;g.push(h);if(g.length>t){g.shift()}}}return g.map(function(e){return va(n[e],n[e+1],n[e+2])})}function ga(e,t){var r=e.length;var n=e[r-1];var i=t[0];var a=t[1];var o=n[0];var s=n[1];var u,l;var d=false;for(var f=0;f<r;f++){n=e[f],u=n[0],l=n[1];if(l>a!==s>a&&i<(o-u)*(a-l)/(s-l)+u){d=!d}o=u,s=l}return d}function va(e,t,r){var n=arguments;var i=_a(e,t,r);var a=0;for(var o=0;o<3;o++){var s=n[o];var u=s[0]-i[0];var l=s[1]-i[1];var d=Math.sqrt(u*u+l*l);if(d>a){a=d}}return i.concat(a)}function pa(e,t,r){var n=_a(e,t,r);var i=n[0];var a=n[1];var o=e[0];var s=e[1];var u=i-o;var l=a-s;return u*u+l*l}function _a(e,t,r){var n=[(e[0]+t[0])/2,(e[1]+t[1])/2];var i=[(t[0]+r[0])/2,(t[1]+r[1])/2];var a=-1/((t[1]-e[1])/(t[0]-e[0]));var o=-1/((r[1]-t[1])/(r[0]-t[0]));var s=n[1]-a*n[0];var u=i[1]-o*i[0];var l=(s-u)/(o-a);return[l,a*l+s]}function minDisk(e,t,r,n){if(!n){n=new Uint32Array(e.length);for(var i=0,a=e.length;i<a;i++){n[i]=i}}function o(e){for(var t=e.length-1;t>=0;t--){var r=Math.floor(Math.random()*(t+1));r=Math.max(Math.min(r,t),0);var n=e[t];e[t]=e[r];e[r]=n}return e}function s(e,t,r,n,i,a,o){var s=null;var u=t.length;var l,d,f;if(u===1){l=t[0];s=[r[l],n[l],i[l]||0]}else if(u===2){l=t[0];d=t[1];s=a(r[l],n[l],r[d],n[d],i[l],i[d])}else if(u===3){l=t[0];d=t[1];f=t[2];s=o(r[l],n[l],r[d],n[d],r[f],n[f],i[l],i[d],i[f])}return s}function u(e,t,r,n,i,a,o,l,d){var f=null;if(r===0||t.length===3){f=s(e,t,n,i,a,l,d)}else{var h=e[r-1];f=u(e,t,r-1,n,i,a,o,l,d);if(f===null||!o(f,n[h],i[h],a[h])){t.push(h);f=u(e,t,r-1,n,i,a,o,l,d);t.pop()}}return f}function l(e,t,r,n){var i=e-r,a=t-n;return[(e+r)/2,(t+n)/2,Math.sqrt(i*i+a*a)/2]}function d(e,t,r,n,i,a){var o=r-e;var s=n-t;var u=a-i;var l=Math.sqrt(o*o+s*s);return[(e+r+o/l*u)/2,(t+n+s/l*u)/2,(l+i+a)/2]}function f(e,t,r,n,i,a,o,s,u){var l=2*(e-r),d=2*(t-n),f=2*(s-o);var h=e*e+t*t-o*o-r*r-n*n+s*s;var c=2*(e-i),g=2*(t-a),v=2*(u-o);var p=e*e+t*t-o*o-i*i-a*a+u*u;var _=c*d-l*g,m=(d*p-g*h)/_-e,y=(g*f-d*v)/_,b=(c*h-l*p)/_-t,x=(l*v-c*f)/_;var S=y*y+x*x-1,A=2*(m*y+b*x+o),E=m*m+b*b-o*o,w=(-A-Math.sqrt(A*A-4*S*E))/(2*S);return[m+y*w+e,b+x*w+t,w]}function h(e,t,r,n,i,a){var o=(e*(n-a)+r*(a-t)+i*(t-n))*2;if(o===0){return null}var s=((e*e+t*t)*(n-a)+(r*r+n*n)*(a-t)+(i*i+a*a)*(t-n))/o;var u=((e*e+t*t)*(i-r)+(r*r+n*n)*(e-i)+(i*i+a*a)*(r-e))/o;var l=s-e,d=u-t;return[s,u,Math.sqrt(l*l+d*d)]}n=o(n);var c=r?d:l;var g=r?f:h;var v=r?Br:Or;r=r||[];return u(n,[],n.length,e,t,r,v,c,g)}function removeRadialOverlap(e){var t=e.X;var r=e.Y;var n=e.sizes;var i=e.indexes;var a=e.R;var o=e.center;var s=e.gap;if(s===void 0)s=0;var u=e.epsilon;if(u===void 0)u=.001;var l=e.maxLoops;if(l===void 0)l=5;var d=e.inPlace;if(d===void 0)d=true;var f=i.length;var h=f;var c=o[0],g=o[1];if(!d){t=t.slice();r=r.slice()}var v=circleCircleIntersection;var p=circleSortCompare;var _=i.slice().sort(function(e,n){return p(t[e],r[e],t[n],r[n],c,g)});var m=_[f-1];var y=t[m],b=r[m];var x,S,A,E,w,k;for(var C=0,T=false;C<h-1;C++){var L=C%f,M=(C+1)%f;if(C===-1){L=f-1;M=0}L=_[L];M=_[M];x=t[L];S=r[L];A=t[M];E=r[M];var I=n[L],F=n[M];var N=I+F+s;var z=p(x,S,A,E,c,g);if(z===-1&&T){z=1}if(N>a){continue}if(z===1||N-distance(x,S,A,E)>u){var R=v(c,g,a,x,S,N);if(R){R=R[0];T=A>c&&R[0]<c;A=t[M]=R[0];E=r[M]=R[1]}}else{T=false}if(C%f===f-2){var P=_[f-1],D=_[0];if(r[P]>g&&r[D]>g&&t[P]-n[P]<t[D]+n[P]){w=0;h=Math.min(f*l,h+f);while(r[_[P]]>g&&r[_[0]]>g&&t[_[P]]<t[_[0]]&&++w<f){_.unshift(_.pop())}}}}x=y-c;S=b-g,A=t[m]-c;E=r[m]-g;var O=x===A?0:Math.abs(Math.acos((x*A+S*E)/(Math.sqrt(x*x+S*S)*Math.sqrt(A*A+E*E))));if(O!==0){var B=Math.sin(-O);var j=Math.cos(-O);var V;for(C=0;C<f;C++){V=_[C];w=t[V]-c;k=r[V]-g;t[V]=w*j-k*B+c;r[V]=w*B+k*j+g}}return{X:t,Y:r}}function circlePack(e){var t=e.X;var r=e.Y;var n=e.R;var i=e.center;var a=e.maxSteps;if(a===void 0)a=1e3;var o=e.padding;if(o===void 0)o=5;var s=e.epsilon;if(s===void 0)s=1e-5;var u=e.damping;if(u===void 0)u=2;var l=e.pinned;var d=e.indexes;var f=e.onUpdate;var h=e.pushSmallerOut;if(h===void 0)h=true;var c=d?d.length:t.length;var g=d;var v;if(!isFinite(l)){l=-1}if(g===undefined){g=new Uint32Array(c);for(v=0;v<c;v++){g[v]=v}}else{g=d}if(l!==-1){i=[t[l],r[l]]}else if(!i){var p=0,_=0;for(v=0;v<c;v++){p+=t[g[v]];_+=r[g[v]]}i=[p/c,_/c]}var m=function(e){return--e*e*e+1};var y=function(e,t){var r=e-i[0];var n=t-i[1];return r*r+n*n};var b=-Infinity,x=Infinity;g.sort(function(e,i){var a=n[e],o=n[i];b=Math.max(b,a,o);x=Math.min(x,a,o);return o*y(t[i],r[i])-a*y(t[e],r[e])});function S(e,a){var s=0;var d,f,v,p,_,m;for(d=0;d<c-1;d++){for(f=d+1;f<c;f++){if(d===f){continue}v=g[d];p=g[f];var y=t[v],S=r[v],A=n[v];var E=t[p],w=r[p],k=n[p];var C=E-y;var T=w-S;var L=A+k+o;var M=C*C+T*T;if(M<L*L-e){var I=(L-Math.sqrt(M))*a;var F=1/M;var N=C*F*I;var z=T*F*I;m=N*N+z*z;if(p!==l){_=A/x;s+=m*_;t[p]+=N*_;r[p]+=z*_}if(v!==l){_=k/x;s+=m*_;t[v]-=N*_;r[v]-=z*_}}}}var R=e*u*(1-a);var P=i[0],D=i[1],O,B;for(d=0;d<c;d++){v=g[d];if(v!==l){O=t[v];B=r[v];L=n[v];_=L/b;var j=h?R*_:R;N=(O-P)*j;z=(B-D)*j;m=N*N+z*z;s+=m;t[v]-=N;r[v]-=z}}return s}var A=0,E=0;var w=m(1/c);for(v=0;v<a;v++){A=S(w,m((v+1)/a));if(f){setTimeout(function(){return f(t,r)})}if(Math.abs(A-E)<s){break}E=A}return{X:t,Y:r}}var ma=3;var ya=function e(t,r,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var a=new Int32Array(this.arrayBuffer);t=a[0];r=a[1];n=a[2];this.d=r+2*n;for(var o=0;o<this.d*this.d;o++){var s=a[ma+o];var u=a[ma+o+1];i.push(s===u?null:a.subarray(s,u))}var l=a[ma+i.length];var d=a[ma+i.length+1];this.keys=a.subarray(l,d);this.bboxes=a.subarray(d);this.insert=this._insertReadonly}else{this.d=r+2*n;for(var f=0;f<this.d*this.d;f++){i.push([])}this.keys=[];this.bboxes=[]}this.n=r;this.extent=t;this.padding=n;this.scale=r/t;this.uid=0;this.freeIndexes=[];this.freeIndexMap={};var h=n/r*t;this.min=-h;this.max=t+h};ya.prototype.clear=function e(){var t=this.cells=[];for(var r=0;r<this.d*this.d;r++){t.push([])}this.keys=[];this.bboxes=[];this.freeIndexMap={};this.freeIndexes=[];this.uid=0};ya.prototype.insert=function e(t,r,n,i,a){var o;if(this.freeIndexes.length===0){o=this.uid++}else{o=this.freeIndexes.pop();delete this.freeIndexMap[o]}var s=o*4;var u=this.bboxes;this._forEachCell(r,n,i,a,this._insertCell,o);this.keys[o]=t;u[s+0]=r;u[s+1]=n;u[s+2]=i;u[s+3]=a;return this};ya.prototype.remove=function e(t){var r=this.keys.indexOf(t);if(r!==-1&&!this.freeIndexMap[r]){var n=r*4;var i=this.bboxes;var a=i[n+0];var o=i[n+1];var s=i[n+2];var u=i[n+3];this._forEachCell(a,o,s,u,this._removeCell,r);this.freeIndexes.push(r);this.freeIndexMap[r]=true}return this};ya.prototype._removeCell=function e(t,r,n,i,a,o){var s=this.cells[a];for(var u=0,l=s.length;u<l;u++){if(s[u]===o){s.splice(u,1);u--;l--}}};ya.prototype._insertReadonly=function e(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."};ya.prototype._insertCell=function e(t,r,n,i,a,o){this.cells[a].push(o)};ya.prototype.query=function e(t,r,n,i){var a=this.min;var o=this.max;var s,u;var l={};var d=[];for(s=0,u=this.freeIndexes.length;s<u;s++){l[this.freeIndexes[s]]=true}if(t<=a&&r<=a&&o<=n&&o<=i){var f=this.keys;for(s=0,u=f.length;s<u;s++){if(!l[s]){d.push(f[s])}}return d}else{this._forEachCell(t,r,n,i,this._queryCell,d,l);return d}};ya.prototype._queryCell=function e(t,r,n,i,a,o,s){var u=this.cells[a];if(u!==null){var l=this.keys;var d=this.bboxes;for(var f=0;f<u.length;f++){var h=u[f];if(s[h]===undefined){var c=h*4;if(t<=d[c+2]&&r<=d[c+3]&&n>=d[c+0]&&i>=d[c+1]){s[h]=true;o.push(l[h])}else{s[h]=false}}}}};ya.prototype._forEachCell=function e(t,r,n,i,a,o,s){var u=this.scale;var l=this.padding;var d=this.d;var f=Math.max(0,Math.min(d-1,Math.floor(t*u)+l));var h=Math.max(0,Math.min(d-1,Math.floor(r*u)+l));var c=Math.max(0,Math.min(d-1,Math.floor(n*u)+l));var g=Math.max(0,Math.min(d-1,Math.floor(i*u)+l));for(var v=f;v<=c;v++){for(var p=h;p<=g;p++){var _=d*p+v;if(a.call(this,t,r,n,i,_,o,s)){return}}}};ya.prototype.toArrayBuffer=function e(){if(this.arrayBuffer){return this.arrayBuffer}var t=this.cells;var r=ma+this.cells.length+1+1;var n=0;for(var i=0;i<this.cells.length;i++){n+=this.cells[i].length}var a=new Int32Array(r+n+this.keys.length+this.bboxes.length);a[0]=this.extent;a[1]=this.n;a[2]=this.padding;var o=r;for(var s=0;s<t.length;s++){var u=t[s];a[ma+s]=o;a.set(u,o);o+=u.length}a[ma+t.length]=o;a.set(this.keys,o);o+=this.keys.length;a[ma+t.length+1]=o;a.set(this.bboxes,o);o+=this.bboxes.length;return a.buffer};function ba(e,t){return e[3]>t[1]&&e[1]<t[3]&&(e[2]>t[0]&&e[0]<t[2])}var xa=function e(t,r,n){if(n===void 0)n=16;if(n<2||n>16||n%2!==0){throw new Error("Wrong grid resolution '"+n+"' - it must be 2, 4, 8 or 16")}this._getBBox=r;this._bbox=t;this._res=n;this._inX=Math.pow(2,n)-1;this._inY=this._inX<<n;this.clear()};xa.prototype._updateResolution=function e(){this._xres=(this._bbox[2]-this._bbox[0])/this._res;this._yres=(this._bbox[3]-this._bbox[1])/this._res;this._clear();var t=Object.keys(this._codes);for(var r=0,n=t.len;r<n;r++){var i=t[r];this._codes[i]=0;this.insert(i)}return this};xa.prototype.insert=function e(t){var r=this._getBBox(t);var n=this._res;var i=this._bbox[0],a=this._bbox[1];var o=(r[0]-i)/this._xres|0;var s=(r[1]-a)/this._yres|0;var u=(r[2]-i)/this._xres|0;var l=(r[3]-a)/this._yres|0;var d=o,f=s;var h=this._x,c=this._y;var g=this._codes;while(d<=u&&d<n){h[d][t]=true;g[t]|=1<<d;d++}while(f<=l&&f<n){c[f][t]=true;g[t]|=1<<n+f;f++}return this};xa.prototype.updateBBox=function e(t){var r=this._bbox;var n=this._res;this._bbox=t;var i=(r[0]-t[0])/this._xres|0;var a=(r[1]-t[1])/this._yres|0;if(Math.abs(i)>=n||Math.abs(a)>=n){this.clear()}else{var o=this._updateDim(this._x,0,i);var s=this._updateDim(this._y,n,a);var u=this._inX,l=this._inY;var d=Object.keys(this._codes);var f=this._x,h=this._y,c=this._codes;for(var g=0,v=d.length;g<v;g++){var p=d[g];var _=c[p];if((_&u)===0||(_&l)===0){for(var m=0;m<n;m++){if(_&1<<m){delete f[m][p]}if(_&1<<n+m){delete h[m][p]}}delete c[p]}}if(i<0){this._x=this._x.slice(-i).concat(o)}else if(i>0){this._x=o.concat(this._x.slice(0,n-i))}if(a<0){this._y=this._y.slice(-a).concat(s)}else if(a>0){this._y=s.concat(this._y.slice(0,n-a))}}return this};xa.prototype._updateDim=function e(t,r,n){var i,a,o,s,u;var l=this._codes;var d=[];if(n<0){for(i=0;i<-n;i++){s=1<<r+i;u=Object.keys(t[i]);for(a=0,o=u.length;a<o;a++){l[u[a]]^=s}d.push({})}}else if(n>0){for(i=this._res-n;i<this._res;i++){s=1<<r+i;u=Object.keys(t[i]);for(a=0,o=u.length;a<o;a++){l[u[a]]^=s}d.push({})}}return d};xa.prototype.resize=function e(t){this._bbox=t;for(var r=0;r<this._res;r++){this._x[r]={};this._y[r]={}}this._updateResolution()};xa.prototype.removeMultiple=function e(t){var r=t.length,n,i,a;for(var o=0;o<this._res;o++){i=this._x[o],a=this._y[o];for(var s=0;s<r;s++){n=t[s];if(this._codes[n]){if(i[n]){delete i[n]}if(a[n]){delete a[n]}delete this._codes[n]}}}return this};xa.prototype.remove=function e(t){var r=this._codes[t];var n=this._x,i=this._y,a=this._res;for(var o=0;o<a;o++){var s=1<<o,u=1<<a+o;if(r&s){delete n[o][t]}if(r&u){delete i[o][t]}}delete this._codes[t];return this};xa.prototype.point=function e(t){return this.query([t[0],t[1],t[0],t[1]])};xa.prototype.query=function e(t){var r=this._bbox[0],n=this._bbox[1],i=this._res;var a=Math.max(0,(t[0]-r)/this._xres|0);var o=Math.max(0,(t[1]-n)/this._yres|0);var s=Math.min(i-1,(t[2]-r)/this._xres|0);var u=Math.min(i-1,(t[3]-n)/this._yres|0);var l=this._getBBox;var d=[];var f=a,h=o,c={},g=[],v,p,_;while(f<=s){g=g.concat(Object.keys(this._x[f++]))}while(h<=u){g=g.concat(Object.keys(this._y[h++]))}for(v=0,p=g.length;v<p;v++){_=g[v];if(!c[_]){if(ba(l(_),t)){d.push(_)}c[_]=true}}return d};xa.prototype.getAll=function e(){var t=this;return Object.keys(this._codes).map(function(e){return t._getBBox(e)})};xa.prototype.getOverlaps=function e(){var t=this._res,r={};var n=this._getBBox;var i=[];var a=this._ycode;for(var o=0;o<t;o++){var s=Object.keys(this._x[o]);for(var u=0;u<t;u++){var l=[],d=1<<u;for(var f=0,h=s.length;f<h;f++){if(a[s[f]]&d){l.push(s[f])}}var c=l.length;for(var g=0;g<c;g++){for(var v=0;v<c;v++){var p=l[g],_=l[v];if(v!==g&&!r[p+":"+_]&&!r[_+":"+p]){r[p+":"+_]=true;if(ba(n(p),n(_))){i.push(p,_)}}}}}}return i};xa.prototype.clear=function e(){var t=this._bbox;var r=this._res;this._x=new Array(r);this._y=new Array(r);for(var n=0;n<r;n++){this._x[n]={};this._y[n]={}}this._xres=(t[2]-t[0])/r;this._yres=(t[3]-t[1])/r;this._codes={}};function Sa(e,t,r,n,i,a){return{minX:e,minY:t,maxX:r,maxY:n,leaf:true,level:a,parent:i,objects:[],final:false}}function Aa(e){var t=e.minX;var r=e.minY;var n=e.maxX;var i=e.maxY;return[t,r,n,i]}function Ea(e,t,r,n,i,a,o,s){var u=(e+r)/2;var l=(t+n)/2;return u>=i&&u<=o&&(l>=a&&l<=s)}function wa(e,t,r,n,i,a,o,s){return e>i&&e<o&&(t>a&&t<s)||r>i&&r<o&&(n>a&&n<s)}function ka(e,t,r,n,i,a,o,s){return n>=a&&t<=s&&(r>=i&&e<=o)}var Ca=0;var Ta=1;var La=2;var Ma=3;function Ia(e,t,r,n,i,a,o,s){var u=(i+o)/2;var l=(a+s)/2;var d=(e+r)/2;var f=(t+n)/2;if(d<=u){return f<=l?Ca:Ta}else{return f<=l?Ma:La}}var Fa=function(e){return e};var Na=function e(t,r,n,i){if(t===void 0)t=Fa;if(r===void 0)r=10;if(i===void 0)i=0;this._nodeCapacity=r;this._root=null;this._getBBox=t;this._upScale=4;this._objects={};this._size=0;this._rootLevel=i;this._maxLevel=i+30;this._idToCell={};if(n){this._root=Sa(n[0],n[1],n[2],n[3],null,i)}};var za={size:{configurable:true},root:{configurable:true}};za.size.get=function(){return this._size};za.root.get=function(){return this._root};Na.prototype.clear=function e(){this._root=null;this._objects={};this._size=0;this._idToCell={};this._rootLevel=0;this._maxLevel=this._rootLevel+30;return this};Na.prototype.insert=function e(t,r,n){if(n===void 0)n=this._root;r=r||this._getBBox(t);if(this._objects[t]){return}this._objects[t]=true;this._size++;if(!this._root){var i=Math.max(Math.abs(r[2]-r[0]),Math.abs(r[3]-r[1]));this._root=Sa(r[0],r[1],r[0]+i,r[1]+i,null,this._rootLevel);this._root.objects.push(t);return t}var a=[n];var o,s=false;var u=this._nodeCapacity,l=this._idToCell;var d=this._maxLevel;while(o=a.pop()){var f=o.minX;var h=o.minY;var c=o.maxX;var g=o.maxY;if(ka(r[0],r[1],r[2],r[3],f,h,c,g)){if(o.leaf){if(o.objects.length<u||o.final){o.objects.push(t);if(l[t]){l[t].push(o)}else{l[t]=[o]}s=true;if(o.level>=d||Math.abs(c-f)<=Math.abs(r[2]-r[0])||Math.abs(g-h)<=Math.abs(r[3]-r[1])){o.final=true}}else{this.splitNode(o);a.push(o)}}else{a.push.apply(a,o.children)}}}if(s){return t}n=this._root;if(!Ea(r[0],r[1],r[2],r[3],n.minX,n.minY,n.maxX,n.maxY)){var v=this._rootLevel;var p=(r[0]+r[2])/2;var _=(r[1]+r[3])/2;while(!Ea(r[0],r[1],r[2],r[3],this._root.minX,this._root.minY,this._root.maxX,this._root.maxY)){n=this._root;var m=n.minX;var y=n.minY;var b=n.maxX;var x=n.maxY;var S=m,A=y,E=b,w=x;var k=Math.abs(b-m);var C=Math.abs(x-y);if(C===0&&k===0){break}var T=Math.max(k,C);if(p<=m){S-=T}if(_<=y){A-=T}if(p>m){E+=T}if(_>y){w+=T}var L=Sa(S,A,E,w,null,--v);this.splitNode(L);L.children[Ia(m,y,b,x,S,A,E,w)]=n;this._root=n.parent=L}a=[this._root];this._root.level=this._rootLevel;while(o=a.shift()){if(!o.leaf){for(var M=0;M<4;M++){var I=o.children[M];I.level=o.level+1;a.push(I)}}}}n=this._root;o=n.children[Ia(r[0],r[1],r[2],r[3],n.minX,n.minY,n.maxX,n.maxY)];if(o.leaf){o.objects.push(t);if(l[t]){l[t].push(o)}else{l[t]=[o]}}return t};Na.prototype.removeById=function e(t){if(!this._objects[t]){return t}this._size--;var r=this._idToCell[t];for(var n=0;n<r.length;n++){var i=r[n];var a=i.objects;for(var o=0,s=a.length;o<s;o++){if(a[o]===t){a.splice(o,1);break}}}delete this._objects[t];delete this._idToCell[t];return t};Na.prototype.remove=function e(t){var r=this._getBBox(t);var n=r[0];var i=r[1];var a=r[2];var o=r[3];var s=[this._root];var u,l,d;while(u=s.pop()){if(ka(n,i,a,o,u.minX,u.minY,u.maxX,u.maxY)){if(u.leaf){var f=u.objects;for(var h=0,c=f.length;h<c;h++){if(f[h]===t){f.splice(h,1);if(c===1){d=d||[];d.push(u)}break}}}else{s.push.apply(s,u.children)}}}delete this._idToCell[t];delete this._objects[t];this._size--;if(d){while(l=d.pop()){var g=l.parent;var v=true;while(g&&v){if(!g.leaf){for(var p=0;p<4;p++){u=g.children[p];if(!u.leaf||u.objects.length!==0){v=false;break}}if(v){g.leaf=true;g.children=null;g.objects=[]}}g=g.parent}}}return t};Na.prototype.splitNode=function e(t){var r=t.minX;var n=t.minY;var i=t.maxX;var a=t.maxY;var o=(r+i)/2,s=(n+a)/2;var u=t.level+1;var l=this._idToCell;var d=this._maxLevel;var f=[Sa(r,n,o,s,t,u),Sa(r,s,o,a,t,u),Sa(o,s,i,a,t,u),Sa(o,n,i,s,t,u)];if(t.objects){var h=t.objects;var c=this._getBBox;for(var g=0,v=h.length;g<v;g++){var p=h[g];var _=c(p);var m=l[p];for(var y=0;y<4;y++){var b=f[y];var x=b.minX;var S=b.minY;var A=b.maxX;var E=b.maxY;if(ka(_[0],_[1],_[2],_[3],x,S,A,E)){b.objects.push(p);if(b.level>=d||Math.abs(A-x)<=Math.abs(_[2]-_[0])||Math.abs(E-S)<=Math.abs(_[3]-_[1])){b.final=true}if(m){m.push(b)}else{m=[b]}}}m.splice(m.indexOf(t),1)}}t.children=f;t.objects=null;t.leaf=false};Na.prototype.point=function e(t,r){var n=[];var i=[this._root];var a,o,s;var u=t[0];var l=t[1];var d=this._getBBox;while(a=i.pop()){if(u>=a.minX&&u<=a.maxX&&l>=a.minY&&l<=a.maxY){if(a.leaf){if(r){n=a.objects}var f=a.objects;for(var h=0,c=f.length;h<c;h++){s=f[h];o=d(s);if(u>=o[0]&&u<=o[2]&&l>=o[1]&&l<=o[3]){n.push(s)}}break}else{i.push.apply(i,a.children)}}}return n};Na.prototype.neigbours=function e(t){var r=[],n;var i=[this._root];var a=t[0];var o=t[1];while(n=i.pop()){if(a>=n.minX&&a<=n.maxX&&o>=n.minY&&o<=n.maxY){if(n.leaf){r=n.objects;break}else{i.push.apply(i,n.children)}}}return r};Na.prototype.query=function e(t,r,n,i){var a=[];var o=[this._root];var s,u,l;var d=this._getBBox;var f={};while(s=o.pop()){if(ka(t,r,n,i,s.minX,s.minY,s.maxX,s.maxY)){if(s.leaf){var h=s.objects;for(var c=0,g=h.length;c<g;c++){l=h[c];if(!f[l]){u=d(l);if(ka(t,r,n,i,u[0],u[1],u[2],u[3])){a.push(l)}f[l]=true}}}else{o.push.apply(o,s.children)}}}return a};Na.prototype.getOverlaps=function e(){var t=[this._root];var r,n,i;var a=[];var o=this._getBBox;var s={},u=this._objects;while(r=t.pop()){if(r.leaf){var l=r.objects,d=l.length;for(var f=0;f<d;f++){for(var h=0;h<d;h++){n=l[f];i=l[h];if(f!==h&&!s[n+":"+i]&&!s[i+":"+n]){var c=u[n],g=u[i];s[n+":"+i]=true;if(ka(o(c),o(g))){a.push(c,g)}}}}}else{t.push.apply(t,r.children)}}return a};Na.prototype.getAll=function e(){return Object.keys(this._objects)};Na.prototype.forEach=function e(t,r){var n=[this._root];var i;while(i=n.pop()){if(i.leaf){for(var a=0,o=i.objects.length;a<o;a++){t.call(r,i.objects[a])}}else{n.push.apply(n,i.children)}}return this};Na.prototype.getLeafs=function e(){var t=[this._root],r=[];var n;while(n=t.pop()){if(n.leaf){r.push(n)}else{t.push.apply(t,n.children)}}return r};Na.prototype.traverse=function e(t,r){var n=[this._root];var i;while(i=n.pop()){if(!t.call(r,i,i.objects)&&!i.leaf){n.push.apply(n,i.children)}}return this};Na.prototype.update=function e(t){this.remove(t);this.insert(t);return this};Na.prototype.getNodeBounds=function e(t){return Aa(t)};Object.defineProperties(Na.prototype,za);Na.flatAccessor=function(e,t){return function(r){var n=t*r;return e.slice(n,n+t)}};Na.inside=Ea;Na.intersects=wa;Na.overlaps=ka;Na.getNodeBBox=Aa;function Ra(e,t,r,n,i){var a=new Array(e.length);for(var o=0;o<t.length;o++){var s=n[t[o]];var u=n[r[o]];a[s]=a[s]||[];a[s].push(u);if(i){a[u]=a[u]||[];a[u].push(s)}}return a}function Pa(e,t){if(e[t]===-1){return t}return Pa(e,e[t])}function Da(e,t,r){var n=Pa(e,t);var i=Pa(e,r);e[n]=i}function Oa(e,t,r,n){if(n===void 0)n=false;var i=new Int32Array(e.length);var a={};for(var o=0;o<e.length;o++){i[o]=-1;a[e[o]]=o}for(var s=0;s<t.length;s++){var u=a[t[s]];var l=a[r[s]];if(n&&u===l){return true}var d=Pa(i,u);var f=Pa(i,l);if(d===f){return true}Da(i,d,f)}return false}function Ba(e,t,r,n,i,a,o,s){n[e]=i;if(r[e]){return true}if(t[e]){return false}t[e]=1;r[e]=1;var u=a[e];if(u){for(var l=0,d=u;l<d.length;l+=1){var f=d[l];if(Ba(f,t,r,n,e,a,o,s)){o.push(s[f]);return true}}}r[e]=0;return false}function ja(e,t,r){var n=e.length;var i=new Uint8Array(n);var a=new Uint8Array(n);var o=new Int32Array(n);var s={};for(var u=0;u<n;u++){s[e[u]]=u}var l=Ra(e,t,r,s,false);for(var d=0;d<n;d++){var f=d,h=[];if(Ba(f,i,a,o,-1,l,h,e)){if(h.length>1){var c=h[0];for(var g=1;g<h.length;g++){if(h[g]===c){h.length=g;break}}h.push(c);return h.reverse()}}}return false}function Va(e,t,r,n,i,a,o){t[e]=1;n[e]=r;var s=i[e];if(s){for(var u=0,l=s;u<l.length;u+=1){var d=l[u];if(!t[d]){if(Va(d,t,e,n,i,a,o)){a.push(o[d]);return true}}else if(d!==r){n[d]=e;a.push(o[d]);return true}}}return false}function Ua(e,t,r){var n=e.length;var i=new Uint8Array(n);var a=new Int32Array(n);var o={};for(var s=0;s<n;s++){o[e[s]]=s;a[s]=-1}var u=Ra(e,t,r,o,true);for(var l=0;l<t.length;l++){var d=o[t[l]];var f=o[r[l]];u[d]=u[d]||[];u[d].push(f)}for(var h=0;h<n;h++){var c=h;var g=[];if(!i[c]&&Va(c,i,-1,a,u,g,e)){return true}}return false}var Ga=function e(t,r,n){this.cycles=[];this.visited={};this.visitedLength=0;this.visitedStack=[];this.stack=[];this.idToIndex={};this.removed={};this.nodes=t;for(var i=0;i<t.length;i++){this.idToIndex[t[i]]=i}this.adjacency=Ra(t,r,n,this.idToIndex)};Ga.prototype.getCycles=function e(){for(var t=0;t<this.nodes.length;t++){this.backtrack(t,t);while(this.visitedLength!==0){var r=this.visitedStack.pop();if(this.visited[r]){this.visited[r]=null;this.visitedLength--}}}return this.cycles};Ga.prototype.backtrack=function e(t,r){var n=false;this.stack.push(r);if(!this.visited[r]){this.visited[r]=true;this.visitedLength++}this.visitedStack.push(r);var i=this.adjacency[r]||[];for(var a=0,o=i;a<o.length;a+=1){var s=o[a];this.removed[r]=this.removed[r]||{};if(this.removed[r][s]){continue}if(s<t){this.removed[r][s]=true}else if(s===t){n=true;var u=[];for(var l=0,d=false;l<this.stack.length;l++){var f=this.stack[l];if(t===f){d=true}if(d){u.push(this.nodes[f])}}this.cycles.push(u)}else if(!this.visited[s]){var h=this.backtrack(t,s);n=n||h}}if(n){var c;do{c=this.visitedStack.pop();if(this.visited[c]){this.visited[c]=null;this.visitedLength--}}while(c!==r)}this.stack.pop();return n};var Wa=Object.freeze({minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,largestEmptyCircle:ca,minDisk:minDisk,removeRadialOverlap:removeRadialOverlap,convexhull:ha,circlePack:circlePack,GridIndex:ya,Grid:xa,Quadtree:Na,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,stressMinimizationStepGeneral:stressMinimizationStepGeneral,detectCyclesUndirected:Oa,detectCyclesDirected:ja,detectCyclesUndirectedDFS:Ua,CyclesFinder:Ga});var Ha=typeof y==="object"&&y!==null&&typeof y.it!=="undefined";function Xa(e){if(!Ha){console.warn(tr()+" "+e)}}function qa(e,t){return e===undefined?t:e}function Ya(e,t){if(!t){return{nodes:e?new e:Object.create(null),edges:e?new e:Object.create(null),fetch:function(e){return e?this.nodes:this.edges}}}else{return{nodes:e,edges:t,fetch:function(e){return e?this.nodes:this.edges}}}}function Za(value,e,t){return $(value,e,t)}function Ka(e,t,value,r){if(t in e){throw new Error(r+" "+t+" already exists")}e[t]=value}function Qa(e,t,r){if(Array.isArray(e)){var n=e.indexOf(t);if(n===-1){throw new Error(r+" "+t+" does not exist")}return n}else{if(!(t in e)){throw new Error(r+" "+t+" does not exist")}return e[t]}}function Ja(e,t){return q(e,t)}Ogma.extend(function(e){var t=new $a;e.modules.events=t;e.events.removeListener=function(e){t.removeListener(e)}});var $a=function e(){this._events={};this._onAnyEvents=[]};$a.prototype.register=function e(t,r){var n=this;if(r===void 0)r=[];t.forEach(function(e){if(n._events[e]){throw new Error('event "'+e+'" already exists')}n._events[e]=new eo(false,e)});r.forEach(function(e){if(n._events[e]){throw new Error('event "'+e+'" already exists')}n._events[e]=new eo(true,e)})};$a.prototype.onAnyEvent=function e(t){this._onAnyEvents.push(t)};$a.prototype.on=function e(t,r){var n=this;if(j(t)){U(t,function(e,t){return n.on(t,e)})}else{var i=t.split(" ").filter(function(e){return!!e});i.forEach(function(e){return Qa(n._events,e,"event").on(r)})}return r};$a.prototype.removeListener=function e(t){U(this._events,function(e){e.off(t)})};$a.prototype.fire=function e(t,r){var n=Qa(this._events,t,"event");this._onAnyEvents.forEach(function(e){return e(t,r)});return n.trigger(r)};$a.prototype.once=function e(t,r){var n=this;var i=function(){r.apply(null,arguments);n.removeListener(i)};return this.on(t,i)};var eo=function e(t,r){this._name=r;this._reverseOrder=t;this._subscribers=[];this._handlers=[]};eo.prototype.trigger=function e(t){for(var r=0,n=this._handlers;r<n.length;r+=1){var i=n[r];i(t,this._name)}};eo.prototype.on=function e(t){if(typeof t!=="function"){throw new Error("handler is not a function")}var r=this._reverseOrder?0:this._subscribers.length;this._handlers.splice(r,0,t);this._subscribers.splice(r,0,t)};eo.prototype.off=function e(t){var r;while((r=this._subscribers.indexOf(t))!==-1){this._subscribers.splice(r,1);this._handlers.splice(r,1)}};Ogma.afterInit(function(e,t){if(t.options){e.setOptions(t.options)}});Ogma.extend(function(e){var t=new to(e);e.modules.settings=t;e.setOptions=function(e){return t.update(e)};e.getOptions=function(){return t.get()}});var to=function e(){this._currentValue={};this._onChange={};this._defaultValues={};this._keys=[]};to.prototype.register=function e(t,r,n,i){if(i===void 0)i=true;this._keys.push(t);this._currentValue[t]=r;this._defaultValues[t]=r;this._onChange[t]=n||function(){};if(n&&i){n(r)}};to.prototype.update=function e(t){t=Y(t);var r=this._keys,n={};for(var i=0;i<r.length;++i){var a=r[i];if(a in t){var value=t[a];if(value===undefined){value=this._defaultValues[a]}n[a]=this._currentValue[a];this._currentValue[a]=value}}var o=Object.keys(n);for(var s=0;s<o.length;++s){var u=o[s],l=this._currentValue[u],d=n[u];if(l!==d){this._onChange[u](l,d)}}return Z(n)};to.prototype.get=function e(t){if(t===undefined){return Z(this._currentValue)}else{return this._currentValue[t]}};to.prototype.set=function e(t,value){var r=this._currentValue[t];var n=this._onChange[t];this._currentValue[t]=value;if(n){n(value,r)}};var ro=typeof window!=="undefined";var no=ro&&!window.PointerEvent&&window.MSPointerEvent;var io=ro&&!!(window.PointerEvent||no);var ao=no?"MSPointerDown":"pointerdown";var oo=no?"MSPointerMove":"pointermove";var so=no?"MSPointerUp":"pointerup";var uo=no?"MSPointerCancel":"pointercancel";var lo={};var fo=0;function ho(){if(typeof document!=="undefined"&&fo===0&&io){var e=document.documentElement;e.addEventListener(ao,go,true);e.addEventListener(oo,vo,true);e.addEventListener(so,po,true);e.addEventListener(uo,po,true)}fo++}function co(){fo--;if(typeof document!=="undefined"&&fo===0){var e=document.documentElement;e.removeEventListener(ao,go,true);e.removeEventListener(oo,vo,true);e.removeEventListener(so,po,true);e.removeEventListener(uo,po,true)}}function go(e){lo[e.pointerId]=e}function vo(e){if(lo[e.pointerId]){lo[e.pointerId]=e}}function po(e){delete lo[e.pointerId]}function _o(e,t){e.touches=[];for(var r in lo){e.touches.push(lo[r])}e.changedTouches=[e];t(e)}function mo(e,t,r){var n=function(e){if(e.pointerType!=="mouse"&&e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){e.preventDefault()}_o(e,r)};e(t,ao,n,false);return n}function yo(e,t,r){var n=function(e){if(e.pointerType!=="mouse"&&e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){e.preventDefault()}_o(e,r)};e(t,uo,n,false);return n}function bo(e,t,r){var n=function(e){if((e.pointerType===e.MSPOINTER_TYPE_MOUSE||e.pointerType==="mouse")&&e.buttons===0){return}_o(e,r)};e(t,oo,n,false);return n}function xo(e,t,r){var n=function(e){return _o(e,r)};e(t,so,n,false);e(t,uo,n,false);return n}function So(e,t,r,n){if(r==="touchstart"){e(t,ao,n,false)}else if(r==="touchmove"){e(t,oo,n,false)}else if(r==="touchend"){e(t,so,n,false);e(t,uo,n,false)}}var Ao=["geo","graphics","legend","brand","tooltip"];var Eo=300;var wo=300;Ogma.afterInit(function(e,t){if(t.container){e.setContainer(t.container)}});Ogma.extend(function(e,t){var r=new ko(e,t.dimensions);e.modules.dom=r;e.setContainer=function(e){return r.setContainer(e)};e.getContainer=function(){return r.getContainer()};e.view.beforeNextFrame=function(){return r.beforeNextFrame()};e.view.afterNextFrame=function(){return r.afterNextFrame()};e.view.setFullScreen=function(value){return r.setFullScreen(value)};e.view.isFullScreen=function(){return r.isFullScreen()};e.view.forceResize=function(){return r.forceResize()};e.view.getSize=function(){return r.getDimensions()};e.view.setSize=function(e){r.setDimensions(e);return Promise.resolve()}});Ogma.onDestroy(function(e){co();e.modules.dom.detachFromDom();e.modules.dom.clearAllTimeouts();e.modules.dom.stopFrames()});var ko=function e(t,r){var n=this;if(r===void 0)r={};var i=r.width;if(i===void 0)i=80;var a=r.height;if(a===void 0)a=60;this._events=t.modules.events;this._settings=t.modules.settings;this._width=i;this._height=a;this._layers={};this._container=null;this._isFullScreen=false;this._beforeNextFramePromises=[];this._afterNextFramePromises=[];this._refreshUntil=0;this._currentTime=$t();this._timeouts=[];this._isDestroyed=false;this._settings.register("minimumWidth",Eo,function(){return n._resize()},false);this._settings.register("minimumHeight",wo,function(){return n._resize()},false);this._events.register(["beforeNewFrame","newFrame","afterNewFrame","setContainer","resize"]);this._onDetachDom=[];this._onWindowResize=function(){return n._resize()};this._onWindowFocus=function(){return n.refresh()};ho();this.addWindowEventListener("resize",this._onWindowResize);this.addWindowEventListener("focus",this._onWindowFocus)};ko.prototype.addWindowEventListener=function e(t,r,n){if(typeof window!=="undefined"&&!window.__OGMA_HEADLESS){this.addElementEventListener(window,t,r,n)}};ko.prototype.addDocumentEventListener=function e(t,r,n){if(typeof document!=="undefined"&&!window.__OGMA_HEADLESS){this.addElementEventListener(document.documentElement,t,r,n)}return r};ko.prototype.removeDocumentEventListener=function e(t,r){if(typeof document!=="undefined"&&!window.__OGMA_HEADLESS){document.documentElement.removeEventListener(t,r)}};ko.prototype.addMediaListener=function e(t,r){if(typeof window!=="undefined"&&!window.__OGMA_HEADLESS&&typeof window.matchMedia==="function"){var n=window.matchMedia(t);n.addListener(r);this._onDetachDom.push(function(){return n.removeListener(r)})}};ko.prototype.addElementEventListener=function e(t,r,n,i){if(!this._isDestroyed){t.addEventListener(r,n,i);this._onDetachDom.push(function(){return t.removeEventListener(r,n,i)})}return n};ko.prototype.detachFromDom=function e(){this._onDetachDom.forEach(function(e){return e()});this._onDetachDom=null;this._emptyContainer()};ko.prototype.setTimeout=function e(t,r){var n=this;if(r===void 0)r=0;var i=setTimeout(function(){n._timeouts.splice(n._timeouts.indexOf(i),1);t()},r);this._timeouts.push(i);return i};ko.prototype.clearTimeout=function e(t){if(t){clearTimeout(t);this._timeouts.splice(this._timeouts.indexOf(t),1)}return null};ko.prototype.clearAllTimeouts=function e(){this._timeouts.forEach(clearTimeout);this._timeouts=[]};ko.prototype.stopFrames=function e(){this._isDestroyed=true;if(this._nextFrame){m(this._nextFrame);this._nextFrame=null}};ko.prototype.isDestroyed=function e(){return this._isDestroyed};ko.prototype.getDimensions=function e(){return{width:this._width,height:this._height}};ko.prototype.setDimensions=function e(t){this._resize(t)};ko.prototype.setLayer=function e(t,r,n){if(n===void 0)n={};var i=n.automaticResize;if(i===void 0)i=false;if(r){r._ogmaLayer=t;if(i){r.style.position="absolute";r.style.top="0px";r.style.left="0px";Fe(r,this._width,this._height,ke())}}this._layers[t]={element:r,automaticResize:i};this._updateContainerContent()};ko.prototype.setContainer=function e(t){if(typeof t==="string"){var r=t;t=document.getElementById(r);if(!t){throw new Error('unable to find DOM element with id "'+r+'"')}}if(t===this._container){return}var n=this._container;this._isFullScreen=false;this._container=t;this._resize();this._updateContainerContent();this._events.fire("setContainer",{element:t,prevElement:n})};ko.prototype.getContainer=function e(){return this._container};ko.prototype.focus=function e(){this._focus=true};ko.prototype.blur=function e(){this._focus=false};ko.prototype.hasFocus=function e(){return this._focus};ko.prototype.forceResize=function e(){this._resize()};ko.prototype._beforeOrAfterNextFrame=function e(t){var r=t?this._afterNextFramePromises:this._beforeNextFramePromises;var n=new Promise(function(e){r.push(function(){e();return n})});this._refresh();return n};ko.prototype.beforeNextFrame=function e(){return this._beforeOrAfterNextFrame(false)};ko.prototype.afterNextFrame=function e(){return this._beforeOrAfterNextFrame(true)};ko.prototype.refresh=function e(t){if(t){this._refreshUntil=Math.max(this._refreshUntil,t)}this._refresh()};ko.prototype._emptyContainer=function e(){if(this._container){var t=[];for(var r=0;r<this._container.childNodes.length;++r){var n=this._container.childNodes[r];if(n._ogmaLayer){t.push(n)}}for(var i=0;i<t.length;++i){this._container.removeChild(t[i])}}};ko.prototype._fillContainer=function e(){var t=this;if(this._container){var r=fe(this._container,"position");if(r!=="absolute"&&r!=="relative"&&r!=="fixed"){this._container.style.position="relative"}var n=this._container.firstChild;Ao.forEach(function(e){var r=t._layers[e];if(r&&r.element){t._container.insertBefore(r.element,n)}})}};ko.prototype._updateContainerContent=function e(){this._emptyContainer();this._fillContainer()};ko.prototype._resize=function e(t){if(!this._container&&!t){return}var r=this._width;var n=this._height;var i;var a;if(this._container){var o=this._settings.get("minimumWidth");var s=this._settings.get("minimumHeight");var u=this._container.clientWidth||1;var l=this._container.clientHeight||1;if(t){i=Math.max(o,t.width);a=Math.max(s,t.height)}else{i=Math.max(o,u);a=Math.max(s,l)}}else{i=t.width;a=t.height}if(i!==r||a!==n){this._width=i;this._height=a;U(this._layers,function(e){var t=e.element;var r=e.automaticResize;if(r){Fe(t,i,a)}});this._events.fire("resize",{prevWidth:r,prevHeight:n,width:i,height:a,difWidth:i-r,difHeight:a-n})}};ko.prototype._refresh=function e(){var t=this;if(this._inFrame){this._mustRefresh=true}else if(!this._nextFrame&&!this._isDestroyed){this._nextFrame=_(function(){return t._playFrame()})}};ko.prototype._playFrame=function e(){var t=this;var r=$t();var n=r-this._currentTime;var i=M([this._beforeNextFramePromises,function(){return t._events.fire("beforeNewFrame",{elapsed:n})},function(){return t._events.fire("newFrame",{elapsed:n})},function(){return t._events.fire("afterNewFrame",{elapsed:n})},this._afterNextFramePromises,function(){t._inFrame=false;if(t._mustRefresh||r<t._refreshUntil+17){t._mustRefresh=false;t._refresh()}}]);this._inFrame=true;this._nextFrame=null;this._mustRefresh=false;this._currentTime=r;this._beforeNextFramePromises=[];this._afterNextFramePromises=[];i.reduce(function(e,r){return e.then(function(){if(!t._isDestroyed){return r()}})},Promise.resolve())};ko.prototype.isPlayingFrame=function e(){return this._inFrame||!!this._nextFrame};ko.prototype.setFullScreen=function e(value){if(this._container){if(value&&!this._isFullScreen){Co(this._container)}else if(!value&&this._isFullScreen){To()}}this._isFullScreen=value};ko.prototype.isFullScreen=function e(){return this._isFullScreen};ko.prototype.debounceBeforeFrame=function e(t){var r=this;var n=false;var i=[];var a=function(){var e=i;n=false;i=[];t();e.forEach(function(e){return e()})};return function(){return new Promise(function(e){i.push(e);if(!n){n=true;r.beforeNextFrame().then(a)}})}};function Co(e){if(e.requestFullScreen){e.requestFullScreen()}else if(e.webkitRequestFullScreen){e.webkitRequestFullScreen()}else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}else if(e.msRequestFullscreen){e.msRequestFullscreen()}}function To(){if(typeof document==="undefined"){return}if(document.cancelFullScreen){document.cancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}}function Lo(e,t){var r=t.directed;var n=t.ids;var i=t.weight;var a=t.nodes;var o=r?"out":"both";a=a||e.getNodes()._indexes;var s=new Array(a.length);for(var u=0;u<a.length;++u){s[u]=e._collectAdjacentEdges([a[u]],o,"all")}var l=e._nodeIdList;var d=e.getAttributes(false,["source","target","width"]);var f=d[0];var h=d[1];var c=d[2];var g=e.getNodeAttribute("id");var v=[],p;var _=1,m=false,y=false;if(typeof i==="number"){m=true;_=i}else if(typeof i==="function"){y=true}else if(typeof i!=="string"){i=i?"width":null}for(var b=0;b<s.length;b++){var x=s[b];var S=a[b];var A=void 0,E=void 0,w=void 0,k=void 0;var C=x.length;var T=n?new Array(C):new Uint32Array(C);var L=new Array(C);for(var M=0;M<C;M++){A=x[M];E=f.get(A);w=h.get(A);k=r?w:S===E?w:E;if(n){k=g.get(k)}T[M]=k;if(i){if(m){L[M]=_}else if(y){L[M]=i(l.get(E),l.get(w))}else{L[M]=c.get(A)||_}}}p=Object.create(null);p.nodes=T;p.id=n?g.get(S):S;if(i){p.weights=L}v.push(p)}return v}Ogma.afterInit(function(e,t){if(t.graph){var r=t.graph;var n=r.nodes;var i=r.edges;if(n){e.addNodes(n)}if(i){e.addEdges(i)}}});Ogma.extend(function(e){var t=new Mo(e);var r=t.Node;var n=t.Edge;var i=t.NodeList;var a=t.EdgeList;e.modules.graph=t;e.Node=r;e.Edge=n;e.NodeList=i;e.EdgeList=a;e.events.onNodesAdded=function(t){e.modules.events.on("addNodes",t);return e.events};e.events.onBeforeNodesRemoved=function(t){e.modules.events.on("beforeRemoveNodes",t);return e};e.events.onNodesRemoved=function(t){e.modules.events.on("removeNodes",t);return e.events};e.events.onEdgesAdded=function(t){e.modules.events.on("addEdges",t);return e.events};e.events.onBeforeEdgesRemoved=function(t){e.modules.events.on("beforeRemoveEdges",t);return e};e.events.onEdgesRemoved=function(t){e.modules.events.on("removeEdges",t);return e.events};e.addNodes=function(e,r){return t.addElements(true,e,r)};e.addEdges=function(e,r){if(r===void 0)r={};return t.addElements(false,e,r)};e.addNode=function(e,r){return t.addElement(true,e,r)};e.addEdge=function(e,r){return t.addElement(false,e,r)};e.removeNodes=function(e,r){return t.removeElements(true,e,r)};e.removeEdges=function(e,r){return t.removeElements(false,e,r)};e.removeNode=function(e,r){return t.removeElements(true,[e],r)};e.removeEdge=function(e,r){return t.removeElements(false,[e],r)};e.getNodes=function(e){return t.getNodes(e)};e.getEdges=function(e){return t.getEdges(e)};e.getNode=function(e){return t.getNode(e)};e.getEdge=function(e){return t.getEdge(e)};e.clearGraph=function(){return t.clear()};e.setGraph=function(r,n){t.clear();return e.addGraph(r,n)};e.addGraph=function(e,r){return t.addGraph(e,r)};e.createNodeList=function(){return e.getNodes([])};e.createEdgeList=function(){return e.getEdges([])};r.prototype.getAdjacentNodes=function(e){return t.getAdjacentNodes(this,e)};i.prototype.getAdjacentNodes=function(e){return t.getAdjacentNodes(this,e)};r.prototype.getAdjacentEdges=function(e){return t.getAdjacentEdges(this,e)};i.prototype.getAdjacentEdges=function(e){return t.getAdjacentEdges(this,e)};r.prototype.getDegree=function(e){return t.getDegree(this,e)[0]};i.prototype.getDegree=function(e){return t.getDegree(this,e)};i.prototype.getConnectedComponents=function(e){return t.getConnectedComponents(this,e)};n.prototype.getParallelEdges=function(e){return t.getParallelEdges(this,e)};a.prototype.getParallelEdges=function(e){return t.getParallelEdges(this,e)};r.prototype.fastGetAdjacentElements=function(){return t.fastGetNodesAdjacentElements(this)};i.prototype.fastGetAdjacentElements=function(){return t.fastGetNodesAdjacentElements(this)};n.prototype.fastGetAdjacentElements=function(){return t.fastGetEdgesAdjacentElements(this)};a.prototype.fastGetAdjacentElements=function(){return t.fastGetEdgesAdjacentElements(this)};e.getConnectedComponents=function(e){if(e===void 0)e={};return t.getConnectedComponents(t.getNodes(e.filter),e)};e.getConnectedComponentByNode=function(e,r){var n=t.getNode(e);if(n===undefined){throw new Error("getComponentByNode: cannot find node "+e)}return t.getConnectedComponentByNode(n,r)[0]};r.prototype.getConnectedComponent=function(e){return t.getConnectedComponentByNode(this,e)[0]};r.prototype.isVisible=function(){return!this.isExcluded()};i.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})};n.prototype.isVisible=function(){return!this.isExcluded()};a.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})};r.prototype.isExcluded=function(){return t.isExcluded(this)[0]};i.prototype.isExcluded=function(){return t.isExcluded(this)};r.prototype.setExcluded=function(value){return t.setExcluded(this,value)};i.prototype.setExcluded=function(value){return t.setExcluded(this,value)};n.prototype.isExcluded=function(){return t.isExcluded(this)[0]};a.prototype.isExcluded=function(){return t.isExcluded(this)};n.prototype.setExcluded=function(value){return t.setExcluded(this,value)};a.prototype.setExcluded=function(value){return t.setExcluded(this,value)};r.prototype.setVisible=function(value){return this.setExcluded(!value)};i.prototype.setVisible=function(value){return this.setExcluded(!value)};n.prototype.setVisible=function(value){return this.setExcluded(!value)};a.prototype.setVisible=function(value){return this.setExcluded(!value)}});var Mo=function e(t){var r=this;this._ogma=t;this._events=t.modules.events;this._dom=t.modules.dom;this._storage=Ya(new qt(true),new qt(false));this._events.register(["addNodes","addEdges","excludedStateChange"],["clear","beforeRemoveNodes","removeNodes","beforeRemoveEdges","removeEdges"]);this._promisesToResolve=[];this._indexFreeStep=0;this._sourceList=this.createEdgeAttribute({name:"source",storage:32});this._targetList=this.createEdgeAttribute({name:"target",storage:32});this._nodeDeduper=this.createNodeAttribute({storage:1});this._edgeDeduper=this.createEdgeAttribute({storage:1});this._fakeDeduper={get:function(){return 0},set:function(){}};this._fakeInvertedDeduper={get:function(){return 1},set:function(){}};this.createAttributes([{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}]);this.Node=function e(t){this._index=t};Object.defineProperty(this.Node.prototype,"_ogma",{value:t});Object.defineProperty(this.Node.prototype,"isNode",{value:true});Object.defineProperty(this.Node.prototype,"size",{value:1});Object.defineProperty(this.Node.prototype,"__indexes",{value:new Uint32Array(1)});Object.defineProperty(this.Node.prototype,"_indexes",{get:function(){this.__indexes[0]=this._index;return this.__indexes}});this.Edge=function e(t){this._index=t};Object.defineProperty(this.Edge.prototype,"_ogma",{value:t});Object.defineProperty(this.Edge.prototype,"isNode",{value:false});Object.defineProperty(this.Edge.prototype,"size",{value:1});Object.defineProperty(this.Edge.prototype,"__indexes",{value:new Uint32Array(1)});Object.defineProperty(this.Edge.prototype,"_indexes",{get:function(){this.__indexes[0]=this._index;return this.__indexes}});this.NodeList=function e(t){this._indexes=t||new Uint32Array(0)};Object.defineProperty(this.NodeList.prototype,"_ogma",{value:t});Object.defineProperty(this.NodeList.prototype,"_isList",{value:true});Object.defineProperty(this.NodeList.prototype,"size",{get:function(){return this._indexes.length}});Object.defineProperty(this.NodeList.prototype,"isNode",{value:true});this.EdgeList=function e(t){this._indexes=t||new Uint32Array(0)};Object.defineProperty(this.EdgeList.prototype,"_ogma",{value:t});Object.defineProperty(this.EdgeList.prototype,"_isList",{value:true});Object.defineProperty(this.EdgeList.prototype,"size",{get:function(){return this._indexes.length}});Object.defineProperty(this.EdgeList.prototype,"isNode",{value:false});this._nodes=this.createAttribute(true,{name:"object",storage:"any"});this._edges=this.createAttribute(false,{name:"object",storage:"any"});this._nodeIndexLists=[];this._edgeIndexLists=[];this._nodeFilters=this._makeFilters(true);this._edgeFilters=this._makeFilters(false);this._init_();this._events.on({newFrame:function(){if(r._indexFreeStep===1){r._indexFreeStep=2}else if(r._indexFreeStep===2){r._storage.nodes.freeIndexes();r._storage.edges.freeIndexes();r._indexFreeStep=0}}})};Mo.prototype.createIndexList=function e(t){return this._storage.fetch(t).createIndexList()};Mo.prototype._isNode=function e(t){return typeof t==="boolean"?t:t.isNode};Mo.prototype.acquireTemporaryIndexList=function e(t){return this._acquireIndexList(t)};Mo.prototype._acquireIndexList=function e(t){var r=this._isNode(t);var n=r?this._nodeIndexLists:this._edgeIndexLists;var i=n.find(function(e){return!e.isBusy()});if(!i){i=this.createIndexList(r);n.push(i)}i.markBusy();return i};Mo.prototype._getObjectList=function e(t){return this._isNode(t)?this._nodes:this._edges};Mo.prototype._getListClass=function e(t){return this._isNode(t)?this.NodeList:this.EdgeList};Mo.prototype._getElementClass=function e(t){return this._isNode(t)?this.Node:this.Edge};Mo.prototype._getDeduper=function e(t){var r=this._isNode(t)?this._nodeDeduper:this._edgeDeduper;r.reset();return r};Mo.prototype._getStorage=function e(t){return this._isNode(t)?this._storage.nodes:this._storage.edges};Mo.prototype._getFilter=function e(t,r){var n=this._isNode(t)?this._nodeFilters:this._edgeFilters;var i=n[r];return i||n.visible};Mo.prototype._getCacheLists=function e(t){return this._isNode(t)?this._nodeCacheLists:this._edgeCacheLists};Mo.prototype._resolvePromises=function e(){var t=this._promisesToResolve;this._promisesToResolve=[];t.forEach(function(e){return e()})};Mo.prototype._init_=function e(){this._nodeCacheLists=this._makeCacheListsForFilters(true);this._edgeCacheLists=this._makeCacheListsForFilters(false);this._neighborTable=new Zt;this._parallelTable=new Zt;this._parallelEdgesIndex=[];this._resolvePromises()};Mo.prototype.getNodeMaxIndex=function e(){return this._storage.nodes.getMaxIndex()};Mo.prototype.getEdgeMaxIndex=function e(){return this._storage.edges.getMaxIndex()};Mo.prototype.isExcluded=function e(t){var r=this._storage.fetch(t.isNode).getFlexArray("excluded");return r.getMultiple(t._indexes)};Mo.prototype.setExcluded=function e(t,value){var r=+value;var n=this._storage.fetch(t.isNode);var i=n.getFlexArray("excluded");var a=n.getFlexArray("removed");var o=this._acquireIndexList(t);var s=this._getListClass(t);for(var u=0,l=t._indexes;u<l.length;u+=1){var d=l[u];var f=i.get(d);var h=a.get(d);if(r!==f&&h===0){o.push(d)}}var c=o.sliceAndReset();if(c.length){this._getCacheLists(t).visible.invalidList();var g=new s(c);i.setMultiple(c,r);this._events.fire("excludedStateChange",{elements:g,value:value})}};Mo.prototype.addElement=function e(t,r,n){if(r===void 0)r={};if(n===void 0)n={};return this._addElements(t,[r],n).get(0)};Mo.prototype.addGraph=function e(t,r){var n=this;var i=t.nodes;if(i===void 0)i=[];var a=t.edges;if(a===void 0)a=[];if(r===void 0)r={};if(!r.batchSize){return Promise.resolve({nodes:this._addElements(true,i,r),edges:this._addElements(false,a,r)})}else{var o;return this.addElements(true,i,r).then(function(e){o=e;return n.addElements(false,a,r)}).then(function(e){return{nodes:o,edges:e}})}};Mo.prototype.addElements=function e(t,r,n){var i=this;if(n===void 0)n={};if(!n.batchSize){return Promise.resolve(this._addElements(t,r,n))}else{var a=[];for(var o=0;o<r.length;o+=n.batchSize){a.push(r.slice(o,o+n.batchSize))}return a.reduce(function(e,r){var a=null;return e.then(function(e){a=e;return i._dom.afterNextFrame()}).then(function(){return i._addElements(t,r,n)}).then(function(e){return a.concat(e)})},Promise.resolve(this.getEmptyList(t)))}};Mo.prototype.getEmptyList=function e(t){return t?new this.NodeList:new this.EdgeList};Mo.prototype._addElements=function e(t,r,n){var i=this._storage.fetch(t);var a=[];var o=[];var s=[];var u=[];var l=new zt;var d=n.virtual;if(d===void 0)d=false;for(var f=0,h=r;f<h.length;f+=1){var c=h[f];if(typeof c!=="object"||c===null||Array.isArray(c)){throw new Error(c+" is not a valid "+(t?"node":"edge"))}var g=Fo(c.id);if(!i.getIndex(g,false)&&!l.has(g)){o.push(g);a.push(c);l.add(g);if(!t){var v=this._getExtremityIndex(g,c.source,"source");var p=this._getExtremityIndex(g,c.target,"target");s.push(v);u.push(p)}}}var _=i.addElements(o);if(t){this._neighborTable.reserve(_.length);for(var m=0;m<_.length;++m){this._neighborTable.addEntry(_[m])}}else{this._parallelTable.reserve(_.length/2|0);for(var y=0;y<_.length;++y){var b=_[y];var x=s[y];var S=u[y];this._sourceList.set(b,x);this._targetList.set(b,S);No(this,b)}}var A=i.getFlexArray("object");var E=i.getFlexArray("excluded");var w=i.getFlexArray("removed");var k=i.getFlexArray("virtual");var C=this._getElementClass(t);var T=this._getListClass(t);var L=this._getCacheLists(t);var M=new T(_);for(var I=0,F=_;I<F.length;I+=1){var N=F[I];A.set(N,new C(N))}E.setMultiple(_,0);w.setMultiple(_,0);k.setMultiple(_,d);L.visible.invalidList();L.all.invalidList();L._all.invalidList();if(!d){L.raw.invalidList()}if(M.size!==0){if(t){this._events.fire("addNodes",{virtual:d,objects:a,nodes:M})}else{this._events.fire("addEdges",{virtual:d,objects:a,edges:M})}}return M};Mo.prototype._getExtremityIndex=function e(t,r,n){if(r instanceof this.Node){return r._index}else{var i=this._storage.nodes.getIndex(r);if(!i){throw new Error("addEdge(s): invalid "+n+' for edge "'+t+'"; node "'+r+'" does not exist')}return i}};Mo.prototype.removeElements=function e(t,r,n,i){if(n===void 0)n={};if(i===void 0)i=false;if(!Array.isArray(r)&&!(r instanceof(t?this.NodeList:this.EdgeList))){r=[r]}var a=this._getElements(t,r);if(!i){a=a.dedupe()}if(!a.size){return Promise.resolve()}if(t){var o=a.getAdjacentEdges({filter:"all"});this.removeElements(false,o,n,true)}var s=n.virtual;if(s===void 0)s=false;var u=a._indexes;var l=this._getStorage(t);var d=this._getCacheLists(t);var f=l.getFlexArray("removed");var h=l.getFlexArray("virtual");var c=Je(h.getMultiple(u));if(c!==(s?u.length:0)){throw new Error("Attempting to remove virtual elements; you should not do that")}var g={virtual:s};g[t?"nodes":"edges"]=a;this._events.fire(t?"beforeRemoveNodes":"beforeRemoveEdges",g);d.visible.invalidList();d.all.invalidList();if(!s){d.raw.invalidList()}this.setExcluded(a,true);f.setMultiple(u,1);if(!t){for(var v=0;v<u.length;++v){zo(this,u[v])}}l.removeElements(u);this._indexFreeStep=1;this._events.fire(t?"removeNodes":"removeEdges",g);return Promise.resolve()};Mo.prototype.getNodes=function e(t){return this._getElements(true,t)};Mo.prototype.getEdges=function e(t){return this._getElements(false,t)};Mo.prototype._getElements=function e(t,r){var n=this._getListClass(t);if(!r||typeof r==="string"){var i=r||"visible";var a=this._getCacheLists(t);var o=a[i];if(!o){throw new Error('getNodes/getEdges: unexpected argument "'+i+'"')}return new n(o.getList())}else{var s=this._acquireIndexList(t);var u=this._getStorage(t);var l=this._getElementClass(t);if(r instanceof l){s.push(r._index)}else if(C(r)){for(var d=0,f=r;d<f.length;d+=1){var h=f[d];if(h instanceof l){s.push(h._index)}else{var c=u.getIndex(h);if(c){s.push(c)}}}}else if(r instanceof n){var g=this._getFilter(t,"all");for(var v=0,p=r._indexes;v<p.length;v+=1){var _=p[v];if(g.match(_)){s.push(_)}}}return new n(s.sliceAndReset())}};Mo.prototype.getNode=function e(t){return this._getElement(true,t)};Mo.prototype.getEdge=function e(t){return this._getElement(false,t)};Mo.prototype._getElement=function e(t,r){var n=this._getElementClass(t);if(r instanceof n){return r}else{var i=this._getStorage(t);var a=this._getObjectList(t);var o=i.getIndex(r);return o?a.get(o):undefined}};Mo.prototype.createNodeList=function e(t){return new this.NodeList(t)};Mo.prototype.createEdgeList=function e(t){return new this.EdgeList(t)};Mo.prototype.clear=function e(){this._events.fire("clear");this._storage.nodes.clear();this._storage.edges.clear();this._init_()};Mo.prototype.forEachElement=function e(t,r){var n=this._getObjectList(t);for(var i=0;i<t._indexes.length;++i){var a=t._indexes[i];var o=n.get(a);r(o,i)}};Mo.prototype.mapElements=function e(t,r){var n=new Array(t.size);var i=this._getObjectList(t);for(var a=0;a<t._indexes.length;++a){var o=t._indexes[a];var s=i.get(o);n[a]=r(s,a)}return n};Mo.prototype.filterElements=function e(t,r){r=r||function(){return true};var n=this._acquireIndexList(t);var i=this._getObjectList(t);var a=this._getListClass(t);for(var o=0;o<t._indexes.length;++o){var s=t._indexes[o];var u=i.get(s);if(u){var l=r(u,o);if(l){n.push(s)}}}return new a(n.sliceAndReset())};Mo.prototype.splitElements=function e(t,r,n){var i=this._getListClass(t);if(!r){return{valid:t,invalid:new i}}var a=this._acquireIndexList(t);var o=this._acquireIndexList(t);var s=this._getObjectList(t);for(var u=0,l=t._indexes;u<l.length;u+=1){var d=l[u];var f=s.get(d);if(f===undefined){continue}var h=r(f,n);var c=h?a:o;c.pushUnchecked(d)}return{valid:new i(a.sliceAndReset()),invalid:new i(o.sliceAndReset())}};Mo.prototype.reduceElements=function e(t,r,n){var i=this._getObjectList(t);var a=n;for(var o=0;o<t._indexes.length;++o){var s=t._indexes[o];var u=i.get(s);a=r(a,u,o)}return a};Mo.prototype.dedupeElements=function e(t){var r=this._getDeduper(t);var n=this._acquireIndexList(t);var i=this._getListClass(t);for(var a=0,o=t._indexes;a<o.length;a+=1){var s=o[a];if(r.get(s)===0){r.set(s,1);n.push(s)}}return new i(n.sliceAndReset())};Mo.prototype.inverseElements=function e(t){var r=this._getStorage(t);var n=r.getFlexArray("excluded");var i=r.getMaxIndex();var a=this._getDeduper(t);var o=this._acquireIndexList(t);var s=this._getListClass(t);for(var u=0,l=t._indexes;u<l.length;u+=1){var d=l[u];a.set(d,1)}for(var f=1;f<=i;++f){if(a.get(f)===0&&n.get(f)===0){o.push(f)}}return new s(o.sliceAndReset())};Mo.prototype.partitionElements=function e(t,r){var n=this._getObjectList(t);var i=this._getListClass(t);var a={};for(var o=0;o<t._indexes.length;++o){var s=t._indexes[o];var u=n.get(s);var l=r(u,o);var d=a[l]||(a[l]=[]);d.push(s)}var f=Object.keys(a);for(var h=0,c=f;h<c.length;h+=1){var g=c[h];a[g]=new i(Uint32Array.from(a[g]))}return a};Mo.prototype.concatElements=function e(t,r){var n=this._getListClass(t);var i=new Uint32Array(t._indexes.length+r._indexes.length);i.set(t._indexes);i.set(r._indexes,t._indexes.length);return new n(i)};Mo.prototype.elementsToArray=function e(t){var r=this._getObjectList(t);var n=new Array(t.size);for(var i=0;i<t._indexes.length;++i){n[i]=r.get(t._indexes[i])}return n};Mo.prototype.getElementsId=function e(t){var r=this._getStorage(t);if(t._isList){var n=new Array(t.size);for(var i=0;i<t._indexes.length;++i){n[i]=r.getId(t._indexes[i])}return n}else{return r.getId(t._index)}};Mo.prototype._getExtremity=function e(t,r){if(r._isList){var n=this._acquireIndexList(true);for(var i=0,a=r._indexes;i<a.length;i+=1){var o=a[i];n.push(t.get(o))}return new this.NodeList(n.sliceAndReset())}else{return this._nodes.get(t.get(r._index))}};Mo.prototype.getEdgesSource=function e(t){return this._getExtremity(this._sourceList,t)};Mo.prototype.getEdgesTarget=function e(t){return this._getExtremity(this._targetList,t)};Mo.prototype.getElementAt=function e(t,r){var n=this._getObjectList(t);return n.get(t._indexes[r])};Mo.prototype.sortElements=function e(t,r){var n=this._getListClass(t);var i=this._getObjectList(t);var a=t._indexes.slice();a.sort(function(e,t){var n=i.get(e);var a=i.get(t);return r(n,a)});return new n(a)};Mo.prototype.createAttribute=function e(t,r){return this._storage.fetch(t).createFlexArray(r)};Mo.prototype.createNodeAttribute=function e(t){return this.createAttribute(true,t)};Mo.prototype.createEdgeAttribute=function e(t){return this.createAttribute(false,t)};Mo.prototype.createAttributes=function e(t){var r=this;t.forEach(function(e){if(e.for!=="edges"){r.createNodeAttribute(e)}if(e.for!=="nodes"){r.createEdgeAttribute(e)}})};Mo.prototype.getAllAttributes=function e(){return this._storage.nodes.getAllFlexArrays().concat(this._storage.nodes.getAllFlexArrays())};Mo.prototype.getAttribute=function e(t,r){return this._storage.fetch(t).getFlexArray(r)};Mo.prototype.getAttributes=function e(t,r){var n=this;return r.map(function(e){return n.getAttribute(t,e)})};Mo.prototype.getNodeAttribute=function e(t){return this.getAttribute(true,t)};Mo.prototype.getEdgeAttribute=function e(t){return this.getAttribute(false,t)};Mo.prototype.getAttributesArrays=function e(t,r,n){if(n===void 0)n={};var i=n.destArrays;var a=n.ids;if(!r){throw new Error("You must provide array of attributes to retrieve the values")}if(!a){a=this._getElements(t,"all")._indexes}return this.getAttributes(t,r).map(function(e,t){return e.getMultiple(a,i?i[t]:undefined)})};Mo.prototype.getNodeAttributesArrays=function e(t,r){return this.getAttributesArrays(true,t,r)};Mo.prototype.getEdgeAttributesArrays=function e(t,r){return this.getAttributesArrays(false,t,r)};Mo.prototype._setExtremities=function e(t,r,n){for(var i=0;i<t.length;++i){zo(this,t[i])}if(r){this._sourceList.setMultiple(t,r)}if(n){this._targetList.setMultiple(t,n)}for(var a=0;a<t.length;++a){No(this,t[a])}};Mo.prototype.setSource=function e(t,r){if(typeof r!=="object"){r=[r]}var n=this.getNodes(r);this._setExtremities(t._indexes,n._indexes,undefined)};Mo.prototype.setTarget=function e(t,r){if(typeof sources!=="object"){r=[r]}var n=this.getNodes(r);this._setExtremities(t._indexes,undefined,n._indexes)};Mo.prototype.getParallelEdges=function e(t,r){if(r===void 0)r={};var n=r.filter||"visible";var i=this._acquireIndexList(t);var a=this._getFilter(t,n);for(var o=0,s=t._indexes;o<s.length;o+=1){var u=s[o];var l=this._sourceList.get(u);var d=this._targetList.get(u);var f=Po(l,d);var h=this._parallelEdgesIndex[f];var c=this._parallelTable.get(+h);if(c){for(var g=0,v=c;g<v.length;g+=1){var p=v[g];if(a.match(p)){i.push(p)}}}}return new this.EdgeList(i.sliceAndReset())};Mo.prototype.getEdgesBetweenTwoNodes=function e(t,r){var n=Po(t._index,r._index);var i=this._parallelEdgesIndex[n];var a=this._parallelTable.get(+i);return new this.EdgeList(Uint32Array.from(a))};Mo.prototype.getAdjacentDirections=function e(t){return this._neighborTable.get(t)};Mo.prototype.getEdgeIndexesInDirection=function e(t){return this._parallelTable.get(t)};Mo.prototype._collectAdjacentEdges=function e(t,r,n,i,a){var o=r==="out";var s=r==="in";var u=!(o||s)&&!a;var l=this._acquireIndexList(false);var d=this._getFilter(false,n);var f=i?this._getDeduper(false):this._fakeDeduper;var h=this._fakeInvertedDeduper;if(a){h=this._getDeduper(true);for(var c=0,g=t;c<g.length;c+=1){var v=g[c];h.set(v,1)}}for(var p=0,_=t;p<_.length;p+=1){var m=_[p];var y=this._neighborTable.get(m);for(var b=0,x=y;b<x.length;b+=1){var S=x[b];var A=this._parallelTable.get(S);if(u){for(var E=0,w=A;E<w.length;E+=1){var k=w[E];if(d.match(k)&&f.get(k)===0){l.push(k);f.set(k,1)}}}else{for(var C=0,T=A;C<T.length;C+=1){var L=T[C];var M=this._sourceList.get(L);var I=this._targetList.get(L);var F=I===m;var N=M+I-m;if((s===F||M===I)&&d.match(L)&&f.get(L)===0&&h.get(N)===1){l.push(L);f.set(L,1)}}}}}return l.sliceAndReset()};Mo.prototype._collectAdjacentNodes=function e(t,r,n,i,a,o){var s=r!=="in";var u=r!=="out";var l=this._acquireIndexList(true);var d=this._getFilter(false,n);var f=i?this._getDeduper(true):this._fakeDeduper;if(a){for(var h=0,c=a;h<c.length;h+=1){var g=c[h];l.push(g);f.set(g,1)}}if(o){for(var v=0,p=o;v<p.length;v+=1){var _=p[v];f.set(_,1)}}for(var m=0,y=t;m<y.length;m+=1){var b=y[m];var x=this._neighborTable.get(b);for(var S=0,A=x;S<A.length;S+=1){var E=A[S];var w=this._parallelTable.get(E);for(var k=0,C=w;k<C.length;k+=1){var T=C[k];if(d.match(T)){var L=this._sourceList.get(T);var M=this._targetList.get(T);var I=u&&b===M||s&&b===L;var F=L+M-b;if(I&&f.get(F)===0){l.push(F);f.set(F,1);break}}}}}return l.sliceAndReset()};Mo.prototype.fastGetNodesAdjacentElements=function e(t){var r=this._acquireIndexList(true);var n=this._acquireIndexList(false);for(var i=0,a=t._indexes;i<a.length;i+=1){var o=a[i];var s=this._neighborTable.get(o);for(var u=0,l=s;u<l.length;u+=1){var d=l[u];var f=this._parallelTable.get(d);var h=f[0];var c=this._sourceList.get(h);var g=this._targetList.get(h);r.push(c+g-o);for(var v=0,p=f;v<p.length;v+=1){var _=p[v];n.push(_)}}}return{nodes:new this.NodeList(r.sliceAndReset()),edges:new this.EdgeList(n.sliceAndReset())}};Mo.prototype.fastGetEdgesAdjacentElements=function e(t){var r=this._acquireIndexList(true);var n=this._acquireIndexList(false);for(var i=0,a=t._indexes;i<a.length;i+=1){var o=a[i];var s=this._sourceList.get(o);var u=this._targetList.get(o);var l=Po(s,u);var d=this._parallelEdgesIndex[l];var f=this._parallelTable.get(+d);if(f){for(var h=0,c=f;h<c.length;h+=1){var g=c[h];n.push(g)}}r.push(s);r.push(u)}return{nodes:new this.NodeList(r.sliceAndReset()),edges:new this.EdgeList(n.sliceAndReset())}};Mo.prototype.getAdjacentNodes=function e(t,r){return new this.NodeList(this._getAdjacentElements(true,t._indexes,r))};Mo.prototype.getAdjacentEdges=function e(t,r){return new this.EdgeList(this._getAdjacentElements(false,t._indexes,r))};Mo.prototype._getAdjacentElements=function e(t,r,n){if(n===void 0)n={};var i=n.direction;if(i===void 0)i="both";var a=n.filter;if(a===void 0)a="visible";var o=n.policy;if(o===void 0)o="union";var s=n.bothExtremities;if(s===void 0)s=false;var u=n.includeSources;if(u===true){o="include-sources"}else if(u===false){o="exclude-sources"}if(!t){return this._collectAdjacentEdges(r,i,a,true,s)}else{var l=o==="include-sources"?r:null;var d=o==="exclude-sources"?r:null;return this._collectAdjacentNodes(r,i,a,true,l,d)}};Mo.prototype.getDegree=function e(t,r){var n=this._getDegreeOptions(r);var i=n.direction;var a=n.filter;var o=new Array(t.size);var s=new Array(1);for(var u=0;u<t.size;++u){s[0]=t._indexes[u];o[u]=this._collectAdjacentNodes(s,i,a).length}return o};Mo.prototype._getDegreeOptions=function e(t){var r={direction:"both",filter:"visible"};if(typeof t==="string"){r.direction=t}else if(t){if(typeof t.direction==="string"){r.direction=t.direction}if(typeof t.filter==="string"){r.filter=t.filter}}return r};Mo.prototype._degrees=function e(t,r){if(r!=="in"&&r!=="out"){return this._neighborTable.sizes(t)}else{var n=new Array(t.length);var i=i==="in";for(var a=0,o=t.length;a<o;a++){n[a]=Ro(this,t[a],i)}return n}};Mo.prototype.getAdjacencyList=function e(t){if(t===void 0)t={};var r=t.directed;if(r===void 0)r=false;var n=t.internalIndexes;if(n===void 0)n=false;var i=t.weight;if(i===void 0)i=1;var a=t.nodes;var o=t.indexes;return Lo(this,{directed:r,weight:i,ids:!n,nodes:o||this.getNodes(a)._indexes})};Mo.prototype.getConnectedComponents=function e(t,r){return Do(this,t._indexes,r)};Mo.prototype.getConnectedComponentByNode=function e(t,r){return Do(this,[t._index],r)};Mo.prototype.generateUnusedNodeId=function e(){return Io()};Mo.prototype.generateUnusedEdgeId=function e(){return Io()};Mo.prototype._makeFilters=function e(t){var r=this._getStorage(t);var n=r.getFlexArray("removed");var i=r.getFlexArray("excluded");var a=r.getFlexArray("virtual");return{all:{_removed:n,match:function(e){return this._removed.get(e)===0}},visible:{_excluded:i,match:function(e){return this._excluded.get(e)===0}},raw:{_removed:n,_virtual:a,match:function(e){return this._virtual.get(e)===0&&this._removed.get(e)===0}},_all:{match:function(){return true}}}};Mo.prototype._makeCacheListsForFilters=function e(t){return{all:this._makeCacheList(t,"all"),visible:this._makeCacheList(t,"visible"),raw:this._makeCacheList(t,"raw"),_all:this._makeCacheList(t,"_all")}};Mo.prototype._makeCacheList=function e(t,r){var n=(t?this._nodeFilters:this._edgeFilters)[r];var i=this._getStorage(t);return{_self:this,_isNode:t,_storage:i,_filter:n,_list:null,getList:function e(){if(!this._list){var t=this._storage.getMaxIndex();var r=this._self._acquireIndexList(this._isNode);r.reset();for(var n=1;n<=t;++n){if(this._filter.match(n)){r.push(n)}}this._list=r.sliceAndReset()}return this._list},invalidList:function e(){this._list=null}}};function Io(){return Math.round(Math.random()*Number.MAX_SAFE_INTEGER)}function Fo(e){if(e===undefined){return Io()}else if(typeof e!=="string"&&(typeof e!=="number"||!isFinite(e))){throw new Error(e+" is not a valid id, expected string or number")}return e}function No(e,t){var r=e._sourceList.get(t);var n=e._targetList.get(t);var i=Po(r,n);var a=e._parallelEdgesIndex[i];if(a===undefined){a=e._parallelTable.addEntry();e._parallelEdgesIndex[i]=a;e._neighborTable.addTo(r,a);if(r!==n){e._neighborTable.addTo(n,a)}}e._parallelTable.addTo(a,t)}function zo(e,t){var r=e._sourceList.get(t);var n=e._targetList.get(t);var i=Po(r,n);var a=e._parallelEdgesIndex[i];if(e._parallelTable.removeFromAndGetSize(a,t)===0){e._neighborTable.removeFrom(r,a);if(r!==n){e._neighborTable.removeFrom(n,a)}e._parallelEdgesIndex[i]=undefined}}function Ro(e,t,r){var n=e._neighborTable.get(t);var i=0;for(var a=0;a<n.length;++a){var o=e._parallelTable.get(n[a]);for(var s=0;s<o.length;++s){var u=o[s],l=e._sourceList.get(u),d=e._targetList.get(u);if(r&&d===t||!r&&l===t){i+=1;break}}}return i}function Po(e,t){var r=e<t?e:t;var n=e+t-r;return r*67108864+n}function Do(e,t,r){if(r===void 0)r={};var n=r.filter;if(n===void 0)n="visible";var i=r.returnIds;if(i===void 0)i=false;var a=r.internalIndexes;if(a===void 0)a=false;var o=[];var s={};var u=e._acquireIndexList(true);var l=e._getFilter(true,n);for(var d=0,f=t;d<f.length;d+=1){var h=f[d];if(l.match(h)){u.push(h)}}var c=u.sliceAndReset();var g={filter:n};for(var v=0;v<c.length;v++){var p=c[v];if(!s[p]){var _=[p];var m=[];while(_.length!==0){var y=_.pop();if(!s[y]){_.push.apply(_,e._getAdjacentElements(true,[y],g));s[y]=1;m.push(y)}}if(m.length>0){o.push(m)}}}if(i){var b=e.getNodeAttribute("id");for(var x=0;x<o.length;x++){o[x]=b.getMultiple(o[x])}}else if(!a){for(var S=0;S<o.length;S++){o[S]=new e.NodeList(o[S])}}return o}Ogma.extend(function(e){var t=e.modules.graph;var r=e.Node;var n=e.Edge;var i=e.NodeList;var a=e.EdgeList;r.prototype.toList=function(){return new i(new Uint32Array([this._index]))};n.prototype.toList=function(){return new a(new Uint32Array([this._index]))};i.prototype.toList=function(){return this};a.prototype.toList=function(){return this};i.prototype.toArray=function(){return t.elementsToArray(this)};i.prototype.clone=function(){return new i(this._indexes.slice())};a.prototype.toArray=function(){return t.elementsToArray(this)};a.prototype.clone=function(){return new a(this._indexes.slice())};r.prototype.getId=function(){return t.getElementsId(this)};i.prototype.getId=function(){return t.getElementsId(this)};n.prototype.getId=function(){return t.getElementsId(this)};a.prototype.getId=function(){return t.getElementsId(this)};n.prototype.getSource=function(){return t.getEdgesSource(this)};a.prototype.getSource=function(){return t.getEdgesSource(this)};n.prototype.getTarget=function(){return t.getEdgesTarget(this)};a.prototype.getTarget=function(){return t.getEdgesTarget(this)};n.prototype.getExtremities=function(){return new i(Uint32Array.from([this.getSource()._index,this.getTarget()._index]))};a.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())};n.prototype.setSource=function(e){t.setSource(this,e)};n.prototype.setTarget=function(e){t.setTarget(this,e)};i.prototype.get=function(e){return t.getElementAt(this,e)};i.prototype.forEach=function(e){return t.forEachElement(this,e)};i.prototype.map=function(e){return t.mapElements(this,e)};i.prototype.filter=function(e){return t.filterElements(this,e)};i.prototype.reduce=function(e,r){return t.reduceElements(this,e,r)};i.prototype.concat=function(e){return t.concatElements(this,e)};i.prototype.dedupe=function(){return t.dedupeElements(this)};r.prototype.slice=function(){return this.toList()};n.prototype.slice=function(){return this.toList()};i.prototype.slice=function(e,t){return new i(this._indexes.slice(e,t))};a.prototype.get=function(e){return t.getElementAt(this,e)};a.prototype.forEach=function(e){t.forEachElement(this,e)};a.prototype.map=function(e){return t.mapElements(this,e)};a.prototype.filter=function(e){return t.filterElements(this,e)};a.prototype.reduce=function(e,r){return t.reduceElements(this,e,r)};a.prototype.concat=function(e){return t.concatElements(this,e)};a.prototype.dedupe=function(){return t.dedupeElements(this)};i.prototype.partition=function(e){return t.partitionElements(this,e)};a.prototype.partition=function(e){return t.partitionElements(this,e)};a.prototype.slice=function(e,t){return new a(this._indexes.slice(e,t))};i.prototype.indexOf=function(e){if(!(e instanceof r)){return-1}return this._indexes.indexOf(e._index)};a.prototype.indexOf=function(e){if(!(e instanceof n)){return-1}return this._indexes.indexOf(e._index)};i.prototype.includes=function(e){return this.indexOf(e)!==-1};a.prototype.includes=function(e){return this.indexOf(e)!==-1};i.prototype.sort=function(e){return t.sortElements(this,e)};a.prototype.sort=function(e){return t.sortElements(this,e)};i.prototype.inverse=function(){return t.inverseElements(this)};a.prototype.inverse=function(){return t.inverseElements(this)};function o(e){if(typeof e!=="object"||e===null){e={}}var t=typeof e.data==="function"?e.data:function(e){return e};var r=Array.isArray(e.attributes)?e.attributes:undefined;return{attributes:r,data:t}}r.prototype.toJSON=function(e){var t=o(e);var r=t.attributes;var n=t.data;return{id:this.getId(),attributes:this.getAttributes(r),data:n(G(this.getData()))}};i.prototype.toJSON=function(e){if(e===void 0)e={};return this.map(function(t){return t.toJSON(e)})};n.prototype.toJSON=function(e){if(e===void 0)e={};var t=o(e);var r=t.attributes;var n=t.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(r),data:n(G(this.getData()))}};a.prototype.toJSON=function(e){if(e===void 0)e={};return this.map(function(t){return t.toJSON(e)})};r.prototype.get=function(e){return e===0?this:undefined};n.prototype.get=function(e){return e===0?this:undefined}});Ogma.extend(function(e){var t=e.Node;var r=e.Edge;var n=e.NodeList;var i=e.EdgeList;var a=new Bo(e);e.modules.data=a;e.events.onNodeDataChange=function(t){e.modules.events.on("updateNodeData",t);return e.events};e.events.onEdgeDataChange=function(t){e.modules.events.on("updateEdgeData",t);return e.events};t.prototype.setData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value);return this};t.prototype.getData=function(e){Oo(arguments.length);return a.getProperty(this,e)[0]};r.prototype.setData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value);return this};r.prototype.getData=function(e){Oo(arguments.length);return a.getProperty(this,e)[0]};n.prototype.setData=function(e,t){if(arguments.length<2){t=e;e=null}if(typeof t!=="function"&&!C(t)){throw new Error("invalid argument "+t+"; expected array or function")}a.setProperty(this,e,t,{dispatch:true});return this};n.prototype.fillData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value,{dispatch:false});return this};n.prototype.getData=function(e){Oo(arguments.length);return a.getProperty(this,e)};i.prototype.setData=function(e,t){if(arguments.length<2){t=e;e=null}if(typeof t!=="function"&&!C(t)){throw new Error("invalid argument "+t+"; expected array or function")}a.setProperty(this,e,t,{dispatch:true});return this};i.prototype.fillData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value,{dispatch:false});return this};i.prototype.getData=function(e){Oo(arguments.length);return a.getProperty(this,e)}});function Oo(e){if(e>1){Xa("getData: more than one argument were specified, you probably want to "+"use a single array argument instead of multiple arguments")}}var Bo=function e(t){var r=this;this._dom=t.modules.dom;this._graph=t.modules.graph;this._events=t.modules.events;this._nodeChanges=[];this._edgeChanges=[];this._nodeDataList=this._graph.createAttribute(true,{name:"data",storage:"any"});this._edgeDataList=this._graph.createAttribute(false,{name:"data",storage:"any"});this._nodeList=this._graph.getAttribute(true,"object");this._edgeList=this._graph.getAttribute(false,"object");this._events.register(["setData","updateNodeData","updateEdgeData"]);this._tmp=new Array(2);this._triggerEvents=false;this._events.on({"addNodes addEdges":function(e){var t=e.nodes;var n=e.edges;var i=e.objects;var a=t||n;var o=a.isNode;var s=a.size;var u=a._indexes;var l=r[o?"_nodeDataList":"_edgeDataList"];for(var d=0;d<s;++d){l.set(u[d],i[d].data)}},beforeNewFrame:function(){if(r._triggerEvents){r._triggerEvents=false;Vo(r)}}})};Bo.prototype.setProperty=function e(t,r,value,n){if(n===void 0)n={};var i=n.dispatch;if(i===void 0)i=false;Ho(this,t.isNode,t._indexes,r,value,i);this._events.fire("setData",{elements:t})};Bo.prototype.getProperty=function e(t,r){return qo(this,t.isNode,t._indexes,r)};function jo(e){e._triggerEvents=true;e._dom.refresh()}function Vo(e){var t=Uo(e,true);var r=Uo(e,false);e._events.fire("updateNodeData",t);e._events.fire("updateEdgeData",r)}function Uo(e,t){var r;var n=t?e._graph.NodeList:e._graph.EdgeList;var i=t?"_nodeChanges":"_edgeChanges";var a=[];var o=e[i];e[i]=[];for(var s=0;s<o.length;++s){var u=o[s];a.push.apply(a,u.indexes);u[t?"nodes":"edges"]=new n(u.indexes);delete u.indexes}return r={},r[t?"nodes":"edges"]=new n(a).dedupe(),r.isNode=t,r.changes=o,r}function Go(e,t){for(var r=0;r<e.length;++r){var n=e[r],i=n.property;if(t===null&&i===null){return n}else if(t&&i&&i.length===t.length){var a=true;for(var o=0;o<i.length;++o){if(i[o]!==t[o]){a=false;break}}if(a){return n}}}var s={property:t&&t.slice(),indexes:[],previousValues:[],newValues:[]};e.push(s);return s}function Wo(e){if(typeof e==="string"){return e.split(".")}else if(C(e)){return e}else if(e===undefined||e===null){return null}else{return[e.toString()]}}function Ho(e,t,r,n,value,i){if(i&&typeof value==="function"){i=false}n=Wo(n);var a=typeof value==="function",o=t?e._nodeList:e._edgeList,s=t?e._nodeDataList:e._edgeDataList,u=t?e._nodeChanges:e._edgeChanges,l=Go(u,n);for(var d=0;d<r.length;++d){var f=r[d],h=s.get(f),c=o.get(f),g=i?value[d]:value,v=void 0,p=void 0;if(n===null){v=h;p=a?g(c):g;s.set(f,p)}else{if(h===null||h===undefined){h={};s.set(f,h)}Xo(h,n,g,a,c,e._tmp);v=e._tmp[0];p=e._tmp[1]}l.indexes.push(f);l.previousValues.push(v);l.newValues.push(p)}jo(e)}function Xo(e,t,value,r,n,i){var a=t.length-1;for(var o=0;o<a;++o){var s=t[o],u=e[s];if(u===null||u===undefined){u={};e[s]=u}e=u}var l=t[a],d=e[l],f=r?value(n):value;e[l]=f;i[0]=d;i[1]=f}function qo(e,t,r,n,i){n=Wo(n);if(!i){i=new Array(r.length)}var a=t?e._nodeDataList:e._edgeDataList;for(var o=0;o<r.length;++o){var s=r[o],u=a.get(s);i[o]=Yo(u,n)}return i}function Yo(e,t){if(t===null||!t.length){return e}else if(e===undefined||e===null){return undefined}var r=t.length-1;for(var n=0;n<r;++n){var i=t[n];e=e[i];if(e===null||e===undefined){return undefined}}return e[t[r]]}var Zo={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){if((e*=2)<1){return.5*e*e*e}return.5*((e-=2)*e*e+2)}};var Ko={duration:0,easing:"linear",callback:function(){},startAfter:0};Ogma.extend(function(e){return e.modules.animations=new Qo(e)});var Qo=function e(t){var r=this;this._dom=t.modules.dom;this._events=t.modules.events;this._animationList=[];this._events.on("beforeNewFrame",function(){return r._updateAnimations()})};Qo.prototype._updateAnimations=function e(){if(this._animationList.length===0){return true}var t=$t();var r=[];for(var n=0;n<this._animationList.length;++n){var i=this._animationList[n],a=(t-i.creationDate)/i.duration,o=i.startAfter,s=i.easing(a);if(a>=1){i.func(1);i.done=true;this._animationList.splice(n,1);n-=1;r.push(i.callback)}else if(s>=o){var u=1/(1-o);s=(s-o)*u;i.func(s)}}for(var l=0;l<r.length;++l){r[l](false)}this._dom.refresh()};Qo.prototype.play=function e(t,r){var n=Za(r,Ko);var i=n.duration;var a=n.easing;var o=n.callback;var s=n.startAfter;var u=null;if(i<=0){t(1);o()}else{u={func:t,easing:typeof a==="function"?a:Zo[a],duration:i,callback:o,startAfter:s,creationDate:$t(),done:false};this._animationList.push(u);this._dom.refresh()}return u};Qo.prototype.end=function e(t,r){if(r===void 0)r=true;var n=this._animationList.indexOf(t);if(n!==-1){t.func(1);this._animationList.splice(n,1);t.done=true;if(r){t.callback(true)}}};var Jo=1e-8;var $o=1e8;var es={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:false};function ts(e){return Math.abs(e)<1e-9}Ogma.extend(function(e){var t=new ns(e);var r=e.modules;var n=e.view;var i=e.Node;var a=e.Edge;r.camera=t;n.setZoom=function(e,r){return t.setZoom(e,r)};n.zoomIn=function(e,r){return t.zoomIn(e,r)};n.zoomOut=function(e,r){return t.zoomOut(e,r)};n.getZoom=function(){return t.getZoom()};n.setCenter=function(e,r){return t.setCenter(e,r)};n.move=function(e,r){return t.move(e,r)};n.getCenter=function(){return t.getCenter()};n.setAngle=function(e,r){return t.setAngle(e,r)};n.rotate=function(e,r){return t.rotate(e,r)};n.getAngle=function(){return t.getAngle()};n.set=function(e,r){return t.setView(e,r)};n.get=function(){return t.getView()};n.graphToScreenCoordinates=function(e){return t.graphToScreenCoordinates(e)};n.screenToGraphCoordinates=function(e){return t.screenToGraphCoordinates(e)};n.getSize=function(){return{width:t.width,height:t.height}};e.events.onZoomProgress=function(t){r.events.on("cameraZoom",t);return e.events};e.events.onViewChanged=function(t){r.events.on("viewChanged",t);return e.events};i.prototype.isInView=function(e){return t.isElementInView(this,e)};a.prototype.isInView=function(e){return t.isElementInView(this,e)}});var rs=50;var ns=function e(t){var r=this;this._ogma=t;this._events=t.modules.events;this._dom=t.modules.dom;this._animations=t.modules.animations;this._settings=t.modules.settings;this._zoomAnimation=null;this._moveAnimation=null;this._reset();this._minZoom=Jo;this._maxZoom=$o;this._events.register(["cameraMove","cameraPan","cameraZoom","cameraRotate","viewChanged","startZoom"]);this._settings.register("minZoom",Jo,function(e){r._minZoom=e;if(r._zoom<e){r._zoom=e;r._events.fire("cameraMove")}});this._settings.register("maxZoom",$o,function(e){r._maxZoom=e;if(r._zoom>e){r._zoom=e;r._events.fire("cameraMove")}});this._timeout=null;this._moveEnd=function(e){if(r._timeout){r._dom.clearTimeout(r._timeout)}r._timeout=r._dom.setTimeout(function(){r._timeout=null;r._events.fire("viewChanged",{type:e})},rs)};this._events.on({setContainer:function(){r._reset();r._events.fire("cameraMove")},resize:function(){r.reloadDimensions();r._events.fire("cameraMove")}})};var is={x:{configurable:true},y:{configurable:true},zoom:{configurable:true},angle:{configurable:true},width:{configurable:true},height:{configurable:true}};is.x.get=function(){return this._x};is.y.get=function(){return this._y};is.zoom.get=function(){return this._zoom};is.angle.get=function(){return this._angle};is.width.get=function(){return this._dimensions.width};is.height.get=function(){return this._dimensions.height};ns.prototype.getCenter=function e(){return{x:this._x,y:this._y}};ns.prototype.setCenter=function e(t,r){var n=this;var i=t.x;var a=t.y;r=Za(r,es);var o=this._x;var s=this._y;var u=i-this._x;var l=a-this._y;if(ts(u)&&ts(l)){return Promise.resolve()}return new Promise(function(e){var t=function(e){n._x=o+u*e;n._y=s+l*e;n._events.fire("cameraMove");n._events.fire("cameraPan")};r.callback=as(n,e,"pan");if(n._moveAnimation){n._animations.end(n._moveAnimation)}n._moveAnimation=n._animations.play(t,r)})};ns.prototype.move=function e(t,r){var n=t.x;var i=t.y;var a=os(this,{x:n,y:i});return this.setCenter({x:this._x+a.x,y:this._y+a.y},r)};ns.prototype.getZoom=function e(){return this._zoom};ns.prototype.setZoom=function e(t,r,n){var i=this;if(n===void 0)n={};var a=n.refX;var o=n.refY;r=Za(r,es);var s=this._minZoom;var u=this._maxZoom;var l=$e(t,s,u);if(!r.ignoreZoomLimits){l=this._applyZoomLimits(l)}if(ts(this._zoom-l)){return Promise.resolve()}return new Promise(function(e){var t=i._dimensions.width/2;var n=i._dimensions.height/2;var s=i._zoom;var u=t/s-t/l;var d=function(e){i._zoom=t/(t/s-u*e);i._events.fire("cameraMove");i._events.fire("cameraZoom")};r.callback=as(i,e,"zoom");if(a!==undefined&&o!==undefined){var f=(a-t)/s-(a-t)/l;var h=(o-n)/s-(o-n)/l;var c=i._cosAngle;var g=i._sinAngle;var v=c*f-g*h;var p=g*f+c*h;i.setCenter({x:i._x+v,y:i._y+p},r)}if(i._zoomAnimation){i._animations.end(i._zoomAnimation)}i._dom.setTimeout(function(){i._events.fire("startZoom",{duration:r.duration,easing:r.easing,startZoom:s,endZoom:l})});i._zoomAnimation=i._animations.play(d,r)})};ns.prototype._applyZoomLimits=function e(t){var r=this._settings.get("interactions.zoom.minValue");var n=this._settings.get("interactions.zoom.maxValue");var i=this._ogma.view.getGraphBoundingBox();var a=this._ogma.view.getZoom();var o=this._ogma.view.getSize();var s=t;if(!isNaN(i.cx)){var u={smallestNodeSize:i.minScaledSize,biggestNodeSize:i.maxScaledSize,graphWidth:i.width+i.maxScaledSize,graphHeight:i.height+i.maxScaledSize,viewWidth:o.width,viewHeight:o.height};var l=r&&r(u);var d=n&&n(u);if(ss(l)&&s<l){if(s<a){s=Math.min(a,l)}}else if(ss(d)&&s>d){if(s>a){s=Math.max(a,d)}}}return s};ns.prototype.zoomIn=function e(t,r,n){if(typeof t!=="number"){n=r;r=t;t=this._settings.get("interactions.zoom.modifier")}return this.setZoom(this._zoom*t,r,n)};ns.prototype.zoomOut=function e(t,r,n){if(typeof t!=="number"){n=r;r=t;t=this._settings.get("interactions.zoom.modifier")}return this.setZoom(this._zoom/t,r,n)};ns.prototype.getAngle=function e(){return this._angle};ns.prototype.setAngle=function e(t,r){var n=this;r=Za(r,es);var i=this._angle;var a=t-i;if(ts(a)){return Promise.resolve()}return new Promise(function(e){var t=function(e){n._angle=i+a*e;while(n._angle>Math.PI){n._angle-=2*Math.PI}while(n._angle<-Math.PI){n._angle+=2*Math.PI}n._sinAngle=Math.sin(n._angle);n._cosAngle=Math.cos(n._angle);n._events.fire("cameraMove");n._events.fire("cameraRotate")};r.callback=as(n,e,"rotate");if(n._rotateAnimation){n._animations.end(n._rotateAnimation)}n._rotateAnimation=n._animations.play(t,r)})};ns.prototype.rotate=function e(t,r){return this.setAngle(this._angle+t,r)};ns.prototype.getScreenCenter=function e(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}};ns.prototype.graphToScreenCoordinates=function e(t,r){var n=t.x;var i=t.y;if(r===void 0)r={};var a=this._dimensions.width/2;var o=this._dimensions.height/2;var s=(n-this._x)*this._zoom+a;var u=(i-this._y)*this._zoom+o;return Ur(s,u,a,o,-this._angle,r)};ns.prototype.screenToGraphCoordinates=function e(t,r){var n=t.x;var i=t.y;if(r===void 0)r={};var a=this._x+(n-this._dimensions.width/2)/this._zoom;var o=this._y+(i-this._dimensions.height/2)/this._zoom;return Ur(a,o,this._x,this._y,this._angle,r)};ns.prototype.projectBounds=function e(t,r){if(r===void 0)r=t;var n=t[0];var i=t[1];var a=t[2];var o=t[3];var s=this._x,u=this._y;var l=this._dimensions.width/2;var d=this._dimensions.height/2;var f=this._sinAngle,h=this._cosAngle,c=1/this._zoom;var g=Infinity;var v=Infinity;var p=-Infinity;var _=-Infinity;var m=[n,i,n,o,a,o,a,i];for(var y=0;y<m.length;y+=2){var b=m[y];var x=m[y+1];b=s+(b-l)*c;x=u+(x-d)*c;var S=b-s;var A=x-u;b=h*S-f*A+s;x=f*S+h*A+u;if(b<g){g=b}if(b>p){p=b}if(x<v){v=x}if(x>_){_=x}}r[0]=g;r[1]=v;r[2]=p;r[3]=_;return r};ns.prototype.screenToGraphVector=function e(t){var r=t.x;var n=t.y;return os(this,{x:r,y:n})};ns.prototype.getView=function e(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}};ns.prototype.setView=function e(t,r){var n=Za(t,{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle});var i=n.x;var a=n.y;var o=n.zoom;var s=n.angle;this.setCenter({x:i,y:a},r);this.setZoom(o,r);return this.setAngle(s,r)};ns.prototype.reloadDimensions=function e(){this._dimensions=this._dom.getDimensions()};ns.prototype.animationInProgress=function e(){var t=this._moveAnimation;var r=this._zoomAnimation;return t&&!t.done||r&&!r.done};ns.prototype.getProjectedScreenBounds=function e(t){if(t===void 0)t=0;var r=this._dimensions;var n=r.width;var i=r.height;var a=Math.max(n,i)*t;return this.projectBounds([0-a,0-a,n+a,i+a])};ns.prototype.isElementInView=function e(t,r){if(r===void 0)r={};var n=r.margin;if(n===void 0)n=0;var i={minX:-n,minY:-n,maxX:this._dimensions.width+n,maxY:this._dimensions.height+n};return t.isNode?this.isNodeInRectangle(t,i):this.isEdgeInRectangle(t,i)};ns.prototype.isNodeInRectangle=function e(t,r){var n=t.getPositionOnScreen();var i=t.getAttribute("radius")*this._zoom;var a=n.x-i;var o=n.y-i;var s=n.x+i;var u=n.y+i;return s>=r.minX&&a<=r.maxX&&u>=r.minY&&o<=r.maxY};ns.prototype.isNodeInPolygon=function e(t,r){var n=t.getPositionOnScreen();return dn(n.x,n.y,r)};ns.prototype.isEdgeInRectangle=function e(t,r){var n=this._getEdgePoints(t);for(var i=0;i<n.length-1;++i){var a=n[i];var o=n[i+1];if(rn(a.x,a.y,o.x,o.y,r.minX,r.minY,r.maxX,r.maxY)){return true}}return false};ns.prototype.isEdgeInPolygon=function e(t,r){var n=t.getSource();var i=t.getTarget();var a=n.getPositionOnScreen();var o=i.getPositionOnScreen();if(dn(a.x,a.y,r)||dn(o.x,o.y,r)){return true}var s=this._getEdgePoints(t);for(var u=0;u<s.length-1;++u){var l=s[u];var d=s[u+1];for(var f=0;f<r.length-1;++f){var h=r[f];var c=r[f+1];if(tn(l.x,l.y,d.x,d.y,h.x,h.y,c.x,c.y)){return true}}}return false};ns.prototype._getEdgePoints=function e(t){var r=t.getAttribute("curvature");var n=t.getSource();var i=t.getTarget();var a=n.getPositionOnScreen();var o=[];if(n===i){var s=(r+n.getAttribute("radius"))*ri*this._zoom;var u=a.x;var l=a.y;var d=u-s;var f=l;var h=u;var c=l+s;o.push(a,Ki(.2,u,l,u,l,d,f,h,c),Ki(.4,u,l,u,l,d,f,h,c),Ki(.6,u,l,u,l,d,f,h,c),Ki(.8,u,l,u,l,d,f,h,c),a)}else{var g=i.getPositionOnScreen();if(r!==0){var v=g.x-a.x;var p=g.y-a.y;var _=Math.sqrt(v*v+p*p);var m=(a.x+g.x)/2;var y=(a.y+g.y)/2;var b=p/_;var x=-v/_;var S=r*(_/ti)*2;var A=m+b*S;var E=y+x*S;o.push(a,qi(.25,a.x,a.y,g.x,g.y,A,E),qi(.5,a.x,a.y,g.x,g.y,A,E),qi(.75,a.x,a.y,g.x,g.y,A,E),g)}else{o.push(a,g)}}return o};ns.prototype._reset=function e(){this._zoom=1;this._x=0;this._y=0;this._angle=0;this._sinAngle=0;this._cosAngle=1;this._dimensions=this._dom.getDimensions()};Object.defineProperties(ns.prototype,is);function as(e,t,r){return function(){e._moveEnd(r);t(r)}}function os(e,t){var r=t.x;var n=t.y;r/=e._zoom;n/=e._zoom;var i=e._sinAngle;var a=e._cosAngle;return{x:a*r-i*n,y:i*r+a*n}}function ss(value){return typeof value==="number"&&isFinite(value)}function us(e){var t=e.filter(function(e){return isFinite(e)&&e>0});var r=t.length?nt(t):1;return r}var ls=1;var ds=2;var fs=3;var hs=1;var cs=2;var gs=3;var vs=4;var ps=5;var _s=6;var ms=7;var ys=1;var bs=2;var xs=3;var Ss=4;var As=5;var Es=1;var ws=2;var ks=3;var Cs={};Cs[cs]="image";Cs[vs]="piechart";Cs[gs]="text";Cs[ps]="icon";Cs[_s]="badge";var Ts=function e(){this._version=0;this._init_()};Ts.prototype.reset=function e(){this._init_()};Ts.prototype._init_=function e(){this._mustUpdate=true;this._nextPatternId=1;this._patterns=[null];this._patternsByHash={};this._pixelRatio=1;this._nullPattern={type:hs,attributes:{}}};Ts.prototype._increaseNextId=function e(){var t=this._nextPatternId++;if(t%256===255){t=this._nextPatternId++}while(this._patterns.length<=t){this._patterns.push(undefined)}return t};Ts.prototype._createPattern=function e(t){var r=t.type;var n=t.attributes;var i={id:this._increaseNextId(),type:r,attributes:this._cloneAttributes(r,n)};this._patterns[i.id]=i;this._mustUpdate=true;return i};Ts.prototype._cloneAttributes=function e(t,r){if(t===cs){return{image:r.image,scaled:r.scaled,duplicated:r.duplicated}}else if(t===gs||t===ps||t===_s){return{font:r.font,size:r.size,style:r.style,text:r.text,align:r.align||"center",offset:r.offset||0}}else if(t===vs){return{colors:r.colors,colorArray:r.colors.split(";").map(function(e){return e.trim()})}}};Ts.prototype.getPatternList=function e(){return this._patterns.filter(function(e){return e})};Ts.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};Ts.prototype.setPixelRatio=function e(value){if(value!==this._pixelRatio){this._pixelRatio=value;this._mustUpdate=true}};Ts.prototype.getPixelRatio=function e(){return this._pixelRatio};Ts.prototype.notifyUpdate=function e(){this._mustUpdate=true};Ts.prototype.getIdFromDefinition=function e(t){var r=t.type;var n=t.attributes;var i=r===gs||r===ps||r===_s;var a=r&&r!==hs&&r!==ms&&(r!==cs||n.image)&&(!i||n.text&&n.font);var o=0;if(a){o=this._addPattern(t);if(r===gs&&n.style==="normal"){n.style="bold";this._addPattern(t)}}return o};Ts.prototype._addPattern=function e(t){var r=this._getPatternHash(t);var n=this._patternsByHash[r];if(!n){if(this._nextPatternId>65500){Xa("maximum number of pattern exceeded")}else{n=this._createPattern(t).id;this._patternsByHash[r]=n}}return n};Ts.prototype._getPatternHash=function e(t){var r=t.type;var n=t.attributes;var i=[Cs[r]];if(r===cs){i.push(n.scaled?"scaled":"non-scaled",n.duplicated?"duplicated":"non-duplicated",n.image.src||n.image.toDataURL())}else if(r===gs){i.push(n.text,n.font,n.style,n.size,n.align||"center",n.offset||0)}else if(r===ps||r===_s){i.push(n.text,n.font,n.style,n.size)}else{i.push(n.colors)}return i.join("+")};Ts.prototype.getDefinitionFromId=function e(t){return t?this._patterns[t]:this._nullPattern};Ts.prototype.getVersion=function e(){return this._version};var Ls=function e(){this._version=0;this._mustUpdate=true;this._byName={};this._byId=new Array(Rn+1)};Ls.prototype.register=function e(t,r){var n=r.getDistanceFromStrokeVertically;var i=r.getDistanceFromStrokeHorizontally;var a=r.points;var o=r.hole;var s=r.isSimple;if(this._byName[t]){return}var u=s?1:On;var l=s?On-1:Rn;while(this._byId[u]){u+=1}if(u>l){throw new Error("exceeded max number of shape")}var d={id:u,name:t,getDistanceFromStrokeVertically:n,getDistanceFromStrokeHorizontally:i,points:a.slice(),hole:o&&o.slice(),isSimple:!!s};this._mustUpdate=true;this._byId[u]=d;this._byName[t]=d;return d};Ls.prototype.getIdFromName=function e(t){return this._byName[t].id};Ls.prototype.getNameFromId=function e(t){var r=this._byId[t];return r?r.name:null};Ls.prototype.getDefinitionFromName=function e(t){return this._byName[t]||null};Ls.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};Ls.prototype.getVersion=function e(){return this._version};Ls.prototype.getShapeList=function e(){return this._byId.filter(function(e){return e})};var Ms=function e(t){var r=t.elementSize;var n=t.sideElementSize;var i=t.nbSideElementsPerMainElement;var a=t.id;var o=t.depth;var s=t.elementType;var u=t.animated;var l=t.stencilUsage;this._id=a;this._depth=o;this._elementType=s;this._animated=u;this._stencilUsage=l;this._version=0;this._elementSize=r;this._sideElementSize=n;this._nbSideElementsPerMainElement=i;this._totalSideElementsSize=i*n;this._capacity=wn;this._byteCapacity=this._capacity*this._elementSize;this._byteArray=new Uint8Array(this._byteCapacity);this._dataView=new DataView(this._byteArray.buffer);this._sideByteCapacity=this._capacity*this._totalSideElementsSize;this._sideByteArray=new Uint8Array(this._sideByteCapacity);this._sideDataView=new DataView(this._sideByteArray.buffer);this._nbCellsAllocated=0;this._nbCellsFreed=0;this._isFullyAllocated=false;this._isFullyFreed=false;this._mustUpdate=true};Ms.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false;if(this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated){this._isFullyFreed=true}}};Ms.prototype.allocate=function e(t){var r=-1;if(!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity){r=this._nbCellsAllocated;this._nbCellsAllocated+=t;this._mustUpdate=true}else{this._isFullyAllocated=true}return r};Ms.prototype.free=function e(t,r){for(var n=0;n<r;++n){var i=(t+n)*this._elementSize;if(this._dataView.getUint16(i)===0){throw new Error('"free": invalid address provided')}this._dataView.setUint16(i,0)}this._mustUpdate=true;this._nbCellsFreed+=r};Ms.prototype.triggerUpdate=function e(){this._mustUpdate=true};Ms.prototype.isEmpty=function e(){return this._nbCellsFreed===this._nbCellsAllocated};Ms.prototype.isFullyFreed=function e(){return this._isFullyFreed};Ms.prototype.getId=function e(){return this._id};Ms.prototype.getDepth=function e(){return this._depth};Ms.prototype.getElementType=function e(){return this._elementType};Ms.prototype.getDataView=function e(){return this._dataView};Ms.prototype.getByteArray=function e(){return this._byteArray};Ms.prototype.getElementSize=function e(){return this._elementSize};Ms.prototype.isAnimated=function e(){return this._animated};Ms.prototype.getCapacity=function e(){return this._capacity};Ms.prototype.getSize=function e(){return this._nbCellsAllocated};Ms.prototype.getNbSideElementsPerMainElement=function e(){return this._nbSideElementsPerMainElement};Ms.prototype.hasSideData=function e(){return this._nbSideElementsPerMainElement>0};Ms.prototype.getSideDataView=function e(){return this._sideDataView};Ms.prototype.getSideByteArray=function e(){return this._sideByteArray};Ms.prototype.getTotalSideElementsSize=function e(){return this._totalSideElementsSize};Ms.prototype.getVersion=function e(){return this._version};Ms.prototype.getStencilUsage=function e(){return this._stencilUsage};var Is=8;var Fs=function e(){this._version=0;this._blockInfo={buffer:null,offset:0,size:0,address:0};this._init_()};Fs.prototype.reset=function e(){this._init_()};Fs.prototype._init_=function e(){this._buffersByDepth=new Array(100);this._buffersById=[];this._buffersByAscendingDepth=[];this._buffersByDescendingDepth=[];this._mustUpdate=true};Fs.prototype._fillBlockInfo=function e(t,r,n,i){this._blockInfo.buffer=t;this._blockInfo.offset=r;this._blockInfo.size=n;this._blockInfo.address=i;return this._blockInfo};Fs.prototype._createBuffer=function e(t,r,n,i,a){var o=r?Qn:Zn;var s=this._buffersById.length;var u=new Ms({elementSize:o,sideElementSize:Jn,nbSideElementsPerMainElement:i,id:s,depth:n,elementType:t,animated:r,stencilUsage:a});this._buffersById.push(u);return u};Fs.prototype.getBlockInfo=function e(t){return this._getBlockInfo(t)};Fs.prototype._getBlockInfo=function e(t){return this._fillBlockInfo(this._buffersById[t>>Ln],(t>>Tn)%wn,t%kn,t)};Fs.prototype.allocateBlock=function e(t,r,n,i,a,o,s){var u=zs(o,Is);this._mustUpdate=true;var l=null;var d=-1;if(t){var f=this._getBlockInfo(t);var h=f.buffer;var c=f.offset;var g=f.size;var v=f.size===a;var p=h.getDepth()===i;var _=h.getElementType()===r;var m=h.isAnimated()===n;var y=h.getNbSideElementsPerMainElement()===u;var b=h.getStencilUsage()===s;if(v&&p&&_&&m&&y&&b){h.triggerUpdate();l=h;d=c}else{h.free(c,g)}}if(d===-1){var x=u/Is;var S=this._buffersByDepth[i]||(this._buffersByDepth[i]=new Array(2));var A=S[+n]||(S[+n]=[]);var E=A[r]||(A[r]=new Array(16));var w=E[x]||(E[x]=new Array(4));var k=w[s]||(w[s]=[]);var C=k[k.length-1];if(C){l=C;d=C.allocate(a)}if(d===-1){l=this._createBuffer(r,n,i,u,s);d=l.allocate(a);k.push(l)}}var T=Ns(l.getId(),d,a);return this._fillBlockInfo(l,d,a,T)};Fs.prototype.freeBlock=function e(t){if(t){this._mustUpdate=true;var r=this._getBlockInfo(t);r.buffer.free(r.offset,r.size)}return 0};Fs.prototype._sortBuffersByDepth=function e(){var t=[];for(var r=0;r<this._buffersByDepth.length;++r){var n=this._buffersByDepth[r];if(!n){continue}for(var i=0;i<n.length;++i){var a=n[i];if(!a){continue}for(var o=0;o<a.length;++o){var s=a[o];if(!s){continue}for(var u=0;u<s.length;++u){var l=s[u];if(!l){continue}for(var d=0;d<l.length;++d){var f=l[d];if(!f){continue}for(var h=0;h<f.length;++h){var c=f[h];c.update();if(c.isFullyFreed()){this._buffersById[c.getId()]=undefined;f.splice(h,1);h-=1}else{t.push(c)}}}}}}}this._buffersByAscendingDepth=t;this._buffersByDescendingDepth=t.slice().reverse()};Fs.prototype.update=function e(){if(this._mustUpdate){this._sortBuffersByDepth();this._version+=1;this._mustUpdate=false}};Fs.prototype.getBuffers=function e(){return this._buffersById};Fs.prototype.getBuffersByAscendingDepth=function e(){return this._buffersByAscendingDepth};Fs.prototype.getBuffersByDescendingDepth=function e(){return this._buffersByDescendingDepth};Fs.prototype.getVersion=function e(){return this._version};function Ns(e,t,r){return((e<<Cn)+t<<Tn)+r}function zs(e,t){var value=0;while(value<e){value+=t}return value}function Rs(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightTargetRadiusScaled:0,rectHeightTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:false,hasTail:false,isBodyTriangle:false,isSelfLoop:false,isText:false,adjustTextAngle:false,unusedFlag1:false,unusedFlag2:false,unusedFlag3:false}}function Ps(e){e.pieceId=0;e.shape="";e.x1=0;e.y1=0;e.x2=0;e.y2=0;e.rectWidthOrSourceRadiusScaled=0;e.rectWidthOrSourceRadiusFixed=0;e.rectHeightTargetRadiusScaled=0;e.rectHeightTargetRadiusFixed=0;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=1;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=0;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isBodyTriangle=false;e.isSelfLoop=false;e.isText=false;e.adjustTextAngle=false;e.unusedFlag1=false;e.unusedFlag2=false;e.unusedFlag3=false;return e}function Ds(e){e.duration=0;e.beginTime=-1;e.easing="linear"}function Os(){return{valid:false,id:undefined,end:Rs(),start:Rs(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function Bs(e,t,r,n){e.width=t*n;e.height=r*n;e.style.width=t+"px";e.style.height=r+"px"}var js=function e(t){this._bufferList=t.bufferList;this._shapeManager=t.shapeManager;this._patternManager=t.patternManager;this._boundariesManager=t.boundariesManager;this._textManager=t.textManager;this._colorManager=t.colorManager;this._easingManager=t.easingManager;this._idRecorder=t.idRecorder;this._firstFrame=true;this._width=0;this._height=0;this._pixelRatio=0;this._viewX=0;this._viewY=0;this._viewZoom=0;this._viewAngle=0;this._viewAngleCos=0;this._viewAngleSin=0;this._currentTime=0;this._bytesToActualCoord=0;this._bytesToActualScaledSize=0;this._bytesToActualMinVisibleSize=0;this._bytesToActualSymbolicSize=0;this._bytesToActualDashLength=0;this._bytesToActualGapLength=0;this._bytesToActualPatternScale=0;this._shapesVersion=0;this._patternsVersion=0;this._boundariesVersion=0;this._textsVersion=0;this._backgroundColor=null;this._backgroundRgba=[0,0,0,0];this._renderBackground=false;this._isBufferDisplayable=null;this._hideImages=false;this._rgbaToString=new Array(65535);this._genericObject=Os();this._littleEndian=B()};js.createInitData=function e(){return null};js.getName=function e(){return null};js.isAvailable=function e(){return true};js.prototype.getDomElement=function e(){return null};js.prototype._initCanvas=function e(t){t.style.touchAction="none"};js.prototype.export=function e(){return Promise.resolve()};js.prototype._bytesToColor=function e(value){var t=this._rgbaToString[value];if(!t){var r=Vs(value,0,4)/15;var n=Vs(value,4,8)/15;var i=Vs(value,8,12)/15;var a=Vs(value,12,16)/15;t="rgba("+(r*255|0)+", "+(n*255|0)+", "+(i*255|0)+", "+a+")";if(r+n+i+a===0){t=null}this._rgbaToString[value]=t}return t};js.prototype._unsignedToSignedByte=function e(value){return value-128};js.prototype._bytesToCoord=function e(value){return value*this._bytesToActualCoord};js.prototype._bytesToScaledSize=function e(value){return value*this._bytesToActualScaledSize};js.prototype._bytesToFixedSize=function e(value){return value};js.prototype._bytesToMinVisibleSize=function e(value){return value*this._bytesToActualMinVisibleSize};js.prototype._extractGenericObject=function e(t,r,n){var i=r;var a=n;var o=this._littleEndian;var s=i.getUint16(a,o);var u=Vs(s,0,4);var l=Vs(s,4,8);var d=Vs(s,8,10);var f=Vs(s,10,12);var h=Vs(s,12,13);var c=Vs(s,13,14);var g=Vs(s,14,15);var v=Vs(s,15,16);var p=i.getUint16(a+2,o);var _=Vs(p,0,8);var m=Vs(p,8,11);var y=Vs(p,11,12);var b=Vs(p,12,13);var x=Vs(p,13,14);var S=Vs(p,14,15);var A=Vs(p,15,16);var E=i.getUint16(a+4,o);var w=Vs(E,0,4);var k=Vs(E,4,8);var C=Vs(E,8,12);var T=Vs(E,12,16);var L=i.getUint16(a+6,o);var M=Vs(L,0,8);var I=Vs(L,8,16);var F=i.getUint16(a+8,o);var N=i.getUint16(a+10,o);var z=i.getUint16(a+12,o);var R=i.getUint16(a+14,o);var P=i.getFloat32(a+16,o);var D=i.getFloat32(a+20,o);var O=i.getFloat32(a+24,o);var B=i.getFloat32(a+28,o);var j=i.getUint16(a+32,o);var V=i.getUint16(a+34,o);var U=i.getUint16(a+36,o);var G=i.getUint16(a+38,o);var W=i.getUint16(a+40,o);var H=i.getUint16(a+42,o);var X=i.getUint16(a+44,o);var q=i.getUint16(a+46,o);var Y=i.getUint16(a+48,o);var Z=i.getUint16(a+50,o);t.pieceId=l;t.shape=this._shapeManager.getNameFromId(u);t.x1=this._bytesToCoord(P);t.y1=this._bytesToCoord(D);t.x2=this._bytesToCoord(O);t.y2=this._bytesToCoord(B);t.rectWidthOrSourceRadiusScaled=this._bytesToScaledSize(j);t.rectWidthOrSourceRadiusFixed=this._bytesToFixedSize(V);t.rectHeightOrTargetRadiusScaled=this._bytesToScaledSize(U);t.rectHeightOrTargetRadiusFixed=this._bytesToFixedSize(G);t.thicknessOrFontSizeScaled=this._bytesToScaledSize(W);t.thicknessOrFontSizeFixed=this._bytesToFixedSize(H);t.strokeWidthScaled=this._bytesToScaledSize(X);t.strokeWidthFixed=this._bytesToFixedSize(q);t.offsetScaled=this._bytesToScaledSize(Y);t.offsetFixed=this._bytesToFixedSize(Z);t.pattern=this._patternManager.getDefinitionFromId(F);t.opacity=w/15;t.fillColor=this._bytesToColor(N);t.strokeColor=this._bytesToColor(z);t.patternColor=this._bytesToColor(R);t.globalMinVisibleSize=this._bytesToMinVisibleSize(k);t.strokeMinVisibleSize=this._bytesToMinVisibleSize(C);t.patternMinVisibleSize=this._bytesToMinVisibleSize(T);t.offsetAngle=m*(Math.PI*2/8);t.patternScale=_*this._bytesToActualPatternScale;t.symbolicSize=M*this._bytesToActualSymbolicSize;t.curvature=this._unsignedToSignedByte(I);t.dashLength=d*this._bytesToActualDashLength;t.gapLength=f*this._bytesToActualGapLength;t.hasHead=!!h;t.hasTail=!!c;t.isBodyTriangle=!!g;t.isSelfLoop=!!v;t.isText=!!y;t.adjustTextAngle=!!b;t.unusedFlag1=!!x;t.unusedFlag2=!!S;t.unusedFlag3=!!A};js.prototype._extractAnimationInformation=function e(t,r,n){var i=r;var a=n;var o=this._littleEndian;var s=i.getFloat32(a,o);var u=i.getFloat32(a+4,o);var l=i.getUint16(a+8,o);var d=i.getUint16(a+10,o);var f=i.getUint16(a+12,o);var h=i.getUint16(a+14,o);var c=(l>>8)-128;var g=(d>>8)-128;var v=(f>>8)-128;var p=(h>>8)-128;var _=l%256-128;var m=d%256-128;var y=f%256-128;var b=h%256-128;t.beginTime=s;t.duration=u;t.easing=this._easingManager.getNameFromPolygon(c,g,v,p,_,m,y,b)};js.prototype._extractTextCharacters=function e(t,r,n,i){t.pattern=this._textManager.extractTextFromDataView(r,n,i)};js.prototype.extractElement=function e(t,r){var n=t.getElementType();var i=t.isAnimated();var a=t.getDataView();var o=t.getElementSize();var s=r*o;var u=this._genericObject;u.valid=false;if(a.getUint16(s)){u.valid=true;this._extractGenericObject(u.end,a,s);if(i){this._extractGenericObject(u.start,a,s+Zn);this._extractAnimationInformation(u.animation,a,s+Zn*2)}u.id=this._idRecorder.get(t,r);if(n===ds){var l=t.getSideDataView();var d=r*t.getTotalSideElementsSize();var f=d+t.getTotalSideElementsSize();var h=u.end;this._extractTextCharacters(h,l,d,f)}}return u};js.prototype._compareDimensions=function e(t,r,n){if(t!==this._width||r!==this._height||n!==this._pixelRatio){this._width=t;this._height=r;this._pixelRatio=n;return true}return false};js.prototype._compareView=function e(t,r,n,i){if(t!==this._viewX||r!==this._viewY||n!==this._viewZoom||i!==this._viewAngle){this._viewX=t;this._viewY=r;this._viewZoom=n;this._viewAngle=i;this._viewAngleCos=Math.cos(i);this._viewAngleSin=Math.sin(i);return true}return false};js.prototype._compareCurrentTime=function e(t){if(t!==this._currentTime){this._currentTime=t;return true}return false};js.prototype._compareBackgroundColor=function e(t,r){if(t!==this._backgroundColor||r!==this._renderBackground){this._renderBackground=r;this._backgroundColor=t;this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor);return true}return false};js.prototype._compareShapes=function e(){if(this._shapesVersion!==this._shapeManager.getVersion()){this._shapesVersion=this._shapeManager.getVersion();return true}return false};js.prototype._comparePatterns=function e(){if(this._patternsVersion!==this._patternManager.getVersion()){this._patternsVersion=this._patternManager.getVersion();return true}return false};js.prototype._compareBoundaries=function e(){if(this._boundariesVersion!==this._boundariesManager.getVersion()){this._boundariesVersion=this._boundariesManager.getVersion();return true}return false};js.prototype._compareTexts=function e(){if(this._textsVersion!==this._textManager.getVersion()){this._textsVersion=this._textManager.getVersion();return true}return false};js.prototype._compareIsDisplayableBuffer=function e(t){if(this._isBufferDisplayable!==t){this._isBufferDisplayable=t;return true}return false};js.prototype._compareHideImages=function e(t){if(this._hideImages!==t){this._hideImages=t;return true}return false};js.prototype.renderFrame=function e(t){var r=t.x;var n=t.y;var i=t.zoom;var a=t.angle;var o=t.width;var s=t.height;var u=t.pixelRatio;var l=t.backgroundColor;var d=t.currentTime;var f=t.isBufferDisplayable;var h=t.hideImages;var c=t.renderBackground;var g=this._compareShapes();var v=this._comparePatterns();var p=this._compareBoundaries();var _=this._compareTexts();var m=this._compareDimensions(o,s,u);var y=this._compareView(r,n,i,a);var b=this._compareCurrentTime(d);var x=this._compareBackgroundColor(l,c);var S=this._compareIsDisplayableBuffer(f);var A=this._compareHideImages(h);if(p){var E=this._boundariesManager;this._bytesToActualCoord=1;this._bytesToActualScaledSize=E.maxScaledSize/Fn;this._bytesToActualMinVisibleSize=E.maxMinVisibleSize/Nn;this._bytesToActualSymbolicSize=E.maxSymbolicSize/Mn;this._bytesToActualDashLength=E.maxDashLength/zn;this._bytesToActualGapLength=E.maxGapLength/zn;this._bytesToActualPatternScale=E.maxPatternScale/Mn}if(this._firstFrame){this._beforeFirstFrame()}this._render({shapesChanged:g,patternsChanged:v,boundariesChanged:p,textsChanged:_,dimensionsChanged:m,viewChanged:y,currentTimeChanged:b,backgroundColorChanged:x,isBufferDisplayableChanged:S,isHideImagesChanged:A});if(this._firstFrame){this._afterFirstFrame();this._firstFrame=false}};js.prototype._render=function e(){};js.prototype._beforeFirstFrame=function e(){};js.prototype._afterFirstFrame=function e(){};js.prototype.destroy=function e(){};js.prototype.ensureAnimationsReady=function e(){};js.prototype.getImageData=function e(){return null};function Vs(value,e,t){return value%(1<<t)>>e}var Us="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_final_offsetScaled_offsetFixed;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_prev_offsetScaled_offsetFixed;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec2 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 dp;\nvarying vec4 dq;\nvarying vec4 dr;\nvarying vec2 ds;\nvarying vec2 dt;\n#if D3D9_FIX\nvarying vec4 du;\nvarying vec3 dv;\nvarying vec4 dw;\nvarying vec4 dx;\n#else\nvarying float dy;\nvarying vec2 dz;\nvarying vec2 ea;\nvarying vec2 eb;\nvarying float ec;\nvarying float ed;\nvarying vec2 ee;\nvarying vec2 ef;\nvarying float eg;\nvarying float eh;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_GRANULARITY;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_MARGIN = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_MULTIPLIER = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float NB_PIECES_PER_CURVE = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_NB_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / NB_PIECES_PER_CURVE;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nstruct fx {\nfloat fy;\nfloat fz;\nfloat ga;\nfloat gb;\nfloat gc;\nfloat gd;\nfloat ge;\nfloat gf;\n};\nstruct gg {\nfloat gh;\nfloat gi;\nfloat gj;\nfloat gk;\nfloat gl;\nfloat gm;\nfloat gn;\n};\nstruct go {\nfloat fy;\nfloat fz;\nfloat ga;\nfloat gb;\nfloat gc;\nfloat gd;\nfloat ge;\nfloat gf;\nfloat gh;\nfloat gi;\nfloat gj;\nfloat gk;\nfloat gl;\nfloat gm;\nfloat gn;\nfloat gp;\nfloat gq;\nfloat gr;\nfloat gs;\nfloat gt;\nfloat gu;\nfloat gv;\nvec4 gw;\nvec4 gx;\nvec4 gy;\nfloat gz;\nfloat ha;\nfloat hb;\nfloat hc;\nfloat hd;\nfloat he;\nfloat hf;\nfloat hg;\nfloat hh;\nfloat hi;\nfloat hj;\nfloat hk;\nfloat hl;\nfloat hm;\nfloat hn;\nfloat ho;\nfloat hp;\n};\nstruct hq {\nfloat hr;\nvec2 hs;\nvec4 gw;\nvec4 gx;\nfloat gp;\nfloat ht;\nfloat hu;\nfloat ga;\nfloat hv;\nvec2 hw;\nfloat hx;\nvec2 hy;\nvec2 hz;\nvec2 ia;\nfloat ib;\nfloat ic;\nvec4 gy;\nvec2 id;\nfloat ie;\nfloat ig;\nvec2 ih;\nvec2 ii;\nvec2 ij;\n};\nfloat ik(float cg, float il, float im) {\nfloat io = mod(cg, pow(2.0, im));\nreturn floor(io / pow(2.0, il));\n}\nfx ip(float cg) {\nfx iq;\niq.fy = ik(cg, 0.0, 4.0);\niq.fz = ik(cg, 4.0, 8.0);\niq.ga = ik(cg, 8.0, 10.0);\niq.gb = ik(cg, 10.0, 12.0);\niq.gc = ik(cg, 12.0, 13.0);\niq.gd = ik(cg, 13.0, 14.0);\niq.ge = ik(cg, 14.0, 15.0);\niq.gf = ik(cg, 15.0, 16.0);\nreturn iq;\n}\ngg ir(float cg) {\ngg iq;\niq.gh = ik(cg, 0.0, 8.0);\niq.gi = ik(cg, 8.0, 11.0);\niq.gj = ik(cg, 11.0, 12.0);\niq.gk = ik(cg, 12.0, 13.0);\niq.gl = ik(cg, 13.0, 14.0);\niq.gm = ik(cg, 14.0, 15.0);\niq.gn = ik(cg, 15.0, 16.0);\nreturn iq;\n}\nvec4 is(in float cg) {\nreturn vec4(\nik(cg, 0.0, 4.0),\nik(cg, 4.0, 8.0),\nik(cg, 8.0, 12.0),\nik(cg, 12.0, 16.0)\n);\n}\nvec2 it(in float cg) {\nreturn vec2(mod(cg, 256.0), floor(cg / 256.0));\n}\nvec2 iu(in float cg) {\nfloat iv = floor(cg / P2_6);\nfloat iw = cg - (iv * P2_6);\nreturn vec2(iv, iw);\n}\nvec2 ix(in float cg) {\nfloat iy = floor(cg / P2_7);\nfloat iz = cg - (iy * P2_7);\nreturn vec2(iy, iz);\n}\nvec2 ja(in vec2 jb, in float jc) {\nfloat jd = cos(jc);\nfloat je = sin(jc);\nreturn vec2(jd * jb.x + je * jb.y, -je * jb.x + jd * jb.y);\n}\nvec4 jf(in vec4 jg) {\nreturn floor(jg / 256.0) - 128.0;\n}\nvec4 jh(in vec4 jg) {\nreturn mod(jg, 256.0) - 128.0;\n}\nfloat ji(float cg) {\nreturn cg - 128.0;\n}\nvec2 ji(vec2 cg) {\nreturn cg - 128.0;\n}\nvec2 jj(vec2 jk) {\nreturn vec2(-jk.y, jk.x);\n}\nvec2 jl(vec2 jm, vec2 jn, vec2 jo, float t) {\nfloat jp = 1.0 - t;\nreturn (jp * jp * jm) + (2.0 * jp * t * jn) + (t * t * jo);\n}\nvec2 jq(vec2 jm, vec2 jr, vec2 js, vec2 jo, float t) {\nfloat jp = 1.0 - t;\nfloat jt = jp * jp;\nfloat ju = jt * jp;\nfloat jv = t * t;\nfloat jw = jv * t;\nreturn (ju * jm) + (3.0 * jt * t * jr) + (3.0 * jp * jv * js) + (jw * jo);\n}\nvec2 jx(vec2 jm, vec2 jn, vec2 jo, float t) {\nfloat jp = (1.0 - t);\nvec2 jb = (jp * jn + t * jo) - (jp * jm + t * jn);\nreturn normalize(jb);\n}\nvec2 jy(vec2 jm, vec2 jn, vec2 jo, float t) {\nreturn jj(jx(jm, jn, jo, t));\n}\nvec2 jz(vec2 jm, vec2 jr, vec2 js, vec2 jo, float t) {\nfloat jp = 1.0 - t;\nfloat jt = jp * jp;\nfloat jv = t * t;\nvec2 jb = jt * (jr - jm) + 2.0 * jp * t * (js - jr) + jv * (jo - js);\nreturn normalize(jb);\n}\nvec2 ka(vec2 jm, vec2 jr, vec2 js, vec2 jo, float t) {\nreturn jj(jz(jm, jr, js, jo, t));\n}\nfloat kq(float gu, float kr, float t) {\nfloat y = abs(gu) / CURVATURE_RATIO + EPSILON;\nfloat hc = y * y;\nfloat jp = t - 0.5;\nfloat jt = jp * jp;\nfloat ks = 1.0 / (16.0 * hc);\nfloat kt = sqrt(jt + ks);\nfloat ku = (0.5 / y) * sqrt(hc + 0.25);\nfloat kv = (abs(2.0 * y)) * ((jp * kt) + (0.5 * ku) + (ks * log(abs((jp + kt) / (-0.5 + ku)))));\nreturn kv * kr;\n}\nfloat kw(vec2 jm, vec2 kx, vec2 ky, vec2 jo, float kz) {\nvec2 id = (jm + kx + ky) / 3.0;\nvec2 la = id - kx;\nvec2 lb = kx - ky;\nfloat lc = dot(la, la);\nfloat ld = dot(lb, lb) / 4.0;\nfloat ln = sqrt(lc - ld) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * ln * kz;\n}\nfloat lo(float cg) {\nreturn cg - 32.0;\n}\nfloat lp(float cg) {\nreturn cg - 512.0;\n}\nfloat lq(float cg) {\nreturn cg - 32768.0;\n}\nvoid lr() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 ls(vec2 lt) {\nreturn vec4(((vec2(lt.x, u_viewHeight - lt.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat lx(float ly, float lz) {\nreturn step(ly - EPSILON, lz) * step(lz, ly + EPSILON);\n}\nbool ma(float ly, float lz) {\nreturn abs(ly - lz) < EPSILON;\n}\nbool mb(float cg) {\nreturn cg > 0.5;\n}\nvec2 mc(vec2 md) {\nreturn ja((md - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat me(float ig) {\nreturn ig * EDGE_ARROW_SIZE_RATIO;\n}\nfloat mf(float mg, float mh) {\nreturn mg * BYTES_TO_SCALED_SIZE * u_viewZoom + mh;\n}\nfloat mo(float ht, float mm, float mn) {\nfloat mp = mn - mm;\nfloat a = 1.0 / mp;\nfloat b = -mm / mp;\nreturn ht * a + b;\n}\nstruct mq {\nvec2 mr;\nvec2 ms;\n};\nmq mt(vec2 mu, float ln, float gu) {\nmq ck;\nfloat mv = (ln + ln / SELF_LOOP_CURVATURE_MULTIPLIER * gu) * SELF_LOOP_CURVATURE_MULTIPLIER;\nfloat mw = -u_viewAngle + PI;\nfloat mx = -u_viewAngle + PI / 2.0;\nck.mr = mu + vec2(cos(mw), sin(mw)) * mv;\nck.ms = mu + vec2(cos(mx), sin(mx)) * mv;\nreturn ck;\n}\nfloat nd(vec2 ne, vec2 kx, vec2 ky, vec2 nf, float ng) {\nvec2 nh = ne;\nfloat t = 0.0;\nfloat ni = 0.0;\nfloat nj = kw(ne, kx, ky, nf, 1.0);\nreturn ng / nj;\n}\ngo nk(\nvec4 nl,\nvec4 nm,\nvec4 nn,\nvec4 no,\nvec4 np,\nvec2 nq,\nvec2 nr\n) {\ngo a;\nfx ns = ip(nl.x);\ngg nt = ir(nl.y);\nvec4 nu = is(nl.z);\nvec2 nv = it(nl.w);\nvec2 nw = iu(nr.y);\na.fy = ns.fy;\na.fz = ns.fz;\na.ga = ns.ga;\na.gb = ns.gb;\na.gc = ns.gc;\na.gd = ns.gd;\na.ge = ns.ge;\na.gf = ns.gf;\na.gh = nt.gh;\na.gi = nt.gi;\na.gj = nt.gj;\na.gk = nt.gk;\na.gl = nt.gl;\na.gm = nt.gm;\na.gn = nt.gn;\na.gp = nu.x;\na.gq = nu.y;\na.gr = nu.z;\na.gs = nu.w;\na.gt = nv.x;\na.gu = nv.y;\na.gv = nm.x;\na.gw = is(nm.y);\na.gx = is(nm.z);\na.gy = is(nm.w);\na.gz = nn.x;\na.ha = nn.y;\na.hb = nn.z;\na.hc = nn.w;\na.hd = no.x;\na.he = no.y;\na.hf = no.z;\na.hg = no.w;\na.hh = np.x;\na.hi = np.y;\na.hj = np.z;\na.hk = np.w;\na.hl = nq.x;\na.hm = nq.y;\na.hn = nr.x;\na.ho = lp(nw.x);\na.hp = lo(nw.y);\nreturn a;\n}\nbool oj(const in go a, out hq ck) {\nfloat fy = a.fy;\nfloat fz = a.fz;\nfloat ga = a.ga * BYTES_TO_DASH_LENGTH;\nfloat gb = a.gb * BYTES_TO_GAP_LENGTH;\nfloat gc = a.gc;\nfloat gd = a.gd;\nfloat ge = a.ge;\nfloat gf = a.gf;\nfloat gh = a.gh * BYTES_TO_PATTERN_SCALE;\nfloat gi = a.gi * BYTES_TO_OFFSET_ANGLE;\nfloat gj = a.gj;\nfloat gk = a.gk;\nfloat gl = a.gl;\nfloat gm = a.gm;\nfloat gn = a.gn;\nfloat gp = a.gp * BYTES_TO_COLOR;\nfloat gq = a.gq * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat gr = a.gr * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat gs = a.gs * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat gt = a.gt * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.gt, EPSILON) * INFINITY;\nfloat gu = ji(a.gu);\nfloat gv = a.gv;\nvec4 gw = a.gw * BYTES_TO_COLOR;\nvec4 gx = a.gx * BYTES_TO_COLOR;\nvec4 gy = a.gy * BYTES_TO_COLOR;\nvec2 ok = vec2(a.gz, a.ha) * BYTES_TO_COORD;\nvec2 ol = vec2(a.hb, a.hc) * BYTES_TO_COORD;\nvec2 ne = mc(ok);\nvec2 nf = mc(ol);\nfloat om = mf(a.hd, a.he);\nfloat on = mf(a.hf, a.hg);\nfloat oo = mf(a.hh, a.hi);\nfloat hr = mf(a.hj, a.hk);\nfloat op = mf(a.hl, a.hm);\nvec2 oq = a_vertexInfo.xy;\nvec2 or = vec2(0.0, 0.0);\nfloat os = om;\nfloat ot = on;\nfloat ou = on * gh;\nif (gj > EPSILON) {\nif (a.hn < EPSILON) {\nreturn false;\n}\nou = oo;\ngv = a.hn;\nom = ou * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\non = ou * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool pu = abs(gu) > EPSILON && lx(fz, PIECE_EDGE_BODY) < EPSILON;\nbool pv = pu && a_vertexInfo.z > EPSILON;\nif (fy < EPSILON || fz < EPSILON || gt < gq || pv) {\nreturn false;\n}\nhr *= step(gr, gt);\nfloat ql = 0.0;\nfloat qm = 1.0;\nfloat qi = 0.0;\nfloat qk = 1.0;\nfloat qn = 0.0;\nfloat qx = 1.0;\nfloat qz = 1.0;\nfloat rk = 0.0;\nfloat rl = 0.0;\nvec2 id;\nvec2 ih;\nvec2 ii;\nvec2 ij;\nfloat ig;\nfloat ie;\nfloat sh = 0.0;\nfloat si = 1.0;\nif (lx(fz, PIECE_NODE_COMPONENT) > EPSILON) {\nid = ceil((ne + nf) / 2.0);\nih = normalize(vec2(ol.x - ok.x + 0.001, ok.y - ol.y));\nii = jj(ih);\nij = ii;\nig = om;\nie = on;\n} else {\nqz = 0.0;\nfloat sy = distance(ne, nf);\nvec2 sz = normalize(nf - ne);\nvec2 ta = (ne + nf) / 2.0;\nvec2 tb = jj(sz);\nvec2 tc = ta + (tb * sy * -gu / CURVATURE_RATIO);\nif (lx(fz, PIECE_EDGE_TEXT) > 0.0) {\nfloat tg;\nfloat th = hr;\nhr = 0.0;\nif (gf > EPSILON) {\nmq jn = mt(ne, th / 2.0, gu);\nid = jq(ne, jn.mr, jn.ms, nf, 0.5);\nih = jz(ne, jn.mr, jn.ms, nf, 0.5);\nii = jj(ih);\nij = ii;\ntg = kw(ne, jn.mr, jn.ms, nf, 0.5);\n} else if (abs(gu) > EPSILON) {\nid = jl(ne, tc, nf, 0.5);\nih = jx(ne, tc, nf, 0.5);\nii = jj(ih);\nij = ii;\ntg = kq(gu, sy, 1.0);\n} else {\nid = ta;\nih = sz;\nii = tb;\nij = tb;\ntg = sy;\n}\nig = om;\nie = on;\nif (gk > EPSILON && gf < EPSILON && os > tg - th) {\nih = vec2(1.0, 0.0);\nii = vec2(0.0, 1.0);\nij = vec2(0.0, 1.0);\n} else {\nfloat jc = -atan(ih.y, ih.x);\nsh = jc;\ngi -= jc;\nif ((jc > PI / 2.0 || jc < -PI / 2.0)) {\ngi += (1.0 - gf) * PI;\nsi = -1.0;\nih *= -1.0;\nii *= -1.0;\nij *= -1.0;\n}\n}\n} else {\nfloat rd = oo;\nfloat tq = om;\nfloat tr = on;\nfloat ts = gc + gd;\nfloat tt = me(rd);\nfloat tu = gc * tt;\nfloat tv = gd * tt;\nfloat tw = lx(fz, PIECE_EDGE_HEAD);\nfloat tx = lx(fz, PIECE_EDGE_TAIL);\nfloat ty = INFINITY * gf + sy - tq - tr;\nfloat tz = min(ty / ts, tt);\nfloat uj =\ngd * (tt + max(tq + tz - tv, 0.0))\n+ (1.0 - gd) * ge * tq;\nfloat uk =\ngc * (tt + max(tr + tz - tu, 0.0))\n+ (1.0 - gc) * ge * tr;\nif (tw > EPSILON || tx > EPSILON) {\nvec2 un = tw * nf + tx * ne;\nfloat op = tw * uk + tx * uj + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat uo = tw * tu + tx * tv;\nvec2 up;\nif (gf > EPSILON) {\nmq jn = mt(ne, tq, gu);\nfloat tg = kw(ne, jn.mr, jn.ms, nf, 1.0);\nfloat ng = tw * (tg - uk) + tx * uj;\nfloat t = nd(ne, jn.mr, jn.ms, nf, ng);\nup = jq(ne, jn.mr, jn.ms, nf, t);\n} else {\nfloat tg = kq(gu, sy, 1.0);\nfloat t = (tw * (tg - uk) + tx * uj) / tg;\nup = jl(ne, tc, nf, t);\n}\nih = normalize(un - up);\nii = jj(ih);\nij = ii;\nid = un - ih * (op - uo / 2.0);\nig = uo;\nie = uo;\nga = 0.0;\ngb = 0.0;\n} else {\nfloat ut;\nfloat uu;\nfloat uv;\nif (abs(gu) < EPSILON) {\nid = ta;\nih = sz;\nii = tb;\nij = ii;\nig = sy;\nut = sy;\nuu = 0.0;\nuv = sy;\n} else {\nfloat ux = a_vertexInfo.z;\nfloat uy = ux * T_STEP_PER_CURVE_PIECE;\nfloat jv = uy + T_STEP_PER_CURVE_PIECE;\nif (gf < EPSILON) {\nvec2 uz = jl(ne, tc, nf, uy);\nvec2 va = jl(ne, tc, nf, jv);\nid = (uz + va) / 2.0;\nih = normalize(va - uz);\nii = jy(ne, tc, nf, uy);\nij = jy(ne, tc, nf, jv);\nig = distance(uz, va);\nut = kq(gu, sy, 1.0);\nuu = kq(gu, sy, uy);\nuv = kq(gu, sy, jv);\n} else {\nmq jn = mt(ne, tq, gu);\nvec2 kx = jn.mr;\nvec2 ky = jn.ms;\nvec2 uz = jq(ne, kx, ky, nf, uy);\nvec2 va = jq(ne, kx, ky, nf, jv);\nid = (uz + va) / 2.0;\nih = normalize(va - uz);\nii = ka(ne, kx, ky, nf, uy);\nij = ka(ne, kx, ky, nf, jv);\nig = distance(uz, va);\nut = kw(ne, kx, ky, nf, 1.0);\nuu = kw(ne, kx, ky, nf, uy);\nuv = kw(ne, kx, ky, nf, jv);\n}\n}\nie = oo;\nqi = (uj - 1.0) / ut;\nqk = 1.0 - (uk - HEAD_TAIL_PX_ADJUST) / ut;\nql = uu / ut;\nqm = uv / ut;\nqn = ut;\nif (ge > 0.0 && ty > 5.0) {\nfloat vg = (ut * ie) / (ut - uj);\nfloat nj = ut;\nfloat gz = uj;\nfloat hb = ut - uk;\nfloat a = -vg / nj;\nfloat b = vg;\nfloat ha = a * gz + b;\nfloat hc = a * hb + b;\nfloat vh = ha / (gz - hb);\nfloat vi = -vh * hb;\nie = vi;\nrl = vh * nj + vi + 1.0;\n}\n}\n}\n}\nvec2 hy = vec2(0.0, 0.0);\nvec2 hz = vec2(EPSILON, EPSILON);\nvec2 ia = vec2(-EPSILON, -EPSILON);\nfloat ib = -1.0;\nfloat ic = 0.0;\nbool vj = false;\nif (gv > EPSILON && gt > gs) {\nfloat vk = floor(gv / PATTERN_INFO_TEXTURE_SIZE);\nfloat vl = gv - (vk * PATTERN_INFO_TEXTURE_SIZE);\nvec4 vm = texture2D(u_patternInfoTexture, vec2(vl, vk) / 255.0) * 255.0;\nvec2 vn = ix(vm.z);\nvec2 vo = ix(vm.w);\nib = vn.x * 2.0 + vo.x;\nfloat vp = 0.0;\nif (ma(ib, FILTER_NEAREST)) {\nvp = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ma(ib, FILTER_LINEAR)) {\nvp = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ma(ib, FILTER_LINEAR_SDF)) {\nvp = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nvj = true;\n} else if (ma(ib, FILTER_MIPMAP)) {\nvp = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat vq = 1.0 / vp;\nvec2 vr = (vec2(vn.y, vo.y) * PATTERN_POSITION_GRANULARITY) * vq / 2.0;\nvec2 vs = (vm.xy * PATTERN_POSITION_GRANULARITY * vq) + vr;\nvs += PATTERN_MARGIN * vq;\nvr -= PATTERN_MARGIN * vq * 2.0;\nvec2 vt = vec2(ig / 2.0, ie / 2.0) * vq;\nvec2 vu = vec2(hr, hr) * vq;\nfloat vv = 1.0 * u_pixelRatio;\nif (gh > EPSILON) {\nif (vj) {\nic = 2.0 / ou;\nvv = SDF_FONT_SIZE / ou;\n} else {\nvv = (vr.y / vt.y) / gh;\n}\n}\nvec2 vw = (vt + vu) * vv;\nvr += PATTERN_MARGIN * vq;\nhy = vs + vw * oq;\nhz = vs - vr;\nia = vs + vr;\n}\nif (gj > EPSILON) {\nor.y = a.hp * ou / 2.0 - 1.0;\nif (vj) {\nor.x = a.ho * BYTES_TO_TEXT_OFFSET * ou;\n} else {\nor.x = floor(a.ho);\n}\nor += vec2(1.0);\nor = ja(or, sh);\nor *= si;\n}\nvec2 vy = vec2(cos(gi), sin(gi)) * op;\nvec2 vz = id + vy + or;\nif (gj > EPSILON && lx(fz, PIECE_NODE_COMPONENT) > EPSILON) {\nvz = ceil(vz);\n}\nfloat wa = hr * 2.0;\nfloat wb = ig + qz * (wa + 1.0);\nfloat wc = ie + qx * (wa + 1.0);\nvec2 wd = ih * wb / 2.0;\nvec2 we = ii * wc / 2.0;\nvec2 wf = ij * wc / 2.0;\nfloat wg = (qm - ql);\nfloat wh = oq.x / 2.0 + 0.5;\nfloat ht = ql + wg * wh;\nfloat hx = rk + (rl - rk) * ht / 2.0;\nfloat wi = step(fy, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat wj = wi * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - wi) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat wk = wj / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat wl = wk * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat wm = wk * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 ww = vec2(mod(fy, NB_SHAPES_BY_SIDE), floor(fy / NB_SHAPES_BY_SIDE));\nvec2 wz = ww + vec2(wl) + vec2(ql * wm, 0.0);\nvec2 xc = vec2(wg, 1.0) * wm;\nvec2 hs = (wz + xc * (oq / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 hw = vec2(wb / wg, wc) / 2.0;\nfloat xj = ga * oo;\nfloat xk = gb * oo;\nfloat hu = xj + xk;\nfloat hv = (ht * qn) / hu;\nck.hs = hs;\nck.hw = hw;\nck.hr = hr;\nck.gw = gw;\nck.gx = gx;\nck.gp = gp;\nck.ht = mo(ht, qi, qk);\nck.hu = hu;\nck.ga = xj;\nck.hv = hv;\nck.hx = hx;\nck.hy = hy;\nck.hz = hz;\nck.ia = ia;\nck.ib = ib;\nck.ic = ic;\nck.gy = gy;\nck.id = vz;\nck.ig = wb;\nck.ie = wc;\nck.ih = ih;\nck.ii = ii;\nck.ij = ij;\nreturn true;\n}\nfloat xl(float xm, float xn, vec4 xo) {\nfloat xp = clamp(((u_currentTime - xm) / xn), 0.0, 1.0);\nfloat r = xp;\nfloat xq = r * r;\nfloat xr = xq * r;\nvec4 xs = xp < 0.5 ? jf(xo) : jh(xo);\nfloat xt = xs.x;\nfloat xu = xs.y;\nfloat xv = xs.z;\nfloat xw = xs.w;\nfloat xx = xt + xu * r + xv * xq + xw * xr;\nreturn xx;\n}\nvoid main() {\ngo a_final = nk(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat xm = a_animationBeginTime_animationDuration.x;\nfloat xn = a_animationBeginTime_animationDuration.y;\nvec4 xo = a_animationEasing;\nfloat oi = xl(xm, xn, xo);\ngo a_prev = nk(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.fy = mix(a_prev.fy, a_final.fy, ONE);\na_final.ga = mix(a_prev.ga, a_final.ga, oi);\na_final.gb = mix(a_prev.gb, a_final.gb, oi);\na_final.gc = mix(a_prev.gc, a_final.gc, ONE);\na_final.gd = mix(a_prev.gd, a_final.gd, ONE);\na_final.fz = mix(a_prev.fz, a_final.fz, ONE);\na_final.gh = mix(a_prev.gh, a_final.gh, ONE);\na_final.gj = mix(a_prev.gj, a_final.gj, ONE);\na_final.gk = mix(a_prev.gk, a_final.gk, ONE);\na_final.gl = mix(a_prev.gl, a_final.gl, ONE);\na_final.gm = mix(a_prev.gm, a_final.gm, ONE);\na_final.gf = mix(a_prev.gf, a_final.gf, ONE);\na_final.gi = mix(a_prev.gi, a_final.gi, oi);\na_final.gp = mix(a_prev.gp, a_final.gp, oi);\na_final.gq = mix(a_prev.gq, a_final.gq, oi);\na_final.gr = mix(a_prev.gr, a_final.gr, oi);\na_final.gs = mix(a_prev.gs, a_final.gs, oi);\na_final.gt = mix(a_prev.gt, a_final.gt, oi);\na_final.gu = mix(a_prev.gu, a_final.gu, oi);\na_final.gv = mix(a_prev.gv, a_final.gv, ONE);\na_final.gw = mix(a_prev.gw, a_final.gw, oi);\na_final.gx = mix(a_prev.gx, a_final.gx, oi);\na_final.gy = mix(a_prev.gy, a_final.gy, oi);\na_final.gz = mix(a_prev.gz, a_final.gz, oi);\na_final.ha = mix(a_prev.ha, a_final.ha, oi);\na_final.hb = mix(a_prev.hb, a_final.hb, oi);\na_final.hc = mix(a_prev.hc, a_final.hc, oi);\na_final.hd = mix(a_prev.hd, a_final.hd, oi);\na_final.he = mix(a_prev.he, a_final.he, oi);\na_final.hf = mix(a_prev.hf, a_final.hf, oi);\na_final.hg = mix(a_prev.hg, a_final.hg, oi);\na_final.hh = mix(a_prev.hh, a_final.hh, oi);\na_final.hi = mix(a_prev.hi, a_final.hi, oi);\na_final.hj = mix(a_prev.hj, a_final.hj, oi);\na_final.hk = mix(a_prev.hk, a_final.hk, oi);\na_final.hl = mix(a_prev.hl, a_final.hl, oi);\na_final.hm = mix(a_prev.hm, a_final.hm, oi);\na_final.hn = mix(a_prev.hn, a_final.hn, ONE);\na_final.ho = mix(a_prev.ho, a_final.ho, ONE);\na_final.hp = mix(a_prev.hp, a_final.hp, ONE);\n#endif\nhq ck;\nbool xy = oj(a_final, ck);\nif (!xy) {\nlr();\nreturn;\n}\nvec2 oq = a_vertexInfo.xy;\ndp = ck.gw;\ndq = ck.gx;\ndr = ck.gy;\nds = ck.hs;\ndt = ck.hy;\n#if D3D9_FIX\ndu = vec4(ck.hz, ck.ia);\ndv = vec3(ck.hr, ck.gp, ck.hx);\ndw = vec4(ck.ht, ck.hu, ck.ga, ck.hv);\ndx = vec4(ck.hw, ck.ic, ck.ib);\n#else\ndy = ck.hr;\ndz = ck.hz;\nea = ck.ia;\neb = vec2(ck.gp, ck.hx);\nec = ck.ht;\ned = ck.hu;\nee = vec2(ck.ga, ck.hv);\nef = ck.hw;\neg = ck.ic;\neh = ck.ib;\n#endif\nfloat xz = step(oq.x, 0.0);\nfloat ya = 1.0 - xz;\nvec2 lt = ck.id\n+ (ck.ih * (ck.ig / 2.0) * oq.x)\n+ ((xz * ck.ii + ya * ck.ij) * (ck.ie / 2.0) * oq.y);\ngl_Position = ls(lt);\n}\n";var Gs="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 dp;\nvarying vec4 dq;\nvarying vec4 dr;\nvarying vec2 ds;\nvarying vec2 dt;\n#if D3D9_FIX\nvarying vec4 du;\nvarying vec3 dv;\nvarying vec4 dw;\nvarying vec4 dx;\n#else\nvarying float dy;\nvarying vec2 dz;\nvarying vec2 ea;\nvarying vec2 eb;\nvarying float ec;\nvarying float ed;\nvarying vec2 ee;\nvarying vec2 ef;\nvarying float eg;\nvarying float eh;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 yd(in vec4 tf, in vec4 ye) {\nfloat yf = ye.a;\nfloat yg = tf.a + EPSILON;\nfloat yh = min(yf + yg, 1.0);\nfloat r = yf / yh;\nreturn vec4(mix(tf.rgb, ye.rgb, r), yh);\n}\nfloat yi(in float yj, in float fb) {\nfloat yk = (yj * 256.0 + fb) * 256.0;\nfloat yl = yk / 60000.0;\nreturn yl * 2.0 - 1.0;\n}\nbool ma(float ly, float lz) {\nreturn abs(ly - lz) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\nfloat dy = dv.x;\nfloat ym = dv.y;\nfloat yn = dv.z;\nvec2 dz = du.xy;\nvec2 ea = du.zw;\nfloat ec = dw.x;\nfloat ed = dw.y;\nfloat yo = dw.z;\nfloat yp = dw.w;\nvec2 ef = dx.xy;\nfloat eg = dx.z;\nfloat eh = dx.w;\n#else\nfloat ym = eb.x;\nfloat yn = eb.y;\nfloat yo = ee.x;\nfloat yp = ee.y;\n#endif\nvec4 ns = texture2D(u_shapeTexture, ds);\nfloat yq = yi(ns.b, ns.a) * ef.x;\nfloat yr = yi(ns.r, ns.g) * ef.y;\nyr += yn;\nfloat ys = min(yq, yr);\nvec4 gw = dp;\nvec4 gx = dq;\nif (eh > -EPSILON) {\nvec2 hy = dt;\nfloat yv =\nstep(dz.x, hy.x) *\nstep(hy.x, ea.x) *\nstep(dz.y, hy.y) *\nstep(hy.y, ea.y);\nfloat yw = yv;\nvec4 gy;\nif (ma(eh, FILTER_NEAREST)) {\ngy = texture2D(u_patternNearestTexture, hy);\n} else if (ma(eh, FILTER_LINEAR)) {\ngy = texture2D(u_patternLinearTexture, hy);\n} else if (ma(eh, FILTER_LINEAR_SDF)) {\ngy = texture2D(u_patternLinearSdfTexture, hy);\ngy.a = smoothstep(SDF_BUFFER - eg, SDF_BUFFER + eg, gy.a);\n} else if (ma(eh, FILTER_MIPMAP)) {\ngy = texture2D(u_patternMipmapTexture, hy);\n}\ngy.rgb += dr.rgb;\ngy.a *= yw;\ngw = yd(gw, gy);\n}\nfloat yx = clamp(ys, 0.0, 1.0);\nfloat yy = clamp(ys - dy, 0.0, 1.0);\nfloat yz = yx - yy;\nyz = 1.0 - clamp(ys - dy, 0.0, 1.0);\ngw.a *= yy;\ngx.a *= yz;\nvec4 za = yd(gw, gx);\nfloat zb = yx;\nza.rgb = mix(u_backgroundColor, za.rgb, ym);\nif (ed > EPSILON) {\nfloat zn = fract(yp) * ed;\nfloat zo = clamp(min(zn, yo - zn), 0.0, 1.0);\nzb *= zo;\n}\nif (ec < 0.0 || ec > 1.0 || zb < EPSILON) {\ndiscard;\n}\nza.a *= zb;\nza.rgb *= za.a;\ngl_FragColor = za;\n}\n";var Ws=function e(t,r){var n=r.vertex;var i=r.fragment;var a=r.constants;var o=r.macros;this._gl=t;this._vertexSource=n;this._fragmentSource=i;this._constants=G(a||{});this._macros=G(o||{});this._program=null;this._vertexShader=null;this._fragmentShader=null;this._state="init"};Ws.prototype.setConstant=function e(t,value){this._constants[t]=value};Ws.prototype.setMacro=function e(t,value){this._macros[t]=value};Ws.prototype.getState=function e(){return this._state};Ws.prototype.getProgram=function e(){return this._program};Ws.prototype.compile=function e(){var t=this._gl;var r=Hs(this._vertexSource,this._macros,this._constants);var n=Hs(this._fragmentSource,this._macros,this._constants);if(this._program){t.deleteProgram(this._program);t.deleteShader(this._vertexShader);t.deleteShader(this._fragmentShader)}this._program=t.createProgram();this._vertexShader=t.createShader(t.VERTEX_SHADER);this._fragmentShader=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(this._vertexShader,r);t.compileShader(this._vertexShader);t.attachShader(this._program,this._vertexShader);t.shaderSource(this._fragmentShader,n);t.compileShader(this._fragmentShader);t.attachShader(this._program,this._fragmentShader);t.linkProgram(this._program);this._state="compiling"};Ws.prototype.getError=function e(){var t=this._gl;if(!t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)){return{step:"vertex",message:t.getShaderInfoLog(this._vertexShader)}}if(!t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)){return{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)}}if(!t.getProgramParameter(this._program,t.LINK_STATUS)){return{step:"link",message:t.getProgramInfoLog(this._program)}}this._state="done";return null};function Hs(e,t,r){var n=Object.keys(t);var i=Object.keys(r);for(var a=0;a<n.length;++a){var o=n[a];var s=t[o];e=e.replace("#define "+o+" 0","#define "+o+" "+s)}for(var u=0;u<i.length;++u){var l=i[u];var value=r[l];var d=value+(value%1===0?".0":"");e=e.replace("const float "+l+" = 0.0;","const float "+l+" = "+d+";")}return e}var Xs=function e(t,r){this._gl=t;this._glTextureUnit=r;this._simpleShapePixels=new Uint8Array(Pn*Pn*4);this._complexShapePixels=new Uint8Array(Dn*Dn*4);this._texture=null;this._shapesWritten=[]};Xs.prototype.refresh=function e(t){var r=t.getShapeList();for(var n=0,i=r;n<i.length;n+=1){var a=i[n];if(!this._shapesWritten.includes(a.id)){var o=a.isSimple?Pn:Dn;var s=a.isSimple?this._simpleShapePixels:this._complexShapePixels;qs(a,o,Bn,s);this._loadShapeInGpu(a.id,o,s);this._shapesWritten.push(a.id)}}};Xs.prototype._loadShapeInGpu=function e(t,r,n){var i=this._gl;var a=Vn;var o=t%jn*Dn;var s=Math.floor(t/jn)*Dn;if(!this._texture){var u=new Uint8Array(a*a*4);this._texture=i.createTexture();i.activeTexture(i.TEXTURE0+this._glTextureUnit);i.bindTexture(i.TEXTURE_2D,this._texture);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,a,a,0,i.RGBA,i.UNSIGNED_BYTE,u)}else{i.bindTexture(i.TEXTURE_2D,this._texture)}i.texSubImage2D(i.TEXTURE_2D,0,o,s,r,r,i.RGBA,i.UNSIGNED_BYTE,n)};Xs.prototype.getTextureSize=function e(){return Vn};Xs.prototype.getSamplingSize=function e(){return Dn};Xs.prototype.getBufferRatio=function e(){return Bn};Xs.prototype.getTextureUnit=function e(){return this._glTextureUnit};function qs(e,t,r,n){var i=e.getDistanceFromStrokeVertically;var a=e.getDistanceFromStrokeHorizontally;var o=t*(1-r)/2;var s=(t-1)/2;for(var u=0;u<t;++u){for(var l=0;l<t;++l){var d=u;var f=l;var h=(f*t+d)*4;var c=(u-s)/o;var g=(l-s)/o;var v=Ys(i(c,g),-1,1);var p=Ys(a(c,g),-1,1);var _=Zs(v);var m=Zs(p);Ks(n,h,_,m)}}}function Ys(value,e,t){return Math.max(e,Math.min(t,value))}function Zs(value){var e=(value+1)/2;return e*6e4}function Ks(e,t,r,n){e[t]=r>>8;e[t+1]=r%256;e[t+2]=n>>8;e[t+3]=n%256}var Qs=1e20;var Js=24;var $s=6;var eu=8;var tu=.25;var ru=(Js+2*$s)/Js;var nu=24;var iu=function e(){this._fontSize=Js;this._buffer=$s;this._radius=eu;this._cutoff=tu;this._height=Math.ceil(this._fontSize+this._buffer*2*qn);this._maxDimension=1;this._gridSize=1;this._canvas=we();this._canvas.height=this._height;this._canvas.width=1;this._ctx=this._canvas.getContext("2d");this._ctx.textBaseline="middle";this._ctx.textAlign="center";this._ctx.fillStyle="black";this._gridOuter=null;this._gridInner=null;this._f=null;this._d=null;this._z=null;this._v=null};var au={SDF_DIV:{configurable:true}};au.SDF_DIV.get=function(){return ru};iu.prototype.getFontToImageSizeRatio=function e(){return 1+this._buffer*2/this._fontSize};iu.prototype.draw=function e(t,r,n){We(this._ctx,r,this._fontSize,n);var i=this._ctx.measureText(t).width+this._buffer*2,a=uu(i)-Gn*2,o=a,s=this._height,u=o*s,l=Math.max(o,s);if(this._canvas.width<o){this._canvas.width=o;We(this._ctx,r,this._fontSize,n);this._ctx.textAlign="center";this._ctx.textBaseline="middle";this._ctx.fillStyle="black"}if(u>this._gridSize){this._gridOuter=new Float64Array(u);this._gridInner=new Float64Array(u);this._gridSize=u}if(l>this._maxDimension){this._f=new Float64Array(l);this._d=new Float64Array(l);this._z=new Float64Array(l+1);this._v=new Int16Array(l);this._maxDimension=l}this._ctx.clearRect(0,0,o,s);this._ctx.fillText(t,o/2,s/2);var d=this._ctx.getImageData(0,0,o,s),f=new Uint8ClampedArray(u);for(var h=0;h<u;h++){var c=d.data[h*4+3]/255;this._gridOuter[h]=c===1?0:c===0?Qs:Math.pow(Math.max(0,.5-c),2);this._gridInner[h]=c===1?Qs:c===0?0:Math.pow(Math.max(0,c-.5),2)}ou(this._gridOuter,o,s,this._f,this._d,this._v,this._z);ou(this._gridInner,o,s,this._f,this._d,this._v,this._z);for(var g=0;g<u;g++){var v=this._gridOuter[g]-this._gridInner[g];f[g]=Math.max(0,Math.min(255,Math.round(255-255*(v/this._radius+this._cutoff))))}return{height:s,width:o,distance:f}};Object.defineProperties(iu,au);function ou(e,t,r,n,i,a,o){for(var s=0;s<t;s++){for(var u=0;u<r;u++){n[u]=e[u*t+s]}su(n,i,a,o,r);for(var l=0;l<r;l++){e[l*t+s]=i[l]}}for(var d=0;d<r;d++){for(var f=0;f<t;f++){n[f]=e[d*t+f]}su(n,i,a,o,t);for(var h=0;h<t;h++){e[d*t+h]=Math.sqrt(i[h])}}}function su(e,t,r,n,i){r[0]=0;n[0]=-Qs;n[1]=+Qs;for(var a=1,o=0;a<i;a++){var s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o]);while(s<=n[o]){o--;s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o])}o++;r[o]=a;n[o]=s;n[o+1]=+Qs}for(var u=0,l=0;u<i;u++){while(n[l+1]<u){l++}t[u]=(u-r[l])*(u-r[l])+e[r[l]]}}function uu(value){return Math.ceil((value+Gn*2)/Un)*Un}var lu=256;var du=0;var fu=1;var hu=2;var cu=3;var gu=4;var vu=0;var pu=1;var _u={};_u[du]={min:"NEAREST",mag:"NEAREST",mipmap:false};_u[fu]={min:"LINEAR",mag:"LINEAR",mipmap:false};_u[hu]={min:"LINEAR",mag:"LINEAR",mipmap:false};_u[cu]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:true};var mu={};mu[vu]="ALPHA";mu[pu]="RGBA";var yu=Xn-Gn*2;var bu=Hn-Gn*2;var xu=function e(t,r){this._gl=t;this._glUnit=r;this._colorManager=new Pr;this._patternIdToInfoTexture=new Uint8Array(lu*lu*4);this._glTextureInfo=null;this._glTextures=[];this._textureSizes=[];this._pixelRatio=1;this._imageCanvas=we();this._imageCanvas.width=Wn;this._imageCanvas.height=Wn;this._imageCanvasContext=this._imageCanvas.getContext("2d");this._canvasForDuplicatedImage=null;this._sdfGenerator=new iu;this._maxTextureSize=Math.min(4096,t.getParameter(t.MAX_TEXTURE_SIZE));this._warned=false};xu.prototype._warn=function e(){if(!this._warned){Xa("exceeded max WebGL texture size of "+this._maxTextureSize+"; some texts/icons/images won't be displayed");this._warned=true}};xu.prototype.refresh=function e(t){this._pixelRatio=t.getPixelRatio();var r=this._gl;var n=this._getPatternsByFilter(t.getPatternList());for(var i=0;i<n.length;++i){var a=i;var o=n[i];var s=this._getApproximateRequestedTextureSize(o);var u=this._fillAtlas(a,o,s);var l=u.texture;var d=u.size;var f=this._glTextures[a]||(this._glTextures[a]=r.createTexture());var h=a===du?vu:pu;this._setupTexture(f,this._glUnit+1+a,l,d,a,h);this._textureSizes[a]=d}var c=this._glTextureInfo||(this._glTextureInfo=r.createTexture());var g=this._patternIdToInfoTexture;this._setupTexture(c,this._glUnit,g,lu,du,pu)};xu.prototype._setupTexture=function e(t,r,n,i,a,o){var s=this._gl;var u=_u[a];var l=u.min;var d=u.mag;var f=u.mipmap;var h=s[mu[o]];if(o===vu){var c=new Uint8Array(i*i);for(var g=0;g<c.length;++g){c[g]=n[g*4+3]}n=c}s.activeTexture(s.TEXTURE0+r);s.bindTexture(s.TEXTURE_2D,t);s.texImage2D(s.TEXTURE_2D,0,h,i,i,0,h,s.UNSIGNED_BYTE,n);s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s[d]);s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s[l]);if(f){s.generateMipmap(s.TEXTURE_2D)}};xu.prototype.getGranularity=function e(){return Un};xu.prototype.getInfoTextureUnit=function e(){return this._glUnit};xu.prototype.getNearestTextureUnit=function e(){return this._glUnit+1+du};xu.prototype.getLinearTextureUnit=function e(){return this._glUnit+1+fu};xu.prototype.getLinearSdfTextureUnit=function e(){return this._glUnit+1+hu};xu.prototype.getMipmapTextureUnit=function e(){return this._glUnit+1+cu};xu.prototype.getInfoTextureSize=function e(){return lu};xu.prototype.getNearestTextureSize=function e(){return this._textureSizes[du]};xu.prototype.getLinearTextureSize=function e(){return this._textureSizes[fu]};xu.prototype.getLinearSdfTextureSize=function e(){return this._textureSizes[hu]};xu.prototype.getMipmapTextureSize=function e(){return this._textureSizes[cu]};xu.prototype._getPatternsByFilter=function e(t){var r=new Array(gu);for(var n=0;n<gu;++n){r[n]=[]}for(var i=0;i<t.length;++i){var a=this._getPatternPixels(t[i]);r[a.filter].push(a)}return r};xu.prototype._getApproximateRequestedTextureSize=function e(t){var r=0;var n=4;for(var i=0;i<t.length;++i){var a=t[i];var o=a.width;var s=a.height;var u=Su(o);var l=Su(s);r+=u*l;n=Math.max(n,Math.max(u,l))}var d=Qe(Math.max(n,Math.sqrt(r)));return Math.min(d,this._maxTextureSize)};xu.prototype._adjustDimension=function e(t,r){return Math.floor((r-t)/2)};xu.prototype._fillAtlas=function e(t,r,n){var i=new Uint8Array(n*n*4);var a=Math.ceil(n/Un);var o=new Uint8Array(a*a);var s=[{x:0,y:0}];for(var u=0;u<r.length;++u){var l=r[u];var d=l.id;var f=Su(l.width)/Un;var h=Su(l.height)/Un;var c=this._setPositionOnCanvas(s,o,a,f,h);if(c){var g=l.width;var v=l.height;var p=l.pixels;var _=f*Un;var m=h*Un;var y=c.x*Un+this._adjustDimension(g,_);var b=c.y*Un+this._adjustDimension(v,m);this._copyPixelsOnTexture(i,n,p,y,b,g,v);this._writePatternMetaData(d,t,y,b,_,m)}else if(n<this._maxTextureSize){return this._fillAtlas(t,r,n*2)}else{this._warn();this._writePatternMetaData(d,t,0,0,0,0)}}return{texture:i,size:n}};xu.prototype._copyPixelsOnTexture=function e(t,r,n,i,a,o,s){i=i|0;a=a|0;o=o|0;s=s|0;r=r|0;for(var u=0;u<o;++u){for(var l=0;l<s;++l){var d=(i+u+(a+l)*r)*4;var f=(u+l*o)*4;t[d]=n[f];t[d+1]=n[f+1];t[d+2]=n[f+2];t[d+3]=n[f+3]}}};xu.prototype._writePatternMetaData=function e(t,r,n,i,a,o){var s=t*4;var u=r>>1<<7;var l=r%2<<7;this._patternIdToInfoTexture[s]=n/Un;this._patternIdToInfoTexture[s+1]=i/Un;this._patternIdToInfoTexture[s+2]=u+a/Un;this._patternIdToInfoTexture[s+3]=l+o/Un};xu.prototype._setPositionOnCanvas=function e(t,r,n,i,a){for(var o=0,s=t.length;o<s;++o){var u=t[o];var l=u.x;var d=u.y;var f=u.x+i;var h=u.y+a;var c=f<n&&h<n;if(c){for(var g=l;g<f;++g){if(r[g+d*n]===1){c=false;break}}}if(c){for(var v=d;v<h;++v){if(r[l+v*n]===1){c=false;break}}}if(c){for(var p=l;p<f;++p){for(var _=d;_<h;++_){r[p+_*n]=1}}t.splice(o,1);t.push({x:l,y:h},{x:f,y:d});return u}}return null};xu.prototype._getPatternPixels=function e(t){var r=t.id;var n=t.type;var i=t.attributes;var a=null;if(n===cs){if(i.duplicated){a=this._getDuplicatedImagePixels(i.image)}else if(i.scaled){a=this._getScaledImagePixels(i.image)}else{a=this._getNonScaledImagePixels(i.image)}}else if(n===gs){var o=i.text;var s=i.font;var u=i.style;var l=i.size;var d=i.offset;if(i.size==="sdf"){a=this._getSdfTextPixels(o,s,u)}else{a=this._getRegularTextPixels(o,s,u,l,d)}}else if(n===ps){a=this._getIconPixels(i.text,i.font,i.style)}else if(n===_s){a=this._getBadgeIconPixels(i.text,i.font,i.style)}else if(n===vs){a=this._getPieChartPixels(i.colorArray)}else{throw new Error('pattern type "'+n+'" does not exist')}a.id=r;return a};xu.prototype._getScaledImagePixels=function e(t){var r=t.width;var n=t.height;if(r>Wn||n>Wn){var i=Wn/Math.max(t.width,t.height);r*=i;n*=i}if(r&&n){r=Su(r);n=Su(n)}r-=Gn*2;n-=Gn*2;return this._getImagePixels(t,r,n)};xu.prototype._getNonScaledImagePixels=function e(t){return this._getImagePixels(t,t.width,t.height)};xu.prototype._getDuplicatedImagePixels=function e(t){if(t.width===0||t.height===0){return this._getImagePixels(t,0,0)}if(!this._canvasForDuplicatedImage){this._canvasForDuplicatedImage=we();this._canvasForDuplicatedImage.width=Wn;this._canvasForDuplicatedImage.height=Wn}var r=this._canvasForDuplicatedImage;var n=r.getContext("2d");var i=t.width;var a=t.height;var o=(Wn-i)/2;var s=(Wn-a)/2;while(o>0){o-=i}while(s>0){s-=a}for(var u=o;u<Wn;u+=i){for(var l=s;l<Wn;l+=a){n.drawImage(t,u,l)}}return this._getImagePixels(r,Wn,Wn)};xu.prototype._getImagePixels=function e(t,r,n){var i;if(r===0||n===0){i=new Uint8Array(0)}else{if(this._imageCanvas.width<r||this._imageCanvas.height<n){this._imageCanvas.width=r;this._imageCanvas.height=n}var a=this._imageCanvasContext;Au(a,0,0,r,n);try{a.drawImage(t,0,0,r,n)}catch(e){}i=a.getImageData(0,0,r,n).data}return{width:r,height:n,pixels:i,filter:cu}};xu.prototype._getPieChartPixels=function e(t){var r=bu;var n=this._imageCanvasContext;var i=r/2;var a=r/2;var o=0;var s=Math.PI*2/t.length;Au(n,0,0,r,r);n.save();n.rect(0,0,r,r);n.clip();for(var u=0;u<t.length;++u){var l=o+s;n.beginPath();n.moveTo(i,a);n.arc(i,a,r,o,l);n.fillStyle=t[u];n.fill();o=l}n.restore();return{width:r,height:r,pixels:n.getImageData(0,0,r,r).data,filter:fu}};xu.prototype._getTextPixels=function e(t,r,n,i,a,o){var s=this._imageCanvasContext;var u=a*this._pixelRatio;We(s,n,u,i);var l=s.measureText(r).width;if(l===0){l=u}var d=0;var f=0;var h=t===cu;if(!h){d=Math.ceil(u*qn/2)*2;f=Math.ceil(l*Yn/2)*2}var c=Math.ceil(l+f);var g=Math.ceil(u+d);if(this._imageCanvas.width<c){this._imageCanvas.width=c;We(s,n,u,i)}s.clearRect(0,0,c,g);s.fillStyle="black";s.textBaseline="middle";s.textAlign="left";s.fillText(r,o+f/2,g/2);return{width:c,height:g,pixels:s.getImageData(0,0,c,g).data,filter:t}};xu.prototype._getRegularTextPixels=function e(t,r,n,i,a){return this._getTextPixels(du,t,r,n,i,a)};xu.prototype._getIconPixels=function e(t,r,n){return this._getTextPixels(cu,t,r,n,yu,0)};xu.prototype._getBadgeIconPixels=function e(t,r,n){return this._getSdfTextPixels(t,r,n)};xu.prototype._getSdfTextPixels=function e(t,r,n){var i=this._sdfGenerator.draw(t,r,n,this._pixelRatio);var a=i.width;var o=i.height;var distance=i.distance;var s=new Uint8Array(a*o*4);for(var u=0;u<distance.length;++u){s[u*4+3]=distance[u]}return{width:a,height:o,pixels:s,filter:hu}};function Su(value){return Math.ceil((value+Gn*2)/Un)*Un}function Au(e,t,r,n,i){e.clearRect(t,r,n,i)}var Eu={byte:1,ubyte:1,short:2,ushort:2,float:4};var wu={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",float:"FLOAT"};var ku=function e(t){var r=t.gl;var n=t.ext;var i=t.specialGlBuffers;var a=t.metaData;var o=t.programWrapper;this._gl=r;this._ext=n;this._specialGlBuffers=i;this._metaData=G(a);this._programWrapper=o;this._program=null;this._setupUniforms=null;this._specialAttributes=null;this._baseAttributes=null;this._textAttributes=null;this._stencilUsage=Es};ku.prototype._finishInit=function e(){var t=this;var r=this._gl;var n=this._programWrapper.getError();if(n){throw new Error('WebGL compilation at step "'+n.step+":\n"+n.message+'"')}this._program=this._programWrapper.getProgram();r.useProgram(this._program);this._metaData.attributes.forEach(function(e){e.location=r.getAttribLocation(t._program,e.name);e.byteSize=e.size*Eu[e.type];e.glType=wu[e.type]});this._specialAttributes=this._createSpecialAttributesFunctions();this._baseAttributes=this._createAttributesFunctions(function(e){return!e.name.startsWith("a_text")});this._textAttributes=this._createAttributesFunctions(function(e){return e.name.startsWith("a_text")});this._setupUniforms=this._createSetupUniformFunction()};ku.prototype._createSetupUniformFunction=function e(){var t={int:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},sampler2D:function(e){return"gl.uniform1i(l."+e+", u."+e+");"},float:function(e){return"gl.uniform1f(l."+e+", u."+e+");"},vec2:function(e){return"gl.uniform2f(l."+e+", u."+e+"[0], u."+e+"[1]);"},vec3:function(e){return"gl.uniform3f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2]);"},vec4:function(e){return"gl.uniform4f(l."+e+", u."+e+"[0], u."+e+"[1], u."+e+"[2], u."+e+"[3]);"}};var r=this._gl;var n={};var i=[];for(var a=0;a<this._metaData.uniforms.length;++a){var o=this._metaData.uniforms[a];var s=o.id;var u=o.name;var l=o.type;var d=r.getUniformLocation(this._program,u);var f=t[l](s);n[s]=d;i.push(f)}var h=new Function("gl","l","u",i.join("\n"));return function(e){return h(r,n,e)}};ku.prototype._createEnableAttributesFunction=function e(t){var r=this;var n=t.map(function(e){var t=e.location;return"gl.enableVertexAttribArray("+t+");"}).join("\n");var i=new Function("gl",n);return function(){return i(r._gl)}};ku.prototype._createDisableAttributesFunction=function e(t){var r=this;var n=t.map(function(e){var t=e.location;return"gl.disableVertexAttribArray("+t+");"}).join("\n");var i=new Function("gl",n);return function(){return i(r._gl)}};ku.prototype._createSetupAttributesFunction=function e(t){var r=this;var n=t.reduce(function(e,t){var r=t.byteSize;return e+r},0);var i=0;var a=["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) { gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW); }"].concat(t.map(function(e){var t=e.location;var r=e.size;var a=e.glType;var o=e.byteSize;var s="gl.vertexAttribPointer("+t+", "+r+", gl."+a+", false, "+n+", "+i+");";i+=o;return s})).concat(t.map(function(e){var t=e.location;return"ext.vertexAttribDivisorANGLE("+t+", divisor);"})).join("\n");var o=new Function("gl","ext","glBuffer","dataBuffer","divisor",a);return function(e,t,n){o(r._gl,r._ext,e,t,n)}};ku.prototype._createAttributesFunctions=function e(t){if(typeof t==="function"){t=this._metaData.attributes.filter(function(e){return e.location!==-1}).filter(t)}var r=this._createEnableAttributesFunction(t);var n=this._createDisableAttributesFunction(t);return{enable:function(){r();this.enabled=true},disable:function(){n();this.enabled=false},setup:this._createSetupAttributesFunction(t),enabled:false}};ku.prototype._createSpecialAttributesFunctions=function e(){return this._createAttributesFunctions([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3}])};ku.prototype.startPass=function e(t){if(!this._program){this._finishInit()}this._gl.useProgram(this._program);this._resetStencil();this._setupUniforms(t);this._specialAttributes.enable();this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)};ku.prototype._setupAttributes=function e(t,r){var n=r.glBuffer;var i=r.dataBuffer;var a=r.divisor;if(t.enabled&&!n){t.disable()}else if(!t.enabled&&n){t.enable()}if(n){t.setup(n,i,a)}};ku.prototype.setupBaseAttributes=function e(t){this._setupAttributes(this._baseAttributes,t)};ku.prototype.setupTextAttributes=function e(t){this._setupAttributes(this._textAttributes,t)};ku.prototype._resetStencil=function e(){var t=this._gl;this._stencilUsage=Es;t.disable(t.STENCIL_TEST)};ku.prototype.setupStencil=function e(t){if(t!==this._stencilUsage){var r=this._gl;if(t!==Es){r.enable(r.STENCIL_TEST);if(t===ws){r.stencilOp(r.KEEP,r.KEEP,r.REPLACE);r.stencilFunc(r.ALWAYS,1,1)}else if(t===ks){r.stencilOp(r.KEEP,r.KEEP,r.KEEP);r.stencilFunc(r.EQUAL,0,1)}}else{r.disable(r.STENCIL_TEST)}this._stencilUsage=t}};ku.prototype.endPass=function e(){this._specialAttributes.disable();this._baseAttributes.disable();this._textAttributes.disable()};var Cu=function e(t){var r=t.gl;var n=t.ext;var i=t.staticProgram;var a=t.animationProgram;this._gl=r;this._ext=n;this._staticProgram=i;this._animationProgram=a;this._program=null;this._dataBuffer=null;this._version=0;this._glBuffer=this._gl.createBuffer();this._sideGlBuffer=null;this._used=false;this._dataBufferChanged=false};Cu.prototype.setDataBuffer=function e(t){if(this._dataBuffer!==t){this._program=t.isAnimated()?this._animationProgram:this._staticProgram;this._dataBuffer=t;this._dataBufferChanged=true;if(t.hasSideData()&&!this._sideGlBuffer){this._sideGlBuffer=this._gl.createBuffer()}else if(!t.hasSideData()&&this._sideGlBuffer){this._gl.deleteBuffer(this._sideGlBuffer);this._sideGlBuffer=null}}};Cu.prototype.markAsUnused=function e(){this._used=false;return this};Cu.prototype.getProgram=function e(){return this._program};Cu.prototype.markAsUsed=function e(){this._used=true;return this};Cu.prototype.isUsed=function e(){return this._used};Cu.prototype.draw=function e(){var t=this._gl;var r=this._dataBuffer.getElementType();var n=r===ds;var i=n?this._dataBuffer.getNbSideElementsPerMainElement():1;var a=r===fs?ei:1;var o=this._dataBuffer.getSize();var s=this._dataBuffer.getStencilUsage();var u=this._dataBuffer.getVersion();var l=this._version!==u||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:l?this._dataBuffer.getByteArray():null,divisor:i});this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:l&&n?this._dataBuffer.getSideByteArray():null,divisor:1});this._program.setupStencil(s);if(l){this._version=u;this._dataBufferChanged=false}this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,6*a,o*i)};Cu.prototype.destroy=function e(){this._gl.deleteBuffer(this._glBuffer);if(this._sideGlBuffer){this._gl.deleteBuffer(this._sideGlBuffer)}};function Tu(e,t){if(t<2){return e}var r=e.split("\n");var n=[];for(var i=0;i<r.length;++i){var a=r[i];if(a.length<t){n.push(a)}else{var o=Lu(r[i],t);for(var s=0;s<o.length;++s){n.push(o[s])}}}return n.join("\n")}function Lu(e,t){var r=e.split(" ");var n=[];var i=0;var a=-1;var o=[];var s=true;for(var u=0;u<r.length;++u){if(s){if(r[u].length>t){var l=Mu(r[u],t);for(var d=0;d<l.length;++d){n.push([l[d]]);++a}i=l[l.length-1].length}else{n.push([r[u]]);++a;i=r[u].length+1}s=false}else if(i+r[u].length<=t){n[a].push(r[u]);i+=r[u].length+1}else{s=true;--u}}for(var f=0;f<n.length;++f){o.push(n[f].join(" "))}return o}function Mu(e,t){var r=[];for(var n=0;n<e.length;n+=t-1){r.push(e.substr(n,t-1)+"-")}var i=r[r.length-1].length;r[r.length-1]=r[r.length-1].substr(0,i-1)+" ";return r}function Iu(e,t){if(e===null){return null}e=e.toString();var r=e.split("\n");var n=[];var i=0;for(var a=0;a<r.length;a++){var o=r[a];if(!t||t<=1||o.length<t){n.push(o);i=Math.max(i,o.length)}else{var s=Lu(r[a],t);for(var u=0;u<s.length;u++){o=s[u];n.push(o);i=Math.max(i,o.length)}}}return{data:n,maxLength:i,lines:n.length}}function Fu(){var e=A("@mapbox/mapbox-gl-rtl-text")||A("mapbox-gl-rtl-text");var t=typeof window!=="undefined";var r=e?e.processBidirectionalText:t?window.processBidirectionalText:null;var n=e?e.applyArabicShaping:t?window.applyArabicShaping:null;return{processBidirectionalText:r?function(e){return r(e,[]).join("")}:function(e){return e},applyArabicShaping:n?function(e){if(e===null){return null}else if(typeof e==="number"){return e.toString()}else{return n(e)}}:function(e){return e===null?null:e.toString()}}}var Nu=B();var zu="\n".charCodeAt(0);var Ru=4;var Pu=12;var Du=25;var Ou=511/Du;var Bu=3;var ju=function e(t){this._patternManager=t;this._canvas=we();this._ctx=this._canvas.getContext("2d");this._processBidirectionalText=Fu().processBidirectionalText;this._textPattern={type:ms,attributes:{text:"",font:"",size:0,style:"",align:""},dimensions:{width:0,height:0}};this._textDimensions={width:0,height:0};this._lineWidthList=new Array(64);this._init_()};ju.prototype._init_=function e(){this._mustClear=false;this._byFont={};this._widthAtlases={normal:{},bold:{},italic:{}}};ju.prototype.reset=function e(){this._init_()};ju.prototype.clear=function e(){this._mustClear=true};ju.prototype._measureChar=function e(t,r,n){We(this._ctx,r,Pu,n);return this._ctx.measureText(t).width/Pu};ju.prototype._getAtlas=function e(t,r,n){var i=n==="sdf"?0:n;var a=this._byFont[t]||(this._byFont[t]={});var o=a[r]||(a[r]=new Array(50));var s=o[i]||(o[i]=new Array(256));return s};ju.prototype._getMeasurementAtlas=function e(t,r){var n=this._widthAtlases[r];var i=n[t]||(n[t]=new Array(256));return i};ju.prototype.measureText=function e(t,r,n,i){if(i===void 0)i=1;if(!r){this._textDimensions.width=0;this._textDimensions.height=0;return this._textDimensions}var a=this._getMeasurementAtlas(r,n);var o=0,s=0;var u=1;for(var l=0;l<t.length;++l){var d=t.charCodeAt(l);if(d===zu){if(s>o){o=s}s=0;u+=1}else{var f=a[d];if(f===undefined){f=this._measureChar(t[l],r,n);a[d]=f}s+=f}}if(s>o){o=s}this._textDimensions.width=o*i;this._textDimensions.height=u*i;return this._textDimensions};ju.prototype._getCharInfo=function e(t,r,n,i,a,o){var s=t[r];if(!s){var u=String.fromCharCode(r);var l=a==="sdf"?1:Bu;s={ratio:this._measureChar(u,n,i),patternId:new Array(l)};for(var d=0;d<l;++d){var f=d/l;s.patternId[d]=this._patternManager.getIdFromDefinition({type:gs,attributes:{text:u,font:n,style:i,size:a,align:o,offset:f}})}t[r]=s}return s};ju.prototype.storeTextInDataView=function e(t,r,n,i){var a=r;if(i&&i.type===ms){var o=i.attributes;var s=o.text;var u=o.font;var l=o.style;var d=o.size;var f=o.align;var h=f==="center";var c=this._getAtlas(u,l,d);var g=0;var v=1;var p=0;var _=0;var m=this._lineWidthList;s=this._processBidirectionalText(s);for(var y=0;y<s.length;++y){var b=s.charCodeAt(y);if(b===zu){if(p>g){g=p}m[_]=p;_+=1;p=0;v+=1}else{var x=this._getCharInfo(c,b,u,l,d,f);p+=x.ratio}}m[_]=p;if(p>g){g=p}if(d==="sdf"){var S=0;var A=-(h?m[S]:g)/2;var E=(-v+1)/2;var w=0;for(var k=0;k<s.length;++k){var C=s.charCodeAt(k);var T=c[C];if(C===zu){S+=1;A=-(h?m[S]:g)/2;E+=1;w=0}else{var L=T.ratio;var M=T.patternId[0];A+=(L+w)/2;w=L;var I=Uu(A*Ou);var F=Vu(E*2);t.setUint16(a,M,Nu);t.setUint16(a+2,(I<<6)+F,Nu);a+=Ru}}}else{var N=0;var z=Math.ceil(-(h?m[N]:g)*d/2);var R=(-v+1)/2;for(var P=0;P<s.length;++P){var D=s.charCodeAt(P);var O=c[D];if(D===zu){N+=1;z=Math.ceil(-(h?m[N]:g)*d/2);R+=1}else{var B=O.ratio*d;var j=Math.floor(z);var V=z-j;var U=Math.round(V*Bu);if(U===Bu){U=0;j+=1}j+=Math.ceil(B/2);z+=B;var G=O.patternId[U];var W=Uu(j);var H=Vu(R*2);t.setUint16(a,G,Nu);t.setUint16(a+2,(W<<6)+H,Nu);a+=Ru}}}}this._fillWithZeros(t,a,n)};ju.prototype.extractTextFromDataView=function e(t,r,n){var i=t;var a=Nu;var o=i.getUint16(r,a);var s=this._textPattern;var u=this._patternManager.getDefinitionFromId(o);var l=u.attributes;var d=l.font;var f=l.style;var h=l.size;var c=l.align;var g=this._getAtlas(d,f,h);var v=[];var p=0;var _=0;var m=0;var y=null;for(var b=r;b<n;b+=Ru){var x=i.getUint16(b,a);if(!x){break}var S=Gu(i.getUint16(b+2,a)%64);var A=this._patternManager.getDefinitionFromId(x);if(!A){break}var E=A.attributes.text.charCodeAt(0);var w=g[E];if(y===null){y=S}else if(S>y){if(p>_){_=p}p=0;m+=1;v.push(zu);y=S}v.push(E);if(w){p+=w.ratio}}if(p>_){_=p}var k=String.fromCharCode.apply(null,v);s.attributes.style=f;s.attributes.font=d;s.attributes.size=h;s.attributes.align=c;s.attributes.text=this._processBidirectionalText(k);s.dimensions.width=_;s.dimensions.height=m;return s};ju.prototype._fillWithZeros=function e(t,r,n){for(var i=r;i<n;i+=Ru){t.setUint16(i,0)}};ju.prototype._clear=function e(){this._byFont={};this._widthAtlases={normal:{},bold:{},italic:{}}};ju.prototype.update=function e(){if(this._mustClear){this._clear();this._mustClear=false}};ju.prototype.getVersion=function e(){};function Vu(value){return $e(value+32,0,63)}function Uu(value){return $e(value+512,0,1023)}function Gu(value){return value-32}var Wu=he();var Hu={stencil:true,antialias:false,alpha:true,premultipliedAlpha:true};var Xu=0;var qu=1;var Yu={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'};function Zu(value,e){if(!value){var t=new Error(Yu[e]);t.code=e;throw t}}var Ku=function(e){function t(r){e.call(this,r);var n=r.initData||t.createInitData();var i=n.canvas;var a=n.gl;var o=n.ext;var s=n.staticProgramWrapper;var u=n.animationProgramWrapper;Zu(a,"NO_WEBGL");Zu(o,"NO_ANGLE_INSTANCED_ARRAYS");this._glCanvas=i;this._gl=a;this._ext=o;this._staticProgramWrapper=s;this._animationProgramWrapper=u;this._shapeTexture=new Xs(this._gl,Xu);this._patternTexture=new xu(this._gl,qu);this._2dcanvas=we();this._ctx=this._2dcanvas.getContext("2d");this._glCanvas.style.imageRendering="pixelated";this._initCanvas(this._glCanvas);this._glBuffers=[];this._staticProgram=null;this._animationProgram=null;this._currentProgram=null;this._specialGlBuffers=null;this._shaderMetadata=null;this._mustResize=false;this._computeShaderInfo();this._initSpecialGlBuffers();this._initGlPrograms();this._initGl()}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.isAvailable=function e(){return Wu};t.createInitData=function e(){var t=we();var r=ce(t,Hu);var n=r&&typeof r.getExtension==="function"?r.getExtension("ANGLE_instanced_arrays"):null;var i=el();var a=new Ws(r,{vertex:Us,fragment:Gs,constants:i,macros:{ANIMATED:0}});var o=new Ws(r,{vertex:Us,fragment:Gs,constants:i,macros:{ANIMATED:1}});if(r&&n){a.compile();r.flush()}return{canvas:t,gl:r,ext:n,staticProgramWrapper:a,animationProgramWrapper:o}};t.getName=function e(){return"WebGL"};t.prototype._afterFirstFrame=function e(){if(this._animationProgramWrapper.getState()==="init"){this._animationProgramWrapper.compile()}};t.prototype.ensureAnimationsReady=function e(){var t=this._animationProgramWrapper.getState();if(t!=="done"){if(t==="init"){this._animationProgramWrapper.compile()}this._animationProgramWrapper.getError()}};t.prototype.getDomElement=function e(){return this._glCanvas};t.prototype._initGl=function e(){var t=this._gl;t.clearColor(0,0,0,0);t.enable(t.BLEND);t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)};t.prototype._computeShaderInfo=function e(){this._shaderMetadata=Qu(Us,Gs)};t.prototype._initGlPrograms=function e(){this._staticProgram=new ku({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper});this._animationProgram=new ku({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})};t.prototype._initSpecialGlBuffers=function e(){var t=this._gl;var r=t.createBuffer();var n=new Int8Array(18*ei);for(var i=0;i<ei;++i){var a=i;var o=[-1,-1,a,1,-1,a,1,1,a,-1,-1,a,-1,1,a,1,1,a];L(n,o,i*18)}t.bindBuffer(t.ARRAY_BUFFER,r);t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW);this._specialGlBuffers={vertexInfo:r}};t.prototype._computeUniforms=function e(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}};t.prototype._render=function e(t){var r=t.shapesChanged;var n=t.patternsChanged;var i=t.dimensionsChanged;var a=t.backgroundColorChanged;var o=this._gl;if(n){this._patternTexture.refresh(this._patternManager)}if(r){this._shapeTexture.refresh(this._shapeManager)}if(i){this._mustResize=true}if(a){var s=this._renderBackground?this._backgroundRgba:[0,0,0,0];var u=s[0];var l=s[1];var d=s[2];var f=s[3];o.clearColor(u*f,l*f,d*f,f)}var h=this._computeUniforms();var c=this._startFrame();if(this._mustResize&&c.length){Fe(this._glCanvas,this._width,this._height,this._pixelRatio);o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio);this._mustResize=false}o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var g=0;g<c.length;++g){this._displayBuffer(c[g],h)}this._endFrame()};t.prototype._displayBuffer=function e(t,r){var n=t.getProgram();if(n!==this._currentProgram){if(this._currentProgram){this._currentProgram.endPass()}this._currentProgram=n;this._currentProgram.startPass(r)}t.markAsUsed();t.draw()};t.prototype._startFrame=function e(){var t=this._bufferList.getBuffersByAscendingDepth();var r=[];for(var n=0;n<this._glBuffers.length;++n){var i=this._glBuffers[n];if(i){i.markAsUnused()}}for(var a=0;a<t.length;++a){var o=t[a];var s=this._getAssociatedGlBuffer(o);s.markAsUsed();if(!o.isEmpty()&&this._isBufferDisplayable(o)){r.push(s)}}for(var u=0;u<this._glBuffers.length;++u){var l=this._glBuffers[u];if(l&&!l.isUsed()){l.destroy();this._glBuffers[u]=undefined}}return r};t.prototype._endFrame=function e(){if(this._currentProgram){this._currentProgram.endPass();this._currentProgram=null}};t.prototype._getAssociatedGlBuffer=function e(t){var r=t.getId();var n=this._glBuffers[r];if(!n){while(this._glBuffers.length<=r){this._glBuffers.push(undefined)}n=new Cu({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram});this._glBuffers[r]=n}n.setDataBuffer(t);return n};t.prototype.destroy=function e(){var t=this._gl.getExtension("WEBGL_lose_context");if(t){t.loseContext()}};t.prototype.getImageData=function e(){var t=this._glCanvas.width;var r=this._glCanvas.height;if(this._2dcanvas.width<t||this._2dcanvas.height<r){this._2dcanvas.width=t;this._2dcanvas.height=r}this._ctx.drawImage(this._glCanvas,0,0);return this._ctx.getImageData(0,0,t,r)};t.prototype._getImageDataFlippedYAxis=function e(){var t=this._gl;var r=this._glCanvas.width;var n=this._glCanvas.height;var i=this._ctx.createImageData(r,n);var a=new Uint8Array(i.data.buffer);t.readPixels(0,0,r,n,t.RGBA,t.UNSIGNED_BYTE,a);return i};return t}(js);function Qu(e,t){var r={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]};$u(r,e);$u(r,t);return r}var Ju={float:1,vec2:2,vec3:3,vec4:4};function $u(e,t){var r=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g;var n=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g;var i=[];var a=r.exec(t);while(a){var o=a[0];if(o==="#endif"){i.pop()}else if(o.startsWith("#if")){i.push(a[4])}else{e.attributes.push({name:a[3],size:Ju[a[2]],type:a[1],tags:i.slice()})}a=r.exec(t)}a=n.exec(t);while(a){if(!e.uniforms.some(function(e){var t=e.id;return t===a[1]})){var s=a[1];var u=a[2];var l=u.replace("u_","");e.uniforms.push({id:l,name:u,type:s})}a=n.exec(t)}}function el(){return{BYTES_TO_OFFSET_ANGLE:Math.PI*2/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:nu,CURVATURE_RATIO:ti,PATTERN_MARGIN:Gn,TEXT_WIDTH_MULTIPLIER:Yn,TEXT_HEIGHT_MULTIPLIER:qn,SELF_LOOP_CURVATURE_MULTIPLIER:ri,EDGE_ARROW_SIZE_RATIO:$n,NB_PIECES_PER_CURVE:ei,PIECE_NODE_COMPONENT:ys,PIECE_EDGE_BODY:bs,PIECE_EDGE_HEAD:xs,PIECE_EDGE_TAIL:Ss,PIECE_EDGE_TEXT:As,MAX_TEXT_SIZE:Du,BYTES_TO_TEXT_OFFSET:1/Ou,FILTER_NEAREST:du,FILTER_LINEAR:fu,FILTER_LINEAR_SDF:hu,FILTER_MIPMAP:cu,SHAPE_TEXTURE_SIZE:Vn,SIMPLE_SHAPE_SAMPLING_SIZE:Pn,COMPLEX_SHAPE_SAMPLING_SIZE:Dn,SHAPE_SAMPLING_BUFFER_RATIO:Bn,MAX_NB_SHAPES:Rn.toString(),FIRST_COMPLEX_SHAPE_ID:On,SELF_LOOP_TO_CIRCLE_APPROX:ni}}var tl=1/ei;var rl=function(e){function t(t){e.call(this,t);this._cachePoints=[];this._nextCachePoint=0;this._tmp={x1:0,y1:0,x2:0,y2:0};this._pointCopies=new Array(128);this._renderInfo={bounds:[]};this._clipViewport=true}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype._resetCachePoints=function e(){this._nextCachePoint=0};t.prototype._point=function e(t,r){var n=this._cachePoints[this._nextCachePoint++];if(!n){n={x:0,y:0};this._cachePoints.push(n)}n.x=t;n.y=r;return n};t.prototype.setViewportClipping=function e(t){this._clipViewport=t};t.prototype._getShapePoints=function e(t){return this._shapeManager.getDefinitionFromName(t).points};t.prototype._formatAngle=function e(t){if(t<-Math.PI){return t+Math.PI*2}else if(t>Math.PI){return t-Math.PI*2}else{return t}};t.prototype._computeSymbolicSize=function e(t){return t===0?Infinity:t*this._viewZoom};t.prototype._computeAnimationRatio=function e(t){var r=t.beginTime;var n=t.duration;var i=t.easing;var a=(this._currentTime-r)/n;var o=a*a;var s=o*a;var u=this._easingManager.getPolygonFromName(i);var l=a<.5?0:4;var d=u[l];var f=u[l+1];var h=u[l+2];var c=u[l+3];return $e(d+f*a+h*o+c*s,0,1)};t.prototype._mix=function e(t,r,n){return t*(1-n)+r*n};t.prototype._mixColor=function e(t,r,n,i){if(t===r){return t}var a=this._colorManager.parseColor(t);var o=this._colorManager.parseColor(r);var s=Math.round(tt(a[0],o[0],n)*255);var u=Math.round(tt(a[1],o[1],n)*255);var l=Math.round(tt(a[2],o[2],n)*255);var d=tt(a[3],o[3],i);return"rgba("+s+","+u+","+l+","+d+")"};t.prototype._displayBuffer=function e(t){var r=t.getSize();var n=t.isAnimated();for(var i=0;i<r;++i){var a=this.extractElement(t,i);if(!a.valid){continue}this._displayElement(a,n)}};t.prototype._mixAttributes=function e(t,r,n){var i=this._computeAnimationRatio(n);t.dashLength=tt(r.dashLength,t.dashLength,i);t.gapLength=tt(r.gapLength,t.gapLength,i);t.offsetAngle=tt(r.offsetAngle,t.offsetAngle,i);t.opacity=tt(r.opacity,t.opacity,i);t.globalMinVisibleSize=tt(r.globalMinVisibleSize,t.globalMinVisibleSize,i);t.strokeMinVisibleSize=tt(r.strokeMinVisibleSize,t.strokeMinVisibleSize,i);t.patternMinVisibleSize=tt(r.patternMinVisibleSize,t.patternMinVisibleSize,i);t.symbolicSize=tt(r.symbolicSize,t.symbolicSize,i);t.curvature=tt(r.curvature,t.curvature,i);t.fillColor=this._mixColor(r.fillColor,t.fillColor,i,i);t.strokeColor=this._mixColor(r.strokeColor,t.strokeColor,i,i);t.patternColor=this._mixColor(r.patternColor,t.patternColor,i,i);t.x1=tt(r.x1,t.x1,i);t.y1=tt(r.y1,t.y1,i);t.x2=tt(r.x2,t.x2,i);t.y2=tt(r.y2,t.y2,i);t.rectWidthOrSourceRadiusScaled=tt(r.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,i);t.rectWidthOrSourceRadiusFixed=tt(r.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,i);t.rectHeightOrTargetRadiusScaled=tt(r.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,i);t.rectHeightOrTargetRadiusFixed=tt(r.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,i);t.thicknessOrFontSizeScaled=tt(r.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,i);t.thicknessOrFontSizeFixed=tt(r.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,i);t.strokeWidthScaled=tt(r.strokeWidthScaled,t.strokeWidthScaled,i);t.strokeWidthFixed=tt(r.strokeWidthFixed,t.strokeWidthFixed,i);t.offsetScaled=tt(r.offsetScaled,t.offsetScaled,i);t.offsetFixed=tt(r.offsetFixed,t.offsetFixed,i);return t};t.prototype._computeRenderInfo=function e(t){var r=this._renderInfo;var n=this._viewZoom;r.shape=this._shapeManager.getDefinitionFromName(t.shape);r.pieceId=t.pieceId;r.dashLength=t.dashLength;r.gapLength=t.gapLength;r.hasHead=t.hasHead;r.hasTail=t.hasTail;r.isBodyTriangle=t.isBodyTriangle;r.isSelfLoop=t.isSelfLoop;r.patternScale=t.patternScale;r.offsetAngle=this._formatAngle(t.offsetAngle);r.isText=t.isText;r.adjustTextAngle=t.adjustTextAngle;r.unusedFlag1=t.unusedFlag1;r.unusedFlag2=t.unusedFlag2;r.unusedFlag3=t.unusedFlag3;r.opacity=t.opacity;r.globalMinVisibleSize=t.globalMinVisibleSize;r.strokeMinVisibleSize=t.strokeMinVisibleSize;r.patternMinVisibleSize=t.patternMinVisibleSize;r.symbolicSize=t.symbolicSize===0?Infinity:t.symbolicSize*n;r.curvature=t.curvature;r.pattern=t.pattern;r.fillColor=t.fillColor;r.strokeColor=t.strokeColor;r.patternColor=t.patternColor;r.pos1OnGraph=this._point(t.x1,t.y1);r.pos2OnGraph=this._point(t.x2,t.y2);r.pos1=this._graphToScreenCoordinates(r.pos1OnGraph);r.pos2=this._graphToScreenCoordinates(r.pos2OnGraph);r.rectWidthOrSourceRadius=t.rectWidthOrSourceRadiusScaled*n+t.rectWidthOrSourceRadiusFixed;r.rectHeightOrTargetRadius=t.rectHeightOrTargetRadiusScaled*n+t.rectHeightOrTargetRadiusFixed;r.thicknessOrFontSize=t.thicknessOrFontSizeScaled*n+t.thicknessOrFontSizeFixed;r.strokeWidth=t.strokeWidthScaled*n+t.strokeWidthFixed;r.offset=t.offsetScaled*n+t.offsetFixed;return r};t.prototype._applyBackgroundBlending=function e(t){if(t.opacity!==1){t.fillColor=this._blendColor(t.fillColor,t.opacity);t.strokeColor=this._blendColor(t.strokeColor,t.opacity);t.textColor=this._blendColor(t.textColor,t.opacity)}};t.prototype._pointArray=function e(t){var r=this._pointCopies[t];if(!r){r=new Array(t);this._pointCopies[t]=r;for(var n=0;n<t;++n){r[n]={x:0,y:0,r:0}}}return r};t.prototype._scalePoints=function e(t,r,n,i){var a=t.shape.points.length;var o=this._pointArray(a);for(var s=0;s<a;++s){var u=t.shape.points[s];var l=o[s];l.x=r.x+u.x*n;l.y=r.y+u.y*i;l.r=u.r*n}var d=t.pos2OnGraph.x-t.pos1OnGraph.x;var f=t.pos2OnGraph.y-t.pos1OnGraph.y;if(d!==0||f!==0){var h=Math.sqrt(d*d+f*f);var c=d/h;var g=f/h;for(var v=0,p=o;v<p.length;v+=1){var _=p[v];var m=_.x-r.x;var y=_.y-r.y;_.x=r.x+c*m+g*y;_.y=r.y-g*m+c*y}}return o};t.prototype._drawPoints=function e(t){if(t.length===1){this._drawCircle(t[0],t[0].r)}else{this._drawPolygon(t)}};t.prototype._computeCenter=function e(t){var r=Math.cos(t.offsetAngle);var n=Math.sin(t.offsetAngle);var i=(t.pos1.x+t.pos2.x)/2+r*t.offset;var a=(t.pos1.y+t.pos2.y)/2+n*t.offset;return this._point(i,a)};t.prototype._displayNodeComponent=function e(t,r,n,i){var a=this;var o=this._computeCenter(t);if(t.pattern.type!==ms){var s=t.rectWidthOrSourceRadius/2;var u=t.rectHeightOrTargetRadius/2;var l=this._scalePoints(t,o,s,u);if(r||i){this._drawPoints(l)}if(r){this._fill(t.fillColor)}if(i){this._startClip();if(t.pattern.type===vs){var d=t.pattern.attributes.colorArray;if(t.opacity!==1){d=d.map(function(e){return a._blendColor(e,t.opacity)})}this._displayPieChart(o,s,d)}else if(t.pattern.type===ps||t.pattern.type===_s){var f=0;var h=Math.round(t.rectHeightOrTargetRadius*t.patternScale);var c=t.pattern.attributes.text;var g=t.patternColor;var v=t.pattern.attributes.font;var p=t.pattern.attributes.style;var _=t.pattern.attributes.align;var m=t.rectWidthOrSourceRadius;this._displayText(o,f,c,g,v,h,p,_,m)}else if(t.pattern.type===cs){var y=t.pattern.attributes.image;if(y.isDummy||y.width&&y.height){var b=t.pattern.attributes.duplicated;var x=b?1:t.patternScale;var S=t.rectWidthOrSourceRadius*x;var A=t.rectHeightOrTargetRadius*x;var E=t.pattern.attributes.scaled;var w=t.opacity;this._displayImage(o,S,A,y,E,b,w)}}this._endClip()}if(n){var k=t.strokeWidth/2;var C=this._scalePoints(t,o,s+k,u+k);this._drawPoints(C);this._stroke(t.strokeColor,t.strokeWidth)}}else if(i){var T=0;var L=t.thicknessOrFontSize;var M=t.pattern.attributes.text;var I=t.patternColor;var F=t.pattern.attributes.font;var N=t.pattern.attributes.style;var z=t.pattern.attributes.align;var R=t.rectWidthOrSourceRadius;this._displayText(o,T,M,I,F,L,N,z,R)}};t.prototype._displayElement=function e(t,r){if(!t.end.shape||!t.end.pieceId){return}this._resetCachePoints();var n=r?this._mixAttributes(t.end,t.start,t.animation):t.end;var i=this._computeRenderInfo(n);if(i.symbolicSize<i.globalMinVisibleSize||i.opacity===0){return}this._applyBackgroundBlending(i);var a=i.strokeColor&&i.strokeWidth>0&&i.symbolicSize>=i.strokeMinVisibleSize;var o=i.pattern.type!==hs&&i.symbolicSize>=i.patternMinVisibleSize;var s=!!i.fillColor;if(i.pieceId===ys){this._displayNodeComponent(i,s,a,o)}else{var u=i.pos2.x-i.pos1.x;var l=i.pos2.y-i.pos1.y;var d=Math.sqrt(u*u+l*l);var f=null;var h=null;var c=null;if(i.isSelfLoop){var g=i.pieceId===As?i.strokeWidth/2:i.rectWidthOrSourceRadius;var v=this._getSelfLoopControlPoints(i.pos1,i.curvature,g);var p=v.x1;var _=v.y1;var m=v.x2;var y=v.y2;f=this._point(p,_);h=this._point(m,y);c=il(i.pos1,f,h,i.pos2,1)}else if(i.curvature){f=this._getQuadraticCurveControlPoint(i);c=nl(i.curvature,d,1)}else{c=d}if(i.pieceId===As){var b=i.strokeWidth;var x=this._getPointOnLine(i.pos1,f,h,i.pos2,.5);var S=this._getTangentOnLine(i.pos1,f,h,i.pos2,.5);if(i.adjustTextAngle&&!i.isSelfLoop&&i.rectWidthOrSourceRadius>=c-b){S.x=1;S.y=0;i.offset=0}var A=-Math.atan2(S.y,S.x);var E=this._formatAngle(i.offsetAngle-A);if(!i.isSelfLoop&&E<0||i.isSelfLoop&&i.offsetAngle<0){S.x*=-1;S.y*=-1}if(A>Math.PI/2||A<-Math.PI/2){A+=Math.PI}var w=this._getOrthogonal(S);var k=x.x+w.x*i.offset;var C=x.y+w.y*i.offset;if(i.fillColor){var T=this._pointArray(4);var L=i.rectWidthOrSourceRadius/2;var M=i.rectHeightOrTargetRadius/2;var I=S.x*L;var F=S.y*L;var N=w.x*M;var z=w.y*M;var R=T[0];var P=T[1];var D=T[2];var O=T[3];R.x=k+I+N;R.y=C+F+z;P.x=k+I-N;P.y=C+F-z;D.x=k-I-N;D.y=C-F-z;O.x=k-I+N;O.y=C-F+z;this._drawPoints(T);this._fill(i.fillColor)}else{var B=this._point(k,C);var j=A;var V=i.thicknessOrFontSize;var U=i.pattern.attributes.text;var G=i.patternColor;var W=i.pattern.attributes.font;var H=i.pattern.attributes.style;var X=i.pattern.attributes.align;var q=i.rectWidthOrSourceRadius;this._displayText(B,j,U,G,W,V,H,X,q)}}else{var Y=i.pieceId===xs;var Z=i.pieceId===Ss;var K=Math.cos(i.offsetAngle);var Q=Math.sin(i.offsetAngle);i.pos1.x+=K*i.offset;i.pos1.y+=Q*i.offset;i.pos2.x+=K*i.offset;i.pos2.y+=Q*i.offset;var J=i.shape.name==="line";var $=i.thicknessOrFontSize;var ee=i.rectWidthOrSourceRadius;var te=i.rectHeightOrTargetRadius;var re=+i.hasHead;var ne=+i.hasTail;var ie=+i.isBodyTriangle;var ae=re+ne;var oe=al($);var se=re*oe;var ue=ne*oe;var le=i.isSelfLoop?Infinity:d-ee-te;var de=Math.min(le/ae,oe);var fe=oe+Math.max(ee+de-ue,0);var he=ne*fe+(1-ne)*ie*ee;var ce=oe+Math.max(te+de-se,0);var ge=re*ce+(1-re)*ie*te;if(Y||Z){var ve=Z?-1:1;var pe=(Y?c-ge:he)-ve;var _e=null;var me=null;if(i.isSelfLoop){var ye=this._getTFromLengthOnCubicCurve(i.pos1,f,h,i.pos2,pe-i.strokeWidth/2*ve);_e=this._getPointOnCubicCurve(i.pos1,f,h,i.pos2,ye);me=this._getTangentOnCubicCurve(i.pos1,f,h,i.pos2,ye)}else if(i.curvature){var be=this._getTFromLengthOnQuadraticCurve(i.pos1,f,i.pos2,pe-i.strokeWidth/2*ve);_e=this._getPointOnQuadraticCurve(i.pos1,f,i.pos2,be);me=this._getTangentOnQuadraticCurve(i.pos1,f,i.pos2,be)}else{var xe=pe/c;_e=this._mixPoints(i.pos1,i.pos2,xe);me=this._point(u/d,l/d)}me.x*=ve;me.y*=ve;if(s){if(i.shape.hole){var Se=this._makeEdgeExtremityPoints(_e,me,oe,i.shape.hole);this._drawPoints(Se);this._startReverseClip()}var Ae=this._makeEdgeExtremityPoints(_e,me,oe,i.shape.points);this._drawPoints(Ae);this._fill(i.fillColor);if(i.shape.hole){this._endReverseClip()}}if(a){if(i.shape.hole){var Ee=this._makeEdgeExtremityPoints(_e,me,oe,i.shape.hole);this._drawPoints(Ee);this._stroke(i.strokeColor,i.strokeWidth)}var we=oe+i.strokeWidth/2;var ke=this._makeEdgeExtremityPoints(_e,me,we,i.shape.points);this._drawPoints(ke);this._stroke(i.strokeColor,i.strokeWidth)}}else{var Ce=c-he-ge;if(Ce<=0){return}if(J){var Te=this._computeLineDash(c,$,he,ge,i.dashLength,i.gapLength);if(a){this._drawLine(i.pos1,f,h,i.pos2);this._stroke(i.strokeColor,$+i.strokeWidth*2,Te)}if(s){this._drawLine(i.pos1,f,h,i.pos2);this._stroke(i.fillColor,$,Te)}}else{var Le=he;var Me=c-ge;if(a){var Ie=this._makeTriangleEdgeBody(i.pos1,f,h,i.pos2,Le,Me,$+i.strokeWidth/2,i.strokeWidth/2);this._drawPoints(Ie);this._stroke(i.strokeColor,i.strokeWidth)}if(s){var Fe=this._makeTriangleEdgeBody(i.pos1,f,h,i.pos2,Le,Me,$,0);this._drawPoints(Fe);this._fill(i.fillColor)}}}}}};t.prototype._makeTriangleEdgeBody=function e(t,r,n,i,a,o,s,u){if(!r){return this._makeStraightTriangleEdge(t,i,a,o,s,u)}else if(!n){return this._makeCurveTriangleEdge(t,r,i,a,o,s,u)}else{return this._makeSelfLoopTriangleEdge(t,r,n,i,a,o,s,u)}};t.prototype._makeCurveTriangleEdge=function e(t,r,n,i,a,o,s){var u=ei*2+2;var l=this._pointArray(u);var d=this._getTFromLengthOnQuadraticCurve(t,r,n,i);var f=this._getTFromLengthOnQuadraticCurve(t,r,n,a);var h=(f-d)/ei;var c=(s-o)/ei/2;var g=o/2;var v=d;for(var p=0;p<=ei;++p){var _=this._getPointOnQuadraticCurve(t,r,n,v);var m=this._getTangentOnQuadraticCurve(t,r,n,v);var y=this._getOrthogonal(m);var b=y.x*g;var x=y.y*g;var S=l[p];var A=l[u-1-p];S.x=_.x+b;S.y=_.y+x;A.x=_.x-b;A.y=_.y-x;v+=h;g+=c}return l};t.prototype._makeSelfLoopTriangleEdge=function e(t,r,n,i,a,o,s,u){var l=ei*2+2;var d=this._pointArray(l);var f=this._getTFromLengthOnCubicCurve(t,r,n,i,a);var h=this._getTFromLengthOnCubicCurve(t,r,n,i,o);var c=(h-f)/ei;var g=(u-s)/ei/2;var v=s/2;var p=f;for(var _=0;_<=ei;++_){var m=this._getPointOnCubicCurve(t,r,n,i,p);var y=this._getTangentOnCubicCurve(t,r,n,i,p);var b=this._getOrthogonal(y);var x=b.x*v;var S=b.y*v;var A=d[_];var E=d[l-1-_];A.x=m.x+x;A.y=m.y+S;E.x=m.x-x;E.y=m.y-S;p+=c;v+=g}return d};t.prototype._makeStraightTriangleEdge=function e(t,r,n,i,a,o){var s=r.x-t.x;var u=r.y-t.y;var l=Math.sqrt(s*s+u*u);var d=this._point(s/l,u/l);var f=this._getOrthogonal(d);var h=a/2;var c=o/2;var g=this._pointArray(4);var v=g[0];var p=g[1];var _=g[2];var m=g[3];var y=t.x+d.x*n;var b=t.y+d.y*n;var x=t.x+d.x*i;var S=t.y+d.y*i;var A=f.x*h;var E=f.y*h;var w=f.x*c;var k=f.y*c;v.x=y+A;v.y=b+E;p.x=y-A;p.y=b-E;_.x=x-w;_.y=S-k;m.x=x+w;m.y=S+k;return g};t.prototype._makeEdgeExtremityPoints=function e(t,r,n,i){var a=this._pointArray(i.length);var o=n/2;var s=t.x+r.x*o;var u=t.y+r.y*o;var l=r.x;var d=r.y;for(var f=0;f<i.length;++f){var h=i[f];var c=a[f];var g=(l*h.x-d*h.y)*o;var v=(d*h.x+l*h.y)*o;c.x=s+g;c.y=u+v;c.r=h.r*o}return a};t.prototype._computeLineDash=function e(t,r,n,i,a,o){var s=[];if(n){s.push(0,n)}if(a&&o){var u=a*r;var l=o*r;var d=u+l;var f=t-i-n-d;var h=0;while(h<f){s.push(u,l);h+=d}var c=t-i-n-h;var g=Math.min(u,c);var v=Math.max(c-g,0);s.push(g,v)}else{s.push(t-i-n,0)}if(i){s.push(0,i)}return s};t.prototype._drawLine=function e(t,r,n,i){if(!r){this._drawStraightLine(t,i)}else if(!n){this._drawQuadraticCurve(t,r,i)}else{this._drawCubicCurve(t,r,n,i)}};t.prototype._getSelfLoopControlPoints=function e(t,r,n){return Xi(t.x,t.y,r,n,this._viewAngle,this._tmp)};t.prototype._getQuadraticCurveControlPoint=function e(t){return Hi(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))};t.prototype._graphToScreenCoordinates=function e(t){var r=this._width/2;var n=this._height/2;var i=(t.x-this._viewX)*this._viewZoom;var a=(t.y-this._viewY)*this._viewZoom;var o=this._viewAngleCos;var s=this._viewAngleSin;var u=o*i+s*a+r;var l=-s*i+o*a+n;return this._point(u,l)};t.prototype._blendColor=function e(t,r){return t?this._mixColor(this._backgroundColor,t,r,1):null};t.prototype._getTangentOnLine=function e(t,r,n,i,a){if(!r){return this._getTangentOnStraightLine(t,i)}else if(!n){return this._getTangentOnQuadraticCurve(t,r,i,a)}else{return this._getTangentOnCubicCurve(t,r,n,i,a)}};t.prototype._getTangentOnStraightLine=function e(t,r){var n=r.x-t.x;var i=r.y-t.y;var a=Math.sqrt(n*n+i*i);return this._point(n/a,i/a)};t.prototype._getTangentOnQuadraticCurve=function e(t,r,n,i){var a=1-i;var o=a*r.x+i*n.x-(a*t.x+i*r.x);var s=a*r.y+i*n.y-(a*t.y+i*r.y);var u=Math.sqrt(o*o+s*s);return this._point(o/u,s/u)};t.prototype._getTangentOnCubicCurve=function e(t,r,n,i,a){var o=1-a;var s=o*o;var u=a*a;var l=s*(r.x-t.x)+2*o*a*(n.x-r.x)+u*(i.x-n.x);var d=s*(r.y-t.y)+2*o*a*(n.y-r.y)+u*(i.y-n.y);var f=Math.sqrt(l*l+d*d);return this._point(l/f,d/f)};t.prototype._mixPoints=function e(t,r,n){var i=tt(t.x,r.x,n);var a=tt(t.y,r.y,n);return this._point(i,a)};t.prototype._getOrthogonal=function e(t){return this._point(-t.y,t.x)};t.prototype._getPointOnLine=function e(t,r,n,i,a){if(!r){return this._mixPoints(t,i,a)}else if(!n){return this._getPointOnQuadraticCurve(t,r,i,a)}else{return this._getPointOnCubicCurve(t,r,n,i,a)}};t.prototype._getPointOnQuadraticCurve=function e(t,r,n,i){var a=Zi(t.x,r.x,n.x,i);var o=Zi(t.y,r.y,n.y,i);return this._point(a,o)};t.prototype._getPointOnCubicCurve=function e(t,r,n,i,a){var o=ta(t.x,r.x,n.x,i.x,a);var s=ta(t.y,r.y,n.y,i.y,a);return this._point(o,s)};t.prototype._getTFromLengthOnCubicCurve=function e(t,r,n,i,a){var o=t.x;var s=t.y;var u=0;var l=0;for(var d=0;d<ei;++d){u+=tl;var f=ta(t.x,r.x,n.x,i.x,u);var h=ta(t.y,r.y,n.y,i.y,u);var c=f-o;var g=h-s;var v=Math.sqrt(c*c+g*g);var p=l+v;if(p>a){var _=(p-a)/v;return u-tl*_}l=p;o=f;s=h}return 1};t.prototype._getTFromLengthOnQuadraticCurve=function e(t,r,n,i){var a=t.x;var o=t.y;var s=0;var u=0;for(var l=0;l<ei;++l){s+=tl;var d=Zi(t.x,r.x,n.x,s);var f=Zi(t.y,r.y,n.y,s);var h=d-a;var c=f-o;var g=Math.sqrt(h*h+c*c);var v=u+g;if(v>i){var p=(v-i)/g;return s-tl*p}u=v;a=d;o=f}return 1};return t}(js);function nl(e,t,r){var n=Math.abs(e)/ti+ki;var i=n*n;var a=r-.5;var o=a*a;var s=1/(16*i);var u=Math.sqrt(o+s);var l=.5/n*Math.sqrt(i+.25);var d=Math.abs(2*n)*(a*u+.5*l+s*Math.log(Math.abs((a+u)/(-.5+l))));return d*t}function il(e,t,r,n,i){var a=(e.x+t.x+r.x)/3;var o=(e.y+t.y+r.y)/3;var s=a-t.x,u=o-t.y;var l=t.x-r.x,d=t.y-r.y;var f=s*s+u*u;var h=(l*l+d*d)/4;var c=Math.sqrt(f-h);return 2*ni*c*3.14159265359*i}function al(e){return e*$n}var ol=!we().__dummy;var sl=function(e){function t(t){e.call(this,t);this._canvas=we();this._ctx=this._canvas.getContext("2d");this._initCanvas(this._canvas);this._imgCanvas=we("2d");this._imgCtx=this._imgCanvas.getContext("2d")}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.getName=function e(){return"Canvas"};t.isAvailable=function e(){return ol};t.prototype.getDomElement=function e(){return this._canvas};t.prototype._render=function e(t){var r=t.dimensionsChanged;if(r){Bs(this._canvas,this._width,this._height,this._pixelRatio)}var n=this._ctx;var i=this._width*this._pixelRatio;var a=this._height*this._pixelRatio;n.clearRect(0,0,i,a);if(this._backgroundColor&&this._renderBackground){n.fillStyle=this._backgroundColor;n.fillRect(0,0,i,a)}var o=this._bufferList.getBuffersByAscendingDepth();for(var s=0;s<o.length;++s){var u=o[s];if(this._isBufferDisplayable(u)){this._displayBuffer(u)}}};t.prototype._drawCircle=function e(t,r){var n=this._ctx;var i=this._pixelRatio;var a=t.x*i;var o=t.y*i;var s=r*i;n.beginPath();n.arc(a,o,s,0,Math.PI*2)};t.prototype._drawPolygon=function e(t){var r=this._ctx;var n=this._pixelRatio;r.beginPath();var i=t[0];r.moveTo(i.x*n,i.y*n);for(var a=1;a<t.length;++a){var o=t[a];r.lineTo(o.x*n,o.y*n)}r.closePath()};t.prototype._drawStraightLine=function e(t,r){var n=this._ctx;var i=this._pixelRatio;n.beginPath();n.moveTo(t.x*i,t.y*i);n.lineTo(r.x*i,r.y*i)};t.prototype._drawQuadraticCurve=function e(t,r,n){var i=this._ctx;var a=this._pixelRatio;i.beginPath();i.moveTo(t.x*a,t.y*a);i.quadraticCurveTo(r.x*a,r.y*a,n.x*a,n.y*a)};t.prototype._drawCubicCurve=function e(t,r,n,i){var a=this._ctx;var o=this._pixelRatio;a.beginPath();a.moveTo(t.x*o,t.y*o);a.bezierCurveTo(r.x*o,r.y*o,n.x*o,n.y*o,i.x*o,i.y*o)};t.prototype._fill=function e(t){var r=this._ctx;r.fillStyle=t;r.fill()};t.prototype._stroke=function e(t,r,n){var i=this;if(n===void 0)n=[];var a=this._ctx;a.setLineDash(n.map(function(e){return e*i._pixelRatio}));a.lineWidth=r;a.strokeStyle=t;a.stroke()};t.prototype._startClip=function e(){this._ctx.save();this._ctx.clip()};t.prototype._endClip=function e(){this._ctx.restore()};t.prototype._startReverseClip=function e(){this._ctx.save();this._ctx.rect(0,0,this._canvas.width,this._canvas.height);this._ctx.clip("evenodd")};t.prototype._endReverseClip=function e(){this._ctx.restore()};t.prototype._displayText=function e(t,r,n,i,a,o,s,u,l){var d=this._ctx;var f=this._pixelRatio;var h=t.x*f;var c=t.y*f;var g=o*f;var v=u==="center"?0:-l/2;d.save();d.translate(h,c);d.rotate(-r);d.textAlign=u;d.textBaseline="middle";We(d,a,g,s);d.fillStyle=i;if(n.indexOf("\n")!==-1){var p=n.split("\n");var _=p.length;var m=(1-_)/2*g;for(var y=0;y<_;++y){d.fillText(p[y],v,m);m+=g}}else{d.fillText(n,v,-1)}d.restore()};t.prototype._displayImage=function e(t,r,n,i,a,o,s){if(this._hideImages){return}if(s!==1){i=this._blendImageOnBackground(i,s)}var u=this._ctx;var l=this._pixelRatio;var d=t.x*l;var f=t.y*l;var h=r*l;var c=n*l;var g=i.width*l;var v=i.height*l;if(a){u.drawImage(i,d-h/2,f-c/2,h,c)}else if(o){var p=d-h/2;var _=f-c/2;var m=d+h/2;var y=f+c/2;var b=d-g/2;var x=f-v/2;while(b>p){b-=g}while(x>_){x-=v}var S=x;while(b<m){while(x<y){u.drawImage(i,b,x,g,v);x+=v}b+=g;x=S}}else{u.drawImage(i,d-g/2,f-v/2,g,v)}};t.prototype._displayPieChart=function e(t,r,n){var i=this._ctx;var a=this._pixelRatio;var o=t.x*a;var s=t.y*a;var u=r*a*2;var l=u*2;if(n.length===1){i.fillStyle=n[0];i.fillRect(o-u,s-u,l,l)}else if(n.length===2){i.fillStyle=n[0];i.fillRect(o-u,s,l,u);i.fillStyle=n[1];i.fillRect(o-u,s-u,l,u)}else{var d=Math.PI*2/n.length;var f=0;for(var h=0;h<n.length;++h){var c=n[h];var g=f+d;i.beginPath();i.moveTo(o,s);i.arc(o,s,u,f,g);i.fillStyle=c;i.fill();f=g}}};t.prototype._blendImageOnBackground=function e(t,r){var n=this._backgroundRgba;var i=Math.round(n[0]*255);var a=Math.round(n[1]*255);var o=Math.round(n[2]*255);var s="rgb("+i+","+a+","+o+")";this._imgCanvas.width=t.width;this._imgCanvas.height=t.height;this._imgCtx.clearRect(0,0,t.width,t.height);this._imgCtx.globalAlpha=1;this._imgCtx.fillStyle=s;this._imgCtx.fillRect(0,0,t.width,t.height);this._imgCtx.globalAlpha=r;this._imgCtx.drawImage(t,0,0);return this._imgCanvas};t.prototype.getImageData=function e(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)};return t}(rl);var ul=false;Ogma.beforeFirstInstanceCreated(function(){try{ul=!!ze("svg")}catch(e){}});var ll="none";var dl={left:"start",center:"middle",right:"end"};var fl="data-element-id";function hl(e,t,r,n,i,a){var o=ze("image");o.setAttribute("width",gl(n));o.setAttribute("height",gl(i));o.setAttribute("x",gl(t));o.setAttribute("y",gl(r));o.setAttribute("href",e);if(a){a.appendChild(o)}return o}function cl(e,t,r,n,i,a,o){if(a===void 0)a=1;var s=ze("rect");s.setAttribute("x",e);s.setAttribute("y",t);s.setAttribute("width",r);s.setAttribute("height",n);s.setAttribute("fill",i);s.setAttribute("fill-opacity",a);if(o){o.appendChild(s)}return s}function gl(e){return Math.round(e*1e3)/1e3}var vl=function(e){function t(t){e.call(this,t);this._svg=ze("svg");this._defs=ze("defs");this._background=ze("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"});this._styles=ze("g",{class:"styles"});this._defs.appendChild(this._styles);this._svg.setAttribute("pointer-events","none");this._svg.style.userSelect="none";this._svg.appendChild(this._defs);this._svg.appendChild(this._background);this._clear();this._currentElementId=0;this._currentClipPathId=null;this._clipPathCounter=1}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.getName=function e(){return"SVG"};t.isAvailable=function e(){return ul};t.prototype.getDomElement=function e(){return this._svg};t.prototype._render=function e(t){var r=t.dimensionsChanged;if(r){Ne(this._svg,{width:this._width,height:this._height})}if(this._backgroundColor&&this._renderBackground){var n=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",n.color);this._background.setAttribute("fill-opacity",n.opacity)}var i=this._bufferList.getBuffersByAscendingDepth();this._clear();this._svg.removeChild(this._container);for(var a=0;a<i.length;++a){var o=i[a];if(this._isBufferDisplayable(o)){this._displayBuffer(o)}}this._svg.appendChild(this._container)};t.prototype._clear=function e(){if(this._container){this._svg.removeChild(this._container)}this._container=ze("g");this._svg.appendChild(this._container);if(this._clipPaths){this._defs.removeChild(this._clipPaths)}this._clipPaths=ze("g");this._defs.appendChild(this._clipPaths);if(this._filters){this._defs.removeChild(this._filters)}this._filters=ze("g");this._defs.appendChild(this._filters)};t.prototype._displayElement=function t(r,n){this._currentElementId=r.id;e.prototype._displayElement.call(this,r,n)};t.prototype._addBackgroundBlendingFilter=function e(t){var r=this._colorManager.parseColor(this._backgroundColor);var n=t;var i=1-t;var a=r[0]*i;var o=r[1]*i;var s=r[2]*i;var u=[n,0,0,0,a,0,n,0,0,o,0,0,n,0,s,0,0,0,1,0].join(" ");var l="filter-"+this._currentElementId;var d=ze("filter",{id:l});var f=ze("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:u});d.appendChild(f);this._filters.appendChild(d);return l};t.prototype._drawCircle=function e(t,r){var n=t.x;var i=t.y;var a="M "+(n-r)+", "+i+" a "+r+","+r+" 0 1,0 "+2*r+",0 a "+r+","+r+" 0 1,0 -"+2*r+",0";var o=ze("path");o.setAttribute("d",a);o.setAttribute("fill",ll);o.setAttribute(fl,this._currentElementId);this._container.appendChild(o);this._element=o};t.prototype._drawPolygon=function e(t){var r=ze("path");var n="";for(var i=0;i<t.length;i++){var a=t[i];var o=a.x;var s=a.y;n+=""+(i===0?"M":"L")+o+","+s+" "}n+="Z";r.setAttribute("d",n);r.setAttribute(fl,this._currentElementId);r.setAttribute("fill",ll);this._container.appendChild(r);this._element=r};t.prototype._drawStraightLine=function e(t,r){var n=ze("path");var i=t.x,a=t.y,o=r.x,s=r.y;var u="M "+i+","+a+" L"+o+","+s;n.setAttribute("d",u);n.setAttribute(fl,this._currentElementId);this._container.appendChild(n);this._element=n};t.prototype._drawQuadraticCurve=function e(t,r,n){var i=ze("path");var a=t.x,o=t.y;var s=r.x,u=r.y;var l=n.x,d=n.y;var f="M "+a+","+o+" Q"+s+","+u+" "+l+","+d;i.setAttribute("d",f);i.setAttribute("fill",ll);i.setAttribute(fl,this._currentElementId);this._container.appendChild(i);this._element=i};t.prototype._drawCubicCurve=function e(t,r,n,i){var a=ze("path");var o=t.x,s=t.y;var u=r.x,l=r.y;var d=n.x,f=n.y;var h=i.x,c=i.y;var g="M "+o+","+s+" C"+u+","+l+" "+d+","+f+" "+h+","+c;a.setAttribute("d",g);a.setAttribute("fill",ll);a.setAttribute(fl,this._currentElementId);this._container.appendChild(a);this._element=a};t.prototype._fill=function e(t){t=this._colorManager.rgbaToRgb(t);this._element.setAttribute("fill",t.color);this._element.setAttribute("fill-opacity",t.opacity);if(this._currentClipPathId){this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}};t.prototype._stroke=function e(t,r,n){if(n===void 0)n=[];var i=this._element;i.setAttribute("stroke-width",r);t=this._colorManager.rgbaToRgb(t);i.setAttribute("stroke",t.color);i.setAttribute("stroke-opacity",t.opacity);if(n.length>0){i.setAttribute("stroke-dasharray",n.map(gl))}};t.prototype._startClip=function e(){var t=ze("clipPath");var r=this._element.cloneNode(false);this._currentClipPathId="clip-path-"+this._clipPathCounter++;t.appendChild(r);this._clipPaths.appendChild(t);t.setAttribute("id",this._currentClipPathId)};t.prototype._endClip=function e(){this._currentClipPathId=null};t.prototype._startReverseClip=function e(){var t=ze("clipPath");var r=this._element.cloneNode(false);var n=r.getAttribute("d");r.setAttribute("clip-rule","evenodd");r.setAttribute("d",n+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height);this._currentClipPathId="clip-path-"+this._clipPathCounter++;t.appendChild(r);this._clipPaths.appendChild(t);t.setAttribute("id",this._currentClipPathId)};t.prototype._endReverseClip=function e(){this._currentClipPathId=null};t.prototype._displayText=function e(t,r,n,i,a,o,s,u){var l=ze("text");l.setAttribute(fl,this._currentElementId);var d=this._colorManager.rgbaToRgb(i);var f=d.opacity;var h=this._colorManager.rgbaToRgb(d.color);var c=t.x;var g=t.y;s=s||"normal";var v=gl(c);l.setAttribute("x",v);l.setAttribute("font-family",a);l.setAttribute("font-size",o);if(s==="bold"){l.setAttribute("font-weight",s)}else{l.setAttribute("font-style",s)}l.setAttribute("fill",h.color);l.setAttribute("fill-opacity",f);if(r){l.setAttribute("transform","rotate("+Hr(-r)+" "+c+", "+g+")")}l.setAttribute("text-anchor",dl[u]||"middle");var p=n.split("\n");var _=p.length;var m=(_+1)/2-1/3;l.setAttribute("y",gl(g-m*o));for(var y=0;y<_;y++){var b=ze("tspan");b.appendChild(Re(p[y]));b.setAttribute("x",v);b.setAttribute("dy",o);l.appendChild(b)}if(this._currentClipPathId){l.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}this._container.appendChild(l)};t.prototype._displayImage=function e(t,r,n,i,a,o,s){var u=t.x;var l=t.y;if(this._hideImages||!i.isDummy&&(!i.width||!i.height)){return}var d=r;var f=n;var h=i.width;var c=i.height;var g;if(a){h=d;c=f}if(o){var v=u-d/2;var p=l-f/2;var _=u+d/2;var m=l+f/2;var y=u-h/2;var b=l-c/2;g=ze("g");g.setAttribute(fl,this._currentElementId);while(y>v){y-=h}while(b>p){b-=c}var x=b;while(y<_){while(b<m){hl(i.src,y,b,h,c,g);b+=c}b=x;y+=h}}else{g=hl(i.src,u-h/2,l-c/2,h,c);g.setAttribute(fl,this._currentElementId)}if(this._currentClipPathId){g.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}if(s!==1){var S=this._addBackgroundBlendingFilter(s);g.setAttribute("filter","url(#"+S+")")}this._container.appendChild(g)};t.prototype._displayPieChart=function e(t,r,n){var i=r*2;var a=i*2;var o=t.x,s=t.y;var u;var l=ze("g");l.setAttribute(fl,this._currentElementId);if(n.length===1){u=cl(o-i,s-i,a,a,n[0],1,l)}else if(n.length===2){u=cl(o-i,s,a,i,n[0],1,l);u=cl(o-i,s-i,a,i,n[1],1,l)}else{var d=Math.PI*2/n.length;var f=0;for(var h=0;h<n.length;++h){var c=f+d;var g=o+r*Math.cos(c);var v=s+r*Math.sin(c);var p=o+r*Math.cos(f);var _=s+r*Math.sin(f);var m=c-f<=Math.PI?0:1;var y="M "+g+","+v+" A "+r+","+r+" 0 "+m+" 0 "+p+","+_+" L "+o+","+s+" L "+g+","+v;u=ze("path");u.setAttribute("d",y);u.setAttribute("fill",n[h]);u.setAttribute("stroke-width",0);f=c;l.appendChild(u)}}if(this._currentClipPathId){l.setAttribute("clip-path","url(#"+this._currentClipPathId+")")}this._container.appendChild(l)};return t}(rl);var pl=function e(){this._version=0;this._init_()};pl.prototype.reset=function e(){this._init_()};pl.prototype._init_=function e(){this._mustUpdate=true;this.maxCoord=0;this.maxScaledSize=0;this.maxMinVisibleSize=0;this.maxSymbolicSize=0;this.maxDashLength=0;this.maxGapLength=0;this.maxPatternScale=0};pl.prototype._mustUpdateBoundary=function e(t,r){return r>t};pl.prototype.set=function e(t){var r=t.maxCoord;var n=t.maxScaledSize;var i=t.maxMinVisibleSize;var a=t.maxSymbolicSize;var o=t.maxDashLength;var s=t.maxGapLength;var u=t.maxPatternScale;var l=this._mustUpdateBoundary(this.maxCoord,r)||this._mustUpdateBoundary(this.maxScaledSize,n)||this._mustUpdateBoundary(this.maxMinVisibleSize,i)||this._mustUpdateBoundary(this.maxSymbolicSize,a)||this._mustUpdateBoundary(this.maxDashLength,o)||this._mustUpdateBoundary(this.maxGapLength,s)||this._mustUpdateBoundary(this.maxPatternScale,u);if(l){this.maxCoord=r;this.maxScaledSize=n;this.maxMinVisibleSize=i;this.maxSymbolicSize=a;this.maxDashLength=o;this.maxGapLength=s;this.maxPatternScale=u;this._mustUpdate=true}return l};pl.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};pl.prototype.getVersion=function e(){return this._version};var _l={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]};var ml=function e(){this._linearEasing=[0,1,0,0,0,1,0,0];this._nameToPolygon={};this._polygonToName={};this.add(_l)};ml.prototype.add=function e(t){var r=this;Object.keys(t).forEach(function(e){var n=t[e].slice();if(n.length<8){n[4]=n[0];n[5]=n[1];n[6]=n[2];n[7]=n[3]}var i=yl(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);r._nameToPolygon[e]=n;r._polygonToName[i]=e})};ml.prototype.getPolygonFromName=function e(t){return this._nameToPolygon[t]||this._linearEasing};ml.prototype.getNameFromPolygon=function e(t,r,n,i,a,o,s,u){var l=yl(t,r,n,i,a,o,s,u);return this._polygonToName[l]||"linear"};function yl(e,t,r,n,i,a,o,s){return e+i+(t+a)*256+(r+o)*65536+(n+s)*16777216}var bl=function e(){this._elementType=ls;this._animated=false;this._size=0;this._capacity=kn;this._depth=0;this._id=0;this._stencilUsage=Es;this._baseElt=Os();this._list=new Array(this._capacity);for(var t=0;t<this._capacity;++t){this._list[t]=Os()}};bl.prototype.setDepth=function e(t){this._depth=t;return this};bl.prototype.reset=function e(t,r,n,i){this._elementType=t;this._animated=r;this._depth=n;this._id=i;this._stencilUsage=Es;this._size=0;return this};bl.prototype.setStencilUsage=function e(t){this._stencilUsage=t};bl.prototype.next=function e(){if(this._size>=this._capacity){throw new Error("internal error: block.next() was called on a full block")}return this._list[this._size++]};bl.prototype.nextAndReset=function e(){var t=this.next();Ps(t.end);Ps(t.start);Ds(t.animation);return t};bl.prototype.forEach=function e(t){this._list.forEach(t)};bl.prototype.getElement=function e(t){return this._list[t]};bl.prototype.getCurrentElement=function e(){return this._list[this._size-1]};bl.prototype.getSize=function e(){return this._size};bl.prototype.getDepth=function e(){return this._depth};bl.prototype.getElements=function e(){return this._list};bl.prototype.getType=function e(){return this._elementType};bl.prototype.getId=function e(){return this._id};bl.prototype.isAnimated=function e(){return this._animated};bl.prototype.getStencilUsage=function e(){return this._stencilUsage};bl.prototype.setGlobalAnimation=function e(t,r,n){for(var i=0;i<this._size;++i){var a=this._list[i].animation;a.duration=t;a.beginTime=r;a.easing=n}};var xl=function e(){this._maps=[]};xl.prototype.reset=function e(){this._maps=[]};xl.prototype.set=function e(t,r,n){var i=t.getId();while(this._maps.length<=i){this._maps.push(new Array(wn))}this._maps[i][r]=n};xl.prototype.get=function e(t,r){return this._maps[t.getId()][r]};var Sl={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return true},hideImages:false,renderBackground:false};var Al={webgl:Ku,canvas:sl,svg:vl,null:js};var El=[0,0,0,0];var wl=function e(t){this._initData=t||{};this._colorManager=new Pr;this._easingManager=new ml;this._patternManager=new Ts;this._shapeManager=new Ls;this._boundariesManager=new pl;this._textManager=new ju(this._patternManager);this._bufferList=new Fs;this._idRecorder=new xl;this._maxCoord=0;this._maxScaledSize=0;this._maxPixelSize=0;this._maxMinVisibleSize=0;this._maxSymbolicSize=0;this._maxDashLength=0;this._maxGapLength=0;this._maxPatternScale=0;this._actualCoordToBytes=1;this._actualScaledSizeToBytes=In;this._actualMinVisibleSizeToBytes=Nn;this._actualSymbolicSizeToBytes=Mn;this._actualDashLengthToBytes=zn;this._actualGapLengthToBytes=zn;this._actualPatternScaleToBytes=Mn;this._blockIdToAddress=new Uint32Array(0);this._currentDataView=null;this._currentElementSize=0;this._currentBlockOffset=0;this._currentByteOffset=0;this._view=G(Sl);this._domElement=typeof document!=="undefined"?document.createElement("div"):Se();this._renderersByType={};this._switchMainRenderer=true;this._renderType=null;this._renderer=null;this._littleEndian=B();this._additionalCanvases=[];this._refreshTexts=false;this._backgroundColor=null};wl.createInitData=function e(){var t={};for(var r=0,n=Object.keys(Al);r<n.length;r+=1){var i=n[r];var a=Al[i];t[i]=a.createInitData()}return t};wl.prototype.addCanvas=function e(t){t.style.touchAction="none";this._resizeCanvas(t);this._additionalCanvases.push(t);this._updateDomElement()};wl.prototype.removeCanvas=function e(t){t.style.touchAction="";F(this._additionalCanvases,t);this._updateDomElement()};wl.prototype._ensureDomElementsFitParent=function e(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px";this._domElement.style.height=this._view.height+"px";for(var t=0;t<this._additionalCanvases.length;++t){this._resizeCanvas(this._additionalCanvases[t])}}};wl.prototype._ensureCorrectBackgroundColor=function e(){if(this._backgroundColor!==this._view.backgroundColor){this._domElement.style.backgroundColor=this._view.backgroundColor;this._backgroundColor=this._view.backgroundColor}};wl.prototype.createBlock=function e(){return new bl};wl.prototype.parseColor=function e(t){return this._colorManager.parseColor(t)};wl.prototype.clear=function e(){this._blockIdToAddress.fill(0);this._patternManager.reset();this._boundariesManager.reset();this._textManager.reset();this._bufferList.reset();this._idRecorder.reset()};wl.prototype.notifyFontsReloaded=function e(){this._patternManager.notifyUpdate();this._textManager.clear();this._refreshTexts=true};wl.prototype.notifyPatternUpdate=function e(){this._patternManager.notifyUpdate()};wl.prototype.getShapePoints=function e(t){return this._shapeManager.getDefinitionFromName(t).points};wl.prototype.checkShapeHit=function e(t,r,n){var i=this._shapeManager.getDefinitionFromName(t);var a=i.getDistanceFromStrokeVertically;var o=i.getDistanceFromStrokeHorizontally;return Math.min(a(r,n),o(r,n))>=0};wl.prototype.setGlobalBoundaries=function e(t){var r=t.maxBlockId;if(r===void 0)r=0;var n=t.maxCoord;var i=t.maxScaledSize;var a=t.maxMinVisibleSize;var o=t.maxSymbolicSize;var s=t.maxDashLength;var u=t.maxGapLength;var l=t.maxPatternScale;if(r>this._blockIdToAddress.length){this._resizeBlockArray(r)}if(this._boundariesManager.set(t)){this._maxCoord=n;this._maxScaledSize=i;this._maxMinVisibleSize=a;this._maxSymbolicSize=o;this._maxDashLength=s;this._maxGapLength=u;this._maxPatternScale=l;this._actualCoordToBytes=1;this._actualScaledSizeToBytes=Fn/i;this._actualMinVisibleSizeToBytes=Nn/a;this._actualSymbolicSizeToBytes=Mn/o;this._actualDashLengthToBytes=zn/s;this._actualGapLengthToBytes=zn/u;this._actualPatternScaleToBytes=Mn/l;return true}return false};wl.prototype._resizeBlockArray=function e(t){var r=new Uint32Array(t);r.set(this._blockIdToAddress);this._blockIdToAddress=r};wl.prototype._clamp=function e(t,r,n){return Math.min(Math.max(t,r),n)};wl.prototype._signedToUnsignedShort=function e(value){return this._clamp(value+32768,0,65535)};wl.prototype._parseColor=function e(t){return this._colorManager.parseColor(t)||El};wl.prototype._colorToBytes=function e(t){var r=this._parseColor(t);var n=Math.round(r[0]*15);var i=Math.round(r[1]*15);var a=Math.round(r[2]*15);var o=Math.round(r[3]*15);return n+(i<<4)+(a<<8)+(o<<12)};wl.prototype._formatAngle=function e(t){return this._clampAngle(t)*(Fn/Ti)};wl.prototype._clampAngle=function e(t){return(t%Ti+Ti)%Ti};wl.prototype._coordToBytes=function e(value){return value};wl.prototype._scaledSizeToBytes=function e(value){return Math.ceil(Math.min(value,this._maxScaledSize)*this._actualScaledSizeToBytes)};wl.prototype._fixedSizeToBytes=function e(value){return value};wl.prototype._minVisibleSizeToBytes=function e(value){return Math.round(Math.min(value,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)};wl.prototype._symbolicSizeToBytes=function e(value){return Math.round(Math.min(value,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)};wl.prototype._dashLengthToBytes=function e(value){return Math.round(Math.min(value,this._maxDashLength)*this._actualDashLengthToBytes)};wl.prototype._gapLengthToBytes=function e(value){return Math.round(Math.min(value,this._maxGapLength)*this._actualGapLengthToBytes)};wl.prototype._patternScaleToBytes=function e(value){return Math.round(Math.min(value,this._maxPatternScale)*this._actualPatternScaleToBytes)};wl.prototype._offsetAngleToBytes=function e(value){return Math.round((value+Ti)%Ti*(8/Ti))};wl.prototype._opacityToBytes=function e(value){return Math.round(Math.min(value,1)*15)};wl.prototype._curvatureToBytes=function e(value){return this._signedToUnsignedByte(value)};wl.prototype._signedToUnsignedByte=function e(value){return this._clamp(value,-128,127)+128};wl.prototype.registerShape=function e(t,r){this._shapeManager.register(t,r)};wl.prototype._bindBlock=function e(t,r,n,i,a,o,s){this._checkBlockId(t);var u=this._blockIdToAddress[t];var l=this._bufferList.allocateBlock(u,r,n,i,a,o,s);this._blockIdToAddress[t]=l.address;this._currentDataView=l.buffer.getDataView();this._currentElementSize=l.buffer.getElementSize();this._currentBlockOffset=l.offset;this._currentByteOffset=this._currentBlockOffset*this._currentElementSize;this._currentSideDataView=l.buffer.getSideDataView();this._currentSideElementSize=l.buffer.getTotalSideElementsSize();this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize;return l};wl.prototype._setItemIndex=function e(t){var r=this._currentBlockOffset+t;this._currentByteOffset=r*this._currentElementSize;this._currentSideByteOffset=r*this._currentSideElementSize};wl.prototype._freeBlock=function e(t){this._checkBlockId(t);var r=this._blockIdToAddress[t];var n=this._bufferList.freeBlock(r);this._blockIdToAddress[t]=n;return n};wl.prototype._checkBlockId=function e(t){if(t>=this._blockIdToAddress.length){this._resizeBlockArray(Qe(t+1))}};wl.prototype._setUint16=function e(t,value){this._currentDataView.setUint16(this._currentByteOffset+t,value,this._littleEndian)};wl.prototype._setInt16=function e(t,value){this._currentDataView.setInt16(this._currentByteOffset+t,value,this._littleEndian)};wl.prototype._setUint8=function e(t,value){this._currentDataView.setUint8(this._currentByteOffset+t,value)};wl.prototype._setInt8=function e(t,value){this._currentDataView.setInt8(this._currentByteOffset+t,value)};wl.prototype._setFloat32=function e(t,value){this._currentDataView.setFloat32(this._currentByteOffset+t,value,this._littleEndian)};wl.prototype._setAnimationBeginTime=function e(t,r){this._setFloat32(t,r)};wl.prototype._setAnimationDuration=function e(t,r){this._setFloat32(t+4,r)};wl.prototype._setAnimationEasing=function e(t,r){var n=this._easingManager.getPolygonFromName(r);this._setUint16(t+8,(n[0]+128<<8)+(n[4]+128));this._setUint16(t+10,(n[1]+128<<8)+(n[5]+128));this._setUint16(t+12,(n[2]+128<<8)+(n[6]+128));this._setUint16(t+14,(n[3]+128<<8)+(n[7]+128))};wl.prototype._setTextCharacters=function e(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)};wl.prototype._storeGenericObject=function e(t,r){var n=this._shapeManager.getIdFromName(r.shape);var i=r.pieceId;var a=this._dashLengthToBytes(r.dashLength);var o=this._gapLengthToBytes(r.gapLength);var s=+r.hasHead;var u=+r.hasTail;var l=+r.isBodyTriangle;var d=+r.isSelfLoop;var f=this._patternScaleToBytes(r.patternScale);var h=this._offsetAngleToBytes(r.offsetAngle);var c=+r.isText;var g=+r.adjustTextAngle;var v=+r.unusedFlag1;var p=+r.unusedFlag2;var _=+r.unusedFlag3;var m=this._opacityToBytes(r.opacity);var y=this._minVisibleSizeToBytes(r.globalMinVisibleSize);var b=this._minVisibleSizeToBytes(r.strokeMinVisibleSize);var x=this._minVisibleSizeToBytes(r.patternMinVisibleSize);var S=this._symbolicSizeToBytes(r.symbolicSize);var A=this._curvatureToBytes(r.curvature);var E=this._patternManager.getIdFromDefinition(r.pattern);var w=this._colorToBytes(r.fillColor);var k=this._colorToBytes(r.strokeColor);var C=this._colorToBytes(r.patternColor);var T=this._coordToBytes(r.x1);var L=this._coordToBytes(r.y1);var M=this._coordToBytes(r.x2);var I=this._coordToBytes(r.y2);var F=this._scaledSizeToBytes(r.rectWidthOrSourceRadiusScaled);var N=this._fixedSizeToBytes(r.rectWidthOrSourceRadiusFixed);var z=this._scaledSizeToBytes(r.rectHeightTargetRadiusScaled);var R=this._fixedSizeToBytes(r.rectHeightTargetRadiusFixed);var P=this._scaledSizeToBytes(r.thicknessOrFontSizeScaled);var D=this._fixedSizeToBytes(r.thicknessOrFontSizeFixed);var O=this._scaledSizeToBytes(r.strokeWidthScaled);var B=this._fixedSizeToBytes(r.strokeWidthFixed);var j=this._scaledSizeToBytes(r.offsetScaled);var V=this._fixedSizeToBytes(r.offsetFixed);var U=n+(i<<4)+(a<<8)+(o<<10)+(s<<12)+(u<<13)+(l<<14)+(d<<15);var G=f+(h<<8)+(c<<11)+(g<<12)+(v<<13)+(p<<14)+(_<<15);var W=m+(y<<4)+(b<<8)+(x<<12);var H=S+(A<<8);this._setUint16(t+0,U);this._setUint16(t+2,G);this._setUint16(t+4,W);this._setUint16(t+6,H);this._setUint16(t+8,E);this._setUint16(t+10,w);this._setUint16(t+12,k);this._setUint16(t+14,C);this._setFloat32(t+16,T);this._setFloat32(t+20,L);this._setFloat32(t+24,M);this._setFloat32(t+28,I);this._setUint16(t+32,F);this._setUint16(t+34,N);this._setUint16(t+36,z);this._setUint16(t+38,R);this._setUint16(t+40,P);this._setUint16(t+42,D);this._setUint16(t+44,O);this._setUint16(t+46,B);this._setUint16(t+48,j);this._setUint16(t+50,V)};wl.prototype._storeAnimationInformation=function e(t,r){this._setAnimationBeginTime(t,r.beginTime);this._setAnimationDuration(t,r.duration);this._setAnimationEasing(t,r.easing)};wl.prototype._storeElement=function e(t,r){this._storeGenericObject(0,t.end);if(r){this._storeGenericObject(Zn,t.start);this._storeAnimationInformation(Zn*2,t.animation)}};wl.prototype.storeBlock=function e(t,r){if(!r||!r.getSize()){return this._freeBlock(t)}var n=r.getType();var i=r.getDepth();var a=r.getSize();var o=r.getElements();var s=r.isAnimated();var u=r.getStencilUsage();var l=r.getId();var d=0;if(n===ds){for(var f=0;f<a;++f){var h=o[f];if(h.end.pattern.type===ms){d=Math.max(d,h.end.pattern.attributes.text.length)}if(s&&h.start.pattern.type===ms){d=Math.max(d,h.start.pattern.attributes.text.length)}}}var c=this._bindBlock(t,n,s,i,a,d,u);for(var g=0;g<a;++g){var v=o[g];this._setItemIndex(g);this._storeElement(v,s);this._idRecorder.set(c.buffer,c.offset+g,l)}if(n===ds){for(var p=0;p<a;++p){var _=o[p];this._setItemIndex(p);this._setTextCharacters(_.end.pattern)}}return c.address};wl.prototype.freeBlock=function e(t){return this._freeBlock(t)};wl.prototype._refreshTextElements=function e(){var t=this._bufferList.getBuffers();for(var r=0,n=t;r<n.length;r+=1){var i=n[r];if(i&&i.getElementType()===ds){var a=i.getSideDataView();var o=i.getTotalSideElementsSize();var s=i.getSize();var u=0;var l=o;for(var d=0;d<s;++d){var f=this._textManager.extractTextFromDataView(a,u,l);this._textManager.storeTextInDataView(a,u,l,f);u=l;l+=o}i.triggerUpdate()}}};wl.prototype._extractElement=function e(t,r){if(!t){return null}var n=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(n.buffer,n.offset+r)};wl.prototype.extractElement=function e(t,r){if(r===void 0)r=0;return this._extractElement(t,r)};wl.prototype.getDomElement=function e(){return this._domElement};wl.prototype.measureText=function e(t,r,n,i){if(i===void 0)i=1;return this._textManager.measureText(t,r,n,i)};wl.prototype.setRenderType=function e(t){if(this._renderType!==t){this._renderType=t;this._switchMainRenderer=true}};wl.prototype._ensureMainRendererReady=function e(){if(this._switchMainRenderer){var t=Al[this._renderType];if(!t||!t.isAvailable()){this._renderType="canvas"}this._renderer=this._renderersByType[this._renderType];if(!this._renderer){this._renderer=this._instanciateRenderer(this._renderType);this._renderersByType[this._renderType]=this._renderer}this._updateDomElement()}};wl.prototype._updateDomElement=function e(){var t=this._renderer&&this._renderer.getDomElement();while(this._domElement.firstChild){this._domElement.removeChild(this._domElement.firstChild)}if(t){this._appendDomChild(t)}for(var r=0;r<this._additionalCanvases.length;++r){this._appendDomChild(this._additionalCanvases[r])}};wl.prototype._appendDomChild=function e(t){t.style.position="absolute";t.style.left="0";t.style.top="0";this._domElement.appendChild(t)};wl.prototype._instanciateRenderer=function e(t){var r=Al[t]||js;return new r({initData:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,idRecorder:this._idRecorder})};wl.prototype.setView=function e(t){Object.assign(this._view,t)};wl.prototype._updateManagers=function e(){this._patternManager.setPixelRatio(this._view.pixelRatio);this._shapeManager.update();this._patternManager.update();this._textManager.update();this._boundariesManager.update();this._bufferList.update();if(this._refreshTexts){this._refreshTexts=false;this._refreshTextElements()}};wl.prototype._resizeCanvas=function e(t){Bs(t,this._view.width,this._view.height,this._view.pixelRatio)};wl.prototype.render=function e(){this._ensureMainRendererReady();this._ensureDomElementsFitParent();this._ensureCorrectBackgroundColor();this._updateManagers();this._renderer.renderFrame(this._view)};wl.prototype.ensureAnimationsReady=function e(){this._ensureMainRendererReady();this._renderer.ensureAnimationsReady()};wl.prototype.export=function e(t,r,n){var i=this._instanciateRenderer(t);var a=Object.assign({},this._view,r);i.setViewportClipping(false);a.renderBackground=true;this._updateManagers();i.renderFrame(a);return i.export(n).then(function(){return i.getDomElement()})};wl.prototype.getCurrentTime=function e(){return $t()};wl.prototype.getImageData=function e(){return this._renderer&&this._renderer.getImageData()};wl.prototype.destroy=function e(){for(var t=0,r=Object.keys(this._renderersByType);t<r.length;t+=1){var n=r[t];var i=this._renderersByType[n];if(i){i.destroy()}}};wl.prototype.transparentify=function e(t){var r=this._parseColor(t);var n=Math.round(r[0]*255);var i=Math.round(r[1]*255);var a=Math.round(r[2]*255);return"rgba("+n+","+i+","+a+",0)"};wl.prototype.initDebugRenderingLoop=function e(t){var r=this;if(t===void 0)t={};var n=t.triggerKey;if(n===void 0)n="r";var i=t.start;if(i===void 0)i=true;var a=i;document.addEventListener("keydown",function(e){var t=e.key;if(t===n){a=!a}});var o=function(e){if(a||e){r.setView({currentTime:$t()});r.render()}window.requestAnimationFrame(function(){o()})};window.requestAnimationFrame(function(){document.body.appendChild(r.getDomElement());o(true)})};var kl=function(e){function t(){e.call(this);this.isDummy=true;this.width=0;this.height=0}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={src:{configurable:true}};r.src.set=function(e){var t=this;if(e){this._src=e;setTimeout(function(){if(t.onload){t.onload.call(t)}t.width=1;t.height=1;t.fire("load")},10)}};r.src.get=function(){return this._src};t.prototype.addEventListener=function e(t,r){this.on(t,r)};Object.defineProperties(t.prototype,r);return t}(zr);var Cl=typeof Image!=="undefined"?Image:kl;var Tl=function e(){this._images={};this._crossOrigin="anonymous";this._whenReady=[];this._onFetch=[];this._nbLoaded=0;this._nbToLoad=0};Tl.prototype.setImgCrossOrigin=function e(t){this._crossOrigin=t};Tl.prototype.clear=function e(){this._images={};this._nbLoaded=0;this._nbToLoad=0};Tl.prototype.getImage=function e(t){var r=this;var n=this._images[t];if(n===undefined){this._nbToLoad+=1;n=new Cl;n.crossOrigin=this._crossOrigin;n.onload=function(){return r._onImgLoad(t)};n.onerror=function(){r._onImgLoad(t);r._images[t]=null};n.src=t;this._images[t]=n}return n};Tl.prototype._onImgLoad=function e(t){this._nbLoaded+=1;this._onFetch.forEach(function(e){return e(t)});if(this._nbLoaded===this._nbToLoad){this._whenReady.forEach(function(e){return e()});this._whenReady=[]}};Tl.prototype.onFetch=function e(t){this._onFetch.push(t)};Tl.prototype.whenReady=function e(){var t=this;if(this._nbLoaded===this._nbToLoad){return Promise.resolve()}else{return new Promise(function(e){return t._whenReady.push(e)})}};Tl.prototype.destroy=function e(){this._whenReady=[];this._onFetch=[]};var Ll=function e(t,r){this._attributesManager=t;this._id=r};Ll.prototype.getDefinition=function e(){return this._attributesManager.getAttributeLayerDefinition(this._id)};Ll.prototype.update=function e(t){this._attributesManager.updateAttributeLayer(this._id,t)};Ll.prototype.destroy=function e(){this._attributesManager.destroyAttributeLayer(this._id)};Ll.prototype.updateElements=function e(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)};Ll.prototype.updateAll=function e(){this._attributesManager.updateAllForAttributeLayer(this._id)};Ll.prototype.setAttributeValues=function e(t,r,n){this._attributesManager.setAttributeLayerValues(this._id,t,r,n)};Ll.prototype.getUsedAttributeNames=function e(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)};Ll.prototype.getFlexArrays=function e(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)};var Ml=1;var Il=2;var Fl=3;var Nl=4;var zl=5;var Rl=6;var Pl="_visible";var Dl="_data";var Ol="_hovered";var Bl="_hoverExtremityHighlighted";var jl="_selected";var Vl="_selectionExtremityHighlighted";var Ul="_dragged";var Gl="_rewirable";var Wl="_export";var Hl="_faded";var Xl="_transparent";var ql=[jl,Ul,Vl,Ol,Bl,Gl,Wl,Hl,Xl];var Yl=2;var Zl=3;var Kl=3;var Ql=4;var Jl=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"];var $l={storage:1,default:0};var ed=function e(t){var r=t.ogma;var n=t.isNode;var i=t.includeRemovedElements;this._isNode=n;this._graph=r.modules.graph;this._includeRemovedElements=i;this._EltList=n?r.NodeList:r.EdgeList;this._flexArray=n?this._graph.createNodeAttribute($l):this._graph.createEdgeAttribute($l);this._all=false;this._indexList=this._graph.createIndexList(n)};ed.prototype._getAllIndexes=function e(){var t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex();var r=new Uint32Array(t);for(var n=1;n<=t;++n){r[n-1]=n}return r};ed.prototype.addAll=function e(){this._all=true};ed.prototype.add=function e(t){if(this._all){return}for(var r=0,n=t._indexes;r<n.length;r+=1){var i=n[r];this._addIndex(i)}};ed.prototype._addIndex=function e(t){if(this._flexArray.get(t)===0){this._flexArray.set(t,1);this._indexList.push(t)}};ed.prototype.isEmpty=function e(){return!this._all&&this._indexList.isEmpty()};ed.prototype.isFull=function e(){return this._all};ed.prototype.getListAndClear=function e(){var t=this.getList();this.clear();return t};ed.prototype.getList=function e(){var t=null;if(this._all&&!this._includeRemovedElements){t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all")}else{var r=this._all?this._getAllIndexes():this._indexList.slice();t=new this._EltList(r)}return t};ed.prototype.clear=function e(){this._all=false;if(!this._indexList.isEmpty()){this._indexList.reset();this._flexArray.reset()}};ed.prototype.addSet=function e(t){if(t._all){this.addAll()}else{var r=t._indexList.getBuffer();var n=t._indexList.getLength();for(var i=0;i<n;++i){this._addIndex(r[i])}}};var td={name:"animationStart",storage:32,default:0};var rd={name:"animationDuration",storage:16,default:0};var nd={name:"animationEasing",storage:"resource",default:"linear"};var id={self:{attributes:"all",tags:[],selection:true,hover:false,data:true},adjacentNodes:{attributes:"all",tags:[],selection:true,hover:false,data:true},adjacentEdges:{attributes:"all",tags:[],selection:true,hover:false,data:true},allNodes:null,allEdges:null};var ad={self:{attributes:"all",tags:[],selection:true,hover:false,data:true},extremities:{attributes:"all",tags:[],selection:true,hover:false,data:true},parallelEdges:{attributes:"all",tags:[],selection:true,hover:false,data:true},allNodes:null,allEdges:null};var od=["x","y","radius","halo.hideNonAdjacentEdges"];var sd={set:function(){},check:function(){return undefined},get:function(e,t){return{x:e.x.get(t),y:e.y.get(t),radius:e.radius.get(t),scalingMethod:e.scalingMethod.get(t),color:e.color.get(t),opacity:e.opacity.get(t),shape:e.shape.get(t),layer:e.layer.get(t),detectable:e.detectable.get(t),draggable:e.draggable.get(t),layoutable:e.layoutable.get(t),innerStroke:{width:e.innerStroke.width.get(t),scalingMethod:e.innerStroke.scalingMethod.get(t),color:e.innerStroke.color.get(t),minVisibleSize:e.innerStroke.minVisibleSize.get(t)},outerStroke:{width:e.outerStroke.width.get(t),scalingMethod:e.outerStroke.scalingMethod.get(t),color:e.outerStroke.color.get(t),minVisibleSize:e.outerStroke.minVisibleSize.get(t)},badges:{topLeft:{color:e.badges.topLeft.color.get(t),scale:e.badges.topLeft.scale.get(t),positionScale:e.badges.topLeft.positionScale.get(t),minVisibleSize:e.badges.topLeft.minVisibleSize.get(t),image:{url:e.badges.topLeft.image.url.get(t),scale:e.badges.topLeft.image.scale.get(t)},stroke:{color:e.badges.topLeft.stroke.color.get(t),width:e.badges.topLeft.stroke.width.get(t),scalingMethod:e.badges.topLeft.stroke.scalingMethod.get(t)},text:{content:e.badges.topLeft.text.content.get(t),color:e.badges.topLeft.text.color.get(t),font:e.badges.topLeft.text.font.get(t),style:e.badges.topLeft.text.style.get(t),scale:e.badges.topLeft.text.scale.get(t)}},topRight:{color:e.badges.topRight.color.get(t),scale:e.badges.topRight.scale.get(t),positionScale:e.badges.topRight.positionScale.get(t),minVisibleSize:e.badges.topRight.minVisibleSize.get(t),image:{url:e.badges.topRight.image.url.get(t),scale:e.badges.topRight.image.scale.get(t)},stroke:{color:e.badges.topRight.stroke.color.get(t),width:e.badges.topRight.stroke.width.get(t),scalingMethod:e.badges.topRight.stroke.scalingMethod.get(t)},text:{content:e.badges.topRight.text.content.get(t),color:e.badges.topRight.text.color.get(t),font:e.badges.topRight.text.font.get(t),style:e.badges.topRight.text.style.get(t),scale:e.badges.topRight.text.scale.get(t)}},bottomLeft:{color:e.badges.bottomLeft.color.get(t),scale:e.badges.bottomLeft.scale.get(t),positionScale:e.badges.bottomLeft.positionScale.get(t),minVisibleSize:e.badges.bottomLeft.minVisibleSize.get(t),image:{url:e.badges.bottomLeft.image.url.get(t),scale:e.badges.bottomLeft.image.scale.get(t)},stroke:{color:e.badges.bottomLeft.stroke.color.get(t),width:e.badges.bottomLeft.stroke.width.get(t),scalingMethod:e.badges.bottomLeft.stroke.scalingMethod.get(t)},text:{content:e.badges.bottomLeft.text.content.get(t),color:e.badges.bottomLeft.text.color.get(t),font:e.badges.bottomLeft.text.font.get(t),style:e.badges.bottomLeft.text.style.get(t),scale:e.badges.bottomLeft.text.scale.get(t)}},bottomRight:{color:e.badges.bottomRight.color.get(t),scale:e.badges.bottomRight.scale.get(t),positionScale:e.badges.bottomRight.positionScale.get(t),minVisibleSize:e.badges.bottomRight.minVisibleSize.get(t),image:{url:e.badges.bottomRight.image.url.get(t),scale:e.badges.bottomRight.image.scale.get(t)},stroke:{color:e.badges.bottomRight.stroke.color.get(t),width:e.badges.bottomRight.stroke.width.get(t),scalingMethod:e.badges.bottomRight.stroke.scalingMethod.get(t)},text:{content:e.badges.bottomRight.text.content.get(t),color:e.badges.bottomRight.text.color.get(t),font:e.badges.bottomRight.text.font.get(t),style:e.badges.bottomRight.text.style.get(t),scale:e.badges.bottomRight.text.scale.get(t)}}},halo:{color:e.halo.color.get(t),width:e.halo.width.get(t),scalingMethod:e.halo.scalingMethod.get(t),strokeColor:e.halo.strokeColor.get(t),strokeWidth:e.halo.strokeWidth.get(t),clustering:e.halo.clustering.get(t),hideNonAdjacentEdges:e.halo.hideNonAdjacentEdges.get(t)},pulse:{enabled:e.pulse.enabled.get(t),duration:e.pulse.duration.get(t),interval:e.pulse.interval.get(t),startColor:e.pulse.startColor.get(t),endColor:e.pulse.endColor.get(t),width:e.pulse.width.get(t),startRatio:e.pulse.startRatio.get(t),endRatio:e.pulse.endRatio.get(t)},icon:{content:e.icon.content.get(t),font:e.icon.font.get(t),color:e.icon.color.get(t),scale:e.icon.scale.get(t),style:e.icon.style.get(t),minVisibleSize:e.icon.minVisibleSize.get(t)},image:{url:e.image.url.get(t),scale:e.image.scale.get(t),fit:e.image.fit.get(t),tile:e.image.tile.get(t),minVisibleSize:e.image.minVisibleSize.get(t)},outline:{enabled:e.outline.enabled.get(t),color:e.outline.color.get(t),minVisibleSize:e.outline.minVisibleSize.get(t)},text:{content:e.text.content.get(t),font:e.text.font.get(t),color:e.text.color.get(t),size:e.text.size.get(t),scale:e.text.scale.get(t),style:e.text.style.get(t),align:e.text.align.get(t),margin:e.text.margin.get(t),padding:e.text.padding.get(t),backgroundColor:e.text.backgroundColor.get(t),tip:e.text.tip.get(t),minVisibleSize:e.text.minVisibleSize.get(t),scaling:e.text.scaling.get(t),position:e.text.position.get(t),maxLineLength:e.text.maxLineLength.get(t),truncateLength:e.text.truncateLength.get(t),secondary:{content:e.text.secondary.content.get(t),font:e.text.secondary.font.get(t),color:e.text.secondary.color.get(t),size:e.text.secondary.size.get(t),scale:e.text.secondary.scale.get(t),style:e.text.secondary.style.get(t),align:e.text.secondary.align.get(t),margin:e.text.secondary.margin.get(t),padding:e.text.secondary.padding.get(t),backgroundColor:e.text.secondary.backgroundColor.get(t),minVisibleSize:e.text.secondary.minVisibleSize.get(t)}}}},nested:{x:{check:function(e){return typeof e==="number"&&isFinite(e)?e:undefined},set:function(e,t,value){e.x.set(t,value)},get:function(e,t){return e.x.get(t)},nested:{}},y:{check:function(e){return typeof e==="number"&&isFinite(e)?e:undefined},set:function(e,t,value){e.y.set(t,value)},get:function(e,t){return e.y.get(t)},nested:{}},radius:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:5*t/100}},set:function(e,t,value){e.radius.set(t,value)},get:function(e,t){return e.radius.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.scalingMethod.set(t,value)},get:function(e,t){return e.scalingMethod.get(t)},nested:{}},color:{check:function(e,t){if(t.parseColor(e)){return e}if(Array.isArray(e)){if(e.length<1){return undefined}for(var r=0;r<e.length;++r){if(!t.parseColor(e[r])){return undefined}}return e}return undefined},set:function(e,t,value){e.color.set(t,value)},get:function(e,t){return e.color.get(t)},nested:{}},opacity:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.opacity.set(t,value)},get:function(e,t){return e.opacity.get(t)},nested:{}},hidden:{set:function(e,t,value){e.opacity.set(t,value===undefined?undefined:+!value)},check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},get:function(e,t){return e.opacity.get(t)===0},nested:{}},shape:{check:function(e){if(e==="equilateral"){return"pentagon"}return e==="circle"||e==="square"||e==="cross"||e==="diamond"||e==="pentagon"||e==="star"?e:undefined},set:function(e,t,value){e.shape.set(t,value)},get:function(e,t){return e.shape.get(t)},nested:{}},layer:{check:function(e){return typeof e==="number"&&isFinite(e)&&e%1===0&&e>=-1&&e<=4?e:undefined},set:function(e,t,value){e.layer.set(t,value)},get:function(e,t){return e.layer.get(t)},nested:{}},detectable:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.detectable.set(t,value)},get:function(e,t){return e.detectable.get(t)},nested:{}},draggable:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.draggable.set(t,value)},get:function(e,t){return e.draggable.get(t)},nested:{}},layoutable:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.layoutable.set(t,value)},get:function(e,t){return e.layoutable.get(t)},nested:{}},innerStroke:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.outerStroke.color.set(t,value)},get:function(e,t){return e.outerStroke.color.get(t)},nested:{width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.innerStroke.width.set(t,value)},get:function(e,t){return e.innerStroke.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.innerStroke.scalingMethod.set(t,value)},get:function(e,t){return e.innerStroke.scalingMethod.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.innerStroke.color.set(t,value)},get:function(e,t){return e.innerStroke.color.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.innerStroke.minVisibleSize.set(t,value)},get:function(e,t){return e.innerStroke.minVisibleSize.get(t)},nested:{}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.innerStroke.minVisibleSize.set(t,value)},get:function(e,t){return e.innerStroke.minVisibleSize.get(t)},nested:{}}}},outerStroke:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.outerStroke.color.set(t,value)},get:function(e,t){return e.outerStroke.color.get(t)},nested:{width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:5*t/100}},set:function(e,t,value){e.outerStroke.width.set(t,value)},get:function(e,t){return e.outerStroke.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.outerStroke.scalingMethod.set(t,value)},get:function(e,t){return e.outerStroke.scalingMethod.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.outerStroke.color.set(t,value)},get:function(e,t){return e.outerStroke.color.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:0*t/100}},set:function(e,t,value){e.outerStroke.minVisibleSize.set(t,value)},get:function(e,t){return e.outerStroke.minVisibleSize.get(t)},nested:{}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:0*t/100}},set:function(e,t,value){e.outerStroke.minVisibleSize.set(t,value)},get:function(e,t){return e.outerStroke.minVisibleSize.get(t)},nested:{}}}},badges:{set:function(e,t,value){e.badges.topLeft.text.content.set(t,value);e.badges.topLeft.image.url.set(t,value);e.badges.topRight.text.content.set(t,value);e.badges.topRight.image.url.set(t,value);e.badges.bottomLeft.text.content.set(t,value);e.badges.bottomLeft.image.url.set(t,value);e.badges.bottomRight.text.content.set(t,value);e.badges.bottomRight.image.url.set(t,value)},check:function(e){return e===null?e:undefined},get:function(e,t){return{topLeft:{color:e.badges.topLeft.color.get(t),scale:e.badges.topLeft.scale.get(t),positionScale:e.badges.topLeft.positionScale.get(t),minVisibleSize:e.badges.topLeft.minVisibleSize.get(t),image:{url:e.badges.topLeft.image.url.get(t),scale:e.badges.topLeft.image.scale.get(t)},stroke:{color:e.badges.topLeft.stroke.color.get(t),width:e.badges.topLeft.stroke.width.get(t),scalingMethod:e.badges.topLeft.stroke.scalingMethod.get(t)},text:{content:e.badges.topLeft.text.content.get(t),color:e.badges.topLeft.text.color.get(t),font:e.badges.topLeft.text.font.get(t),style:e.badges.topLeft.text.style.get(t),scale:e.badges.topLeft.text.scale.get(t)}},topRight:{color:e.badges.topRight.color.get(t),scale:e.badges.topRight.scale.get(t),positionScale:e.badges.topRight.positionScale.get(t),minVisibleSize:e.badges.topRight.minVisibleSize.get(t),image:{url:e.badges.topRight.image.url.get(t),scale:e.badges.topRight.image.scale.get(t)},stroke:{color:e.badges.topRight.stroke.color.get(t),width:e.badges.topRight.stroke.width.get(t),scalingMethod:e.badges.topRight.stroke.scalingMethod.get(t)},text:{content:e.badges.topRight.text.content.get(t),color:e.badges.topRight.text.color.get(t),font:e.badges.topRight.text.font.get(t),style:e.badges.topRight.text.style.get(t),scale:e.badges.topRight.text.scale.get(t)}},bottomLeft:{color:e.badges.bottomLeft.color.get(t),scale:e.badges.bottomLeft.scale.get(t),positionScale:e.badges.bottomLeft.positionScale.get(t),minVisibleSize:e.badges.bottomLeft.minVisibleSize.get(t),image:{url:e.badges.bottomLeft.image.url.get(t),scale:e.badges.bottomLeft.image.scale.get(t)},stroke:{color:e.badges.bottomLeft.stroke.color.get(t),width:e.badges.bottomLeft.stroke.width.get(t),scalingMethod:e.badges.bottomLeft.stroke.scalingMethod.get(t)},text:{content:e.badges.bottomLeft.text.content.get(t),color:e.badges.bottomLeft.text.color.get(t),font:e.badges.bottomLeft.text.font.get(t),style:e.badges.bottomLeft.text.style.get(t),scale:e.badges.bottomLeft.text.scale.get(t)}},bottomRight:{color:e.badges.bottomRight.color.get(t),scale:e.badges.bottomRight.scale.get(t),positionScale:e.badges.bottomRight.positionScale.get(t),minVisibleSize:e.badges.bottomRight.minVisibleSize.get(t),image:{url:e.badges.bottomRight.image.url.get(t),scale:e.badges.bottomRight.image.scale.get(t)},stroke:{color:e.badges.bottomRight.stroke.color.get(t),width:e.badges.bottomRight.stroke.width.get(t),scalingMethod:e.badges.bottomRight.stroke.scalingMethod.get(t)},text:{content:e.badges.bottomRight.text.content.get(t),color:e.badges.bottomRight.text.color.get(t),font:e.badges.bottomRight.text.font.get(t),style:e.badges.bottomRight.text.style.get(t),scale:e.badges.bottomRight.text.scale.get(t)}}}},nested:{topLeft:{set:function(e,t,value){e.badges.topLeft.text.content.set(t,value);if(value===null||value===undefined){e.badges.topLeft.image.url.set(t,value)}},check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},get:function(e,t){return e.badges.topLeft.text.content.get(t)},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.topLeft.color.set(t,value)},get:function(e,t){return e.badges.topLeft.color.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.45*t/100}},set:function(e,t,value){e.badges.topLeft.scale.set(t,value)},get:function(e,t){return e.badges.topLeft.scale.get(t)},nested:{}},positionScale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.badges.topLeft.positionScale.set(t,value)},get:function(e,t){return e.badges.topLeft.positionScale.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.topLeft.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.topLeft.minVisibleSize.get(t)},nested:{}},image:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topLeft.image.url.set(t,value)},get:function(e,t){return e.badges.topLeft.image.url.get(t)},nested:{url:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topLeft.image.url.set(t,value)},get:function(e,t){return e.badges.topLeft.image.url.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:1*t/100}},set:function(e,t,value){e.badges.topLeft.image.scale.set(t,value)},get:function(e,t){return e.badges.topLeft.image.scale.get(t)},nested:{}}}},stroke:{set:function(){},check:function(){return undefined},get:function(e,t){return{color:e.badges.topLeft.stroke.color.get(t),width:e.badges.topLeft.stroke.width.get(t),scalingMethod:e.badges.topLeft.stroke.scalingMethod.get(t)}},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.topLeft.stroke.color.set(t,value)},get:function(e,t){return e.badges.topLeft.stroke.color.get(t)},nested:{}},width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.badges.topLeft.stroke.width.set(t,value)},get:function(e,t){return e.badges.topLeft.stroke.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.badges.topLeft.stroke.scalingMethod.set(t,value)},get:function(e,t){return e.badges.topLeft.stroke.scalingMethod.get(t)},nested:{}}}},text:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topLeft.text.content.set(t,value)},get:function(e,t){return e.badges.topLeft.text.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topLeft.text.content.set(t,value)},get:function(e,t){return e.badges.topLeft.text.content.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.topLeft.text.color.set(t,value)},get:function(e,t){return e.badges.topLeft.text.color.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.badges.topLeft.text.font.set(t,value)},get:function(e,t){return e.badges.topLeft.text.font.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.badges.topLeft.text.style.set(t,value)},get:function(e,t){return e.badges.topLeft.text.style.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.5*t/100}},set:function(e,t,value){e.badges.topLeft.text.scale.set(t,value)},get:function(e,t){return e.badges.topLeft.text.scale.get(t)},nested:{}}}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.topLeft.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.topLeft.minVisibleSize.get(t)},nested:{}}}},topRight:{set:function(e,t,value){e.badges.topRight.text.content.set(t,value);if(value===null||value===undefined){e.badges.topRight.image.url.set(t,value)}},check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},get:function(e,t){return e.badges.topRight.text.content.get(t)},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.topRight.color.set(t,value)},get:function(e,t){return e.badges.topRight.color.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.45*t/100}},set:function(e,t,value){e.badges.topRight.scale.set(t,value)},get:function(e,t){return e.badges.topRight.scale.get(t)},nested:{}},positionScale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.badges.topRight.positionScale.set(t,value)},get:function(e,t){return e.badges.topRight.positionScale.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.topRight.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.topRight.minVisibleSize.get(t)},nested:{}},image:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topRight.image.url.set(t,value)},get:function(e,t){return e.badges.topRight.image.url.get(t)},nested:{url:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topRight.image.url.set(t,value)},get:function(e,t){return e.badges.topRight.image.url.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:1*t/100}},set:function(e,t,value){e.badges.topRight.image.scale.set(t,value)},get:function(e,t){return e.badges.topRight.image.scale.get(t)},nested:{}}}},stroke:{set:function(){},check:function(){return undefined},get:function(e,t){return{color:e.badges.topRight.stroke.color.get(t),width:e.badges.topRight.stroke.width.get(t),scalingMethod:e.badges.topRight.stroke.scalingMethod.get(t)}},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.topRight.stroke.color.set(t,value)},get:function(e,t){return e.badges.topRight.stroke.color.get(t)},nested:{}},width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.badges.topRight.stroke.width.set(t,value)},get:function(e,t){return e.badges.topRight.stroke.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.badges.topRight.stroke.scalingMethod.set(t,value)},get:function(e,t){return e.badges.topRight.stroke.scalingMethod.get(t)},nested:{}}}},text:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topRight.text.content.set(t,value)},get:function(e,t){return e.badges.topRight.text.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.topRight.text.content.set(t,value)},get:function(e,t){return e.badges.topRight.text.content.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.topRight.text.color.set(t,value)},get:function(e,t){return e.badges.topRight.text.color.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.badges.topRight.text.font.set(t,value)},get:function(e,t){return e.badges.topRight.text.font.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.badges.topRight.text.style.set(t,value)},get:function(e,t){return e.badges.topRight.text.style.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.5*t/100}},set:function(e,t,value){e.badges.topRight.text.scale.set(t,value)},get:function(e,t){return e.badges.topRight.text.scale.get(t)},nested:{}}}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.topRight.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.topRight.minVisibleSize.get(t)},nested:{}}}},bottomLeft:{set:function(e,t,value){e.badges.bottomLeft.text.content.set(t,value);if(value===null||value===undefined){e.badges.bottomLeft.image.url.set(t,value)}},check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},get:function(e,t){return e.badges.bottomLeft.text.content.get(t)},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.bottomLeft.color.set(t,value)},get:function(e,t){return e.badges.bottomLeft.color.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.45*t/100}},set:function(e,t,value){e.badges.bottomLeft.scale.set(t,value)},get:function(e,t){return e.badges.bottomLeft.scale.get(t)},nested:{}},positionScale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.badges.bottomLeft.positionScale.set(t,value)},get:function(e,t){return e.badges.bottomLeft.positionScale.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.bottomLeft.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.bottomLeft.minVisibleSize.get(t)},nested:{}},image:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomLeft.image.url.set(t,value)},get:function(e,t){return e.badges.bottomLeft.image.url.get(t)},nested:{url:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomLeft.image.url.set(t,value)},get:function(e,t){return e.badges.bottomLeft.image.url.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:1*t/100}},set:function(e,t,value){e.badges.bottomLeft.image.scale.set(t,value)},get:function(e,t){return e.badges.bottomLeft.image.scale.get(t)},nested:{}}}},stroke:{set:function(){},check:function(){return undefined},get:function(e,t){return{color:e.badges.bottomLeft.stroke.color.get(t),width:e.badges.bottomLeft.stroke.width.get(t),scalingMethod:e.badges.bottomLeft.stroke.scalingMethod.get(t)}},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.bottomLeft.stroke.color.set(t,value)},get:function(e,t){return e.badges.bottomLeft.stroke.color.get(t)},nested:{}},width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.badges.bottomLeft.stroke.width.set(t,value)},get:function(e,t){return e.badges.bottomLeft.stroke.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.badges.bottomLeft.stroke.scalingMethod.set(t,value)},get:function(e,t){return e.badges.bottomLeft.stroke.scalingMethod.get(t)},nested:{}}}},text:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomLeft.text.content.set(t,value)},get:function(e,t){return e.badges.bottomLeft.text.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomLeft.text.content.set(t,value)},get:function(e,t){return e.badges.bottomLeft.text.content.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.bottomLeft.text.color.set(t,value)},get:function(e,t){return e.badges.bottomLeft.text.color.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.badges.bottomLeft.text.font.set(t,value)},get:function(e,t){return e.badges.bottomLeft.text.font.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.badges.bottomLeft.text.style.set(t,value)},get:function(e,t){return e.badges.bottomLeft.text.style.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.5*t/100}},set:function(e,t,value){e.badges.bottomLeft.text.scale.set(t,value)},get:function(e,t){return e.badges.bottomLeft.text.scale.get(t)},nested:{}}}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.bottomLeft.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.bottomLeft.minVisibleSize.get(t)},nested:{}}}},bottomRight:{set:function(e,t,value){e.badges.bottomRight.text.content.set(t,value);if(value===null||value===undefined){e.badges.bottomRight.image.url.set(t,value)}},check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},get:function(e,t){return e.badges.bottomRight.text.content.get(t)},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.bottomRight.color.set(t,value)},get:function(e,t){return e.badges.bottomRight.color.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.45*t/100}},set:function(e,t,value){e.badges.bottomRight.scale.set(t,value)},get:function(e,t){return e.badges.bottomRight.scale.get(t)},nested:{}},positionScale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.badges.bottomRight.positionScale.set(t,value)},get:function(e,t){return e.badges.bottomRight.positionScale.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.bottomRight.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.bottomRight.minVisibleSize.get(t)},nested:{}},image:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomRight.image.url.set(t,value)},get:function(e,t){return e.badges.bottomRight.image.url.get(t)},nested:{url:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomRight.image.url.set(t,value)},get:function(e,t){return e.badges.bottomRight.image.url.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:1*t/100}},set:function(e,t,value){e.badges.bottomRight.image.scale.set(t,value)},get:function(e,t){return e.badges.bottomRight.image.scale.get(t)},nested:{}}}},stroke:{set:function(){},check:function(){return undefined},get:function(e,t){return{color:e.badges.bottomRight.stroke.color.get(t),width:e.badges.bottomRight.stroke.width.get(t),scalingMethod:e.badges.bottomRight.stroke.scalingMethod.get(t)}},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.bottomRight.stroke.color.set(t,value)},get:function(e,t){return e.badges.bottomRight.stroke.color.get(t)},nested:{}},width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.badges.bottomRight.stroke.width.set(t,value)},get:function(e,t){return e.badges.bottomRight.stroke.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.badges.bottomRight.stroke.scalingMethod.set(t,value)},get:function(e,t){return e.badges.bottomRight.stroke.scalingMethod.get(t)},nested:{}}}},text:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomRight.text.content.set(t,value)},get:function(e,t){return e.badges.bottomRight.text.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.badges.bottomRight.text.content.set(t,value)},get:function(e,t){return e.badges.bottomRight.text.content.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.badges.bottomRight.text.color.set(t,value)},get:function(e,t){return e.badges.bottomRight.text.color.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.badges.bottomRight.text.font.set(t,value)},get:function(e,t){return e.badges.bottomRight.text.font.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.badges.bottomRight.text.style.set(t,value)},get:function(e,t){return e.badges.bottomRight.text.style.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.5*t/100}},set:function(e,t,value){e.badges.bottomRight.text.scale.set(t,value)},get:function(e,t){return e.badges.bottomRight.text.scale.get(t)},nested:{}}}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.badges.bottomRight.minVisibleSize.set(t,value)},get:function(e,t){return e.badges.bottomRight.minVisibleSize.get(t)},nested:{}}}}}},halo:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.halo.color.set(t,value)},get:function(e,t){return e.halo.color.get(t)},nested:{color:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.halo.color.set(t,value)},get:function(e,t){return e.halo.color.get(t)},nested:{}},width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:50*t/100}},set:function(e,t,value){e.halo.width.set(t,value)},get:function(e,t){return e.halo.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.halo.scalingMethod.set(t,value)},get:function(e,t){return e.halo.scalingMethod.get(t)},nested:{}},strokeColor:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.halo.strokeColor.set(t,value)},get:function(e,t){return e.halo.strokeColor.get(t)},nested:{}},strokeWidth:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:1*t/100}},set:function(e,t,value){e.halo.strokeWidth.set(t,value)},get:function(e,t){return e.halo.strokeWidth.get(t)},nested:{}},clustering:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.halo.clustering.set(t,value)},get:function(e,t){return e.halo.clustering.get(t)},nested:{}},hideNonAdjacentEdges:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.halo.hideNonAdjacentEdges.set(t,value)},get:function(e,t){return e.halo.hideNonAdjacentEdges.get(t)},nested:{}},size:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:50*t/100}},set:function(e,t,value){e.halo.width.set(t,value)},get:function(e,t){return e.halo.width.get(t)},nested:{}}}},pulse:{set:function(){},check:function(){return undefined},get:function(e,t){return{enabled:e.pulse.enabled.get(t),duration:e.pulse.duration.get(t),interval:e.pulse.interval.get(t),startColor:e.pulse.startColor.get(t),endColor:e.pulse.endColor.get(t),width:e.pulse.width.get(t),startRatio:e.pulse.startRatio.get(t),endRatio:e.pulse.endRatio.get(t)}},nested:{enabled:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.pulse.enabled.set(t,value)},get:function(e,t){return e.pulse.enabled.get(t)},nested:{}},duration:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.duration.set(t,value)},get:function(e,t){return e.pulse.duration.get(t)},nested:{}},interval:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.interval.set(t,value)},get:function(e,t){return e.pulse.interval.get(t)},nested:{}},startColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.pulse.startColor.set(t,value)},get:function(e,t){return e.pulse.startColor.get(t)},nested:{}},endColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.pulse.endColor.set(t,value)},get:function(e,t){return e.pulse.endColor.get(t)},nested:{}},width:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.width.set(t,value)},get:function(e,t){return e.pulse.width.get(t)},nested:{}},startRatio:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.startRatio.set(t,value)},get:function(e,t){return e.pulse.startRatio.get(t)},nested:{}},endRatio:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.endRatio.set(t,value)},get:function(e,t){return e.pulse.endRatio.get(t)},nested:{}}}},icon:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.icon.content.set(t,value)},get:function(e,t){return e.icon.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.icon.content.set(t,value)},get:function(e,t){return e.icon.content.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.icon.font.set(t,value)},get:function(e,t){return e.icon.font.get(t)},nested:{}},color:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.icon.color.set(t,value)},get:function(e,t){return e.icon.color.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:.7*t/100}},set:function(e,t,value){e.icon.scale.set(t,value)},get:function(e,t){return e.icon.scale.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.icon.style.set(t,value)},get:function(e,t){return e.icon.style.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.icon.minVisibleSize.set(t,value)},get:function(e,t){return e.icon.minVisibleSize.get(t)},nested:{}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.icon.minVisibleSize.set(t,value)},get:function(e,t){return e.icon.minVisibleSize.get(t)},nested:{}}}},image:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.image.url.set(t,value)},get:function(e,t){return e.image.url.get(t)},nested:{url:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.image.url.set(t,value)},get:function(e,t){return e.image.url.get(t)},nested:{}},scale:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:1*t/100}},set:function(e,t,value){e.image.scale.set(t,value)},get:function(e,t){return e.image.scale.get(t)},nested:{}},fit:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.image.fit.set(t,value)},get:function(e,t){return e.image.fit.get(t)},nested:{}},tile:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.image.tile.set(t,value)},get:function(e,t){return e.image.tile.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.image.minVisibleSize.set(t,value)},get:function(e,t){return e.image.minVisibleSize.get(t)},nested:{}},rescale:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.image.fit.set(t,value)},get:function(e,t){return e.image.fit.get(t)},nested:{}},duplicate:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.image.tile.set(t,value)},get:function(e,t){return e.image.tile.get(t)},nested:{}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.image.minVisibleSize.set(t,value)},get:function(e,t){return e.image.minVisibleSize.get(t)},nested:{}}}},outline:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.outline.enabled.set(t,value)},get:function(e,t){return e.outline.enabled.get(t)},nested:{enabled:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.outline.enabled.set(t,value)},get:function(e,t){return e.outline.enabled.get(t)},nested:{}},color:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.outline.color.set(t,value)},get:function(e,t){return e.outline.color.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.outline.minVisibleSize.set(t,value)},get:function(e,t){return e.outline.minVisibleSize.get(t)},nested:{}}}},text:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.content.set(t,value)},get:function(e,t){return e.text.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.content.set(t,value)},get:function(e,t){return e.text.content.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.text.font.set(t,value)},get:function(e,t){return e.text.font.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.color.set(t,value)},get:function(e,t){return e.text.color.get(t)},nested:{}},size:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.text.size.set(t,value)},get:function(e,t){return e.text.size.get(t)},nested:{}},scale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.scale.set(t,value)},get:function(e,t){return e.text.scale.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.text.style.set(t,value)},get:function(e,t){return e.text.style.get(t)},nested:{}},align:{check:function(e){return e==="left"||e==="center"?e:undefined},set:function(e,t,value){e.text.align.set(t,value)},get:function(e,t){return e.text.align.get(t)},nested:{}},margin:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:10*t/100}},set:function(e,t,value){e.text.margin.set(t,value)},get:function(e,t){return e.text.margin.get(t)},nested:{}},padding:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.padding.set(t,value)},get:function(e,t){return e.text.padding.get(t)},nested:{}},backgroundColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.backgroundColor.set(t,value)},get:function(e,t){return e.text.backgroundColor.get(t)},nested:{}},tip:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.text.tip.set(t,value)},get:function(e,t){return e.text.tip.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:24*t/100}},set:function(e,t,value){e.text.minVisibleSize.set(t,value)},get:function(e,t){return e.text.minVisibleSize.get(t)},nested:{}},scaling:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.text.scaling.set(t,value)},get:function(e,t){return e.text.scaling.get(t)},nested:{}},position:{check:function(e){return e==="top"||e==="bottom"||e==="left"||e==="right"||e==="center"?e:undefined},set:function(e,t,value){e.text.position.set(t,value)},get:function(e,t){return e.text.position.get(t)},nested:{}},maxLineLength:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.maxLineLength.set(t,value)},get:function(e,t){return e.text.maxLineLength.get(t)},nested:{}},truncateLength:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.truncateLength.set(t,value)},get:function(e,t){return e.text.truncateLength.get(t)},nested:{}},backgroundArrowBaseSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:10*t/100}},set:function(e,t,value){e.text.margin.set(t,value)},get:function(e,t){return e.text.margin.get(t)},nested:{}},backgroundMargin:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.padding.set(t,value)},get:function(e,t){return e.text.padding.get(t)},nested:{}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:24*t/100}},set:function(e,t,value){e.text.minVisibleSize.set(t,value)},get:function(e,t){return e.text.minVisibleSize.get(t)},nested:{}},secondary:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.secondary.content.set(t,value)},get:function(e,t){return e.text.secondary.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.secondary.content.set(t,value)},get:function(e,t){return e.text.secondary.content.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.text.secondary.font.set(t,value)},get:function(e,t){return e.text.secondary.font.get(t)},nested:{}},color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.secondary.color.set(t,value)},get:function(e,t){return e.text.secondary.color.get(t)},nested:{}},size:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:10*t/100}},set:function(e,t,value){e.text.secondary.size.set(t,value)},get:function(e,t){return e.text.secondary.size.get(t)},nested:{}},scale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.secondary.scale.set(t,value)},get:function(e,t){return e.text.secondary.scale.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.text.secondary.style.set(t,value)},get:function(e,t){return e.text.secondary.style.get(t)},nested:{}},align:{check:function(e){return e==="left"||e==="center"?e:undefined},set:function(e,t,value){e.text.secondary.align.set(t,value)},get:function(e,t){return e.text.secondary.align.get(t)},nested:{}},margin:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:5*t/100}},set:function(e,t,value){e.text.secondary.margin.set(t,value)},get:function(e,t){return e.text.secondary.margin.get(t)},nested:{}},padding:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.secondary.padding.set(t,value)},get:function(e,t){return e.text.secondary.padding.get(t)},nested:{}},backgroundColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.secondary.backgroundColor.set(t,value)},get:function(e,t){return e.text.secondary.backgroundColor.get(t)},nested:{}},minVisibleSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:24*t/100}},set:function(e,t,value){e.text.secondary.minVisibleSize.set(t,value)},get:function(e,t){return e.text.secondary.minVisibleSize.get(t)},nested:{}},backgroundArrowBaseSize:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:5*t/100}},set:function(e,t,value){e.text.secondary.margin.set(t,value)},get:function(e,t){return e.text.secondary.margin.get(t)},nested:{}},backgroundMargin:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.secondary.padding.set(t,value)},get:function(e,t){return e.text.secondary.padding.get(t)},nested:{}},threshold:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:24*t/100}},set:function(e,t,value){e.text.secondary.minVisibleSize.set(t,value)},get:function(e,t){return e.text.secondary.minVisibleSize.get(t)},nested:{}}}}}}}};var ud={set:function(){},check:function(){return undefined},get:function(e,t){return{width:e.width.get(t),scalingMethod:e.scalingMethod.get(t),color:e.color.get(t),opacity:e.opacity.get(t),minVisibleSize:e.minVisibleSize.get(t),layer:e.layer.get(t),detectable:e.detectable.get(t),curvature:e.curvature.get(t),adjustAnchors:e.adjustAnchors.get(t),shape:{type:e.shape.type.get(t),head:e.shape.head.get(t),tail:e.shape.tail.get(t),style:e.shape.style.get(t)},stroke:{color:e.stroke.color.get(t),width:e.stroke.width.get(t),scalingMethod:e.stroke.scalingMethod.get(t),minVisibleSize:e.stroke.minVisibleSize.get(t)},halo:{color:e.halo.color.get(t),width:e.halo.width.get(t),scalingMethod:e.halo.scalingMethod.get(t)},pulse:{enabled:e.pulse.enabled.get(t),duration:e.pulse.duration.get(t),interval:e.pulse.interval.get(t),startColor:e.pulse.startColor.get(t),endColor:e.pulse.endColor.get(t),width:e.pulse.width.get(t),startRatio:e.pulse.startRatio.get(t),endRatio:e.pulse.endRatio.get(t)},outline:{enabled:e.outline.enabled.get(t),color:e.outline.color.get(t),minVisibleSize:e.outline.minVisibleSize.get(t)},text:{content:e.text.content.get(t),font:e.text.font.get(t),color:e.text.color.get(t),size:e.text.size.get(t),scale:e.text.scale.get(t),style:e.text.style.get(t),align:e.text.align.get(t),margin:e.text.margin.get(t),padding:e.text.padding.get(t),backgroundColor:e.text.backgroundColor.get(t),minVisibleSize:e.text.minVisibleSize.get(t),adjustAngle:e.text.adjustAngle.get(t),scaling:e.text.scaling.get(t),maxLineLength:e.text.maxLineLength.get(t),secondary:{content:e.text.secondary.content.get(t),font:e.text.secondary.font.get(t),color:e.text.secondary.color.get(t),size:e.text.secondary.size.get(t),scale:e.text.secondary.scale.get(t),style:e.text.secondary.style.get(t),align:e.text.secondary.align.get(t),margin:e.text.secondary.margin.get(t),padding:e.text.secondary.padding.get(t),backgroundColor:e.text.secondary.backgroundColor.get(t),minVisibleSize:e.text.secondary.minVisibleSize.get(t)}}}},nested:{width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:1*t/100}},set:function(e,t,value){e.width.set(t,value)},get:function(e,t){return e.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.scalingMethod.set(t,value)},get:function(e,t){return e.scalingMethod.get(t)},nested:{}},color:{check:function(e,t){return e==="source"||e==="target"||!!t.parseColor(e)?e:undefined},set:function(e,t,value){e.color.set(t,value)},get:function(e,t){return e.color.get(t)},nested:{}},opacity:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.opacity.set(t,value)},get:function(e,t){return e.opacity.get(t)},nested:{}},hidden:{set:function(e,t,value){e.opacity.set(t,value===undefined?undefined:+!value)},check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},get:function(e,t){return e.opacity.get(t)===0},nested:{}},minVisibleSize:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.minVisibleSize.set(t,value)},get:function(e,t){return e.minVisibleSize.get(t)},nested:{}},threshold:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.minVisibleSize.set(t,value)},get:function(e,t){return e.minVisibleSize.get(t)},nested:{}},layer:{check:function(e){return typeof e==="number"&&isFinite(e)&&e%1===0&&e>=-1&&e<=4?e:undefined},set:function(e,t,value){e.layer.set(t,value)},get:function(e,t){return e.layer.get(t)},nested:{}},detectable:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.detectable.set(t,value)},get:function(e,t){return e.detectable.get(t)},nested:{}},curvature:{check:function(e){return typeof e==="number"&&isFinite(e)?e:undefined},set:function(e,t,value){e.curvature.set(t,value)},get:function(e,t){return e.curvature.get(t)},nested:{}},adjustAnchors:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.adjustAnchors.set(t,value)},get:function(e,t){return e.adjustAnchors.get(t)},nested:{}},shape:{set:function(e,t,value){var r=undefined;var n=undefined;var i=undefined;var a=undefined;if(value==="line"){r="line";n="plain";i=null;a=null}else if(value==="arrow"){r="line";n="plain";i="arrow";a=null}else if(value==="tapered"){r="triangle";n="plain";i=null;a=null}else if(value==="dashed"){r="line";n="dashed";i=null;a=null}else if(value==="dotted"){r="line";n="dotted";i=null;a=null}e.shape.type.set(t,r);e.shape.style.set(t,n);e.shape.head.set(t,i);e.shape.tail.set(t,a)},check:function(e){return["line","tapered","arrow","dashed","dotted"].includes(e)?e:undefined},get:function(e,t){return{type:e.shape.type.get(t),head:e.shape.head.get(t),tail:e.shape.tail.get(t),style:e.shape.style.get(t)}},nested:{type:{check:function(e){return e==="line"||e==="triangle"?e:undefined},set:function(e,t,value){e.shape.type.set(t,value)},get:function(e,t){return e.shape.type.get(t)},nested:{}},head:{check:function(e){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(e)?e:undefined},set:function(e,t,value){e.shape.head.set(t,value)},get:function(e,t){return e.shape.head.get(t)},nested:{}},tail:{check:function(e){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(e)?e:undefined},set:function(e,t,value){e.shape.tail.set(t,value)},get:function(e,t){return e.shape.tail.get(t)},nested:{}},style:{check:function(e){return e==="plain"||e==="dashed"||e==="dotted"?e:undefined},set:function(e,t,value){e.shape.style.set(t,value)},get:function(e,t){return e.shape.style.get(t)},nested:{}}}},stroke:{set:function(){},check:function(){return undefined},get:function(e,t){return{color:e.stroke.color.get(t),width:e.stroke.width.get(t),scalingMethod:e.stroke.scalingMethod.get(t),minVisibleSize:e.stroke.minVisibleSize.get(t)}},nested:{color:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.stroke.color.set(t,value)},get:function(e,t){return e.stroke.color.get(t)},nested:{}},width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:0*t/100}},set:function(e,t,value){e.stroke.width.set(t,value)},get:function(e,t){return e.stroke.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.stroke.scalingMethod.set(t,value)},get:function(e,t){return e.stroke.scalingMethod.get(t)},nested:{}},minVisibleSize:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.stroke.minVisibleSize.set(t,value)},get:function(e,t){return e.stroke.minVisibleSize.get(t)},nested:{}}}},strokeWidth:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:0*t/100}},set:function(e,t,value){e.stroke.width.set(t,value)},get:function(e,t){return e.stroke.width.get(t)},nested:{}},halo:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.halo.color.set(t,value)},get:function(e,t){return e.halo.color.get(t)},nested:{color:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.halo.color.set(t,value)},get:function(e,t){return e.halo.color.get(t)},nested:{}},width:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:10*t/100}},set:function(e,t,value){e.halo.width.set(t,value)},get:function(e,t){return e.halo.width.get(t)},nested:{}},scalingMethod:{check:function(e){return e==="fixed"||e==="scaled"?e:undefined},set:function(e,t,value){e.halo.scalingMethod.set(t,value)},get:function(e,t){return e.halo.scalingMethod.get(t)},nested:{}},size:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:10*t/100}},set:function(e,t,value){e.halo.width.set(t,value)},get:function(e,t){return e.halo.width.get(t)},nested:{}}}},pulse:{set:function(){},check:function(){return undefined},get:function(e,t){return{enabled:e.pulse.enabled.get(t),duration:e.pulse.duration.get(t),interval:e.pulse.interval.get(t),startColor:e.pulse.startColor.get(t),endColor:e.pulse.endColor.get(t),width:e.pulse.width.get(t),startRatio:e.pulse.startRatio.get(t),endRatio:e.pulse.endRatio.get(t)}},nested:{enabled:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.pulse.enabled.set(t,value)},get:function(e,t){return e.pulse.enabled.get(t)},nested:{}},duration:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.duration.set(t,value)},get:function(e,t){return e.pulse.duration.get(t)},nested:{}},interval:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.interval.set(t,value)},get:function(e,t){return e.pulse.interval.get(t)},nested:{}},startColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.pulse.startColor.set(t,value)},get:function(e,t){return e.pulse.startColor.get(t)},nested:{}},endColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.pulse.endColor.set(t,value)},get:function(e,t){return e.pulse.endColor.get(t)},nested:{}},width:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.width.set(t,value)},get:function(e,t){return e.pulse.width.get(t)},nested:{}},startRatio:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.startRatio.set(t,value)},get:function(e,t){return e.pulse.startRatio.get(t)},nested:{}},endRatio:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.pulse.endRatio.set(t,value)},get:function(e,t){return e.pulse.endRatio.get(t)},nested:{}}}},outline:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.outline.enabled.set(t,value)},get:function(e,t){return e.outline.enabled.get(t)},nested:{enabled:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.outline.enabled.set(t,value)},get:function(e,t){return e.outline.enabled.get(t)},nested:{}},color:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.outline.color.set(t,value)},get:function(e,t){return e.outline.color.get(t)},nested:{}},minVisibleSize:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.outline.minVisibleSize.set(t,value)},get:function(e,t){return e.outline.minVisibleSize.get(t)},nested:{}}}},text:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.content.set(t,value)},get:function(e,t){return e.text.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.content.set(t,value)},get:function(e,t){return e.text.content.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.text.font.set(t,value)},get:function(e,t){return e.text.font.get(t)},nested:{}},color:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.color.set(t,value)},get:function(e,t){return e.text.color.get(t)},nested:{}},size:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.text.size.set(t,value)},get:function(e,t){return e.text.size.get(t)},nested:{}},scale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.scale.set(t,value)},get:function(e,t){return e.text.scale.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.text.style.set(t,value)},get:function(e,t){return e.text.style.get(t)},nested:{}},align:{check:function(e){return e==="left"||e==="center"?e:undefined},set:function(e,t,value){e.text.align.set(t,value)},get:function(e,t){return e.text.align.get(t)},nested:{}},margin:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.margin.set(t,value)},get:function(e,t){return e.text.margin.get(t)},nested:{}},padding:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.padding.set(t,value)},get:function(e,t){return e.text.padding.get(t)},nested:{}},backgroundColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.backgroundColor.set(t,value)},get:function(e,t){return e.text.backgroundColor.get(t)},nested:{}},minVisibleSize:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.minVisibleSize.set(t,value)},get:function(e,t){return e.text.minVisibleSize.get(t)},nested:{}},threshold:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.minVisibleSize.set(t,value)},get:function(e,t){return e.text.minVisibleSize.get(t)},nested:{}},adjustAngle:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.text.adjustAngle.set(t,value)},get:function(e,t){return e.text.adjustAngle.get(t)},nested:{}},scaling:{check:function(e){return typeof e==="boolean"||e===0||e===1?e:undefined},set:function(e,t,value){e.text.scaling.set(t,value)},get:function(e,t){return e.text.scaling.get(t)},nested:{}},maxLineLength:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.maxLineLength.set(t,value)},get:function(e,t){return e.text.maxLineLength.get(t)},nested:{}},secondary:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.secondary.content.set(t,value)},get:function(e,t){return e.text.secondary.content.get(t)},nested:{content:{check:function(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined},set:function(e,t,value){e.text.secondary.content.set(t,value)},get:function(e,t){return e.text.secondary.content.get(t)},nested:{}},font:{check:function(e){if(e===null){return null}if(typeof e!=="string"){return undefined}return e.split(",").map(function(e){var t=e.trim();var r=t.indexOf(" ")!==-1;var n=t[0];return r&&n!=='"'&&n!=="'"?'"'+t+'"':t}).join(",")},set:function(e,t,value){e.text.secondary.font.set(t,value)},get:function(e,t){return e.text.secondary.font.get(t)},nested:{}},color:{check:function(e,t){return t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.secondary.color.set(t,value)},get:function(e,t){return e.text.secondary.color.get(t)},nested:{}},size:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:12*t/100}},set:function(e,t,value){e.text.secondary.size.set(t,value)},get:function(e,t){return e.text.secondary.size.get(t)},nested:{}},scale:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.secondary.scale.set(t,value)},get:function(e,t){return e.text.secondary.scale.get(t)},nested:{}},style:{check:function(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"||e==="italic bold"?e:undefined},set:function(e,t,value){e.text.secondary.style.set(t,value)},get:function(e,t){return e.text.secondary.style.get(t)},nested:{}},align:{check:function(e){return e==="left"||e==="center"?e:undefined},set:function(e,t,value){e.text.secondary.align.set(t,value)},get:function(e,t){return e.text.secondary.align.get(t)},nested:{}},margin:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.secondary.margin.set(t,value)},get:function(e,t){return e.text.secondary.margin.get(t)},nested:{}},padding:{check:function(e){if(typeof e==="number"){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}else if(typeof e!=="string"||e.charAt(e.length-1)!=="%"){return undefined}else{var t=parseFloat(e);return isNaN(t)?undefined:2*t/100}},set:function(e,t,value){e.text.secondary.padding.set(t,value)},get:function(e,t){return e.text.secondary.padding.get(t)},nested:{}},backgroundColor:{check:function(e,t){return e==="inherit"||t.parseColor(e)?e:undefined},set:function(e,t,value){e.text.secondary.backgroundColor.set(t,value)},get:function(e,t){return e.text.secondary.backgroundColor.get(t)},nested:{}},minVisibleSize:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.secondary.minVisibleSize.set(t,value)},get:function(e,t){return e.text.secondary.minVisibleSize.get(t)},nested:{}},threshold:{check:function(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined},set:function(e,t,value){e.text.secondary.minVisibleSize.set(t,value)},get:function(e,t){return e.text.secondary.minVisibleSize.get(t)},nested:{}}}}}}}};var ld=function(e){var t=this._graph;var r=this._isNode;var n=e.named;var i=e.useDefaultValues;return{x:t.createAttribute(true,{storage:"any",default:i?0:undefined,name:n?"x":undefined}),y:t.createAttribute(true,{storage:"any",default:i?0:undefined,name:n?"y":undefined}),radius:t.createAttribute(true,{storage:"resource",default:i?5:undefined,name:n?"radius":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"scaled":undefined,name:n?"scalingMethod":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"grey":undefined,name:n?"color":undefined}),opacity:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"opacity":undefined}),shape:t.createAttribute(true,{storage:"resource",default:i?"circle":undefined,name:n?"shape":undefined}),layer:t.createAttribute(true,{storage:"resource",default:i?0:undefined,name:n?"layer":undefined}),detectable:t.createAttribute(true,{storage:"resource",default:i?true:undefined,name:n?"detectable":undefined}),draggable:t.createAttribute(true,{storage:"resource",default:i?true:undefined,name:n?"draggable":undefined}),layoutable:t.createAttribute(true,{storage:"resource",default:i?true:undefined,name:n?"layoutable":undefined}),innerStroke:{width:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"innerStroke.width":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"fixed":undefined,name:n?"innerStroke.scalingMethod":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"white":undefined,name:n?"innerStroke.color":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"innerStroke.minVisibleSize":undefined})},outerStroke:{width:t.createAttribute(true,{storage:"resource",default:i?5:undefined,name:n?"outerStroke.width":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"fixed":undefined,name:n?"outerStroke.scalingMethod":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"outerStroke.color":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?0:undefined,name:n?"outerStroke.minVisibleSize":undefined})},badges:{topLeft:{color:t.createAttribute(true,{storage:"resource",default:i?"white":undefined,name:n?"badges.topLeft.color":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.45:undefined,name:n?"badges.topLeft.scale":undefined}),positionScale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.topLeft.positionScale":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"badges.topLeft.minVisibleSize":undefined}),image:{url:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.topLeft.image.url":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.topLeft.image.scale":undefined})},stroke:{color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.topLeft.stroke.color":undefined}),width:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"badges.topLeft.stroke.width":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"fixed":undefined,name:n?"badges.topLeft.stroke.scalingMethod":undefined})},text:{content:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.topLeft.text.content":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.topLeft.text.color":undefined}),font:t.createAttribute(true,{storage:"resource",default:i?"Arial":undefined,name:n?"badges.topLeft.text.font":undefined}),style:t.createAttribute(true,{storage:"resource",default:i?"normal":undefined,name:n?"badges.topLeft.text.style":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.5:undefined,name:n?"badges.topLeft.text.scale":undefined})}},topRight:{color:t.createAttribute(true,{storage:"resource",default:i?"white":undefined,name:n?"badges.topRight.color":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.45:undefined,name:n?"badges.topRight.scale":undefined}),positionScale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.topRight.positionScale":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"badges.topRight.minVisibleSize":undefined}),image:{url:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.topRight.image.url":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.topRight.image.scale":undefined})},stroke:{color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.topRight.stroke.color":undefined}),width:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"badges.topRight.stroke.width":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"fixed":undefined,name:n?"badges.topRight.stroke.scalingMethod":undefined})},text:{content:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.topRight.text.content":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.topRight.text.color":undefined}),font:t.createAttribute(true,{storage:"resource",default:i?"Arial":undefined,name:n?"badges.topRight.text.font":undefined}),style:t.createAttribute(true,{storage:"resource",default:i?"normal":undefined,name:n?"badges.topRight.text.style":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.5:undefined,name:n?"badges.topRight.text.scale":undefined})}},bottomLeft:{color:t.createAttribute(true,{storage:"resource",default:i?"white":undefined,name:n?"badges.bottomLeft.color":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.45:undefined,name:n?"badges.bottomLeft.scale":undefined}),positionScale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.bottomLeft.positionScale":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"badges.bottomLeft.minVisibleSize":undefined}),image:{url:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.bottomLeft.image.url":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.bottomLeft.image.scale":undefined})},stroke:{color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.bottomLeft.stroke.color":undefined}),width:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"badges.bottomLeft.stroke.width":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"fixed":undefined,name:n?"badges.bottomLeft.stroke.scalingMethod":undefined})},text:{content:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.bottomLeft.text.content":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.bottomLeft.text.color":undefined}),font:t.createAttribute(true,{storage:"resource",default:i?"Arial":undefined,name:n?"badges.bottomLeft.text.font":undefined}),style:t.createAttribute(true,{storage:"resource",default:i?"normal":undefined,name:n?"badges.bottomLeft.text.style":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.5:undefined,name:n?"badges.bottomLeft.text.scale":undefined})}},bottomRight:{color:t.createAttribute(true,{storage:"resource",default:i?"white":undefined,name:n?"badges.bottomRight.color":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.45:undefined,name:n?"badges.bottomRight.scale":undefined}),positionScale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.bottomRight.positionScale":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"badges.bottomRight.minVisibleSize":undefined}),image:{url:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.bottomRight.image.url":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"badges.bottomRight.image.scale":undefined})},stroke:{color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.bottomRight.stroke.color":undefined}),width:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"badges.bottomRight.stroke.width":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"fixed":undefined,name:n?"badges.bottomRight.stroke.scalingMethod":undefined})},text:{content:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"badges.bottomRight.text.content":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"badges.bottomRight.text.color":undefined}),font:t.createAttribute(true,{storage:"resource",default:i?"Arial":undefined,name:n?"badges.bottomRight.text.font":undefined}),style:t.createAttribute(true,{storage:"resource",default:i?"normal":undefined,name:n?"badges.bottomRight.text.style":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.5:undefined,name:n?"badges.bottomRight.text.scale":undefined})}}},halo:{color:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"halo.color":undefined}),width:t.createAttribute(true,{storage:"resource",default:i?50:undefined,name:n?"halo.width":undefined}),scalingMethod:t.createAttribute(true,{storage:"resource",default:i?"fixed":undefined,name:n?"halo.scalingMethod":undefined}),strokeColor:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"halo.strokeColor":undefined}),strokeWidth:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"halo.strokeWidth":undefined}),clustering:t.createAttribute(true,{storage:"resource",default:i?false:undefined,name:n?"halo.clustering":undefined}),hideNonAdjacentEdges:t.createAttribute(true,{storage:"resource",default:i?false:undefined,name:n?"halo.hideNonAdjacentEdges":undefined})},pulse:{enabled:t.createAttribute(true,{storage:"resource",default:i?false:undefined,name:n?"pulse.enabled":undefined}),duration:t.createAttribute(true,{storage:"resource",default:i?1e3:undefined,name:n?"pulse.duration":undefined}),interval:t.createAttribute(true,{storage:"resource",default:i?800:undefined,name:n?"pulse.interval":undefined}),startColor:t.createAttribute(true,{storage:"resource",default:i?"rgba(0, 0, 0, 0.6)":undefined,name:n?"pulse.startColor":undefined}),endColor:t.createAttribute(true,{storage:"resource",default:i?"rgba(0, 0, 0, 0)":undefined,name:n?"pulse.endColor":undefined}),width:t.createAttribute(true,{storage:"resource",default:i?50:undefined,name:n?"pulse.width":undefined}),startRatio:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"pulse.startRatio":undefined}),endRatio:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"pulse.endRatio":undefined})},icon:{content:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"icon.content":undefined}),font:t.createAttribute(true,{storage:"resource",default:i?"Arial":undefined,name:n?"icon.font":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"icon.color":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.7:undefined,name:n?"icon.scale":undefined}),style:t.createAttribute(true,{storage:"resource",default:i?"normal":undefined,name:n?"icon.style":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"icon.minVisibleSize":undefined})},image:{url:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"image.url":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?1:undefined,name:n?"image.scale":undefined}),fit:t.createAttribute(true,{storage:"resource",default:i?true:undefined,name:n?"image.fit":undefined}),tile:t.createAttribute(true,{storage:"resource",default:i?false:undefined,name:n?"image.tile":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"image.minVisibleSize":undefined})},outline:{enabled:t.createAttribute(true,{storage:"resource",default:i?false:undefined,name:n?"outline.enabled":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"rgba(0, 0, 0, 0.36)":undefined,name:n?"outline.color":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"outline.minVisibleSize":undefined})},text:{content:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"text.content":undefined}),font:t.createAttribute(true,{storage:"resource",default:i?"Arial":undefined,name:n?"text.font":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"text.color":undefined}),size:t.createAttribute(true,{storage:"resource",default:i?12:undefined,name:n?"text.size":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.1:undefined,name:n?"text.scale":undefined}),style:t.createAttribute(true,{storage:"resource",default:i?"normal":undefined,name:n?"text.style":undefined}),align:t.createAttribute(true,{storage:"resource",default:i?"center":undefined,name:n?"text.align":undefined}),margin:t.createAttribute(true,{storage:"resource",default:i?10:undefined,name:n?"text.margin":undefined}),padding:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"text.padding":undefined}),backgroundColor:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"text.backgroundColor":undefined}),tip:t.createAttribute(true,{storage:"resource",default:i?true:undefined,name:n?"text.tip":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?24:undefined,name:n?"text.minVisibleSize":undefined}),scaling:t.createAttribute(true,{storage:"resource",default:i?false:undefined,name:n?"text.scaling":undefined}),position:t.createAttribute(true,{storage:"resource",default:i?"bottom":undefined,name:n?"text.position":undefined}),maxLineLength:t.createAttribute(true,{storage:"resource",default:i?0:undefined,name:n?"text.maxLineLength":undefined}),truncateLength:t.createAttribute(true,{storage:"resource",default:i?0:undefined,name:n?"text.truncateLength":undefined}),secondary:{content:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"text.secondary.content":undefined}),font:t.createAttribute(true,{storage:"resource",default:i?"Arial":undefined,name:n?"text.secondary.font":undefined}),color:t.createAttribute(true,{storage:"resource",default:i?"black":undefined,name:n?"text.secondary.color":undefined}),size:t.createAttribute(true,{storage:"resource",default:i?10:undefined,name:n?"text.secondary.size":undefined}),scale:t.createAttribute(true,{storage:"resource",default:i?.08:undefined,name:n?"text.secondary.scale":undefined}),style:t.createAttribute(true,{storage:"resource",default:i?"normal":undefined,name:n?"text.secondary.style":undefined}),align:t.createAttribute(true,{storage:"resource",default:i?"center":undefined,name:n?"text.secondary.align":undefined}),margin:t.createAttribute(true,{storage:"resource",default:i?5:undefined,name:n?"text.secondary.margin":undefined}),padding:t.createAttribute(true,{storage:"resource",default:i?2:undefined,name:n?"text.secondary.padding":undefined}),backgroundColor:t.createAttribute(true,{storage:"resource",default:i?null:undefined,name:n?"text.secondary.backgroundColor":undefined}),minVisibleSize:t.createAttribute(true,{storage:"resource",default:i?24:undefined,name:n?"text.secondary.minVisibleSize":undefined})}}}};var dd=function(e){var t=this._graph;var r=this._isNode;var n=e.named;var i=e.useDefaultValues;return{width:t.createAttribute(false,{storage:"resource",default:i?1:undefined,name:n?"width":undefined}),scalingMethod:t.createAttribute(false,{storage:"resource",default:i?"scaled":undefined,name:n?"scalingMethod":undefined}),color:t.createAttribute(false,{storage:"resource",default:i?"grey":undefined,name:n?"color":undefined}),opacity:t.createAttribute(false,{storage:"resource",default:i?1:undefined,name:n?"opacity":undefined}),minVisibleSize:t.createAttribute(false,{storage:"resource",default:i?0:undefined,name:n?"minVisibleSize":undefined}),layer:t.createAttribute(false,{storage:"resource",default:i?0:undefined,name:n?"layer":undefined}),detectable:t.createAttribute(false,{storage:"resource",default:i?true:undefined,name:n?"detectable":undefined}),curvature:t.createAttribute(false,{storage:"resource",default:i?0:undefined,name:n?"curvature":undefined}),adjustAnchors:t.createAttribute(false,{storage:"resource",default:i?true:undefined,name:n?"adjustAnchors":undefined}),shape:{type:t.createAttribute(false,{storage:"resource",default:i?"line":undefined,name:n?"shape.type":undefined}),head:t.createAttribute(false,{storage:"resource",default:i?null:undefined,name:n?"shape.head":undefined}),tail:t.createAttribute(false,{storage:"resource",default:i?null:undefined,name:n?"shape.tail":undefined}),style:t.createAttribute(false,{storage:"resource",default:i?"plain":undefined,name:n?"shape.style":undefined})},stroke:{color:t.createAttribute(false,{storage:"resource",default:i?"inherit":undefined,name:n?"stroke.color":undefined}),width:t.createAttribute(false,{storage:"resource",default:i?0:undefined,name:n?"stroke.width":undefined}),scalingMethod:t.createAttribute(false,{storage:"resource",default:i?"fixed":undefined,name:n?"stroke.scalingMethod":undefined}),minVisibleSize:t.createAttribute(false,{storage:"resource",default:i?0:undefined,name:n?"stroke.minVisibleSize":undefined})},halo:{color:t.createAttribute(false,{storage:"resource",default:i?null:undefined,name:n?"halo.color":undefined}),width:t.createAttribute(false,{storage:"resource",default:i?10:undefined,name:n?"halo.width":undefined}),scalingMethod:t.createAttribute(false,{storage:"resource",default:i?"fixed":undefined,name:n?"halo.scalingMethod":undefined})},pulse:{enabled:t.createAttribute(false,{storage:"resource",default:i?false:undefined,name:n?"pulse.enabled":undefined}),duration:t.createAttribute(false,{storage:"resource",default:i?1e3:undefined,name:n?"pulse.duration":undefined}),interval:t.createAttribute(false,{storage:"resource",default:i?800:undefined,name:n?"pulse.interval":undefined}),startColor:t.createAttribute(false,{storage:"resource",default:i?"rgba(0, 0, 0, 0.6)":undefined,name:n?"pulse.startColor":undefined}),endColor:t.createAttribute(false,{storage:"resource",default:i?"rgba(0, 0, 0, 0)":undefined,name:n?"pulse.endColor":undefined}),width:t.createAttribute(false,{storage:"resource",default:i?10:undefined,name:n?"pulse.width":undefined}),startRatio:t.createAttribute(false,{storage:"resource",default:i?1:undefined,name:n?"pulse.startRatio":undefined}),endRatio:t.createAttribute(false,{storage:"resource",default:i?2:undefined,name:n?"pulse.endRatio":undefined})},outline:{enabled:t.createAttribute(false,{storage:"resource",default:i?false:undefined,name:n?"outline.enabled":undefined}),color:t.createAttribute(false,{storage:"resource",default:i?"rgba(0, 0, 0, 0.36)":undefined,name:n?"outline.color":undefined}),minVisibleSize:t.createAttribute(false,{storage:"resource",default:i?0:undefined,name:n?"outline.minVisibleSize":undefined})},text:{content:t.createAttribute(false,{storage:"resource",default:i?null:undefined,name:n?"text.content":undefined}),font:t.createAttribute(false,{storage:"resource",default:i?"Arial":undefined,name:n?"text.font":undefined}),color:t.createAttribute(false,{storage:"resource",default:i?"black":undefined,name:n?"text.color":undefined}),size:t.createAttribute(false,{storage:"resource",default:i?12:undefined,name:n?"text.size":undefined}),scale:t.createAttribute(false,{storage:"resource",default:i?1:undefined,name:n?"text.scale":undefined}),style:t.createAttribute(false,{storage:"resource",default:i?"normal":undefined,name:n?"text.style":undefined}),align:t.createAttribute(false,{storage:"resource",default:i?"center":undefined,name:n?"text.align":undefined}),margin:t.createAttribute(false,{storage:"resource",default:i?2:undefined,name:n?"text.margin":undefined}),padding:t.createAttribute(false,{storage:"resource",default:i?2:undefined,name:n?"text.padding":undefined}),backgroundColor:t.createAttribute(false,{storage:"resource",default:i?null:undefined,name:n?"text.backgroundColor":undefined}),minVisibleSize:t.createAttribute(false,{storage:"resource",default:i?4:undefined,name:n?"text.minVisibleSize":undefined}),adjustAngle:t.createAttribute(false,{storage:"resource",default:i?true:undefined,name:n?"text.adjustAngle":undefined}),scaling:t.createAttribute(false,{storage:"resource",default:i?false:undefined,name:n?"text.scaling":undefined}),maxLineLength:t.createAttribute(false,{storage:"resource",default:i?0:undefined,name:n?"text.maxLineLength":undefined}),secondary:{content:t.createAttribute(false,{storage:"resource",default:i?null:undefined,name:n?"text.secondary.content":undefined}),font:t.createAttribute(false,{storage:"resource",default:i?"Arial":undefined,name:n?"text.secondary.font":undefined}),color:t.createAttribute(false,{storage:"resource",default:i?"black":undefined,name:n?"text.secondary.color":undefined}),size:t.createAttribute(false,{storage:"resource",default:i?12:undefined,name:n?"text.secondary.size":undefined}),scale:t.createAttribute(false,{storage:"resource",default:i?.8:undefined,name:n?"text.secondary.scale":undefined}),style:t.createAttribute(false,{storage:"resource",default:i?"normal":undefined,name:n?"text.secondary.style":undefined}),align:t.createAttribute(false,{storage:"resource",default:i?"center":undefined,name:n?"text.secondary.align":undefined}),margin:t.createAttribute(false,{storage:"resource",default:i?2:undefined,name:n?"text.secondary.margin":undefined}),padding:t.createAttribute(false,{storage:"resource",default:i?2:undefined,name:n?"text.secondary.padding":undefined}),backgroundColor:t.createAttribute(false,{storage:"resource",default:i?null:undefined,name:n?"text.secondary.backgroundColor":undefined}),minVisibleSize:t.createAttribute(false,{storage:"resource",default:i?4:undefined,name:n?"text.secondary.minVisibleSize":undefined})}}}};var fd=function e(t,r,n){this._ogma=t;this._colorManager=r;this._graph=t.modules.graph;this._isNode=n;this._eltName=n?"node":"edge";this._accessors=n?sd:ud;this._createFlexArrays=n?ld:dd;this._finalFlexArrays=this._createFlexArrays({named:true,useDefaultValues:true});this._prevFlexArrays=this._createFlexArrays({named:false,useDefaultValues:true});this._defaultFlexArrays=this._createFlexArrays({named:false,useDefaultValues:true});this._allAttributePaths=K(this._defaultFlexArrays);this._currentFlexArrays=this._defaultFlexArrays;this._lastFlexArrays=null;this.setLastFlexArrays(this._defaultFlexArrays);this._elementsToRedraw=new ed({ogma:t,isNode:n,includeRemovedElements:true});this._elementsUpdated=new ed({ogma:t,isNode:n,includeRemovedElements:false});this._updatedAttributes=new zt;this._updatedAttributesTmp=new zt;this._allUsedAttributes=new zt;this._finalFlexArraysWrapped=Object.assign({},this._finalFlexArrays,{excluded:this._graph.getAttribute(n,"excluded"),textHidden:this._graph.getAttribute(n,"textHidden"),animationStart:this._graph.createAttribute(n,td),animationDuration:this._graph.createAttribute(n,rd),animationEasing:this._graph.createAttribute(n,nd),id:this._graph.getAttribute(n,"id")});if(!n){Object.assign(this._finalFlexArraysWrapped,{source:this._graph.getEdgeAttribute("source"),target:this._graph.getEdgeAttribute("target")})}};fd.prototype.clear=function e(){this._elementsToRedraw.clear();this._elementsUpdated.clear();this._updatedAttributes.clear();this._updatedAttributesTmp.clear()};fd.prototype.getAttributeFlexArrays=function e(){return this._finalFlexArraysWrapped};fd.prototype.getPrevAttributeFlexArrays=function e(){return this._prevFlexArrays};fd.prototype.getAnimationInformation=function e(t){var r=t._indexes;var n=new Array(r.length);for(var i=0;i<r.length;++i){var a=r[i];n[i]={duration:this._finalFlexArraysWrapped.animationDuration.get(a),start:this._finalFlexArraysWrapped.animationStart.get(a),easing:this._finalFlexArraysWrapped.animationEasing.get(a)}}return n};fd.prototype.startUpdate=function e(){};fd.prototype.prepareFlexArraysUpdate=function e(t){this._currentFlexArrays=t.inputFlexArrays};fd.prototype.setLastFlexArrays=function e(t){this._lastFlexArrays=t};fd.prototype.updateFlexArrays=function e(t){var r=t.attributes;var n=t.selector;var i=t.context;var a=t.outputFlexArrays;var o=t.toUpdate;var s=t.formattedOutput;this._elementsUpdated.addSet(o);this._elementsToRedraw.addSet(o);var u=o.getListAndClear(true);if(r&&u.size){var l=this._graph.splitElements(u,n,i);var d=l.valid;var f=l.invalid;for(var h=0,c=s.attributes;h<c.length;h+=1){var g=c[h];var v=q(a,g);for(var p=0,_=f._indexes;p<_.length;p+=1){var m=_[p];v.set(m,undefined)}}this._assignAttributesToFlexArrays(this._accessors,a,d,r,i);this._addUpdatedAttributes(t)}};fd.prototype.endUpdate=function e(){var t=this._elementsUpdated.getList();var r=this._updatedAttributesTmp.values();for(var n=0,i=r;n<i.length;n+=1){var a=i[n];var o=q(this._lastFlexArrays,a);var s=q(this._finalFlexArrays,a);for(var u=0,l=t._indexes;u<l.length;u+=1){var d=l[u];s.set(d,o.get(d))}}this._updatedAttributesTmp.clear();this._currentFlexArrays=this._finalFlexArrays};fd.prototype.setAttributeValues=function e(t,r,n,i){var a=t.outputFlexArrays;var o=this._accessors;var s=null;this._assignAttributesToFlexArrays(o,a,r,n,s);this._addUpdatedAttributes(t,i);this._elementsUpdated.add(r);this._elementsToRedraw.add(r)};fd.prototype.notifyLayerDestroyed=function e(t){this._addUpdatedAttributes(t)};fd.prototype._addUpdatedAttributes=function e(t,r){var n=t.outputFlexArrays;var i=t.formattedOutput;var a=Array.isArray(r)?Sd(r):i.attributes;for(var o=0,s=a;o<s.length;o+=1){var u=s[o];var l=q(n,u);if(l.isInitialized()){this._updatedAttributes.add(u);this._updatedAttributesTmp.add(u);this._allUsedAttributes.add(u)}}};fd.prototype.getUsedAttributeNames=function e(t){return cd(t.outputFlexArrays)};fd.prototype.redrawElements=function e(t){this._elementsToRedraw.add(t)};fd.prototype.redrawAll=function e(){this._elementsToRedraw.addAll()};fd.prototype.getAndResetElementsToRedraw=function e(){return this._elementsToRedraw.getListAndClear()};fd.prototype.getAndResetElementsUpdated=function e(){return this._elementsUpdated.getListAndClear()};fd.prototype.getAndResetAttributesUpdated=function e(){var t=this._updatedAttributes.values();this._updatedAttributes.clear();return t};fd.prototype.createFlexArrays=function e(){return this._createFlexArrays({named:false,useDefaultValues:false})};fd.prototype.getAttributeValues=function e(t,r,n,i){var a=i?this._prevFlexArrays:this._currentFlexArrays;if(n){return this._getMultipleAttributeValues(t,r,a)}else{return this._getSingleAttributeValues(t,r,a)}};fd.prototype._getAccessor=function e(t){if(t===void 0)t="";var r=this._accessors;var n=z(t);for(var i=0,a=n;i<a.length;i+=1){var o=a[i];r=r.nested[o];if(!r){throw new Error(this._eltName+' attribute "'+n.join("")+'" does not exist')}}return r};fd.prototype._getSingleAttributeValues=function e(t,r,n){var i=this._getAccessor(r);var a=t._indexes;var o=new Array(a.length);for(var s=0;s<a.length;++s){o[s]=i.get(n,a[s])}return o};fd.prototype._getMultipleAttributeValues=function e(t,r,n){if(!r||r==="all"){return this._getSingleAttributeValues(t,"",n)}var i=new Array(t.size);for(var a=0;a<i.length;++a){i[a]={}}for(var o=0;o<r.length;++o){var s=r[o];var u=this._getSingleAttributeValues(t,s,n);for(var l=0;l<i.length;++l){var d=i[l];var value=u[l];X(d,s,value)}}return i};fd.prototype.setAnimationAttributes=function e(t,r){var n=r.duration;var i=r.startTime;var a=r.easing;var o=t._indexes;var s=this._finalFlexArraysWrapped.animationDuration;var u=this._finalFlexArraysWrapped.animationStart;var l=this._finalFlexArraysWrapped.animationEasing;var d=this._allUsedAttributes.values();if(n){var f=false;for(var h=0,c=d;h<c.length;h+=1){var g=c[h];if(g==="x"||g==="y"){f=true;continue}var v=q(this._finalFlexArrays,g);var p=q(this._prevFlexArrays,g);for(var _=0,m=o;_<m.length;_+=1){var y=m[_];p.set(y,v.get(y))}}if(f){var b=$t();var x=this._finalFlexArrays.x;var S=this._finalFlexArrays.y;var A=this._prevFlexArrays.x;var E=this._prevFlexArrays.y;for(var w=0;w<o.length;++w){var k=o[w];var C=s.get(k);if(C){var T=u.get(k);var L=l.get(k);var M=Zo[L]||Zo.linear;var I=Math.min((b-T)/C,1);var F=M(I);var N=et(A.get(k),x.get(k),F);var z=et(E.get(k),S.get(k),F);A.set(k,N);E.set(k,z)}else{A.set(k,x.get(k));E.set(k,S.get(k))}}}}s.fill(o,n);u.fill(o,i);l.fill(o,a)};fd.prototype.resetAnimationAttributes=function e(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)};fd.prototype.getUsedAttributes=function e(){return this._allUsedAttributes.values()};fd.prototype.getDefaultFlexArrays=function e(){return this._defaultFlexArrays};fd.prototype._assignAttributesToFlexArrays=function e(t,r,n,i,a,o){if(o===void 0)o=[];if(typeof i==="function"){var s=o.join(".");for(var u=0;u<n.size;++u){var l=n.get(u);var d=i(l,a,s);this._assignSingleValueToFlexArray(r,l,t,d,o)}}else if(ee(i)){var f=Object.keys(i);for(var h=0;h<f.length;++h){var c=f[h];o.push(c);var g=this._getNestedAccessor(t,c,o);var v=i[c];this._assignAttributesToFlexArrays(g,r,n,v,a,o);o.pop()}}else if((Array.isArray(i)||ArrayBuffer.isView(i))&&o[0]!=="color"){if(!o.length){for(var p=0;p<n.size;++p){this._assignSingleValueToFlexArray(r,n.get(p),t,i[p],o)}}else{for(var _=0;_<n.size;++_){var m=n._indexes[_];var y=t.check(i[_],this._colorManager);t.set(r,m,y)}}}else{var b=t.check(i,this._colorManager);for(var x=0;x<n.size;++x){var S=n.get(x);t.set(r,S._index,b)}}};fd.prototype._getNestedAccessor=function e(t,r,n){var i=t.nested[r];if(!i){throw new Error(this._eltName+' attribute "'+n.join(".")+'" does not exist')}return i};fd.prototype._assignSingleValueToFlexArray=function e(t,r,n,value,i){if(ee(value)){var a=Object.keys(value);for(var o=0,s=a;o<s.length;o+=1){var u=s[o];i.push(u);var l=value[u];var d=this._getNestedAccessor(n,u,i);this._assignSingleValueToFlexArray(t,r,d,l,i);i.pop()}}else{var f=n.check(value,this._colorManager);n.set(t,r._index,f)}};var hd=function e(t){this._ogma=t;this._graph=t.modules.graph;this._dom=t.modules.dom;this._colorManager=new Pr;this._textHiddenSet=new Cr(t,"textHidden");this._nodes=new fd(t,this._colorManager,true);this._edges=new fd(t,this._colorManager,false);this._layerIdCounter=0;this._layers=[];this._destroyedLayers=[];this._layersNeedUpdate=false;this._updateOngoing=false;this._needUpdate=false};hd.prototype._getLayerById=function e(t){for(var r=0;r<this._layers.length;++r){var n=this._layers[r];if(n.id===t){n.index=r;return n}}throw new Error("usage of a destroyed style rule or class")};hd.prototype._fetch=function e(t){return t.isNode?this._nodes:this._edges};hd.prototype.getFlexArrays=function e(){return{nodes:{current:this._nodes.getAttributeFlexArrays(),previous:this._nodes.getPrevAttributeFlexArrays()},edges:{current:this._edges.getAttributeFlexArrays(),previous:this._edges.getPrevAttributeFlexArrays()}}};hd.prototype.createFlexArrays=function e(){return{nodes:this._nodes.createFlexArrays(),edges:this._edges.createFlexArrays()}};hd.prototype.clear=function e(){this._updateOngoing=false;this._needUpdate=false;this._destroyedLayers=[];this._nodes.clear();this._edges.clear();this.updateAllForAllAttributeLayers()};hd.prototype.redrawElements=function e(t){if(t.size){this._fetch(t).redrawElements(t);this._dom.refresh()}};hd.prototype.redrawAll=function e(){this._nodes.redrawAll();this._edges.redrawAll();this._dom.refresh()};hd.prototype._triggerUpdate=function e(){this._needUpdate=true;this._dom.refresh()};hd.prototype._reconstructAttributeLayersIfNecessary=function e(){if(this._layersNeedUpdate){this._reconstructAttributeLayers();this._layersNeedUpdate=false;this._dom.refresh();return true}return false};hd.prototype.getAnimationInformation=function e(t){return this._fetch(t).getAnimationInformation(t)};hd.prototype.update=function e(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token){return false}this._reconstructAttributeLayersIfNecessary();this._updateOngoing=true;this._nodes.startUpdate();this._edges.startUpdate();for(var t=0,r=this._destroyedLayers;t<r.length;t+=1){var n=r[t];if(n.initialized){this._nodes.notifyLayerDestroyed(n.nodes);this._edges.notifyLayerDestroyed(n.edges)}}for(var i=0,a=this._layers;i<a.length;i+=1){var o=a[i];var s=o;var u=s.nodes;var l=s.edges;this._nodes.prepareFlexArraysUpdate(u);this._edges.prepareFlexArraysUpdate(l);this._nodes.updateFlexArrays(u);this._edges.updateFlexArrays(l)}this._nodes.endUpdate();this._edges.endUpdate();this._updateOngoing=false;this._needUpdate=false;return true};hd.prototype.setAttributeLayerValues=function e(t,r,n,i){var a=this._getLayerById(t);var o=r.isNode?a.nodes:a.edges;this._reconstructAttributeLayersIfNecessary();this._fetch(r).setAttributeValues(o,r,n,i);this._updateElementsForAttributeLayers([a],r)};hd.prototype.getAttributeLayerFlexArrays=function e(t){var r=this._getLayerById(t);return{nodes:r.nodes.outputFlexArrays,edges:r.edges.outputFlexArrays}};hd.prototype.getUsedAttributeLayerAttributes=function e(t,r){var n=this._getLayerById(t);return this._fetch(r).getUsedAttributeNames(r.isNode?n.nodes:n.edges)};hd.prototype.getAndResetElementsUpdated=function e(){return{nodes:this._nodes.getAndResetElementsUpdated(),edges:this._edges.getAndResetElementsUpdated(),nodeAttributes:this._nodes.getAndResetAttributesUpdated(),edgeAttributes:this._edges.getAndResetAttributesUpdated()}};hd.prototype.getAndResetElementsToRedraw=function e(){return{nodes:this._nodes.getAndResetElementsToRedraw(),edges:this._edges.getAndResetElementsToRedraw()}};hd.prototype.addAttributeLayer=function e(t){if(t===void 0)t={};if(t.name&&this._layers.find(function(e){return e.name===t.name})){throw new Error('attribute layer with name "'+t.name+'" already exists')}var r={id:++this._layerIdCounter,name:t.name,tag:t.tag,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:false,nodes:{name:t.name,standaloneSelector:!!t.standaloneSelectors,toUpdate:new ed({ogma:this._ogma,isNode:true,includeRemovedElements:false}),outputFlexArrays:this._nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{name:t.name,standaloneSelector:!!t.standaloneSelectors,toUpdate:new ed({ogma:this._ogma,isNode:false,includeRemovedElements:false}),outputFlexArrays:this._edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}};this._layers.push(r);this._updateLayer(r,t);return new Ll(this,this._layerIdCounter)};hd.prototype._reconstructAttributeLayers=function e(){this._layers.sort(function(e,t){return e.priority-t.priority});var t=G(this._nodes.getDefaultFlexArrays());var r=G(this._edges.getDefaultFlexArrays());var n=K(t);var i=K(r);for(var a=0,o=this._layers;a<o.length;a+=1){var s=o[a];s.nodes.allAttributePaths=n;s.edges.allAttributePaths=i;s.nodes.formattedDependencies=yd(s.nodes);s.edges.formattedDependencies=bd(s.edges);s.nodes.formattedOutput=vd(s.nodes,s.tag);s.edges.formattedOutput=vd(s.edges,s.tag);s.nodes.redrawAdjacentEdges=s.nodes.formattedOutput.attributes.some(function(e){return od.includes(e)});s.initialized=true}for(var u=0,l=this._layers;u<l.length;u+=1){var d=l[u];d.nodes.inputFlexArrays=G(t);d.edges.inputFlexArrays=G(r);d.depsNodeSelf=[];d.depsNodeAdjacentNodes=[];d.depsNodeAdjacentEdges=[];d.depsNodeAllNodes=[];d.depsNodeAllEdges=[];d.depsEdgeSelf=[];d.depsEdgeExtremities=[];d.depsEdgeParallelEdges=[];d.depsEdgeAllNodes=[];d.depsEdgeAllEdges=[];d.nodes.toUpdate.addAll();d.edges.toUpdate.addAll();for(var f=0,h=d.nodes.formattedOutput.attributes;f<h.length;f+=1){var c=h[f];var g=q(t,c);var v=q(d.nodes.outputFlexArrays,c);v.setFallback(g);X(t,c,v)}for(var p=0,_=d.edges.formattedOutput.attributes;p<_.length;p+=1){var m=_[p];var y=q(r,m);var b=q(d.edges.outputFlexArrays,m);b.setFallback(y);X(r,m,b)}for(var x=0,S=this._layers;x<S.length;x+=1){var A=S[x];if(d===A){continue}var E=d.priority;var w=A.priority;var k=d.nodes.formattedOutput;var C=d.edges.formattedOutput;var T=A.nodes.formattedDependencies;var L=A.edges.formattedDependencies;md(d.depsNodeSelf,A,k,T.self,E,w);md(d.depsNodeAdjacentNodes,A,k,T.adjacentNodes,E,w);md(d.depsNodeAdjacentEdges,A,C,L.extremities,E,w);md(d.depsNodeAllNodes,A,k,T.allNodes,E,w);md(d.depsNodeAllEdges,A,C,L.allNodes,E,w);md(d.depsEdgeSelf,A,C,L.self,E,w);md(d.depsEdgeExtremities,A,k,T.adjacentEdges,E,w);md(d.depsEdgeParallelEdges,A,C,L.parallelEdges,E,w);md(d.depsEdgeAllNodes,A,k,T.allEdges,E,w);md(d.depsEdgeAllEdges,A,C,L.allEdges,E,w)}}this._nodes.setLastFlexArrays(t);this._edges.setLastFlexArrays(r);for(var M=0,I=this._layers;M<I.length;M+=1){var F=I[M];F.nodes.needAdjacentElements=F.nodes.redrawAdjacentEdges||F.depsNodeAdjacentNodes.length>0||F.depsNodeAdjacentEdges.length>0;F.edges.needAdjacentElements=F.depsEdgeExtremities.length>0||F.depsEdgeParallelEdges.length>0}};hd.prototype._updateLayer=function e(t,r){if(r===void 0)r={};var n=r.priority;var i=r.fullOverwrite;var a=r.nodeAttributes;var o=r.nodeSelector;var s=r.nodeContext;var u=r.nodeDependencies;var l=r.nodeOutput;var d=r.edgeAttributes;var f=r.edgeSelector;var h=r.edgeContext;var c=r.edgeDependencies;var g=r.edgeOutput;if(a!==undefined){t.nodes.attributes=i?a:te(t.nodes.attributes,a)}if(o!==undefined){t.nodes.selector=o}if(s!==undefined){t.nodes.context=s}if(u!==undefined){t.nodes.dependencies=u}if(l!==undefined){t.nodes.output=l}if(d!==undefined){t.edges.attributes=i?d:te(t.edges.attributes,d)}if(f!==undefined){t.edges.selector=f}if(h!==undefined){t.edges.context=h}if(c!==undefined){t.edges.dependencies=c}if(g!==undefined){t.edges.output=g}if(n!==undefined){t.priority=n}this._triggerLayerUpdate()};hd.prototype._triggerLayerUpdate=function e(){this._layersNeedUpdate=true;this._triggerUpdate()};hd.prototype.updateAllForAttributeLayer=function e(t){var r=this._getLayerById(t);this._updateAllForAttributeLayer(r)};hd.prototype.updateAllForAllAttributeLayers=function e(){for(var t=0,r=this._layers;t<r.length;t+=1){var n=r[t];this._updateAllForAttributeLayer(n)}};hd.prototype._updateAllForAttributeLayer=function e(t,r,n){if(r===void 0)r=true;if(n===void 0)n=true;if(r&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(var i=0,a=t.depsNodeSelf;i<a.length;i+=1){var o=a[i];this._updateAllForAttributeLayer(o,true,false)}for(var s=0,u=t.depsNodeAdjacentNodes;s<u.length;s+=1){var l=u[s];this._updateAllForAttributeLayer(l,true,false)}for(var d=0,f=t.depsNodeAdjacentEdges;d<f.length;d+=1){var h=f[d];this._updateAllForAttributeLayer(h,false,true)}for(var c=0,g=t.depsNodeAllNodes;c<g.length;c+=1){var v=g[c];this._updateAllForAttributeLayer(v,true,false)}for(var p=0,_=t.depsNodeAllEdges;p<_.length;p+=1){var m=_[p];this._updateAllForAttributeLayer(m,false,true)}}if(n&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(var y=0,b=t.depsEdgeSelf;y<b.length;y+=1){var x=b[y];this._updateAllForAttributeLayer(x,false,true)}for(var S=0,A=t.depsEdgeExtremities;S<A.length;S+=1){var E=A[S];this._updateAllForAttributeLayer(E,true,false)}for(var w=0,k=t.depsEdgeParallelEdges;w<k.length;w+=1){var C=k[w];this._updateAllForAttributeLayer(C,false,true)}for(var T=0,L=t.depsEdgeAllNodes;T<L.length;T+=1){var M=L[T];this._updateAllForAttributeLayer(M,true,false)}for(var I=0,F=t.depsEdgeAllEdges;I<F.length;I+=1){var N=F[I];this._updateAllForAttributeLayer(N,false,true)}}this._triggerUpdate()};hd.prototype.updateElementsForAttributeLayer=function e(t,r){var n=this._getLayerById(t);this._updateElementsForAttributeLayers([n],r)};hd.prototype.updateForAllAttributeLayers=function e(t){this._updateElementsForAttributeLayers(this._layers,t)};hd.prototype._updateElementsForAttributeLayers=function e(t,r){var n=null;if(r.isNode){for(var i=0,a=t;i<a.length;i+=1){var o=a[i];if(!o.nodes.toUpdate.isFull()){if(o.nodes.needAdjacentElements){n=n||r.fastGetAdjacentElements()}o.nodes.toUpdate.add(r);for(var s=0,u=o.depsNodeSelf;s<u.length;s+=1){var l=u[s];l.nodes.toUpdate.add(r)}for(var d=0,f=o.depsNodeAdjacentNodes;d<f.length;d+=1){var h=f[d];h.nodes.toUpdate.add(n.nodes)}for(var c=0,g=o.depsNodeAdjacentEdges;c<g.length;c+=1){var v=g[c];v.edges.toUpdate.add(n.edges)}for(var p=0,_=o.depsNodeAllNodes;p<_.length;p+=1){var m=_[p];this._updateAllForAttributeLayer(m,true,false)}for(var y=0,b=o.depsNodeAllEdges;y<b.length;y+=1){var x=b[y];this._updateAllForAttributeLayer(x,false,true)}if(o.nodes.redrawAdjacentEdges){this._edges.redrawElements(n.edges)}}}}else{for(var S=0,A=t;S<A.length;S+=1){var E=A[S];if(!E.edges.toUpdate.isFull()){if(E.edges.needAdjacentElements){n=n||r.fastGetAdjacentElements()}E.edges.toUpdate.add(r);for(var w=0,k=E.depsEdgeSelf;w<k.length;w+=1){var C=k[w];C.edges.toUpdate.add(r)}for(var T=0,L=E.depsEdgeExtremities;T<L.length;T+=1){var M=L[T];M.nodes.toUpdate.add(n.nodes)}for(var I=0,F=E.depsEdgeParallelEdges;I<F.length;I+=1){var N=F[I];N.edges.toUpdate.add(n.edges)}for(var z=0,R=E.depsEdgeAllNodes;z<R.length;z+=1){var P=R[z];this._updateAllForAttributeLayer(P,true,false)}for(var D=0,O=E.depsEdgeAllEdges;D<O.length;D+=1){var B=O[D];this._updateAllForAttributeLayer(B,false,true)}}}}this._triggerUpdate()};hd.prototype.destroyAttributeLayer=function e(t){var r=this._getLayerById(t);this._destroyedLayers.push(r);this._layers.splice(r.index,1);this._triggerLayerUpdate()};hd.prototype.updateAttributeLayer=function e(t,r){var n=this._getLayerById(t);this._updateLayer(n,r)};hd.prototype.getAttributeLayerDefinition=function e(t){var r=this._getLayerById(t);var n=r.priority;var i=r.nodes;var a=r.edges;return{priority:n,nodeAttributes:i.attributes,nodeSelector:i.selector,nodeContext:i.context,nodeDependencies:i.dependencies,nodeOutput:i.output,edgeAttributes:a.attributes,edgeSelector:a.selector,edgeContext:a.context,edgeDependencies:a.dependencies,edgeOutput:a.output}};hd.prototype.getAttributeValues=function e(t,r,n,i){this.update();return this._fetch(t).getAttributeValues(t,r,n,i)};hd.prototype.setAnimationAttributes=function e(t,r){var n=t.nodes;var i=t.edges;this._nodes.setAnimationAttributes(n,r);this._edges.setAnimationAttributes(i,r)};hd.prototype.resetAnimationAttributes=function e(t){var r=t.nodes;var n=t.edges;this._nodes.resetAnimationAttributes(r);this._edges.resetAnimationAttributes(n)};hd.prototype.setTextHidden=function e(t,value){var r=this._textHiddenSet.addOrRemoveElements(t,value);this.redrawElements(r)};hd.prototype.resetTextHidden=function e(){var t=this._textHiddenSet.getElements();var r=t.nodes;var n=t.edges;this._textHiddenSet.clear();this._nodes.redrawElements(r);this._edges.redrawElements(n)};hd.prototype.getUsedNodeAttributes=function e(){return this._nodes.getUsedAttributes()};hd.prototype.getUsedEdgeAttributes=function e(){return this._edges.getUsedAttributes()};function cd(e,t,r){if(t===void 0)t=[];if(r===void 0)r="";if(e.constructor===Ut){if(e.isInitialized()){t.push(r)}}else if(e.constructor===Object){Object.keys(e).forEach(function(n){cd(e[n],t,gd(r,n))})}return t}function gd(e,t){return e?e+"."+t:t}function vd(e,t){return{attributes:pd(e),tags:t?[t]:[]}}function pd(e){var t=null;if(e.output===undefined){if(typeof e.attributes==="function"){t="all"}else if(ee(e.attributes)){t=K(e.attributes)}else{t=null}}else{t=e.output&&e.output.attributes}return Sd(t,e.allAttributePaths)}function _d(e,t,r,n){if(n>r){for(var i=0,a=t.attributes;i<a.length;i+=1){var o=a[i];for(var s=0,u=e.attributes;s<u.length;s+=1){var l=u[s];if(l===o){return true}}}}for(var d=0,f=t.tags;d<f.length;d+=1){var h=f[d];for(var c=0,g=e.tags;c<g.length;c+=1){var v=g[c];if(h===v){return true}}}return false}function md(e,t,r,n,i,a){if(_d(r,n,i,a)){e.push(t)}}function yd(e){var t=e.dependencies;if(t===undefined){t=id}else if(!ee(t)){t={}}var r=Q(e.attributes).some(function(value){return typeof value==="function"});var n=e.selector&&!e.standaloneSelector;var i=r||n;var a=t.adjacentEdges;if(!a&&t.adjacentNodes){a=true}return{self:xd(t.self,i,e.allAttributePaths),adjacentNodes:xd(t.adjacentNodes,i,e.allAttributePaths),adjacentEdges:xd(a,i,e.allAttributePaths),allNodes:xd(t.allNodes,i,e.allAttributePaths),allEdges:xd(t.allEdges,i,e.allAttributePaths)}}function bd(e){var t=e.dependencies;if(t===undefined){t=ad}else if(!ee(t)){t={}}var r=Q(e.attributes).some(function(value){return typeof value==="function"});var n=e.selector&&!e.standaloneSelector;var i=r||n;return{self:xd(t.self,i,e.allAttributePaths),extremities:xd(t.extremities,i,e.allAttributePaths),parallelEdges:xd(t.parallelEdges,i,e.allAttributePaths),allNodes:xd(t.allNodes,i,e.allAttributePaths),allEdges:xd(t.allEdges,i,e.allAttributePaths)}}function xd(e,t,r){if(!t){return{attributes:[],tags:[]}}if(e===true){return{attributes:[],tags:[Pl]}}e=e||{};var n={attributes:Sd(e.attributes,r),tags:Ad(e.tags)};if(e.data){n.tags.push(Dl)}if(e.selection){n.tags.push(jl)}if(e.hover){n.tags.push(Ol)}return n}function Sd(value,e){if(value==="all"){return e.slice()}else if(!Array.isArray(value)){return[]}else{value=value.map(function(e){return Array.isArray(e)?e.join("."):e});value=value.filter(function(e){return typeof e==="string"});if(e){return e.filter(function(e){return value.some(function(t){return e.startsWith(t)})})}else{return value}}}function Ad(value){if(!Array.isArray(value)){return[]}else{return value.filter(function(e){return typeof e==="string"})}}function Ed(e){return e||e===0}function wd(e,t,r){if(r===void 0)r=0;if(e==="inherit"){if(!Array.isArray(t)){return t}else{var n=r/(2*Math.PI)*t.length|0;return t[n]}}else{return e}}function kd(e,t,r){if(e==="source"){return t}else if(e==="target"){return r}else{return e}}function Cd(e,t){var r=e();var n=K(r);var i=n.map(function(e){var value=q(r,e);if(!Array.isArray(value)){return"target."+e+" = source."+e+"."+t+";"}else{return"for (var i = 0; i < "+value.length+"; ++i) target."+e+"[i] = source."+e+"[i]."+t+";"}}).join("\n");return new Function("target, source",i)}function Td(e){var t=e();var r=K(t);var n=r.map(function(e){var value=q(t,e);if(!Array.isArray(value)){return"target."+e+" = target."+e+" || source."+e+";"}else{return"for (var i = 0; i < "+value.length+"; ++i) target."+e+"[i] = target."+e+"[i] || source."+e+"[i];"}}).join("\n");return new Function("target","source",n)}function Ld(e){var t=e.getDepth();if(t===_i||t===pi){return true}return(t-mi)%wi>=Si}function Md(e){var t=(e.getDepth()-mi)%wi;return t>=0&&t!==yi&&t!==Si}function Id(e,t,r,n){Fd(e,t,r,n);Nd(e,t.texts.primary,r.text,n,t);Nd(e,t.texts.secondary,r.text.secondary,n,t);zd(e,t.badges.topLeft,r.badges.topLeft,n,t);zd(e,t.badges.topRight,r.badges.topRight,n,t);zd(e,t.badges.bottomLeft,r.badges.bottomLeft,n,t);zd(e,t.badges.bottomRight,r.badges.bottomRight,n,t)}function Fd(e,t,r,n){var i=+(r.scalingMethod.get(n)==="scaled");var a=r.radius.get(n)*2;var o=r.innerStroke.width.get(n);var s=+(r.innerStroke.scalingMethod.get(n)==="scaled");var u=r.outerStroke.width.get(n);var l=+(r.outerStroke.scalingMethod.get(n)==="scaled");t.x=r.x.get(n);t.y=r.y.get(n);t.shape=r.shape.get(n);t.color=r.color.get(n);t.opacity=r.opacity.get(n);t.diameterScaled=a*i;t.diameterFixed=a*(1-i);t.innerStroke.color=wd(r.innerStroke.color.get(n),t.color);t.innerStroke.widthScaled=o*s;t.innerStroke.widthFixed=o*(1-s);t.innerStroke.minVisibleSize=r.innerStroke.minVisibleSize.get(n);t.outerStroke.color=wd(r.outerStroke.color.get(n),t.color);t.outerStroke.widthScaled=u*l;t.outerStroke.widthFixed=u*(1-l);t.halo.color=r.halo.color.get(n);t.halo.strokeColor=r.halo.strokeColor.get(n);t.icon.content=e.formatText(r.icon.content.get(n));t.image.url=r.image.url.get(n);t.outline.enabled=r.outline.enabled.get(n);t.textHidden=r.textHidden.get(n)}function Nd(e,t,r,n,i){var a=t===i.texts.primary;t.hidden=i.textHidden;t.content=e.formatText(r.content.get(n));t.backgroundColor=wd(r.backgroundColor.get(n),i.color);t.tip=a&&r.tip.get(n);t.position=a?r.position.get(n):"bottom"}function zd(e,t,r,n){t.textContent=e.formatText(r.text.content.get(n));t.imageUrl=r.image.url.get(n)}function Rd(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,minVisibleSize:0},image:{url:"",content:null,scale:0,rescale:false,duplicate:false,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:false,color:"",minVisibleSize:""},badges:{topLeft:Pd(Li),topRight:Pd(Mi),bottomLeft:Pd(Ii),bottomRight:Pd(Fi)},textHidden:false,texts:{primary:Dd(),secondary:Dd()}}}function Pd(e){return{angle:e,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:"",textStyle:"",imageUrl:"",imageContent:null,imageScale:0}}function Dd(){return{hidden:false,content:"",position:"",backgroundColor:"",tip:false,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"",align:"",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:false,isPositionVertical:false,isPositionHorizontal:false}}function Od(e){return typeof e==="number"&&isFinite(e)?e:undefined}function Bd(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}function jd(e){return typeof e==="number"&&isFinite(e)&&e>0?e:undefined}var Vd=-1;var Ud=4;var Gd=new Function("x","return (typeof x === 'number' && isFinite(x) && x % 1 === 0 && x >= "+Vd+" && x <= "+Ud+") ? x : undefined;");function Wd(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function Hd(e,t){var r=t||Wd();var n=(e-Vd)*wi+mi;r.edgeHalo=vi;r.nodeHaloStroke=pi;r.nodeHalo=_i;r.edgeBody=n+yi;r.edgeTextBackground=n+bi;r.edgeText=n+xi;r.nodeBody=n+Si;r.nodeTextBackground=n+Ai;r.nodeText=n+Ei;return r}function Xd(e,t){qd(e,t);Yd(e.texts.primary,t.texts.primary);Yd(e.texts.secondary,t.texts.secondary);Zd(e.badges.topLeft,t.badges.topLeft);Zd(e.badges.topRight,t.badges.topRight);Zd(e.badges.bottomLeft,t.badges.bottomLeft);Zd(e.badges.bottomRight,t.badges.bottomRight)}function qd(e,t){e.body=true;e.icon=!!t.icon.content;e.image=!!t.image.url;e.pieChart=Array.isArray(t.color);e.outerStroke=!!t.outerStroke.color;e.outline=!!t.outline.enabled;e.halo=!!t.halo.color;e.haloStroke=e.halo&&!!t.halo.strokeColor}function Yd(e,t){e.text=!t.hidden&&!!t.content;e.background=e.text&&!!t.backgroundColor;e.tip=e.background&&t.tip&&t.position!=="center"}function Zd(e,t){e.text=!!t.textContent;e.image=!!t.imageUrl}function Kd(e,t,r){Qd(e,t);e.fillColor=Array.isArray(t.color)?null:t.color;e.strokeColor=t.innerStroke.color;e.strokeMinVisibleSize=t.innerStroke.minVisibleSize;e.strokeWidthScaled=t.innerStroke.widthScaled;e.strokeWidthFixed=t.innerStroke.widthFixed;if(r){e.pattern.type=0}}function Qd(e,t){e.pieceId=ys;e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=t.diameterScaled;e.rectWidthOrSourceRadiusFixed=t.diameterFixed;e.rectHeightTargetRadiusScaled=t.diameterScaled;e.rectHeightTargetRadiusFixed=t.diameterFixed;e.shape=t.shape;e.opacity=t.opacity;e.symbolicSize=t.diameterScaled;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.fillColor=null;e.strokeColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.offsetAngle=0;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function Jd(e,t){var r=t.image.fit&&!t.image.tile;Qd(e,t);e.pattern.type=cs;e.pattern.attributes.image=t.image.content;e.pattern.attributes.scaled=r;e.pattern.attributes.duplicated=t.image.tile;e.patternScale=r?t.image.scale:0;e.patternMinVisibleSize=t.image.minVisibleSize;e.patternColor=null}function $d(e,t){var r=t.diameterScaled+t.halo.widthScaled*2;var n=t.diameterFixed+t.halo.widthFixed*2;e.pieceId=ys;e.shape="circle";e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=n;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=n;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=t.halo.color;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function ef(e,t){var r=t.diameterScaled+t.halo.widthScaled*2;var n=t.diameterFixed+t.halo.widthFixed*2;e.pieceId=ys;e.shape="circle";e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=n;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=n;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=t.halo.strokeWidthScaled;e.strokeWidthFixed=t.halo.strokeWidthFixed;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=null;e.strokeColor=t.halo.strokeColor;e.patternColor=null;e.globalMinVisibleSize=0;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function tf(e,t){var r=t.diameterScaled*Ni;var n=t.diameterFixed*Ni;var i=t.diameterScaled*zi;var a=t.diameterFixed*zi+Ri;if(t.outerStroke.color){i+=t.outerStroke.widthScaled/2;a+=t.outerStroke.widthFixed/2}e.pieceId=ys;e.shape=t.shape;e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=n;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=n;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=i;e.offsetFixed=a;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=t.outline.color;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.outline.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=1.5707963267948966;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function rf(e,t){Qd(e,t);e.pattern.type=ps;e.pattern.attributes.text=t.icon.content;e.pattern.attributes.font=t.icon.font;e.pattern.attributes.style=t.icon.style;e.pattern.attributes.size="sdf";e.patternMinVisibleSize=t.icon.minVisibleSize;e.patternColor=t.icon.color;e.patternScale=t.icon.scale}function nf(e,t){Qd(e,t);if(Array.isArray(t.color)){e.pattern.type=vs;e.pattern.attributes.colors=t.color.join(";");e.patternScale=1;e.patternMinVisibleSize=0;e.patternColor=null}}function af(e,t){var r=t.diameterScaled+t.innerStroke.widthScaled*2;var n=t.diameterFixed+t.innerStroke.widthFixed*2;e.pieceId=ys;e.shape=t.shape;e.x1=t.x;e.y1=t.y;e.x2=t.x;e.y2=t.y;e.rectWidthOrSourceRadiusScaled=r;e.rectWidthOrSourceRadiusFixed=n;e.rectHeightTargetRadiusScaled=r;e.rectHeightTargetRadiusFixed=n;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=t.outerStroke.widthScaled;e.strokeWidthFixed=t.outerStroke.widthFixed;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=null;e.strokeColor=t.outerStroke.color;e.patternColor=null;e.globalMinVisibleSize=t.outerStroke.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function of(e,t,r){uf(e,t,r);if(t.imageContent){e.pattern.type=cs;e.pattern.attributes.image=t.imageContent;e.pattern.attributes.scaled=true;e.pattern.attributes.duplicated=false;e.patternScale=t.imageScale;e.patternMinVisibleSize=0;e.patternColor=null}else{e.fillColor=null;e.strokeColor=null}}function sf(e,t,r){uf(e,t,r);if(t.textContent){e.pattern.type=_s;e.pattern.attributes.text=t.textContent;e.pattern.attributes.font=t.textFont;e.pattern.attributes.style=t.textStyle;e.pattern.attributes.size="sdf";e.patternMinVisibleSize=0;e.patternColor=t.textColor;e.patternScale=t.textScale}if(t.imageUrl||!t.textContent){e.fillColor=null;e.strokeColor=null}}function uf(e,t,r){var n=r.diameterScaled*t.scale;var i=r.diameterFixed*t.scale;var a=r.diameterScaled*t.positionScale/2;var o=r.diameterFixed*t.positionScale/2;e.pieceId=ys;e.shape="circle";e.x1=r.x;e.y1=r.y;e.x2=r.x;e.y2=r.y;e.rectWidthOrSourceRadiusScaled=n;e.rectWidthOrSourceRadiusFixed=i;e.rectHeightTargetRadiusScaled=n;e.rectHeightTargetRadiusFixed=i;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=t.strokeWidthScaled;e.strokeWidthFixed=t.strokeWidthFixed;e.offsetScaled=a;e.offsetFixed=o;e.pattern.type=0;e.opacity=r.opacity;e.fillColor=t.color;e.strokeColor=t.strokeColor;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.angle;e.patternScale=0;e.symbolicSize=r.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function lf(e,t,r){hf(e,t,r);e.pattern.type=ms;e.pattern.attributes.text=t.content;e.pattern.attributes.font=t.font;e.pattern.attributes.style=t.style;e.pattern.attributes.align=t.align;e.patternMinVisibleSize=0;e.patternColor=t.color;e.thicknessOrFontSizeScaled=t.sizeScaled;e.thicknessOrFontSizeFixed=t.sizeFixed;e.isText=true}function df(e,t,r){hf(e,t,r);e.fillColor=t.backgroundColor}function ff(e,t,r){var n=Math.ceil(t.margin/2)+1;var i=r.diameterScaled/2+r.innerStroke.widthScaled+r.outerStroke.widthScaled;var a=r.diameterFixed/2+r.innerStroke.widthFixed+r.outerStroke.widthFixed+n;var o=Wi[t.position];var s=Math.cos(o);var u=Math.sin(o);e.pieceId=ys;e.shape="triangle";e.x1=r.x-s;e.y1=r.y-u;e.x2=r.x+s;e.y2=r.y+u;e.rectWidthOrSourceRadiusScaled=0;e.rectWidthOrSourceRadiusFixed=t.margin;e.rectHeightTargetRadiusScaled=0;e.rectHeightTargetRadiusFixed=t.margin*Vi;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=i;e.offsetFixed=a;e.pattern.type=0;e.opacity=r.opacity;e.fillColor=t.backgroundColor;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.positionAngle;e.patternScale=0;e.symbolicSize=r.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false}function hf(e,t,r){var n=0;var i=0;var a,o;if(!t.isPositionCenter){n+=r.innerStroke.widthScaled+r.outerStroke.widthScaled+r.diameterScaled/2;i+=r.innerStroke.widthFixed+r.outerStroke.widthFixed+r.diameterFixed/2+t.margin+t.padding}if(t.isPositionVertical){n+=t.heightScaled/2;i+=t.heightFixed/2;if(t===r.texts.secondary&&r.texts.primary.position==="bottom"){var s=r.texts.primary;n+=s.heightScaled;i+=s.heightFixed+s.margin+s.padding*2}}else if(t.isPositionHorizontal){n+=t.widthScaled/2;i+=t.widthFixed/2}if(t.sizeScaled>0){a="sdf";o=1}else{a=t.sizeFixed;o=0}e.pieceId=ys;e.shape="square";e.x1=r.x;e.y1=r.y;e.x2=r.x;e.y2=r.y;e.rectWidthOrSourceRadiusScaled=t.widthScaled;e.rectWidthOrSourceRadiusFixed=t.widthFixed+t.padding*2;e.rectHeightTargetRadiusScaled=t.heightScaled;e.rectHeightTargetRadiusFixed=t.heightFixed+t.padding*2;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=n;e.offsetFixed=i;e.pattern.type=0;e.pattern.attributes.size=a;e.opacity=r.opacity;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.positionAngle;e.patternScale=o;e.symbolicSize=r.diameterScaled;e.curvature=0;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=false;e.isText=false}function cf(e,t,r,n,i,a){var o=i;var s=n;var u=a;var l=i.badges;var d=n.badges;var f=a.badges;gf(e,t,r,n,i,a);pf(e,t,r,s.text,o.texts.primary,u.texts.primary,u);pf(e,t,r,s.text.secondary,o.texts.secondary,u.texts.secondary,u);vf(e,t,r,d.topLeft,l.topLeft,f.topLeft,u);vf(e,t,r,d.topRight,l.topRight,f.topRight,u);vf(e,t,r,d.bottomLeft,l.bottomLeft,f.bottomLeft,u);vf(e,t,r,d.bottomRight,l.bottomRight,f.bottomRight,u)}function gf(e,t,r,n,i,a){if(i.halo){var o=n.halo.width.get(r);var s=+(n.halo.scalingMethod.get(r)==="scaled");a.halo.widthScaled=o*s;a.halo.widthFixed=o*(1-s);$d(i.halo,a);if(i.haloStroke){a.halo.strokeWidthScaled=0;a.halo.strokeWidthFixed=n.halo.strokeWidth.get(r);ef(i.haloStroke,a)}}if(i.outline){a.outline.color=n.outline.color.get(r);a.outline.minVisibleSize=n.outline.minVisibleSize.get(r);tf(i.outline,a)}if(i.outerStroke){a.outerStroke.minVisibleSize=n.outerStroke.minVisibleSize.get(r);af(i.outerStroke,a)}if(i.pieChart){nf(i.pieChart,a)}if(i.image){a.image.content=t.imageManager.getImage(a.image.url);a.image.fit=n.image.fit.get(r);a.image.tile=n.image.tile.get(r);a.image.scale=n.image.scale.get(r);a.image.minVisibleSize=n.image.minVisibleSize.get(r);Jd(i.image,a)}if(i.icon){a.icon.font=t.fontManager.getFont(n.icon.font.get(r));a.icon.style=n.icon.style.get(r);a.icon.color=n.icon.color.get(r);a.icon.scale=n.icon.scale.get(r);a.icon.minVisibleSize=n.icon.minVisibleSize.get(r);rf(i.icon,a)}if(i.body){var u=!i.pieChart&&!i.image&&!i.icon;Kd(i.body,a,u)}}function vf(e,t,r,n,i,a,o){if(i.image||i.text){var s=n.stroke.width.get(r);var u=+(n.stroke.scalingMethod.get(r)==="scaled");a.color=wd(n.color.get(r),o.color,a.angle);a.strokeColor=n.stroke.color.get(r);a.strokeWidthScaled=s*u;a.strokeWidthFixed=s*(1-u);a.minVisibleSize=n.minVisibleSize.get(r);a.positionScale=n.positionScale.get(r);a.scale=n.scale.get(r)}if(i.image){a.imageContent=t.imageManager.getImage(a.imageUrl);a.imageScale=n.image.scale.get(r);of(i.image,a,o)}if(i.text){a.textFont=t.fontManager.getFont(n.text.font.get(r));a.textStyle=n.text.style.get(r);a.textColor=wd(n.text.color.get(r),o.color);a.textScale=n.text.scale.get(r);var l=e.measureText(a.textContent,a.textFont,a.textStyle,a.textScale).width;if(l>1){var d=0;var f=0;while(f<a.textContent.length&&d<1){d+=e.measureText(a.textContent[f],a.textFont,a.textStyle,a.textScale).width;f+=1}if(f!==a.textContent.length){a.textContent=a.textContent.substring(0,f-1)+""}}sf(i.text,a,o)}}function pf(e,t,r,n,i,a,o){if(i.text){var s=n.scaling.get(r);a.font=t.fontManager.getFont(n.font.get(r));a.color=wd(n.color.get(r),o.color);a.style=n.style.get(r);a.align=n.align.get(r);a.minVisibleSize=n.minVisibleSize.get(r);a.margin=n.margin.get(r);a.padding=n.padding.get(r);a.maxLineLength=n.maxLineLength.get(r);a.content=Tu(a.content,a.maxLineLength);if(s){var u=n.scale.get(r);a.sizeScaled=o.diameterScaled*u;a.sizeFixed=o.diameterFixed*u}else{a.sizeFixed=n.size.get(r);a.sizeScaled=0}var l=e.measureText(a.content,a.font,a.style);a.widthScaled=l.width*a.sizeScaled;a.widthFixed=l.width*a.sizeFixed;a.heightScaled=l.height*a.sizeScaled;a.heightFixed=l.height*a.sizeFixed;a.positionAngle=Gi[a.position];a.isPositionCenter=a.position==="center";a.isPositionVertical=a.position==="top"||a.position==="bottom";a.isPositionHorizontal=a.position==="left"||a.position==="right";lf(i.text,a,o);if(i.background){df(i.background,a,o);if(i.tip){ff(i.tip,a,o)}}}}var _f=Cd(Sf,"start");var mf=Cd(Sf,"end");var yf=Td(Sf);var bf=function e(t){var r=t.engine;var n=t.imageManager;var i=t.fontManager;var a=t.formatText;var o=t.attributes;var s=t.attributesPrev;this._engine=r;this._attributes=o;this._attributesPrev=s;this._helper={imageManager:n,fontManager:i,formatText:a};this._blocks=xf(function(){return r.createBlock()});this._blockIds=xf();this._fullComponents=Sf();this._startComponents=Sf();this._endComponents=Sf();this._startFlags=Sf();this._endFlags=Sf();this._startInput=Rd();this._endInput=Rd();this._depthInfo=Wd();this._nodePatternAssigned=false;this._nullElt={start:null,end:null}};bf.prototype.drawNode=function e(t){this._computeBlockIds(t);var r=this._attributes.excluded.get(t);if(r){this._freeBlocks()}else{var n=this._engine;var i=this._helper;var a="n"+t;var o=this._attributes.layer.get(t);var s=Hd(o,this._depthInfo);var u=this._attributes.animationDuration.get(t);var l=u>0;this._prepareBlocks(l,s,a);Id(i,this._endInput,this._attributes,t);Xd(this._endFlags,this._endInput);if(l){Id(i,this._startInput,this._attributesPrev,t);Xd(this._startFlags,this._startInput);yf(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks);mf(this._endComponents,this._fullComponents);cf(n,i,t,this._attributes,this._endComponents,this._endInput);if(l){_f(this._startComponents,this._fullComponents);cf(n,i,t,this._attributesPrev,this._startComponents,this._startInput)}if(l){var d=this._attributes.animationStart.get(t);var f=this._attributes.animationEasing.get(t);this._setBlocksAnimation(u,d,f)}if(this._endFlags.halo){var h=this._attributes.halo.hideNonAdjacentEdges.get(t);if(h){this._blocks.halo.setStencilUsage(ws);this._blocks.haloStroke.setStencilUsage(ws)}}this._storeBlocks()}};bf.prototype._computeBlockIds=function e(t){var r=t*gi;this._blockIds.body=r+ii;this._blockIds.text=r+ai;this._blockIds.textBg=r+oi;this._blockIds.halo=r+si;this._blockIds.haloStroke=r+ui};bf.prototype._prepareBlocks=function e(t,r,n){this._blocks.body.reset(ls,t,r.nodeBody,n);this._blocks.text.reset(ds,t,r.nodeText,n);this._blocks.textBg.reset(ls,t,r.nodeTextBackground,n);this._blocks.halo.reset(ls,t,r.nodeHalo,n);this._blocks.haloStroke.reset(ls,t,r.nodeHaloStroke,n)};bf.prototype._storeBlocks=function e(){this._engine.storeBlock(this._blockIds.body,this._blocks.body);this._engine.storeBlock(this._blockIds.text,this._blocks.text);this._engine.storeBlock(this._blockIds.textBg,this._blocks.textBg);this._engine.storeBlock(this._blockIds.halo,this._blocks.halo);this._engine.storeBlock(this._blockIds.haloStroke,this._blocks.haloStroke)};bf.prototype._freeBlocks=function e(){this._engine.freeBlock(this._blockIds.body);this._engine.freeBlock(this._blockIds.text);this._engine.freeBlock(this._blockIds.textBg);this._engine.freeBlock(this._blockIds.halo);this._engine.freeBlock(this._blockIds.haloStroke)};bf.prototype._setBlocksAnimation=function e(t,r,n){this._blocks.body.setGlobalAnimation(t,r,n);this._blocks.text.setGlobalAnimation(t,r,n);this._blocks.textBg.setGlobalAnimation(t,r,n);this._blocks.halo.setGlobalAnimation(t,r,n);this._blocks.haloStroke.setGlobalAnimation(t,r,n)};bf.prototype._initComponents=function e(t,r,n){this._nodePatternAssigned=false;this._initBaseComponents(t,r,n);this._initBadgeComponents(t.badges.topLeft,r.badges.topLeft,n);this._initBadgeComponents(t.badges.topRight,r.badges.topRight,n);this._initBadgeComponents(t.badges.bottomLeft,r.badges.bottomLeft,n);this._initBadgeComponents(t.badges.bottomRight,r.badges.bottomRight,n);this._initTextComponents(t.texts.primary,r.texts.primary,n);this._initTextComponents(t.texts.secondary,r.texts.secondary,n)};bf.prototype._initBaseComponents=function e(t,r,n){t.haloStroke=this._nextElement(r.haloStroke,n.haloStroke);t.halo=this._nextElement(r.halo,n.halo);t.outline=this._nextElement(r.outline,n.body);t.outerStroke=this._nextElement(r.outerStroke,n.body);t.body=this._nextElement(r.body,n.body);t.pieChart=this._getNodePatternElement(r.pieChart,n);t.image=this._getNodePatternElement(r.image,n);t.icon=this._getNodePatternElement(r.icon,n)};bf.prototype._initBadgeComponents=function e(t,r,n){t.image=this._nextElement(r.image,n.body);t.text=this._nextElement(r.text,n.body)};bf.prototype._initTextComponents=function e(t,r,n){t.background=this._nextElement(r.background,n.textBg);t.tip=this._nextElement(r.tip,n.textBg);t.text=this._nextElement(r.text,n.text)};bf.prototype._nextElement=function e(t,r){return t?r.next():this._nullElt};bf.prototype._getNodePatternElement=function e(t,r){if(!t){return this._nullElt}else if(!this._nodePatternAssigned){this._nodePatternAssigned=true;return r.body.getCurrentElement()}else{return r.body.next()}};function xf(e){if(e===void 0)e=function(){return 0};return{body:e(),text:e(),textBg:e(),halo:e(),haloStroke:e()}}function Sf(){return{haloStroke:undefined,halo:undefined,outline:undefined,outerStroke:undefined,body:undefined,pieChart:undefined,image:undefined,icon:undefined,badges:{topLeft:{text:undefined,image:undefined},topRight:{text:undefined,image:undefined},bottomLeft:{text:undefined,image:undefined},bottomRight:{text:undefined,image:undefined}},texts:{primary:{text:undefined,background:undefined,tip:undefined},secondary:{text:undefined,background:undefined,tip:undefined}}}}function Af(e,t,r,n,i,a){Ef(e,t,r,n,i,a);wf(e,t.texts.primary,r.text,n,t);wf(e,t.texts.secondary,r.text.secondary,n,t)}function Ef(e,t,r,n,i,a){var o=i.source;var s=i.target;var u=r.source.get(n);var l=r.target.get(n);var d=o.x.get(u);var f=o.y.get(u);var h=o.radius.get(u);var c=o.color.get(u);var g=+(o.scalingMethod.get(u)==="scaled");var v=s.x.get(l);var p=s.y.get(l);var _=s.radius.get(l);var m=s.color.get(l);var y=+(s.scalingMethod.get(l)==="scaled");var b=kd(r.color.get(n),c,m);var x=r.width.get(n);var S=+(r.scalingMethod.get(n)==="scaled");var A=r.stroke.width.get(n);var E=+(r.stroke.scalingMethod.get(n)==="scaled");var w=Ui[r.shape.style.get(n)];var k=r.adjustAnchors.get(n);t.source=u;t.target=l;t.sourceX=d;t.sourceY=f;t.targetX=v;t.targetY=p;t.sourceRadiusScaled=h*g;t.sourceRadiusFixed=h*(1-g);t.targetRadiusScaled=_*y;t.targetRadiusFixed=_*(1-y);t.widthScaled=x*S;t.widthFixed=x*(1-S);t.curvature=r.curvature.get(n);t.isSelfLoop=u===l;t.color=b;t.opacity=r.opacity.get(n);t.minVisibleSize=r.minVisibleSize.get(n);t.shape.type=r.shape.type.get(n);t.shape.head=r.shape.head.get(n);t.shape.tail=r.shape.tail.get(n);t.shape.dashLength=w.dash;t.shape.gapLength=w.gap;t.shape.isBodyTriangle=t.shape.type==="triangle";t.stroke.color=wd(r.stroke.color.get(n),b);t.stroke.widthScaled=A*E;t.stroke.widthFixed=A*(1-E);t.stroke.minVisibleSize=r.stroke.minVisibleSize.get(n);t.halo.color=r.halo.color.get(n);t.outline.enabled=r.outline.enabled.get(n);t.textHidden=r.textHidden.get(n);if(k&&(t.shape.head||t.shape.tail||t.shape.type==="triangle")){var C=t;var T=C.curvature;var L=C.sourceX;var M=C.sourceY;var I=C.targetX;var F=C.targetY;var N=1;var z=1;if(!T){N=kf(C,a,o,u,L,M,I,F);z=kf(C,a,s,l,I,F,L,M)}else if(!C.isSelfLoop){var R=Hi(L,M,I,F,T/2);N=kf(C,a,o,u,L,M,R.x,R.y);z=kf(C,a,s,l,I,F,R.x,R.y)}t.sourceRadiusScaled*=N;t.sourceRadiusFixed*=N;t.targetRadiusScaled*=z;t.targetRadiusFixed*=z}}function wf(e,t,r,n,i){t.hidden=i.textHidden;t.content=e.formatText(r.content.get(n));t.backgroundColor=wd(r.backgroundColor.get(n),i.color)}function kf(e,t,r,n,i,a,o,s){var u=t.angle;var l=Math.atan2(s-a,o-i)-u;var d=1;var f=0;var h=null;if(l<-Ci){l+=Ti}else if(l>Ci){l-=Ti}if(l<-Ci/2){f=Li;h=r.badges.topLeft}else if(l<0){f=Mi;h=r.badges.topRight}else if(l<Ci/2){f=Fi;h=r.badges.bottomRight}else{f=Ii;h=r.badges.bottomLeft}f+=u;var c=h.text.content.get(n);var g=h.image.url.get(n);if(Ed(c)||g){var v=h.positionScale.get(n);var p=h.scale.get(n);var _=Math.cos(f);var m=Math.sin(f);var y=i+_*v;var b=a+m*v;var x=Vr(o,s,i,a,y,b,p);if(x){var S=x.x-i;var A=x.y-a;var E=Math.sqrt(S*S+A*A);d=Math.max(d,E)}}var w=r.shape.get(n);if(w==="square"){var k=Math.abs(Math.cos(l));var C=Math.abs(Math.sin(l));var T=1/Math.max(k,C);d=Math.max(d,T)}return d}function Cf(){return{sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:false,color:"",opacity:0,minVisibleSize:0,shape:{type:"",head:null,tail:null,dashLength:0,gapLength:0},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:false,color:"",minVisibleSize:""},textHidden:false,texts:{primary:Tf(),secondary:Tf()}}}function Tf(){return{hidden:false,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:false}}function Lf(e,t){Mf(e.body,t,true,true);Mf(e.outline,t,t.outline.enabled,true);Mf(e.halo,t,!!t.halo.color,false);If(e.texts.primary,t.texts.primary);If(e.texts.secondary,t.texts.secondary)}function Mf(e,t,value,r){e.body=value;e.head=value&&r&&!!t.shape.head;e.tail=value&&r&&!!t.shape.tail}function If(e,t){e.text=!t.hidden&&!!t.content;e.background=e.text&&!!t.backgroundColor}function Ff(e,t,r,n){Nf(e,t,r,n);e.thicknessOrFontSizeScaled=t.widthScaled;e.thicknessOrFontSizeFixed=t.widthFixed;e.strokeWidthScaled=t.stroke.widthScaled;e.strokeWidthFixed=t.stroke.widthFixed;e.offsetScaled=0;e.offsetFixed=0;e.fillColor=t.color;e.strokeColor=t.stroke.color;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=t.stroke.minVisibleSize;e.offsetAngle=0;e.symbolicSize=t.widthScaled;e.dashLength=t.shape.dashLength;e.gapLength=t.shape.gapLength;e.hasHead=!!t.shape.head;e.hasTail=!!t.shape.tail;e.isBodyTriangle=t.shape.isBodyTriangle}function Nf(e,t,r,n){e.pieceId=r;e.shape=n;e.x1=t.sourceX;e.y1=t.sourceY;e.x2=t.targetX;e.y2=t.targetY;e.rectWidthOrSourceRadiusScaled=t.sourceRadiusScaled;e.rectWidthOrSourceRadiusFixed=t.sourceRadiusFixed;e.rectHeightTargetRadiusScaled=t.targetRadiusScaled;e.rectHeightTargetRadiusFixed=t.targetRadiusFixed;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.pattern.type=0;e.opacity=t.opacity;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=null;e.patternMinVisibleSize=0;e.offsetAngle=0;e.patternScale=0;e.symbolicSize=t.widthScaled;e.curvature=t.curvature;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=t.isSelfLoop;e.isText=false}function zf(e,t,r){var n=t.widthScaled+t.halo.widthScaled*2;var i=t.widthFixed+t.halo.widthFixed*2;Nf(e,t,r,"line");e.thicknessOrFontSizeScaled=n;e.thicknessOrFontSizeFixed=i;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=0;e.offsetFixed=0;e.fillColor=t.halo.color;e.strokeColor=null;e.globalMinVisibleSize=t.minVisibleSize;e.strokeMinVisibleSize=0;e.offsetAngle=0;e.symbolicSize=t.widthScaled;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isBodyTriangle=false}function Rf(e,t,r,n){Nf(e,t,r,n);e.thicknessOrFontSizeScaled=t.widthScaled*Pi;e.thicknessOrFontSizeFixed=t.widthFixed*Pi;e.strokeWidthScaled=0;e.strokeWidthFixed=0;e.offsetScaled=t.widthScaled*Di;e.offsetFixed=t.widthFixed*Di+Oi;e.fillColor=t.outline.color;e.strokeColor=0;e.globalMinVisibleSize=Math.max(t.minVisibleSize,t.outline.minVisibleSize);e.strokeMinVisibleSize=0;e.offsetAngle=Math.PI/2;e.symbolicSize=t.widthScaled;e.dashLength=t.shape.dashLength;e.gapLength=t.shape.gapLength;e.hasHead=!!t.shape.head;e.hasTail=!!t.shape.tail;e.isBodyTriangle=t.shape.isBodyTriangle}function Pf(e,t,r){Of(e,t,r);e.pattern.type=ms;e.pattern.attributes.text=t.content;e.pattern.attributes.size="sdf";e.pattern.attributes.font=t.font;e.pattern.attributes.style=t.style;e.pattern.attributes.align=t.align;e.patternColor=t.color;e.patternScale=1;e.thicknessOrFontSizeScaled=t.sizeScaled;e.thicknessOrFontSizeFixed=t.sizeFixed;e.isText=true}function Df(e,t,r){Of(e,t,r);e.fillColor=t.backgroundColor}function Of(e,t,r){var n=(r.widthScaled+t.heightScaled)/2+r.stroke.widthScaled;var i=(r.widthFixed+t.heightFixed)/2+r.stroke.widthFixed+t.padding+t.margin;e.pieceId=As;e.shape="square";e.x1=r.sourceX;e.y1=r.sourceY;e.x2=r.targetX;e.y2=r.targetY;e.rectWidthOrSourceRadiusScaled=t.widthScaled;e.rectWidthOrSourceRadiusFixed=t.widthFixed+t.padding*2+1;e.rectHeightTargetRadiusScaled=t.heightScaled;e.rectHeightTargetRadiusFixed=t.heightFixed+t.padding*2;e.thicknessOrFontSizeScaled=0;e.thicknessOrFontSizeFixed=0;e.strokeWidthScaled=r.sourceRadiusScaled+r.targetRadiusScaled;e.strokeWidthFixed=r.sourceRadiusFixed+r.targetRadiusFixed;e.offsetScaled=n;e.offsetFixed=i;e.pattern.type=0;e.opacity=r.opacity;e.fillColor=null;e.strokeColor=null;e.patternColor=null;e.globalMinVisibleSize=Math.max(t.minVisibleSize,r.minVisibleSize);e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.offsetAngle=t.offsetAngle;e.patternScale=0;e.symbolicSize=r.widthScaled;e.curvature=r.curvature;e.dashLength=0;e.gapLength=0;e.hasHead=false;e.hasTail=false;e.isSelfLoop=r.isSelfLoop;e.isText=false;e.adjustTextAngle=t.adjustAngle}function Bf(e,t,r,n,i,a){jf(e,t,r,n,i,a);Uf(e,t,r,n.text,i.texts.primary,a.texts.primary,a);Uf(e,t,r,n.text.secondary,i.texts.secondary,a.texts.secondary,a)}function jf(e,t,r,n,i,a){Vf(i.body,a,Ff);if(i.halo.body){var o=n.halo.width.get(r);var s=+(n.halo.scalingMethod.get(r)==="scaled");a.halo.widthScaled=o*s;a.halo.widthFixed=o*(1-s);Vf(i.halo,a,zf)}if(i.outline.body){a.outline.color=n.outline.color.get(r);a.outline.minVisibleSize=n.outline.minVisibleSize.get(r);Vf(i.outline,a,Rf)}}function Vf(e,t,r){r(e.body,t,bs,t.shape.type);if(e.head){r(e.head,t,xs,t.shape.head)}if(e.tail){r(e.tail,t,Ss,t.shape.tail)}}function Uf(e,t,r,n,i,a,o){if(i.text){var s=n.scaling.get(r);a.font=t.fontManager.getFont(n.font.get(r));a.color=wd(n.color.get(r),o.color);a.style=n.style.get(r);a.minVisibleSize=n.minVisibleSize.get(r);a.margin=n.margin.get(r);a.padding=n.padding.get(r);a.maxLineLength=n.maxLineLength.get(r);a.content=Tu(a.content,a.maxLineLength);a.adjustAngle=n.adjustAngle.get(r);a.align=n.align.get(r);if(s){var u=n.scale.get(r);a.sizeScaled=o.widthScaled*u;a.sizeFixed=o.widthFixed*u}else{a.sizeFixed=n.size.get(r);a.sizeScaled=0}var l=e.measureText(a.content,a.font,a.style);a.widthScaled=l.width*a.sizeScaled;a.widthFixed=l.width*a.sizeFixed;a.heightScaled=l.height*a.sizeScaled;a.heightFixed=l.height*a.sizeFixed;a.offsetAngle=a===o.texts.primary?Bi:ji;Pf(i.text,a,o);if(i.background){Df(i.background,a,o)}}}var Gf=Cd(Yf,"start");var Wf=Cd(Yf,"end");var Hf=Td(Yf);var Xf=function e(t){var r=t.engine;var n=t.imageManager;var i=t.fontManager;var a=t.formatText;var o=t.view;var s=t.attributes;var u=t.attributesPrev;var l=t.nodeAttributes;var d=t.nodeAttributesPrev;this._engine=r;this._view=o;this._helper={imageManager:n,fontManager:i,formatText:a};this._attributes=s;this._attributesPrev=u;this._nodeAttributes=l;this._nodeAttributesPrev=d;this._extremitiesAttributes={source:null,target:null};this._blocks=qf(function(){return r.createBlock()});this._blockIds=qf();this._fullComponents=Yf();this._startComponents=Yf();this._endComponents=Yf();this._startFlags=Yf();this._endFlags=Yf();this._startInput=Cf();this._endInput=Cf();this._depthInfo=Wd();this._nullElt={start:null,end:null}};Xf.prototype.drawEdge=function e(t){this._computeBlockIds(t);var r=this._attributes.excluded.get(t);if(r){this._freeBlocks()}else{var n=this._engine;var i=this._helper;var a=this._extremitiesAttributes;var o="e"+t;var s=this._attributes.layer.get(t);var u=Hd(s,this._depthInfo);var l=this._attributes.source.get(t);var d=this._attributes.target.get(t);var f=this._attributes.curvature.get(t);var h=this._attributesPrev.curvature.get(t);var c=this._attributes.animationDuration.get(t);var g=this._attributes.animationStart.get(t);var v=this._attributes.animationEasing.get(t);var p=c>0;var _=f!==0||p&&h!==0;this._prepareBlocks(p,u,o,_);a.source=this._nodeAttributes;a.target=this._nodeAttributes;Af(i,this._endInput,this._attributes,t,a,this._view);Lf(this._endFlags,this._endInput);if(p){var m=this._nodeAttributes.animationDuration.get(l)>0;var y=this._nodeAttributes.animationDuration.get(d)>0;a.source=m?this._nodeAttributesPrev:this._nodeAttributes;a.target=y?this._nodeAttributesPrev:this._nodeAttributes;Af(i,this._startInput,this._attributesPrev,t,a,this._view);Lf(this._startFlags,this._startInput);Hf(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks);Wf(this._endComponents,this._fullComponents);Bf(n,i,t,this._attributes,this._endComponents,this._endInput);if(p){Gf(this._startComponents,this._fullComponents);Bf(n,i,t,this._attributesPrev,this._startComponents,this._startInput);this._setBlocksAnimation(c,g,v)}this._setupHaloMasking(l,d);this._storeBlocks()}};Xf.prototype._setupHaloMasking=function e(t,r){var n=this._nodeAttributes.halo;var i=n.color.get(t)&&n.hideNonAdjacentEdges.get(t);var a=n.color.get(r)&&n.hideNonAdjacentEdges.get(r);var o=!i&&!a;var s=o?ks:Es;this._blocks.body.setStencilUsage(s);this._blocks.text.setStencilUsage(s);this._blocks.textBg.setStencilUsage(s)};Xf.prototype._computeBlockIds=function e(t){var r=t*gi;this._blockIds.body=r+li;this._blockIds.halo=r+hi;this._blockIds.text=r+di;this._blockIds.textBg=r+fi};Xf.prototype._prepareBlocks=function e(t,r,n,i){this._blocks.body.reset(i?fs:ls,t,r.edgeBody,n);this._blocks.halo.reset(i?fs:ls,t,r.edgeHalo,n);this._blocks.text.reset(ds,t,r.edgeText,n);this._blocks.textBg.reset(ls,t,r.edgeTextBackground,n)};Xf.prototype._storeBlocks=function e(){this._engine.storeBlock(this._blockIds.body,this._blocks.body);this._engine.storeBlock(this._blockIds.halo,this._blocks.halo);this._engine.storeBlock(this._blockIds.text,this._blocks.text);this._engine.storeBlock(this._blockIds.textBg,this._blocks.textBg)};Xf.prototype._freeBlocks=function e(){this._engine.freeBlock(this._blockIds.body);this._engine.freeBlock(this._blockIds.halo);this._engine.freeBlock(this._blockIds.text);this._engine.freeBlock(this._blockIds.textBg)};Xf.prototype._setBlocksAnimation=function e(t,r,n){this._blocks.body.setGlobalAnimation(t,r,n);this._blocks.halo.setGlobalAnimation(t,r,n);this._blocks.text.setGlobalAnimation(t,r,n);this._blocks.textBg.setGlobalAnimation(t,r,n)};Xf.prototype._initComponents=function e(t,r,n){this._initEdgeComponents(t.halo,r.halo,n.halo);this._initEdgeComponents(t.outline,r.outline,n.body);this._initEdgeComponents(t.body,r.body,n.body);this._initTextComponents(t.texts.primary,r.texts.primary,n);this._initTextComponents(t.texts.secondary,r.texts.secondary,n)};Xf.prototype._initEdgeComponents=function e(t,r,n){t.head=this._nextElement(r.head,n);t.tail=this._nextElement(r.tail,n);t.body=this._nextElement(r.body,n)};Xf.prototype._initTextComponents=function e(t,r,n){t.background=this._nextElement(r.background,n.textBg);t.text=this._nextElement(r.text,n.text)};Xf.prototype._nextElement=function e(t,r){return t?r.next():this._nullElt};function qf(e){if(e===void 0)e=function(){return 0};return{body:e(),halo:e(),text:e(),textBg:e()}}function Yf(){return{halo:{body:undefined,head:undefined,tail:undefined},outline:{body:undefined,head:undefined,tail:undefined},body:{body:undefined,head:undefined,tail:undefined},texts:{primary:{text:undefined,background:undefined},secondary:{text:undefined,background:undefined}}}}function Zf(e){var t=e.ogma;var r=e.graph;var n=e.engine;var i=e.imageManager;var a=e.fontManager;var o=e.view;var s=e.attributes;var u=e.boundaries;var l=e.formatText;var d=Kf(s);var f=d.nodeAttributes;var h=d.nodeAttributesPrev;var c=d.edgeAttributes;var g=d.edgeAttributesPrev;var v=r.nodes;var p=r.edges;var _=u.maxSize;var m=u.maxMinVisibleSize;if(!v.size&&!p.size){return}var y=Math.max(t.modules.graph.getNodeMaxIndex(),t.modules.graph.getEdgeMaxIndex());var b=(y+1)*gi;var x=n.setGlobalBoundaries({maxBlockId:Qe(b),maxScaledSize:Qe(_*8),maxMinVisibleSize:Qe(m),maxSymbolicSize:Qe(_),maxDashLength:3,maxGapLength:1,maxPatternScale:2});var S=(x?t.getNodes("_all"):v)._indexes;var A=(x?t.getEdges("_all"):p)._indexes;if(S.length){var E=new bf({engine:n,imageManager:i,fontManager:a,formatText:l,attributes:f,attributesPrev:h});for(var w=0;w<S.length;++w){E.drawNode(S[w])}}if(A.length){var k=new Xf({engine:n,imageManager:i,fontManager:a,formatText:l,view:o,attributes:c,attributesPrev:g,nodeAttributes:f,nodeAttributesPrev:h});for(var C=0;C<A.length;++C){k.drawEdge(A[C])}}}function Kf(e){var t=te(e.nodes.current,{text:{secondary:{scaling:e.nodes.current.text.scaling,maxLineLength:e.nodes.current.text.maxLineLength}}});var r=te(e.nodes.previous,{textHidden:t.textHidden,text:{secondary:{scaling:e.nodes.previous.text.scaling,maxLineLength:e.nodes.previous.text.maxLineLength}}});var n=te(e.edges.current,{text:{secondary:{scaling:e.edges.current.text.scaling,maxLineLength:e.edges.current.text.maxLineLength,adjustAngle:e.edges.current.text.adjustAngle}}});var i=te(e.edges.previous,{source:e.edges.current.source,target:e.edges.current.target,textHidden:e.edges.current.textHidden,text:{secondary:{scaling:e.edges.previous.text.scaling,maxLineLength:e.edges.previous.text.maxLineLength,adjustAngle:e.edges.previous.text.adjustAngle}}});return{nodeAttributes:t,nodeAttributesPrev:r,edgeAttributes:n,edgeAttributesPrev:i}}var Qf=typeof document!=="undefined"&&!window.__OGMA_HEADLESS;var Jf=Qf&&document.fonts;var $f=200;var eh="/qwerty/ [HELLO] ";var th="serif";var rh="12px FontThatDoesNotExist";var nh=function e(){this._fontFaceSet=Jf?document.fonts:null;this._checkReliable=this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check(rh);this._canvas=we();this._ctx=this._canvas.getContext("2d")};nh.prototype._measureText=function e(t,r){this._ctx.font="12px "+r;return this._ctx.measureText(t).width};nh.prototype.check=function e(t){if(this._checkReliable){return this._fontFaceSet.check("12px "+t)}else{var r=this._measureText(eh,th);var n=this._measureText(eh,t);return n!==r}};nh.prototype.load=function e(t){if(this._fontFaceSet&&this._fontFaceSet.load){return this._fontFaceSet.load("12px "+t)}else{this._ctx.font="12px "+t;this._ctx.fillText(eh,10,50);return Promise.resolve()}};var ih=function e(){this._fontFaceSet=new nh;this._fonts={};this._onFontLoaded=[];this._hideUntilFontsLoaded=true};ih.prototype.setHideUntilFontsLoaded=function e(value){this._hideUntilFontsLoaded=value};ih.prototype.getFont=function e(t){var r=this;var n=this._fonts[t];if(!n){n=new ah(this._fontFaceSet,t);this._fonts[t]=n;if(!n.isLoaded()){n.load().then(function(){return r._triggerFontLoaded(t)})}}return!this._hideUntilFontsLoaded&&t||n.getValue()};ih.prototype.onFontLoaded=function e(t){this._onFontLoaded.push(t)};ih.prototype.destroy=function e(){var t=this;this._onFontLoaded=[];Object.keys(this._fonts).forEach(function(e){return t._fonts[e].destroy()})};ih.prototype._triggerFontLoaded=function e(t){this._onFontLoaded.forEach(function(e){return e(t)})};var ah=function e(t,r){this._fontFaceSet=t;this._fontName=r;this._loaded=false;this._value=null;this._timeout=null;if(!Qf||this._fontFaceSet.check(this._fontName)){this._setLoaded()}};ah.prototype._setLoaded=function e(){this._loaded=true;this._value=this._fontName};ah.prototype.getValue=function e(){return this._value};ah.prototype.isLoaded=function e(){return this._loaded};ah.prototype.destroy=function e(){clearTimeout(this._timeout)};ah.prototype.load=function e(){var t=this;return this._tryLoad($f).then(function(){t._setLoaded()})};ah.prototype._tryLoad=function e(t){var r=this;return this._fontFaceSet.load(this._fontName).then(function(){var e=r._fontFaceSet.check(r._fontName);if(!e){return new Promise(function(e){if(t<6e4){r._timeout=setTimeout(e,t)}}).then(function(){return r._tryLoad(t*1.5)})}})};function oh(e,t){var r=["circle","square","triangle","line"];var n=["cross","diamond","pentagon","star"];var i=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];for(var a=0,o=r;a<o.length;a+=1){var s=o[a];sh(e,s)}var u=t.nodes.current.shape.getValues();var l=t.edges.current.shape.head.getValues();var d=t.edges.current.shape.tail.getValues();for(var f=0,h=n;f<h.length;f+=1){var c=h[f];if(u.includes(c)){sh(e,c)}}for(var g=0,v=i;g<v.length;g+=1){var p=v[g];if(l.includes(p)||d.includes(p)){sh(e,p)}}}function sh(e,t){e.registerShape(t,vh[t])}var uh=_h(4);var lh=_h(5);var dh=_h(10,.4);var fh=1/3;var hh=[{x:-1,y:-fh},{x:0,y:-fh},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:fh},{x:-1,y:fh}];var ch=[{x:-1,y:-fh},{x:-.55,y:-fh},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:fh},{x:-1,y:fh}];var gh=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}];var vh={circle:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.sqrt(e*e+t*t)},points:[{x:0,y:0,r:1}],isSimple:true},square:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:true},line:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:true},triangle:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:true},arrow:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:true},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){return Math.min(Math.sqrt((e+.4)*(e+.4)+t*t)-.27,(1-e)/2-Math.abs(t))},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:true},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(e,t){var r=Math.min((1-e)/2-Math.abs(t),1-Math.abs(e));var n=-ph(e,t,gh);return Math.min(r,n)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:gh,isSimple:true},"short-arrow":mh(hh,false),"sharp-arrow":mh(ch,false),cross:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){var r=Math.abs(e);var n=Math.abs(t);var i=.31-Math.min(r,n);var a=1-Math.max(Math.abs(e),Math.abs(t));return Math.min(i,a)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}]},diamond:mh(uh),pentagon:mh(lh),star:mh(dh)};function ph(e,t,r){var n=Infinity;var i={x:e,y:t};for(var a=0;a<r.length;++a){var o=r[a];var s=r[(a+1)%r.length];n=Math.min(n,nn(i,o,s))}var u=dn(e,t,r);return n*(u?1:-1)}function _h(e,t){if(t===void 0)t=1;var r=-Math.PI/2+ki;var n=[];var i=Math.PI*2/e;var a=r;for(var o=0;o<e;++o){var s=o%2===1?t:1;n.push({x:Math.cos(a)*s,y:Math.sin(a)*s});a+=i}return n}function mh(e,t){return{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(t,r){return ph(t,r,e)},points:e,isSimple:t}}Ogma.extend(function(e){var t=new Ch(e);var r=e.Node;var n=e.Edge;var i=e.NodeList;var a=e.EdgeList;e.modules.graphics=t;e.reloadFonts=function(){t.reloadFonts()};e.view.getImageData=function(){return t.getImageData()};e.events.onRendererStateChange=function(t){e.modules.events.on("rendererStateChange",t);return e.events};e.styles.setNodesVisibility=function(value){return t.setNodesVisibility(value)};e.styles.setEdgesVisibility=function(value){return t.setEdgesVisibility(value)};e.styles.setNodeTextsVisibility=function(value){return t.setNodeTextsVisibility(value)};e.styles.setEdgeTextsVisibility=function(value){return t.setEdgeTextsVisibility(value)};r.prototype.getAnimationInformation=function(){return t.getAnimationInformation(this)[0]};i.prototype.getAnimationInformation=function(){return t.getAnimationInformation(this)};n.prototype.getAnimationInformation=function(){return t.getAnimationInformation(this)[0]};a.prototype.getAnimationInformation=function(){return t.getAnimationInformation(this)};yh([r,n,i,a],"setStyle","setAttributes");yh([r,n,i,a],"resetStyle","resetAttributes");yh([r,n,i,a],"getStyle","getAttribute");yh([r,i],"setPosition","setAttributes")});function yh(e,t,r){for(var n=0;n<e.length;++n){var i=e[n];i.prototype[t]=function(e,n){Xa('Deprecated method "'+t+'"; please use "'+r+'" instead.');return this[r](e,n)}}}var bh="anonymous";var xh="white";var Sh="default";var Ah={maxBlockId:1024,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1};Ogma.afterInit(function(e,t){if(t.renderer!==undefined){e.setOptions({renderer:t.renderer})}if(t.imgCrossOrigin!==undefined){e.setOptions({imgCrossOrigin:t.imgCrossOrigin})}e.modules.dom.addWindowEventListener("unload",function(){Eh(e)})});Ogma.onDestroy(function(e){Eh(e);wh(e)});function Eh(e){if(e.modules){e.modules.graphics.getGraphicsEngine().destroy()}}function wh(e){if(e.modules){e.modules.graphics.getImageManager().destroy();e.modules.graphics.getFontManager().destroy()}}var kh=typeof window==="undefined"||window.__OGMA_HEADLESS?null:"webgl";Ogma.beforeInit(function(e){if(kh==="webgl"){e._graphicsEngineInitData=wl.createInitData()}});var Ch=function e(t){var r=this;this._ogma=t;this._debug=t._debug;this._events=t.modules.events;this._dom=t.modules.dom;this._graph=t.modules.graph;this._camera=t.modules.camera;this._events=t.modules.events;this._settings=t.modules.settings;this._formatText=Fu().applyArabicShaping;this._attributesManager=new hd(t);this._imageManager=new Tl;this._fontManager=new ih;this._engine=new wl(t._graphicsEngineInitData);this._domElement=this._engine.getDomElement();this._animations=[];this._cursorStyle=[];this._initDone=false;this._fontsNewlyLoaded=[];this._rendererState={type:"",code:"",state:"",message:""};this._boundaries={maxSize:10,maxMinVisibleSize:64};this._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0};this._nextAnimationId=1;this._nodeAnimationList=this._graph.createNodeAttribute({storage:32,default:0});this._edgeAnimationList=this._graph.createEdgeAttribute({storage:32,default:0});this._nextGeIndex=1;this._availableGeIndexes=[];this._events.register(["reloadFonts","rendererStateChange","updateAttributes","animate"]);this._settings.register("renderer",kh,function(e){r._updateRendererState({type:e,state:"requested",code:null,message:null});r._engine.setRenderType(e);r._dom.refresh()});this._settings.register("backgroundColor",xh,function(e){if(!r._engine.parseColor(e)){Xa('Invalid background color "'+e+'" specified; will default to black.');r._settings.set("backgroundColor","black")}else{r._dom.refresh()}});this._settings.register("texts.hideUntilFontsLoaded",true,function(e){r._fontManager.setHideUntilFontsLoaded(e)});this._settings.register("imgCrossOrigin",bh,function(){return r._updateImageCrossOrigin()});this._settings.register("cursor.default",Sh,function(){return r._applyCursorStyle()});this._dom.setLayer("graphics",this._domElement);this._engine.setGlobalBoundaries(Ah);this._dom.beforeNextFrame().then(function(){r._initDone=true;r._fireRendererStateChangeEvent()});this._isBufferDisplayable=function(e){var t=Ld(e);var n=Md(e);var i=t?r._visibility.nodes:r._visibility.edges;var a=t?r._visibility.nodeTexts:r._visibility.edgeTexts;var o=i===0;var s=!n||a===0;return o&&s};this._imageManager.onFetch(function(){r._engine.notifyPatternUpdate();r._dom.refresh()});this._fontManager.onFontLoaded(function(e){r._fontsNewlyLoaded.push(e);r._engine.notifyPatternUpdate();r._dom.refresh()});this._dom.addMediaListener("(min-resolution: 2dppx)",function(){r._dom.refresh()});this._visibleAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:"internal("+Pl+")",tag:Pl,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null});this._dataAttributeLayer=this._attributesManager.addAttributeLayer({priority:0,name:"internal("+Dl+")",tag:Dl,nodeDependencies:null,edgeDependencies:null});oh(this._engine,this._attributesManager.getFlexArrays());this._events.on({cameraMove:function(){return r._dom.refresh()},newFrame:function(){r._processAnimations();r._loadGraphInGraphicsEngine();r._render()},clear:function(){r._nextGeIndex=1;r._availableGeIndexes=[];r._engine.clear();r._attributesManager.clear();r._dom.refresh()},viewChanged:function(e){var t=e.type;if(t==="rotate"){var n=r._ogma.getEdges().filter(function(e){return e.getAttribute("adjustAnchors")});r._attributesManager.redrawElements(n)}},"addNodes addEdges":function(e){r._attributesManager.updateForAllAttributeLayers(e.nodes||e.edges)},excludedStateChange:function(e){r._visibleAttributeLayer.updateElements(e.elements)},setData:function(e){r._dataAttributeLayer.updateElements(e.elements)}});t._graphicsEngineInitData=undefined};Ch.prototype.getTransparentBackgroundColor=function e(){var t=this._settings.get("backgroundColor");if(!t){return null}return this._engine.transparentify(t)};Ch.prototype._render=function e(){var t=this._dom.getDimensions();var r=this._camera.getView();var n=ke();var i=$t();var a=this._settings.get("backgroundColor");var o=this._isBufferDisplayable;this._engine.setView({x:r.x,y:r.y,zoom:r.zoom,angle:r.angle,width:t.width,height:t.height,pixelRatio:n,currentTime:i,backgroundColor:a,isBufferDisplayable:o});try{this._engine.render();if(this._rendererState.state==="requested"){this._updateRendererState({state:"ok"})}}catch(e){if(this._debug){throw e}var s=e.message;var u=e.code;if(u===void 0)u="OTHER";var l=this._renderState.type;var d=this._formatRendererName(l);var f=this._rendererState.state==="requested";var h="Error while initializing the "+d+" renderer";var c="The "+d+" renderer encountered an unexpected runtime error";var g=f?h:c;var v=null;if(l==="webgl"){g+="; fallbacking on canvas renderer";v="canvas"}Xa(s);Xa(g);this._updateRendererState({state:"error",code:u,message:s});this._settings.set("renderer",v)}};Ch.prototype._formatRendererName=function e(t){if(t==="webgl"){return"WebGL"}else if(t==="svg"){return"SVG"}else{return t}};Ch.prototype._fireRendererStateChangeEvent=function e(){var t={type:this._rendererState.type,state:this._rendererState.state,code:this._rendererState.code,message:this._rendererState.message};this._events.fire("rendererStateChange",t)};Ch.prototype._updateRendererState=function e(t){var r=t.type;var n=t.state;var i=t.code;var a=t.message;var o=false;if(r!==undefined&&this._rendererState.type!==r){this._rendererState.type=r;o=true}if(n!==undefined&&this._rendererState.state!==n){this._rendererState.state=n;o=true}if(i!==undefined&&this._rendererState.code!==i){this._rendererState.code=i;o=true}if(a!==undefined&&this._rendererState.message!==a){this._rendererState.message=a;o=true}if(o&&this._initDone){this._fireRendererStateChangeEvent()}};Ch.prototype.getImageData=function e(){var t=this;return this._dom.afterNextFrame().then(function(){return t._engine.getImageData()})};Ch.prototype.addCanvas=function e(t){this._engine.addCanvas(t)};Ch.prototype.removeCanvas=function e(t){this._engine.removeCanvas(t)};Ch.prototype.getNodeAttributes=function e(){return this._attributesManager.getFlexArrays().nodes.current};Ch.prototype.getEdgeAttributes=function e(){return this._attributesManager.getFlexArrays().edges.current};Ch.prototype.getGraphicsEngine=function e(){return this._engine};Ch.prototype.getImageManager=function e(){return this._imageManager};Ch.prototype.getFontManager=function e(){return this._fontManager};Ch.prototype.allocateGraphicsEngineBlockId=function e(){if(this._availableGeIndexes.length){return this._availableGeIndexes.pop()}else{return this._nextGeIndex++*gi+ci}};Ch.prototype.releaseGraphicsEngineBlockId=function e(t){this._engine.freeBlock(t);this._availableGeIndexes.push(t);this._dom.refresh()};Ch.prototype.addCursorStyle=function e(t){if(!t){return}this._cursorStyle.push(t);this._applyCursorStyle()};Ch.prototype.removeCursorStyle=function e(t){if(!t){return}var r=this._cursorStyle.lastIndexOf(t);if(r!==-1){this._cursorStyle.splice(r,1);this._applyCursorStyle()}};Ch.prototype._applyCursorStyle=function e(){var t=this._cursorStyle[this._cursorStyle.length-1]||this._settings.get("cursor.default");je(this._domElement,t)};Ch.prototype.reloadFonts=function e(){this._events.fire("reloadFonts");this._engine.notifyFontsReloaded();this._dom.refresh()};Ch.prototype._updateImageCrossOrigin=function e(){this._imageManager.setImgCrossOrigin(this._settings.get("imgCrossOrigin"))};Ch.prototype.getDomElement=function e(){return this._domElement};Ch.prototype.setTextHidden=function e(t,r){this._attributesManager.setTextHidden(t,r)};Ch.prototype.resetTextHidden=function e(){this._attributesManager.resetTextHidden();this._dom.refresh()};Ch.prototype.getAttributesManager=function e(){return this._attributesManager};Ch.prototype._checkFontsNewlyLoaded=function e(){if(this._fontsNewlyLoaded.length){this._fontsNewlyLoaded=[];return true}return false};Ch.prototype._loadGraphInGraphicsEngine=function e(){this._attributesManager.update();if(this._checkFontsNewlyLoaded()){this._attributesManager.redrawAll()}var t=this._attributesManager.getAndResetElementsToRedraw();var r=this._attributesManager.getAndResetElementsUpdated();var n=r.nodes.size||r.edges.size;if(r.nodeAttributes.includes("radius")||r.edgeAttributes.includes("width")){this._computeMaxSize()}if(r.nodeAttributes.includes("shape")||r.edgeAttributes.includes("shape.head")||r.edgeAttributes.includes("shape.tail")){oh(this._engine,this._attributesManager.getFlexArrays())}Zf({ogma:this._ogma,graph:t,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText});if(n){this._events.fire("updateAttributes",r)}};Ch.prototype._computeMaxSize=function e(){var t=this._graph.getNodeAttribute("radius");var r=this._graph.getEdgeAttribute("width");var n=this._graph.getNodes();var i=this._graph.getEdges();var a=0;var o=0;for(var s=0,u=n._indexes;s<u.length;s+=1){var l=u[s];var d=t.get(l);if(d>a){a=d}}for(var f=0,h=i._indexes;f<h.length;f+=1){var c=h[f];var g=r.get(c);if(g>o){o=g}}this._boundaries.maxSize=Math.max(a*2,o)};Ch.prototype._forceCompleteGraphRefresh=function e(){this._attributesManager.redrawAll();this._loadGraphInGraphicsEngine()};Ch.prototype.export=function e(t,r,n,i){var a=this;var o;return Promise.all([this._graph.getNodes().addClass(Wl),this._graph.getEdges().addClass(Wl)]).then(function(){return a.resolveAtNextFrame()}).then(function(){return a._imageManager.whenReady()}).then(function(){if(n==="all"){o=Fh(a._ogma);a._forceCompleteGraphRefresh()}else{a._loadGraphInGraphicsEngine()}return a._engine.export(t,r,i)}).then(function(e){return Promise.all([a._graph.getNodes().removeClass(Wl),a._graph.getEdges().removeClass(Wl)]).then(function(){return e})}).then(function(e){if(n==="all"){Nh(o);a._forceCompleteGraphRefresh()}return e})};Ch.prototype.addAttributeLayer=function e(t){return this._attributesManager.addAttributeLayer(t)};Ch.prototype.createFlexArrays=function e(){return this._attributesManager.createFlexArrays()};Ch.prototype.getAttributeValues=function e(t,r,n,i){return this._attributesManager.getAttributeValues(t,r,n,i)};Ch.prototype.forceAttributesComputation=function e(){this._attributesManager.update()};Ch.prototype.resolveAtNextFrame=function e(t){return this._dom.afterNextFrame().then(function(){return t})};Ch.prototype.animate=function e(t,r,n){var i=Th(n);if(i.duration){this._engine.ensureAnimationsReady()}return this._animate(t,r,i)};Ch.prototype.isAnimating=function e(){return this._animations.length>0};Ch.prototype.getAnimationInformation=function e(t){return this._attributesManager.getAnimationInformation(t)};Ch.prototype._toSubGraph=function e(t){var r=this._graph;var n=r.Node;var i=r.Edge;var a=r.NodeList;var o=r.EdgeList;if(t instanceof a||t instanceof n){return{nodes:t.toList(),edges:t.getAdjacentEdges()}}else if(t instanceof o||t instanceof i){return{nodes:new a,edges:t.toList()}}else{var s={nodes:t.nodes||new a,edges:t.edges||new o};if(s.nodes.size){if(s.edges.size){s.edges=s.edges.concat(s.nodes.getAdjacentEdges()).dedupe()}else{s.edges=s.nodes.getAdjacentEdges()}}return s}};Ch.prototype._animate=function e(t,r,n){var i=n.duration;var a=n.easing;if(!this._animations.length&&!i){r(t);return Promise.resolve(t)}var o=this._toSubGraph(t);var s=o.nodes;var u=o.edges;if(!s.size&&!u.size){return Promise.resolve(t)}if(s.size){this._events.fire("animate",{elements:s,duration:i,easing:a})}if(u.size){this._events.fire("animate",{elements:u,duration:i,easing:a})}var l={id:this._nextAnimationId++,startTime:-1,finished:false,func:function(){return r(t)},duration:i,easing:a,nodes:s,edges:u,resolve:undefined};var d=new Promise(function(e){return l.resolve=function(){return e(t)}});for(var f=0,h=s._indexes;f<h.length;f+=1){var c=h[f];this._nodeAnimationList.set(c,l.id)}for(var g=0,v=u._indexes;g<v.length;g+=1){var p=v[g];this._edgeAnimationList.set(p,l.id)}this._animations.push(l);this._dom.refresh();if(!i){this._processAnimations()}return d};Ch.prototype._isElementAnimated=function e(t){var r=(t.isNode?this._nodeAnimationList:this._edgeAnimationList).get(t._index)!==0;if(!t.isNode){r|=this._nodeAnimationList.get(t.getSource()._index)!==0;r|=this._nodeAnimationList.get(t.getTarget()._index)!==0}return r};Ch.prototype._endAnimation=function e(t){t.resolve(t.elements);t.finished=true};Ch.prototype._removeFinishedAnimations=function e(){this._animations=this._animations.filter(function(e){return!e.finished})};Ch.prototype._getAnimationElements=function e(t){var r=this._graph;var n=r.NodeList;var i=r.EdgeList;var a=[];var o=[];for(var s=0,u=t.nodes._indexes;s<u.length;s+=1){var l=u[s];if(this._nodeAnimationList.get(l)===t.id){a.push(l)}}for(var d=0,f=t.edges._indexes;d<f.length;d+=1){var h=f[d];if(this._edgeAnimationList.get(h)===t.id){o.push(h)}}return{nodes:new n(a),edges:new i(o)}};Ch.prototype._resetAnimationAttributes=function e(t){var r=t.nodes;var n=t.edges;this._attributesManager.resetAnimationAttributes({nodes:r,edges:n});this._nodeAnimationList.fill(r._indexes,0);this._edgeAnimationList.fill(n._indexes,0)};Ch.prototype._processAnimations=function e(){if(!this._animations.length){return}var t=$t();var r=[];this._attributesManager.update();for(var n=0,i=this._animations;n<i.length;n+=1){var a=i[n];if(a.startTime===-1){a.startTime=t;r.push(a.func);if(a.duration>0){this._attributesManager.setAnimationAttributes(this._getAnimationElements(a),a)}}}for(var o=0,s=r;o<s.length;o+=1){var u=s[o];u()}for(var l=0,d=this._animations;l<d.length;l+=1){var f=d[l];if(t>=f.startTime+f.duration){this._resetAnimationAttributes(this._getAnimationElements(f));this._endAnimation(f)}}this._removeFinishedAnimations();if(this._animations.length){this._dom.refresh()}};Ch.prototype.hideTexts=function e(){this.setNodeTextsVisibility(false);this.setEdgeTextsVisibility(false)};Ch.prototype.showTexts=function e(){this.setNodeTextsVisibility(true);this.setEdgeTextsVisibility(true)};Ch.prototype.setNodesVisibility=function e(value){return this._updateVisibilityCounter("nodes",value)};Ch.prototype.setNodeTextsVisibility=function e(value){return this._updateVisibilityCounter("nodeTexts",value)};Ch.prototype.setEdgesVisibility=function e(value){return this._updateVisibilityCounter("edges",value)};Ch.prototype.setEdgeTextsVisibility=function e(value){return this._updateVisibilityCounter("edgeTexts",value)};Ch.prototype._updateVisibilityCounter=function e(t,value){this._visibility[t]+=value?-1:1;this._dom.refresh()};Ch.prototype.detectNode=function e(t){var r=t.position;var n=t.margin;var i=t.texts;var a=t.indexes;if(a===void 0)a=this._graph.getNodes()._indexes;var o=this._engine;var s=this._graph._nodes;var u=this._attributesManager.getFlexArrays().nodes.current;var l=this._camera.getZoom();var d=r.x;var f=r.y;var h={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}};var c=0;this._attributesManager.update();for(var g=0;g<a.length;++g){var v=a[g];if(!u.excluded.get(v)&&u.detectable.get(v)&&u.animationDuration.get(v)===0){var p=u.x.get(v);var _=u.y.get(v);var m=this._camera.graphToScreenCoordinates({x:p,y:_});var y=m.x;var b=m.y;var x=u.shape.get(v);var S=u.scalingMethod.get(v)==="scaled";var A=u.radius.get(v)*(S?l:1);var E=A+n;var w=(d-y)/E;var k=(f-b)/E;if(o.checkShapeHit(x,w,k)){c=v}else if(i){var C=this._formatText(u.text.content.get(v));var T=u.textHidden.get(v);var L=u.text.minVisibleSize.get(v);var M=S?A*2:Infinity;if(!T&&C&&M>=L){var I=Tu(C,u.text.maxLineLength.get(v));var F=u.innerStroke.width.get(v);var N=u.outerStroke.width.get(v);var z=u.text.margin.get(v);var R=u.text.padding.get(v);var P=u.text.size.get(v);var D=u.text.scale.get(v);var O=u.text.scaling.get(v);var B=u.text.font.get(v);var j=u.text.style.get(v);var V=u.text.position.get(v);var U=o.measureText(I,B,j,1);var G=O?D*A:P;var W=U.width*G/2+R+n;var H=U.height*G/2+R+n;var X=h[V];var q=F+N+z+A;var Y=(q+W)*X.x;var Z=(q+H)*X.y;var K=y+Y;var Q=b+Z;var J=K-W;var $=K+W;var ee=Q-H;var te=Q+H;if(d>J&&d<$&&f>ee&&f<te){c=v}}}}}return s.get(c)||null};Ch.prototype.detectEdge=function e(t){var r=t.position;var n=t.margin;var i=t.texts;var a=t.indexes;if(a===void 0)a=this._graph.getEdges()._indexes;var o=this._graph._edges;var s=this._attributesManager.getFlexArrays();var u=s.edges.current;var l=s.nodes.current;var d=this._camera.getZoom();var f=n/d;var h=this._camera.screenToGraphCoordinates(r);var c=h.x;var g=h.y;var v=0;this._attributesManager.update();for(var p=0;p<a.length;++p){var _=a[p];var m=u.source.get(_);var y=u.target.get(_);var b=u.excluded.get(_);var x=u.detectable.get(_);var S=u.animationDuration.get(_)!==0;var A=l.animationDuration.get(m)!==0;var E=l.animationDuration.get(y)!==0;if(!b&&x&&!S&&!A&&!E){var w=m===y;var k=u.curvature.get(_);var C=u.shape.type.get(_)==="triangle";var T=u.scalingMethod.get(_)==="scaled";var L=u.width.get(_)/(T?1:d);var M=l.x.get(m);var I=l.y.get(m);var F=l.x.get(y);var N=l.y.get(y);if(w){var z=l.scalingMethod.get(m)==="scaled";var R=l.radius.get(m)/(z?1:d);var P=Xi(M,I,k,R,0);if(Qi(c,g,M,I,M,I,P.x1,P.y1,P.x2,P.y2,L,f)){v=_}}else if(k!==0){var D=Hi(M,I,F,N,k);if(Yi(c,g,M,I,F,N,D.x,D.y,L,f,C)){v=_}}else{if(Yr(c,g,M,I,F,N,L,f,C)){v=_}}}}return o.get(v)||null};Ch.prototype._getAttributeArray=function e(t,r){var n=this._attributesManager.getFlexArrays();var i=t?n.nodes:n.edges;return Ja(i.current,r)};function Th(e){if(typeof e==="number"){e={duration:e}}else if(typeof e!=="object"||e===null){e={}}return{duration:Lh(e.duration),easing:e.easing||"linear",chain:!!e.chain}}function Lh(e){if(typeof e!=="number"||!isFinite(e)||e<0){return 0}else{return e}}function Mh(e,t){var r=e.modules.graph.getAttribute(t,"excluded"),n=(t?e.getNodes("all"):e.getEdges("all"))._indexes,i=r.getMultiple(n);r.fill(n,0);return{excludedList:r,indexes:n,values:i}}function Ih(e){var t=e.excludedList;var r=e.indexes;var n=e.values;t.setMultiple(r,n)}function Fh(e){return{nodes:Mh(e,true),edges:Mh(e,false)}}function Nh(e){var t=e.nodes;var r=e.edges;Ih(t);Ih(r)}Ogma.extend(function(e){return e.modules.curvatureManager=new zh(e)});var zh=function e(t){var r=this;this._settings=t.modules.settings;this._graphics=t.modules.graphics;this._context={edgesAlwaysCurvy:false,directedEdges:false};this._attributeLayer=this._addAttributeLayer();this._settings.register("edgesAlwaysCurvy",false,function(value){r._context.edgesAlwaysCurvy=value;r._attributeLayer.updateAll()});this._settings.register("directedEdges",false,function(value){r._context.directedEdges=value;r._attributeLayer.updateAll()})};zh.prototype._addAttributeLayer=function e(){return this._graphics.addAttributeLayer({name:"curvature",priority:Il,edgeDependencies:{parallelEdges:true},edgeContext:this._context,edgeAttributes:{curvature:function(e,t){var r=t.edgesAlwaysCurvy;var n=t.directedEdges;var i=e.getSource()===e.getTarget();var a=e.getParallelEdges();var o=a.indexOf(e);if(o===-1){return 0}var s;if(i){s=o+1}else{var u=e.getSource();var l=a.size;if(l===1&&!r){return 0}if(n){var d=0;for(var f=0;f<o;++f){if(a.get(f).getSource()===u){d+=1}}s=d+1}else{var h=u!==a.get(0).getSource();if(l%2===1&&!r){if(o===0){s=0}else{s=((o+1)/2|0)*(o%2===0?1:-1)*(h?-1:1)}}else{s=((o/2|0)+1)*(o%2===0?1:-1)*(h?-1:1)}}}return s}}})};var Rh=function e(t){var r=this;this._events=t.modules.events;this._graphics=t.modules.graphics;this._events.on({"addNodes addEdges":function(e){var t=e.nodes;var n=e.edges;var i=e.objects;var a=t||n;var o=i.map(function(e){return e.attributes});r._originalAttributesLayer.setAttributeValues(a,o)}});this._originalAttributesLayer=this._graphics.addAttributeLayer({name:"original-attributes",priority:Ml,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null});this._individualAttributesLayer=this._graphics.addAttributeLayer({name:"individual-attributes",priority:Nl,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:null,edgeDependencies:null})};Rh.prototype.getOriginalAttributes=function e(){return this._originalAttributesLayer.getFlexArrays()};Rh.prototype.setMultipleAttributes=function e(t,r,n,i){var a=this;return this._graphics.animate(t,function(){a._individualAttributesLayer.setAttributeValues(t,r,i)},n)};Rh.prototype.setSingleAttribute=function e(t,r,n,i){var a={};X(a,r,n);return this.setMultipleAttributes(t,a,i)};Rh.prototype.resetMultipleAttributes=function e(t,r,n){var i=this;r=r||this._individualAttributesLayer.getUsedAttributeNames(t);var a={};for(var o=0,s=r;o<s.length;o+=1){var u=s[o];X(a,u,undefined)}return this._graphics.animate(t,function(){i._individualAttributesLayer.setAttributeValues(t,a)},n)};Rh.prototype.getMultipleAttributes=function e(t,r){return this._graphics.getAttributeValues(t,r,true,false)};Rh.prototype.getSingleAttribute=function e(t,r){return this._graphics.getAttributeValues(t,r,false,false)};Rh.prototype.replaceOriginalAttributes=function e(t,r,n){if(n===void 0)n=[];var i={};var a=this._originalAttributesLayer.getUsedAttributeNames(t).filter(function(e){return!n.includes(e)});for(var o=0;o<a.length;++o){X(i,a[o],undefined)}this._originalAttributesLayer.setAttributeValues(t,i);this._originalAttributesLayer.setAttributeValues(t,r)};Rh.prototype.getSinglePreviousAttribute=function e(t,r){return this._graphics.getAttributeValues(t,r,false,true)};Rh.prototype.getMultiplePreviousAttributes=function e(t,r){return this._graphics.getAttributeValues(t,r,true,true)};Ogma.extend(function(e){var t=e.Node;var r=e.Edge;var n=e.NodeList;var i=e.EdgeList;var a=new Rh(e);var o=e.modules.camera;e.modules.individualAttributes=a;t.prototype.setAttributes=function(e,t,r){return a.setMultipleAttributes(this,e,t,r)};t.prototype.setAttribute=function(e,value,t){return a.setSingleAttribute(this,e,value,t)};t.prototype.resetAttributes=function(e,t){return a.resetMultipleAttributes(this,e,t)};t.prototype.getAttributes=function(e){return a.getMultipleAttributes(this,e)[0]};t.prototype.getAttribute=function(e){return a.getSingleAttribute(this,e)[0]};n.prototype.setAttributes=function(e,t,r){return a.setMultipleAttributes(this,e,t,r)};n.prototype.setAttribute=function(e,t,r){return a.setSingleAttribute(this,e,t,r)};n.prototype.getAttributes=function(e){return a.getMultipleAttributes(this,e)};n.prototype.getAttribute=function(e){return a.getSingleAttribute(this,e)};n.prototype.resetAttributes=function(e,t){return a.resetMultipleAttributes(this,e,t)};r.prototype.setAttributes=function(e,t,r){return a.setMultipleAttributes(this,e,t,r)};r.prototype.setAttribute=function(e,value,t){return a.setSingleAttribute(this,e,value,t)};r.prototype.getAttributes=function(e){return a.getMultipleAttributes(this,e)[0]};r.prototype.getAttribute=function(e){return a.getSingleAttribute(this,e)[0]};r.prototype.resetAttributes=function(e,t){return a.resetMultipleAttributes(this,e,t)};i.prototype.setAttributes=function(e,t,r){return a.setMultipleAttributes(this,e,t,r)};i.prototype.setAttribute=function(e,value,t){return a.setSingleAttribute(this,e,value,t)};i.prototype.getAttributes=function(e){return a.getMultipleAttributes(this,e)};i.prototype.getAttribute=function(e){return a.getSingleAttribute(this,e)};i.prototype.resetAttributes=function(e,t){return a.resetMultipleAttributes(this,e,t)};t.prototype.getPosition=function(){return this.getAttributes(["x","y"])};n.prototype.getPosition=function(){return this.getAttributes(["x","y"])};t.prototype.getPositionOnScreen=function(){return o.graphToScreenCoordinates(this.getPosition())};n.prototype.getPositionOnScreen=function(){return this.getPosition().map(function(e){return o.graphToScreenCoordinates(e)})};t.prototype.isInScreen=function(){var e=this.getPositionOnScreen();return e.x>=0&&e.x<=o.width&&e.y>=0&&e.y<=o.height};t.prototype.replaceOriginalAttributes=function(e,t){return a.replaceOriginalAttributes(this,e,t)};n.prototype.replaceOriginalAttributes=function(e,t){return a.replaceOriginalAttributes(this,e,t)};r.prototype.replaceOriginalAttributes=function(e,t){return a.replaceOriginalAttributes(this,e,t)};i.prototype.replaceOriginalAttributes=function(e,t){return a.replaceOriginalAttributes(this,e,t)};t.prototype.getPreviousAttributes=function(e){return a.getMultiplePreviousAttributes(this,e)[0]};n.prototype.getPreviousAttributes=function(e){return a.getMultiplePreviousAttributes(this,e)};r.prototype.getPreviousAttributes=function(e){return a.getMultiplePreviousAttributes(this,e)[0]};i.prototype.getPreviousAttributes=function(e){return a.getMultiplePreviousAttributes(this,e)};n.prototype.getPreviousAttribute=function(e){return a.getSinglePreviousAttribute(this,e)};i.prototype.getPreviousAttribute=function(e){return a.getSinglePreviousAttribute(this,e)}});var Ph=1e3;var Dh=1/Ph;var Oh=function e(t){this._ogma=t;this._events=t.modules.events;this._graphics=t.modules.graphics;this._idCounter=1;this._rules=[]};Oh.prototype._get=function e(t){for(var r=0;r<this._rules.length;++r){var n=this._rules[r];if(n.id===t){n.index=r;return n}}throw new Error("calling a method on a destroyed style rule")};Oh.prototype._updatePriorities=function e(){for(var t=0;t<this._rules.length;++t){var r=this._rules[t];var n=Fl+t*Dh;r.attributeLayer.update({priority:n})}};Oh.prototype._afterNextFrame=function e(){return this._ogma.view.afterNextFrame()};Oh.prototype.addRule=function e(t){if(t===void 0)t={};var r=this._idCounter++;var n=this._graphics.addAttributeLayer(Object.assign({name:"rule("+r+")"},Bh(t)));var i=this._afterNextFrame();var a=new jh(this,r,i);var o={id:r,attributeLayer:n,wrapper:a};this._rules.push(o);this._updatePriorities();return a};Oh.prototype.getRuleIndex=function e(t){return this._get(t).index};Oh.prototype.setRuleIndex=function e(t,r){var n=this._get(t);var i=$e(r,0,this._rules.length-1);this._rules.splice(n.index,1);this._rules.splice(i,0,n);this._updatePriorities();return this._afterNextFrame()};Oh.prototype.updateRule=function e(t,r){var n=this._get(t);var i=Object.assign({fullOverwrite:r.fullOverwrite},Bh(r));n.attributeLayer.update(i);return this._afterNextFrame()};Oh.prototype.getRuleDefinition=function e(t){var r=this._get(t);var n=r.attributeLayer.getDefinition();return Bh(n)};Oh.prototype.destroyRule=function e(t){var r=this._get(t);r.attributeLayer.destroy();this._rules.splice(r.index,1);return this._afterNextFrame()};Oh.prototype.refreshRule=function e(t){var r=this._get(t);r.attributeLayer.updateAll();return this._afterNextFrame()};Oh.prototype.refreshAllRules=function e(){for(var t=0,r=this._rules;t<r.length;t+=1){var n=r[t];n.attributeLayer.updateAll()}return this._afterNextFrame()};Oh.prototype.getRuleList=function e(){return this._rules.map(function(e){return e.wrapper})};function Bh(e){return{nodeAttributes:e.nodeAttributes,edgeAttributes:e.edgeAttributes,nodeSelector:e.nodeSelector,edgeSelector:e.edgeSelector,nodeDependencies:e.nodeDependencies,edgeDependencies:e.edgeDependencies,nodeOutput:e.nodeOutput,edgeOutput:e.edgeOutput}}var jh=function e(t,r,n){var i=this;this._module=t;this._id=r;this._whenApplied=n.then(function(){return i})};jh.prototype.getId=function e(){return this._id};jh.prototype.whenApplied=function e(){return this._whenApplied};jh.prototype.refresh=function e(){return this._module.refreshRule(this._id)};jh.prototype.getIndex=function e(){return this._module.getRuleIndex(this._id)};jh.prototype.setIndex=function e(t){return this._module.setRuleIndex(this._id,t)};jh.prototype.update=function e(t){return this._module.updateRule(this._id,t)};jh.prototype.getDefinition=function e(){return this._module.getRuleDefinition(this._id)};jh.prototype.destroy=function e(){return this._module.destroyRule(this._id)};jh.prototype.delete=function e(){return this.destroy()};Ogma.extend(function(e){var t=new Oh(e);e.modules.styleRules=t;e.styles.addRule=function(e){return t.addRule(e)};e.styles.getRuleList=function(){return t.getRuleList()};e.styles.addNodeRule=function(t,r){if(arguments.length===1){r=t;t=undefined}return e.styles.addRule({nodeAttributes:r,nodeSelector:t})};e.styles.addEdgeRule=function(t,r){if(arguments.length===1){r=t;t=undefined}return e.styles.addRule({edgeAttributes:r,edgeSelector:t})};e.styles.getNodeRules=function(){return e.styles.getRuleList().filter(function(e){return e.getDefinition().edgeAttributes===undefined})};e.styles.getEdgeRules=function(){return e.styles.getRuleList().filter(function(e){return e.getDefinition().nodeAttributes===undefined})}});var Vh=1e3;var Uh=.5/Vh;var Gh=function e(t){var r=this;this._ogma=t;this._events=t.modules.events;this._graphics=t.modules.graphics;this._builtinClasses=[];this._userClasses=[];this._classesByName={};this._events.on({excludedStateChange:function(e){var t=e.elements;var value=e.value;if(value){var n=r._builtinClasses.map(function(e){return e.name});r._addOrRemoveClassesToElements(n,t,false)}},clear:function(){r._builtinClasses.concat(r._userClasses).forEach(function(e){return e.elementSet.clear()})}})};Gh.prototype._getClassList=function e(t){return t?this._builtinClasses:this._userClasses};Gh.prototype.createClass=function e(t){if(t===void 0)t={};var r=t.name;var n=t.isBuiltin;var i=t.after;var a=t.nodeAttributes;var o=t.nodeDependencies;var s=t.nodeOutput;var u=t.edgeAttributes;var l=t.edgeDependencies;var d=t.edgeOutput;if(typeof r!=="string"){throw new Error('the "name" argument should be a string')}var f=this._getClassList(n);var h=i?Hh(f,i)+1:f.length;if(h===-1){throw new Error('createClass: class specified as `after` parameter "'+i+'" does not exist')}if(n&&!r.startsWith("_")){throw new Error('invalid builtin class name "'+r+"\": builtin classes should start with '_'")}var c=new Cr(this._ogma);var g=new Xh(this,r);var v=this._graphics.addAttributeLayer({name:"class("+r+")",tag:r,standaloneSelectors:true,nodeAttributes:a,edgeAttributes:u,nodeSelector:function(e,t){return t.hasElement(e)},edgeSelector:function(e,t){return t.hasElement(e)},nodeContext:c,edgeContext:c,nodeOutput:s,edgeOutput:d,nodeDependencies:o,edgeDependencies:l});var p={name:r,elementSet:c,attributeLayer:v,isBuiltin:n,wrapper:g};f.splice(h,0,p);if(n){f.sort(function(e,t){return ql.indexOf(e.name)-ql.indexOf(t.name)})}this._updatePriorities(n);this._classesByName[r]=p;this._events.register([Wh(r,true,true),Wh(r,true,false),Wh(r,false,true),Wh(r,false,false)]);return g};Gh.prototype._updatePriorities=function e(t){var r=this._getClassList(t);var n=zl+(t?.5:0);for(var i=0;i<r.length;++i){var a=r[i];var o=n+Uh*i;a.attributeLayer.update({priority:o})}};Gh.prototype._get=function e(t){var r=this._classesByName[t];if(!r){throw new Error('class "'+t+'" does not exist')}return r};Gh.prototype.getIndex=function e(t){var r=this._get(t);var n=this._getClassList(r.isBuiltin);return n.indexOf(r)};Gh.prototype.setIndex=function e(t,r){var n=this._get(t);var i=this._getClassList(n.isBuiltin);var a=i.indexOf(n);var o=$e(r,0,i.length-1);i.splice(a,1);i.splice(o,0,n);this._updatePriorities(n.isBuiltin)};Gh.prototype.update=function e(t,r){if(r===void 0)r={};var n=this._get(t);n.attributeLayer.update({nodeAttributes:r.nodeAttributes,edgeAttributes:r.edgeAttributes,nodeDependencies:r.nodeDependencies,edgeDependencies:r.edgeDependencies,nodeOutput:r.nodeOutput,edgeOutput:r.edgeOutput,fullOverwrite:r.fullOverwrite})};Gh.prototype.getDefinition=function e(t){var r=this._get(t);var n=r.attributeLayer.getDefinition();var i=n.nodeAttributes;var a=n.nodeDependencies;var o=n.nodeOutput;var s=n.edgeAttributes;var u=n.edgeDependencies;var l=n.edgeOutput;return{nodeAttributes:i,edgeAttributes:s,nodeDependencies:a,edgeDependencies:u,nodeOutput:o,edgeOutput:l}};Gh.prototype._addOrRemoveClassesToElements=function e(t,r,n){var i=r.isNode;for(var a=0;a<t.length;++a){var o=t[a];var s=this._get(o);var u=s.elementSet;var l=s.attributeLayer;var d=u.addOrRemoveElements(r,n);var f=Wh(o,i,n);if(d.size){l.updateElements(d);this._events.fire(f,i?{nodes:d}:{edges:d})}}};Gh.prototype.addClassesToElements=function e(t,r,n){var i=this;return this._graphics.animate(r,function(){i._addOrRemoveClassesToElements(t,r,true)},n)};Gh.prototype.removeClassesFromElements=function e(t,r,n){var i=this;return this._graphics.animate(r,function(){i._addOrRemoveClassesToElements(t,r,false)},n)};Gh.prototype.hasSingleElementClass=function e(t,r){return this._get(t).elementSet.hasElement(r)};Gh.prototype.getElementsClassList=function e(t,r){if(r===void 0)r={};var n=r.includeBuiltinClasses;if(n===void 0)n=false;var i=new Array(t.size);for(var a=0;a<i.length;++a){i[a]=[]}this._addClassNamesToList(i,t,this._userClasses);if(n){this._addClassNamesToList(i,t,this._builtinClasses)}return i};Gh.prototype._addClassNamesToList=function e(t,r,n){var i=r.toList();for(var a=0;a<n.length;++a){var o=this._userClasses[a];var s=o.name;var u=o.elementSet;for(var l=0;l<i.size;++l){var d=i.get(l);if(u.hasElement(d)){t[l].push(s)}}}};Gh.prototype.getClassByName=function e(t,r){if(r===void 0)r=false;var n=this._classesByName[t]||null;if(r&&!n){throw new Error('class "'+t+'" does not exist')}return n&&n.wrapper};Gh.prototype.getClassList=function e(){return this._userClasses.map(function(e){return e.wrapper})};Gh.prototype.getElementsByClass=function e(t){var r=this._get(t);var n=r.elementSet;var i=n.getElements();return{nodes:i.nodes.filter(function(e){return e.isVisible()}),edges:i.edges.filter(function(e){return e.isVisible()})}};Gh.prototype._onClassEvent=function e(t,r,n,i){var a=Wh(t,n,i);this._events.on(a,r)};Gh.prototype.onNodeClassAdded=function e(t,r){this._onClassEvent(t,r,true,true)};Gh.prototype.onNodeClassRemoved=function e(t,r){this._onClassEvent(t,r,true,false)};Gh.prototype.onEdgeClassAdded=function e(t,r){this._onClassEvent(t,r,false,true)};Gh.prototype.onEdgeClassRemoved=function e(t,r){this._onClassEvent(t,r,false,false)};function Wh(e,t,r){return(t?"node":"edge")+"Class"+(r?"Added":"Removed")+"_"+e}function Hh(e,t){for(var r=0;r<e.length;++r){if(e[r].name===t){return r}}return-1}var Xh=function e(t,r){this._classes=t;this._name=r};Xh.prototype.getName=function e(){return this._name};Xh.prototype.getIndex=function e(){return this._classes.getIndex(this._name)};Xh.prototype.setIndex=function e(t){return this._classes.setIndex(this._name,t)};Xh.prototype.update=function e(t){return this._classes.update(this._name,t)};Xh.prototype.getDefinition=function e(){return this._classes.getDefinition(this._name)};Xh.prototype.getNodes=function e(){return this._classes.getElementsByClass(this._name).nodes};Xh.prototype.getEdges=function e(){return this._classes.getElementsByClass(this._name).edges};Xh.prototype.clearNodes=function e(){this.getNodes().removeClass(this._name)};Xh.prototype.clearEdges=function e(){this.getEdges().removeClass(this._name)};Xh.prototype.add=function e(t){t.addClass(this._name)};Xh.prototype.remove=function e(t){t.removeClass(this._name)};Ogma.extend(function(e){var t=e.Node;var r=e.Edge;var n=e.NodeList;var i=e.EdgeList;var a=new Gh(e);e.modules.classes=a;e.createClass=function(t,r){return e.styles.createClass(Object.assign({},r,{name:t}))};e.updateClass=function(e,t){return a.getClassByName(e,true).update(t)};e.getNodesByClassName=function(e){return a.getClassByName(e,true).getNodes()};e.getEdgesByClassName=function(e){return a.getClassByName(e,true).getEdges()};e.styles.createClass=function(e){return a.createClass(e)};e.styles.getClass=function(e){return a.getClassByName(e)};e.styles.getClassList=function(){return a.getClassList()};e.events.onNodesClassAdded=function(t,r){a.onNodeClassAdded(t,r);return e.events};e.events.onNodesClassRemoved=function(t,r){a.onNodeClassRemoved(t,r);return e.events};e.events.onEdgesClassAdded=function(t,r){a.onEdgeClassAdded(t,r);return e.events};e.events.onEdgesClassRemoved=function(t,r){a.onEdgeClassRemoved(t,r);return e.events};t.prototype.addClass=function(e,t){return a.addClassesToElements([e],this,t)};n.prototype.addClass=function(e,t){return a.addClassesToElements([e],this,t)};t.prototype.addClasses=function(e,t){return a.addClassesToElements(e,this,t)};n.prototype.addClasses=function(e,t){return a.addClassesToElements(e,this,t)};t.prototype.removeClass=function(e,t){return a.removeClassesFromElements([e],this,t)};n.prototype.removeClass=function(e,t){return a.removeClassesFromElements([e],this,t)};t.prototype.removeClasses=function(e,t){return a.removeClassesFromElements(e,this,t)};n.prototype.removeClasses=function(e,t){return a.removeClassesFromElements(e,this,t)};t.prototype.hasClass=function(e){return a.hasSingleElementClass(e,this)};n.prototype.hasClass=function(e){return this.map(function(t){return a.hasSingleElementClass(e,t)})};t.prototype.getClassList=function(){return a.getElementsClassList(this)[0]};n.prototype.getClassList=function(){return a.getElementsClassList(this)};r.prototype.addClass=function(e,t){return a.addClassesToElements([e],this,t)};i.prototype.addClass=function(e,t){return a.addClassesToElements([e],this,t)};r.prototype.addClasses=function(e,t){return a.addClassesToElements(e,this,t)};i.prototype.addClasses=function(e,t){return a.addClassesToElements(e,this,t)};r.prototype.removeClass=function(e,t){return a.removeClassesFromElements([e],this,t)};i.prototype.removeClass=function(e,t){return a.removeClassesFromElements([e],this,t)};r.prototype.removeClasses=function(e,t){return a.removeClassesFromElements(e,this,t)};i.prototype.removeClasses=function(e,t){return a.removeClassesFromElements(e,this,t)};r.prototype.hasClass=function(e){return a.hasSingleElementClass(e,this)};i.prototype.hasClass=function(e){return this.map(function(t){return a.hasSingleElementClass(e,t)})};r.prototype.getClassList=function(){return a.getElementsClassList(this)[0]};i.prototype.getClassList=function(){return a.getElementsClassList(this)}});var qh=function e(t,r){this.key=t;this.data=r;this.left=null;this.right=null};function Yh(e,t){return e>t?1:e<t?-1:0}function Zh(e,t,r){if(t===null){return t}var n,i,a;var o=new qh;n=i=o;while(true){var s=r(e,t.key);if(s<0){if(t.left===null){break}if(r(e,t.left.key)<0){a=t.left;t.left=a.right;a.right=t;t=a;if(t.left===null){break}}i.left=t;i=t;t=t.left}else if(s>0){if(t.right===null){break}if(r(e,t.right.key)>0){a=t.right;t.right=a.left;a.left=t;t=a;if(t.right===null){break}}n.right=t;n=t;t=t.right}else{break}}n.right=t.left;i.left=t.right;t.left=o.right;t.right=o.left;return t}function Kh(e,t,r,n,i){var a=new qh(e,t);i._size++;if(r===null){a.left=a.right=null;return a}r=Zh(e,r,n);var o=n(e,r.key);if(o<0){a.left=r.left;a.right=r;r.left=null}else if(o>=0){a.right=r.right;a.left=r;r.right=null}return a}function Qh(e,t,r,n,i){var a=new qh(e,t);if(r===null){a.left=a.right=null;i._size++;return a}r=Zh(e,r,n);var o=n(e,r.key);if(o===0){return r}else{if(o<0){a.left=r.left;a.right=r;r.left=null}else if(o>0){a.right=r.right;a.left=r;r.right=null}i._size++;return a}}function Jh(e,t,r,n){var i;if(t===null){return null}t=Zh(e,t,r);var a=r(e,t.key);if(a===0){if(t.left===null){i=t.right}else{i=Zh(e,t.left,r);i.right=t.right}n._size--;return i}return t}function $h(e,t,r){var n,i;if(t===null){n=i=null}else{t=Zh(e,t,r);var a=r(t.key,e);if(a===0){n=t.left;i=t.right}else if(a<0){i=t.right;t.right=null;n=t}else{n=t.left;t.left=null;i=t}}return{left:n,right:i}}function ec(e,t,r){if(t===null){return e}if(e===null){return t}t=Zh(e.key,t,r);t.left=e;return t}function tc(e,t,r,n,i){if(e){n(""+t+(r?" ":" ")+i(e)+"\n");var a=t+(r?"    ":"   ");if(e.left){tc(e.left,a,false,n,i)}if(e.right){tc(e.right,a,true,n,i)}}}var rc=function e(t){if(t===void 0)t=Yh;this._comparator=t;this._root=null;this._size=0};var nc={size:{configurable:true}};rc.prototype.insert=function e(t,r){return this._root=Kh(t,r,this._root,this._comparator,this)};rc.prototype.add=function e(t,r){return this._root=Qh(t,r,this._root,this._comparator,this)};rc.prototype.remove=function e(t){this._root=Jh(t,this._root,this._comparator,this)};rc.prototype.pop=function e(){var t=this._root;if(t){while(t.left){t=t.left}this._root=Zh(t.key,this._root,this._comparator);this._root=Jh(t.key,this._root,this._comparator,this);return{key:t.key,data:t.data}}return null};rc.prototype.findStatic=function e(t){var r=this._root;var n=this._comparator;while(r){var i=n(t,r.key);if(i===0){return r}else if(i<0){r=r.left}else{r=r.right}}return null};rc.prototype.find=function e(t){if(this._root){this._root=Zh(t,this._root,this._comparator);if(this._comparator(t,this._root.key)!==0){return null}}return this._root};rc.prototype.contains=function e(t){var r=this._root;var n=this._comparator;while(r){var i=n(t,r.key);if(i===0){return true}else if(i<0){r=r.left}else{r=r.right}}return false};rc.prototype.forEach=function e(t,r){var n=this._root;var i=[];var a=false;while(!a){if(n!==null){i.push(n);n=n.left}else{if(i.length!==0){n=i.pop();t.call(r,n);n=n.right}else{a=true}}}return this};rc.prototype.range=function e(t,r,n,i){var a=[];var o=this._comparator;var s=this._root,u;while(a.length!==0||s){if(s){a.push(s);s=s.left}else{s=a.pop();u=o(s.key,r);if(u>0){break}else if(o(s.key,t)>=0){if(n.call(i,s)){return this}}s=s.right}}return this};rc.prototype.keys=function e(){var e=[];this.forEach(function(t){var r=t.key;return e.push(r)});return e};rc.prototype.values=function e(){var e=[];this.forEach(function(t){var r=t.data;return e.push(r)});return e};rc.prototype.min=function e(){if(this._root){return this.minNode(this._root).key}return null};rc.prototype.max=function e(){if(this._root){return this.maxNode(this._root).key}return null};rc.prototype.minNode=function e(t){if(t===void 0)t=this._root;if(t){while(t.left){t=t.left}}return t};rc.prototype.maxNode=function e(t){if(t===void 0)t=this._root;if(t){while(t.right){t=t.right}}return t};rc.prototype.at=function e(t){var r=this._root,n=false,i=0;var a=[];while(!n){if(r){a.push(r);r=r.left}else{if(a.length>0){r=a.pop();if(i===t){return r}i++;r=r.right}else{n=true}}}return null};rc.prototype.next=function e(t){var r=this._root;var n=null;if(t.right){n=t.right;while(n.left){n=n.left}return n}var i=this._comparator;while(r){var a=i(t.key,r.key);if(a===0){break}else if(a<0){n=r;r=r.left}else{r=r.right}}return n};rc.prototype.prev=function e(t){var r=this._root;var n=null;if(t.left!==null){n=t.left;while(n.right){n=n.right}return n}var i=this._comparator;while(r){var a=i(t.key,r.key);if(a===0){break}else if(a<0){r=r.left}else{n=r;r=r.right}}return n};rc.prototype.clear=function e(){this._root=null;this._size=0;return this};rc.prototype.toList=function e(){return oc(this._root)};rc.prototype.load=function e(t,r,n){if(t===void 0)t=[];if(r===void 0)r=[];if(n===void 0)n=false;var i=t.length;var a=this._comparator;if(n){lc(t,r,0,i-1,a)}if(this._root===null){this._root=ic(this._root,t,r,0,i);this._size=i}else{var o=uc(this.toList(),ac(t,r),a);i=this._size+i;this._root=sc({head:o},0,i)}return this};rc.prototype.isEmpty=function e(){return this._root===null};nc.size.get=function(){return this._size};rc.prototype.toString=function e(t){if(t===void 0)t=function(e){return e.key};var r=[];tc(this._root,"",true,function(e){return r.push(e)},t);return r.join("")};rc.prototype.update=function e(t,r,n){var i=this._comparator;var a=$h(t,this._root,i);var o=a.left;var s=a.right;this._size--;if(i(t,r)<0){s=Kh(r,n,s,i,this)}else{o=Kh(r,n,o,i,this)}this._root=ec(o,s,i)};rc.prototype.split=function e(t){return $h(t,this._root,this._comparator)};Object.defineProperties(rc.prototype,nc);function ic(e,t,r,n,i){var a=i-n;if(a>0){var o=n+Math.floor(a/2);var s=t[o];var u=r[o];var l={key:s,data:u,parent:e};l.left=ic(l,t,r,n,o);l.right=ic(l,t,r,o+1,i);return l}return null}function ac(e,t){var r={next:null};var n=r;for(var i=0;i<e.length;i++){n=n.next={key:e[i],data:t[i]}}n.next=null;return r.next}function oc(e){var t=e;var r=[],n=false;var i={next:null};var a=i;while(!n){if(t){r.push(t);t=t.left}else{if(r.length>0){t=a=a.next=r.pop();t=t.right}else{n=true}}}a.next=null;return i.next}function sc(e,t,r){var n=r-t;if(n>0){var i=t+Math.floor(n/2);var a=sc(e,t,i);var o=e.head;o.left=a;e.head=e.head.next;o.right=sc(e,i+1,r);return o}return null}function uc(e,t,r){if(r===void 0)r=function(e,t){return e-t};var n={};var i=n;var a=e;var o=t;while(a!==null&&o!==null){if(r(a.key,o.key)<0){i.next=a;a=a.next}else{i.next=o;o=o.next}i=i.next}if(a!==null){i.next=a}else if(o!==null){i.next=o}return n.next}function lc(e,t,r,n,i){if(r>=n){return}var a=e[r+n>>1];var o=r-1;var s=n+1;while(true){do{o++}while(i(e[o],a)<0);do{s--}while(i(e[s],a)>0);if(o>=s){break}var u=e[o];e[o]=e[s];e[s]=u;u=t[o];t[o]=t[s];t[s]=u}lc(e,t,r,s,i);lc(e,t,s+1,n,i)}var dc=function(e){function t(t){e.call(this,t,true)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;return t}(rc);dc.prototype.lte=function(e){var t=this._comparator;var r=this._root,n;while(r){n=t(r.key,e);if(r.left===null&&r.right===null&&n>0){return null}if(n<=0&&r.right===null||n<=0&&t(r.right.key,e)>0){return r}if(n>=0){r=r.left}else{r=r.right}}return r};dc.prototype.gte=dc.prototype.gte||function(e){var t=[];var r=this._comparator;var n=this._root;while(t.length!==0||n){if(n){t.push(n);n=n.left}else{n=t.pop();if(r(n.key,e)>=0){break}n=n.right}}return n};dc.prototype.clear=dc.prototype.clear||function(){this._root=null;this._size=0;return this};var fc=16;var hc=function e(t,r,n){if(t===void 0)t=Int32Array;if(r===void 0)r=fc;if(n===void 0)n=8;this._BIG_LIST=new Uint8Array([-1])[0];this._ArrayType=t;this._capacity=r;this._MAX_LIST_SIZE=n;this._freeIndex=-1;this.clear()};var cc={averageSize:{configurable:true}};hc.prototype.clear=function e(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE);this._sizes=new Uint8Array(this._capacity);this._bigLists=[];this._nextIndex=0;this._idToIndex={};this._constList=new Array(this._MAX_LIST_SIZE)};hc.prototype.addEntry=function e(t){var r;if(this._freeIndex===-1){r=this._nextIndex++}else{r=this._freeIndex;this._freeIndex=-1}this._idToIndex[t]=r;if(r>=this._capacity){this._expand(r+1)}this._sizes[r]=0;return r};hc.prototype.getItems=function e(t){var r=this._idToIndex[t];if(r===undefined){return}var n=this._sizes[r];var i=this._MAX_LIST_SIZE*r;if(n<=this._MAX_LIST_SIZE){this._constList.length=n;for(var a=0,o=n;a<o;++a){this._constList[a]=this._buffer[i+a]}return this._constList}else if(n===this._BIG_LIST){var s=this._buffer[i];return this._bigLists[s]}};hc.prototype.removeEntry=function e(t){var r=this._idToIndex[t];var n=this._sizes[r];if(n===this._BIG_LIST){var i=this._MAX_LIST_SIZE*r;var a=this._buffer[i];this._bigLists[a].length=0}this._sizes[r]=0;this._freeIndex=r};hc.prototype.size=function e(t){var r=this._idToIndex[t];var e=this._sizes[r];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[r*this._MAX_LIST_SIZE]].length};hc.prototype.sizes=function e(t){var e=this._sizes;var r=this._bigLists;var n=this._buffer;var i=this._MAX_LIST_SIZE;var a=t.length;var o=new Array(a);for(var s=0;s<a;s++){var u=this._idToIndex[t[s]];var l=e[u];o[s]=l<=i?l:r[n[u*i]].length}return o};hc.prototype.addTo=function e(t,value){var r=this._idToIndex[t];var n=this._sizes[r];var i=r*this._MAX_LIST_SIZE;if(n<this._MAX_LIST_SIZE){this._buffer[i+n]=value;this._sizes[r]=n+1}else if(n===this._BIG_LIST){var a=this._buffer[i];this._bigLists[a].push(value)}else{var o=new Array(this._MAX_LIST_SIZE);for(var s=0;s<this._MAX_LIST_SIZE;++s){o[s]=this._buffer[i+s]}o.push(value);this._bigLists.push(o);this._sizes[r]=this._BIG_LIST;this._buffer[i]=this._bigLists.length-1}};hc.prototype.removeFrom=function e(t,value){this.removeFromAndGetSize(t,value)};hc.prototype.removeFromAndGetSize=function e(t,value){var r=this._idToIndex[t];var n=this._sizes[r],i=this._MAX_LIST_SIZE*r;if(n<=this._MAX_LIST_SIZE){for(var a=i,o=i+n;a<o;++a){if(this._buffer[a]===value){n-=1;this._buffer[a]=this._buffer[o-1];this._sizes[r]=n;return n}}}else if(n===this._BIG_LIST){var s=this._buffer[i],u=this._bigLists[s],l=u.indexOf(value);if(l!==-1){u.splice(l,1);return u.length}}};hc.prototype.reserve=function e(t){if(this._capacity<t){this._expand(t)}};hc.prototype._expand=function e(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t)));this._buffer=gc(this._buffer,this._capacity*this._MAX_LIST_SIZE);this._sizes=gc(this._sizes,this._capacity)};hc.prototype.has=function e(t){var r=this._idToIndex[t];if(r===undefined||r>=this._capacity){return false}return this._sizes[r]!==0};cc.averageSize.get=function(){var e=0;for(var t=0;t<this._capacity;t++){e+=this._sizes[t]}return e/this._capacity};Object.defineProperties(hc.prototype,cc);function gc(e,t){var r=new e.constructor(t);r.set(e);return r}var vc=[0,1],pc=[0,2];for(var _c=4;_c<65535;_c<<=2){for(var mc=0,yc=vc.length;mc<yc;mc++){vc.push(vc[mc]|_c);pc.push((vc[mc]|_c)<<1)}}function bc(e,t){return(pc[t&255]|vc[e&255])+(pc[t>>8&255]|vc[e>>8&255])*65536+(pc[t>>16&255]|vc[e>>16&255])*4294967296}bc.code=function e(t,r,n){if(t>24){throw"Morton codes are only supported up to Z=24"}var i=1<<24-t;return bc(r*i,n*i)};bc.range=function e(t,r,n){if(t>24){throw"Morton ranges are only supported up to Z=24"}var i=1<<24-t;var a=bc(r*i,n*i);return[a,a+i*i-1]};var xc,Sc;function Ac(e,t){if(t===void 0)t=[];if(e>0xffffffffffff){throw"Only morton codes up to 48 bits are supported."}if(!xc){xc={};Sc={};for(var r=0;r<256;r++){xc[bc(r,0)]=r;Sc[bc(0,r)]=r}}var n=xc[e&21845];var i=Sc[e&43690];if(e>65535){e/=65536;n|=xc[e&21845]<<8;i|=Sc[e&43690]<<8;if(e>65535){e/=65536;n|=xc[e&21845]<<16;i|=Sc[e&43690]<<16}}t[0]=n;t[1]=i;return t}bc.reverse=Ac;bc.decode=function e(t,r){var n=Ac(r);var i=1<<24-t;return[n[0]/i,n[1]/i]};bc.min=function e(t,r){var n=t&1431655765;var i=r&1431655765;var a=t&2863311530;var o=r&2863311530;return Math.min(n,i)+Math.min(a,o)};var Ec=0;var wc=1;var kc=3;var Cc=4;var Tc=5;var Lc=Sn;var Mc=En;function Ic(e,t){return e[3]>t[1]&&e[1]<t[3]&&(e[2]>t[0]&&e[0]<t[2])}function Fc(e,t,r,n,i,a,o,s){if(e>=i&&t>=a&&e<=o&&t<=s){return true}if(r>=i&&n>=a&&r<=o&&n<=s){return true}if(Rc(e,t,r,n,i,a,i,s)){return true}if(Rc(e,t,r,n,o,a,o,s)){return true}if(Rc(e,t,r,n,i,a,o,a)){return true}if(Rc(e,t,r,n,i,s,o,s)){return true}return false}function Nc(e,t,r){return Math.min(Math.max(t,e),r)}function zc(e,t,r,n,i,a,o){var s=Nc(e,n,a);var u=Nc(t,i,o);var l=e-s;var d=t-u;var f=l*l+d*d;return f<r*r}function Rc(e,t,r,n,i,a,o,s){var u=((o-i)*(t-a)-(s-a)*(e-i))/((s-a)*(r-e)-(o-i)*(n-t));var l=((r-e)*(t-a)-(n-t)*(e-i))/((s-a)*(r-e)-(o-i)*(n-t));if(u>=0&&u<=1&&l>=0&&l<=1){return true}return false}function Pc(e,t){var r=e.type;var n=e.coordinates;if(r===Tc){return zc(n[0],n[1],n[2],t[0],t[1],t[2],t[3])}else if(r===wc){return Fc(n[0],n[1],n[2],n[3],t[0],t[1],t[2],t[3])}else if(r===kc){return Lc(n[0],n[1],n[2],n[3],n[4],n[5],t[0],t[1],t[2],t[3])}else if(r===Cc){return Mc(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],t[0],t[1],t[2],t[3])}else{return Ic(n,t)}}function Dc(e,t,r,n,i){var a=Math.abs(r-e),o=e<r?1:-1;var s=-Math.abs(n-t),u=t<n?1:-1;var l=a+s,d;for(;;){i(e,t);d=2*l;if(d>=s){if(e===r){break}l+=s;e+=o}if(d<=a){if(t===n){break}l+=a;t+=u}}}function Oc(e,t,r,n,i){var a=e<r?1:-1,o=t<n?1:-1,s;var u=Math.abs(r-e),l=Math.abs(n-t),d=u*u+l*l;var f=d==0?1:16777087/Math.sqrt(d);u*=f;l*=f;d=u-l;for(;;){i(e,t,Math.abs(d-u+l)>>16);f=d;s=e;if(2*f>=-u){if(e==r){break}if(f+l<16711680){i(e,t+o,f+l>>16)}d-=l;e+=a}if(2*f<=l){if(t==n){break}if(u-f<16711680){i(s+a,t,u-f>>16)}d+=u;t+=o}}}function Bc(e,t){if(t===void 0)t="assert error";if(!e){throw new Error(t)}}function jc(e,t,r,n,i,a,o){var s=i-r,u=a-n;var l=e-r,d=t-n,f;var h,c,g,v=l*u-d*s;Bc(l*s<=0&&d*u<=0,"sign of gradient must not change");if(s*s+u*u>l*l+d*d){i=e;e=s+r;a=t;t=u+n;v=-v}if(v!=0){l+=s;l*=s=e<i?1:-1;d+=u;d*=u=t<a?1:-1;f=2*l*d;l*=l;d*=d;if(v*s*u<0){l=-l;d=-d;f=-f;v=-v}h=4*u*v*(r-e)+l-f;c=4*s*v*(t-n)+d-f;l+=l;d+=d;g=h+c+f;do{o(e,t);if(e==i&&t==a){return}n=2*g<h;if(2*g>c){e+=s;h-=f;g+=c+=d}if(n){t+=u;c-=f;g+=h+=l}}while(c<0&&h>0)}Dc(e,t,i,a,o)}function Vc(e,t,r,n,i,a,o){var s=e-r,u=t-n;var l=e-2*r+i,d;if(s*(i-r)>0){if(u*(a-n)>0){if(Math.abs((t-2*n+a)/l*s)>Math.abs(u)){e=i;i=s+r;t=a;a=u+n}}l=(e-r)/l;d=(1-l)*((1-l)*t+2*l*n)+l*l*a;l=(e*i-r*r)*l/(e-r);s=Math.floor(l+.5);u=Math.floor(d+.5);d=(n-t)*(l-e)/(r-e)+t;Uc(e,t,s,Math.floor(d+.5),s,u,o);d=(n-a)*(l-i)/(r-i)+a;e=r=s;t=u;n=Math.floor(d+.5)}if((t-n)*(a-n)>0){l=t-2*n+a;l=(t-n)/l;d=(1-l)*((1-l)*e+2*l*r)+l*l*i;l=(t*a-n*n)*l/(t-n);s=Math.floor(d+.5);u=Math.floor(l+.5);d=(r-e)*(l-t)/(n-t)+e;Uc(e,t,Math.floor(d+.5),u,s,u,o);d=(r-i)*(l-a)/(n-a)+i;e=s;r=Math.floor(d+.5);t=n=u}Uc(e,t,r,n,i,a,o)}function Uc(e,t,r,n,i,a,o){var s=i-r,u=a-n;var l=e-r,d=t-n,f;var h,c,g,v,p=l*u-d*s;if(s*s+u*u>l*l+d*d){i=e;e=s+r;a=t;t=u+n;p=-p}if(p!=0){l+=s;l*=s=e<i?1:-1;d+=u;d*=u=t<a?1:-1;f=2*l*d;l*=l;d*=d;if(p*s*u<0){l=-l;d=-d;f=-f;p=-p}h=4*u*(r-e)*p+l-f;c=4*s*(t-n)*p+d-f;l+=l;d+=d;g=h+c+f;do{p=Math.min(h+f,-f-c);v=Math.max(h+f,-f-c);v+=2*v*p*p/(4*v*v+p*p);o(e,t,255*Math.abs(g-h-c-f)/v);if(e==i||t==a){break}r=e;p=h-g;n=2*g+c<0;if(2*g+h>0){if(g-c<v){o(e,t+u,255*Math.abs(g-c)/v)}e+=s;h-=f;g+=c+=d}if(n){if(p<v){o(r+s,t,255*Math.abs(p)/v)}t+=u;c-=f;g+=h+=l}}while(c<h)}Oc(e,t,i,a,o)}function Gc(e,t,r,n,i,a,o,s,u){var l,d,f,h=1;var c=e<o?1:-1,g=t<s?1:-1;var v=-Math.abs(e+r-i-o),p=v-4*c*(r-i),_=c*(e-r-i+o);var m=-Math.abs(t+n-a-s),y=m-4*g*(n-a),b=g*(t-n-a+s);var x,S,A,E,w,k,C,T,L,M,I,F=.01;Bc((r-e)*(i-o)<F&&((o-e)*(r-i)<F||_*_<p*v+F),"slope change");Bc((n-t)*(a-s)<F&&((s-t)*(n-a)<F||b*b<y*m+F),"slope change");if(p==0&&y==0){c=Math.floor((3*r-e+1)/2);g=Math.floor((3*n-t+1)/2);return jc(e,t,c,g,o,s,u)}r=(r-e)*(r-e)+(n-t)*(n-t)+1;i=(i-o)*(i-o)+(a-s)*(a-s)+1;do{x=p*b-_*y;S=p*m-v*y;A=_*m-v*b;M=x*(x+S-3*A)+S*S;l=M>0?1:Math.sqrt(1+1024/r);x*=l;S*=l;A*=l;M*=l*l;k=9*(x+S+A)/8;E=8*(p-y);T=27*(8*x*(b*b-y*m)+M*(y+2*b+m))/64-y*y*(k-y);L=27*(8*x*(_*_-p*v)-M*(p+2*_+v))/64-p*p*(k+p);w=3*(3*x*(3*b*b-y*y-2*y*m)-y*(3*S*(y+b)+y*E))/4;C=3*(3*x*(3*_*_-p*p-2*p*v)-p*(3*S*(p+_)+p*E))/4;k=p*y*(6*x+6*S-3*A+E);S=y*y;E=p*p;k=3*(k+9*l*(E*b*m-_*v*S)-18*_*b*x)/8;if(M<0){T=-T;L=-L;w=-w;C=-C;k=-k;S=-S;E=-E}x=6*y*S;S=-6*p*S;A=6*y*E;E=-6*p*E;T+=k;M=T+L;L+=k;e:for(I=k,d=f=l;e!=o&&t!=s;){u(e,t);do{if(T>I||L<I){break e}n=2*M-L;if(2*M>=T){d--;M+=T+=w;L+=k+=S;C+=A;w+=x}if(n<=0){f--;M+=L+=C;T+=k+=A;w+=S;C+=E}}while(d>0&&f>0);if(2*d<=l){e+=c;d+=l}if(2*f<=l){t+=g;f+=l}if(I==k&&T<0&&L>0){I=F}}w=e;e=o;o=w;c=-c;_=-_;C=t;t=s;s=C;g=-g;b=-b;r=i}while(h--);Dc(e,t,o,s,u)}function Wc(e,t,r,n,i,a,o,s,u,l){var d=0,f=0;var h=e+r-i-o,c=h-4*(r-i);var g=e-r-i+o,v=g+4*(r+i);var p=t+n-a-s,_=p-4*(n-a);var m=t-n-a+s,y=m+4*(n+a);var b=e,x,S,A,E=t,w,k,C;var T=g*g-c*h,L,M=[0,0,0,0,0];if(c==0){if(Math.abs(h)<2*Math.abs(g)){M[d++]=h/(2*g)}}else if(T>0){L=Math.sqrt(T);T=(g-L)/c;if(Math.abs(T)<1){M[d++]=T}T=(g+L)/c;if(Math.abs(T)<1){M[d++]=T}}T=m*m-_*p;if(_==0){if(Math.abs(p)<2*Math.abs(m)){M[d++]=p/(2*m)}}else if(T>0){L=Math.sqrt(T);T=(m-L)/_;if(Math.abs(T)<1){M[d++]=T}T=(m+L)/_;if(Math.abs(T)<1){M[d++]=T}}for(f=1;f<d;f++){if((T=M[f-1])>M[f]){M[f-1]=M[f];M[f]=T;f=0}}T=-1;M[d]=1;for(f=0;f<=d;f++){L=M[f];x=(T*(T*g-2*h)-L*(T*(T*c-2*g)+h)+v)/8-b;w=(T*(T*m-2*p)-L*(T*(T*_-2*m)+p)+y)/8-E;S=(L*(L*g-2*h)-T*(L*(L*c-2*g)+h)+v)/8-b;k=(L*(L*m-2*p)-T*(L*(L*_-2*m)+p)+y)/8-E;b-=A=(L*(L*(3*g-L*c)-3*h)+v)/8;E-=C=(L*(L*(3*m-L*_)-3*p)+y)/8;o=Math.floor(A+.5);s=Math.floor(C+.5);if(b!=0){x*=b=(e-o)/b;S*=b}if(E!=0){w*=E=(t-s)/E;k*=E}if(e!=o||t!=s){u(e,t,e+x,t+w,e+S,t+k,o,s,l)}e=o;t=s;b=A;E=C;T=L}}function Hc(e,t,r,n,i,a,o,s,u){Wc(e,t,r,n,i,a,o,s,Gc,u)}/**
   * Bresenham rasterisation functions by Alois Zingl
   * @author Alois Zingl
   * @preserve
   */
var Xc=bc;var qc=14;var Yc,Zc,Kc;function Qc(){return Yc}function Jc(e){Yc=e;Zc=1<<Yc;Kc=1<<Yc-1}Jc(qc);function $c(e,t,r){var n=1<<r;e=~~(n*((e+Kc)/Zc)),t=~~(n*((t+Kc)/Zc));return[e,t]}function eg(e,t,r){var n=1<<r;e=n*((e+Kc)/Zc),t=n*((t+Kc)/Zc);return[e,t]}function tg(e,t,r,n,i,a){var o=$c(e,t,i);var s=$c(r,n,i);for(var u=o[0];u<=s[0];u++){for(var l=o[1];l<=s[1];l++){a.push(Xc(u,l,i))}}}function rg(e,t,r,n){var i,a;for(var o=0;o<e.length-1;o++){var s=eg(e[o][0],e[o][1],t),u=eg(e[o+1][0],e[o+1][1],t),l=s[0],d=s[1],f=u[0],h=u[1],c=f-l,g=h-d;if(g===0&&c===0){continue}var v=c>0?1:-1,p=g>0?1:-1,_=Math.floor(l),m=Math.floor(d),y=c===0?Infinity:Math.abs(((c>0?1:0)+_-l)/c),b=g===0?Infinity:Math.abs(((g>0?1:0)+m-d)/g),x=Math.abs(v/c),S=Math.abs(p/g);if(_!==i||m!==a){n.push(Xc(_,m,t));if(r&&m!==a){r.push([_,m])}i=_;a=m}while(y<1||b<1){if(y<b){y+=x;_+=v}else{b+=S;m+=p}n.push(Xc(_,m,t));if(r&&m!==a){r.push([_,m])}i=_;a=m}}if(r&&m===r[0][1]){r.pop()}}function ng(e,t,r){var n=$c(e[0],e[1],t);var i=n[0];var a=n[1];var o=$c(e[2],e[3],t);var s=o[0];var u=o[1];var l=$c(e[4],e[5],t);var d=l[0];var f=l[1];Vc(i,a,s,u,d,f,function(e,n){r.push(Xc(e,n,t))})}function ig(e,t,r){var n=$c(e[0],e[1],t);var i=n[0];var a=n[1];var o=$c(e[2],e[3],t);var s=o[0];var u=o[1];var l=$c(e[4],e[5],t);var d=l[0];var f=l[1];var h=$c(e[6],e[7],t);var c=h[0];var g=h[1];Hc(i,a,s,u,d,f,c,g,function(e,n){r.push(Xc(e,n,t))})}var ag=[[0,0],[0,0]];function og(e,t){var r=e.type;var n=e.coordinates;var i=[];switch(r){case wc:ag[0][0]=n[0];ag[0][1]=n[1];ag[1][0]=n[2];ag[1][1]=n[3];rg(ag,t,undefined,i);break;case Ec:tg(n[0],n[1],n[2],n[3],t,i);break;case Tc:var a=n[0];var o=n[1];var s=n[2];tg(a-s,o-s,a+s,o+s,t,i);break;case kc:ng(n,t,i);break;case Cc:ig(n,t,i);break;default:break}return i}var sg=1,ug=3,lg=4,dg=5;var fg=2863311530;var hg=4294967295;var cg=31;function gg(e,t,r){var n=e;for(var i=cg;i>=0;i--){var a=1<<i;var o=((r&a)<<2|(e&a)<<1|t&a)>>i;if(o===sg){var s=fg>>>cg-i&(~(hg<<i)&hg);t=(t|s)&~(1<<i)&hg}else if(o===ug){return n}else if(o===lg){return t}else if(o===dg){var u=fg>>>cg-i&(~(hg<<i)&hg);n=(t|u)&~(1<<i)&hg;var l=~(fg>>>cg-i)&hg;e=e&l|1<<i}}return n}function vg(e,t,r){var n=t;for(var i=cg;i>=0;i--){var a=1<<i;var o=((r&a)<<2|(e&a)<<1|t&a)>>i;if(o===sg){var s=~(fg>>>cg-i)&hg;n=e&s|1<<i;var u=fg>>>cg-i&(~(hg<<i)&hg);t=(t|u)&~(1<<i)&hg}else if(o===ug){return e}else if(o===lg){return n}else if(o===dg){var l=~(fg>>>cg-i)&hg;e=e&l|1<<i}}return n}function pg(e,t,r){for(var n=cg;n>=0;n--){var i=1<<n;var a=((r&i)<<2|(e&i)<<1|t&i)>>n;if(a===sg){var o=fg>>>cg-n&(~(hg<<n)&hg);t=(t|o)&~(1<<n)&hg}else if(a===ug){return false}else if(a===lg){return false}else if(a===dg){var s=~(fg>>>cg-n)&hg;e=e&s|1<<n}}return true}function _g(e,t,r){var n=r+1;var i=0;for(var a=cg;a>=0;a--){var o=1<<a;var s=(n&o)>>a;var u=(e&o)>>a;var l=(t&o)>>a;var d=a&1;var f=i&3<<2*d;if(f===0&&s>l&&u<=l){i|=2<<2*d;break}else if(f===0&&s<u){i|=1<<2*d;break}}if(i===0){return n}else{return vg(e,t,r)}}var mg=12;var yg=function e(t,r){if(r===void 0)r=8;this.setLevel(r);this.setAccessor(t);this._tree=new dc(function(e,t){return e-t});this._nodeToId=new hc(Uint32Array,1e3,16);this._idToNode=new hc(Uint32Array,16,8);this._size=0;this._checkedNodes=[];this._codeCache=[0,0]};var bg={intersectionChecks:{configurable:true},level:{configurable:true},size:{configurable:true}};yg.prototype.setAccessor=function e(t){this._getGeometry=t;return this};yg.prototype.load=function e(t){var r=[];var n=this._nodeToId;var i=this._idToNode;var a=this._level;var o=this._getGeometry;for(var s=0;s<t.length;s++){var u=t[s];var l=o(u);var d=og(l,a);i.addEntry(u);for(var f=0;f<d.length;f++){var h=d[f];if(!n.has(h)){n.addEntry(h);r.push(h)}n.addTo(h,u);i.addTo(u,h)}}this._tree.load(r,[],true);this._size+=t.length;return this};yg.prototype.addToPage=function e(){};yg.prototype.removeFromPage=function e(){};yg.prototype.insert=function e(t){var r=og(this._getGeometry(t),this._level);var n=this._idToNode;var i=this._nodeToId;var a=this._tree;this._size++;n.addEntry(t);for(var o=0;o<r.length;o++){var s=r[o];if(!i.has(s)){a.insert(s);i.addEntry(s)}i.addTo(s,t);n.addTo(t,s)}};yg.prototype.remove=function e(t){var r=this._idToNode.getItems(t);var n=this._nodeToId;var i=this._tree;if(r){for(var a=0;a<r.length;a++){var o=r[a];var s=n.removeFromAndGetSize(o,t);if(s===0){i.remove(o)}}}this._idToNode.removeEntry(t);this._size--;return this};yg.prototype.update=function e(t){this.remove(t);this.insert(t);return this};yg.prototype.forEach=function e(t){this._tree.forEach(t);return this};yg.prototype.all=function e(){var e=[];this._tree.forEach(function(t){return e.push(t)});return e};yg.prototype.clear=function e(){this._tree.clear();this._nodeToId.clear();this._idToNode.clear();return this};yg.prototype.setLevel=function e(t){this._level=t;return this};yg.prototype.traverse=function e(t,r){var n=r[0];var i=r[1];var a=r[2];var o=r[3];var s=eg(n,i,this._level);var u=s[0];var l=s[1];var d=eg(a,o,this._level);var f=d[0];var h=d[1];var c=bc(u,l);var g=bc(f,h);var v=this._tree;var p=v._root;var _=[];var m=c;while(_.length>0||p){if(p){_.push(p);p=p.left}else{p=_.pop();var y=p.key;if(y>g){break}else if(y>=c){if(y>=m){m=_g(c,g,y);if(t(p)){return this}}}p=p.right}}return this};yg.prototype.getKeys=function e(t){var r=t[0];var n=t[1];var i=t[2];var a=t[3];var o=eg(r,n,this._level);var s=o[0];var u=o[1];var l=eg(i,a,this._level);var d=l[0];var f=l[1];var h=bc(s,u);var c=bc(d,f);var g=this._tree;var v=g._root;var p=[];var _=h;while(p.length>0||v){if(v){p.push(v);v=v.left}else{v=p.pop();var m=v.key;if(m>c){break}else if(m>=h){if(m>=_){_=_g(h,c,m)}}v=v.right}}return this};yg.prototype.traverseDescend=function e(t,r){var n=r[0];var i=r[1];var a=r[2];var o=r[3];var s=eg(n,i,this._level);var u=eg(a,o,this._level);var l=bc(s[0],s[1]);var d=bc(u[0],u[1]);this._recurse(this._tree._root,l,d,l,d,t,n,i,a,o);return this};yg.prototype.traverseRange=function e(t,r){var n=this;var i=r[0];var a=r[1];var o=r[2];var s=r[3];var u=eg(i,a,this._level);var l=u[0];var d=u[1];var f=eg(o,s,this._level);var h=f[0];var c=f[1];var g=bc(l,d);var v=bc(h,c);this._tree.range(g,v,function(e){var r=e.key;if(pg(g,v,r)){if(t(e)){return n}}});return this};yg.prototype._recurse=function e(t,r,n,i,a,o){if(t===null){return}var s=t.key;if(s<r){return this._recurse(t.right,r,n,i,a,o)}if(s>n){return this._recurse(t.left,r,n,i,a,o)}if(pg(i,a,s)){this._recurse(t.left,r,s,i,a,o);if(o(t)){return}this._recurse(t.right,s,n,i,a,o)}else{var u=vg(i,a,s);var l=gg(i,a,s);this._recurse(t.left,r,l,i,a,o);this._recurse(t.right,u,n,i,a,o)}};yg.prototype.query=function e(t){var r=[];var n=[];this.traverse(function(e){r.push(e)},t);var i={};var a=this._getGeometry;this._intersectionChecks=0;for(var o=0;o<r.length;o++){var s=r[o];var u=this._nodeToId.getItems(s.key);for(var l=0;l<u.length;l++){var d=u[l];if(!i[d]){var f=a(d);this._intersectionChecks++;if(Pc(f,t)){n.push(d)}i[d]=true}}}this._checkedNodes=r;return n};yg.prototype.getItems=function e(t){return this._nodeToId.getItems(t)};bg.intersectionChecks.get=function(){return this._intersectionChecks};bg.level.get=function(){return this._level};bg.size.get=function(){return this._size};yg.prototype.keyToBBox=function e(t){var r=Qc();var n=bc.reverse(t);var i=n[0];var a=n[1];var o=1<<mg-this._level+(r-mg);var s=1<<r-1;return[i*o-s,a*o-s,(i+1)*o-s,(a+1)*o-s]};Object.defineProperties(yg.prototype,bg);yg.MAX_ZOOM=mg;var xg=typeof Map==="undefined"?function(){function e(){this._values={};this._size=0}var t={size:{configurable:true}};t.size.get=function(){return this._size};e.prototype.has=function e(t){return!!this._values[t]};e.prototype.set=function e(t,value){if(!(t in this._values)){this._size++}this._values[t]=value};e.prototype.get=function e(t){return this._values[t]};e.prototype.delete=function e(t){if(t in this._values){delete this._values[t];this._size--}};e.prototype.keys=function e(){return Object.keys(this._values)};e.prototype.clear=function e(){this._values={};this._size=0};Object.defineProperties(e.prototype,t);return e}():Map;var Sg=typeof Set==="undefined"?function(){function e(){this._values={};this._size=0}var t={size:{configurable:true}};t.size.get=function(){return this._size};e.prototype.has=function e(t){return!!this._values[t]};e.prototype.add=function e(t){if(!(t in this._values)){this._size++}this._values[t]=true};e.prototype.delete=function e(t){if(t in this._values){delete this._values[t];this._size--}};e.prototype.keys=function e(){return Object.keys(this._values)};e.prototype.clear=function e(){this._values={};this._size=0};Object.defineProperties(e.prototype,t);return e}():Set;var Ag=1<<16;var Eg=16;var wg=16;var kg=(1<<Eg)-1;var Cg=Math.log2(Eg);var Tg=(1<<Cg)-1;var Lg=function(e,t,r){return r|bc(e,t)<<4};var Mg=function(e,t){if(t===void 0)t=[];bc.reverse(e>>4,t);t[2]=e&Tg;return t};var Ig=function e(t,r,n,i,a){if(n===void 0)n=wg;if(i===void 0)i=Ag;if(a===void 0)a=Int32Array;this._intersects=t;this._getBounds=r;this._occupied=0;this._cells=new hc(a);this._objectsAtLevel=new Array(Eg).fill(0);this._idToCode=new xg;this._codeCache=[];this._offset=i;this._min=-i;this._max=i;this._resolution=kg/(this._max-this._min);this._minCellSize=n*this._resolution;this._bounds=new Array(Eg*4);for(var o=0;o<Eg;o++){this._bounds[o*4]=Infinity;this._bounds[o*4+1]=Infinity;this._bounds[o*4+2]=-Infinity;this._bounds[o*4+3]=-Infinity}};var Fg={averageCellOccupancy:{configurable:true},size:{configurable:true}};Ig.prototype.setMinCellSize=function e(t){this._minCellSize=t;return this};Ig.prototype.setOffset=function e(t){this._offset=t;this._min=-t;this._max=t;this._resolution=kg/(this._max-this._min);return this};Ig.prototype.setIntersector=function e(t){this._intersects=t;return this};Ig.prototype.setBoundsGetter=function e(t){this._getBounds=t;return this};Ig.prototype.insert=function e(t,r){if(r===void 0)r=this._getBounds(t);var n=Math.max(r[2]-r[0],r[3]-r[1]);var i=this._minCellSize,a;for(a=0;i<n&&a<Eg;a++){i*=2}var o=this._resolution,s=this._min;var u=o*((r[2]+r[0])*.5-s);var l=o*((r[3]+r[1])*.5-s);var d=u/i|0;var f=l/i|0;var h=Lg(d,f,a);if(!this._cells.has(h)){this._cells.addEntry(h)}this._cells.addTo(h,t);this._objectsAtLevel[a]++;this._occupied|=1<<a;var c=a*4;var g=this._bounds;if(d<g[c]){g[c]=d}if(f<g[c+1]){g[c+1]=f}if(d>g[c+2]){g[c+2]=d}if(f>g[c+3]){g[c+3]=f}this._idToCode.set(t,h);return h};Ig.prototype.has=function e(t){return this._idToCode.has(t)};Ig.prototype.update=function e(t,r){this.remove(t);return this.insert(t,r)};Ig.prototype.remove=function e(t){var r=this._idToCode.get(t);Mg(r,this._codeCache);var n=this._codeCache[2];if(--this._objectsAtLevel[n]===0){this._occupied&=~(1<<n);this._bounds[n*4]=Infinity;this._bounds[n*4+1]=Infinity;this._bounds[n*4+2]=-Infinity;this._bounds[n*4+3]=-Infinity}this._cells.removeFrom(r,t);this._idToCode.delete(t);return this};Ig.prototype.query=function e(t){var r=t[0];var n=t[1];var i=t[2];var a=t[3];var o=this._cells;var s=this._bounds;var u=this._intersects;var l=this._min;var d=this._resolution;var f=0;var h=this._minCellSize;var c=this._occupied;var g=[];r=d*(r-l);n=d*(n-l);i=d*(i-l);a=d*(a-l);for(var v=f;v<Eg;h*=2,c>>=1,v++){if(c===0){break}if((c&1)===0){continue}var p=1/h;var _=v*4;var m=Math.max(s[_],r*p-1>>0);var y=Math.max(s[_+1],n*p-1>>0);var b=Math.min(s[_+2],i*p+1>>0);var x=Math.min(s[_+3],a*p+1>>0);for(var S=m;S<=b;S++){for(var A=y;A<=x;A++){var E=Lg(S,A,v);var w=o.getItems(E);if(w===undefined){continue}for(var k=0;k<w.length;k++){var C=w[k];if(u(C,t)){g.push(C)}}}}}return g};Ig.prototype.collisions=function e(t,r){if(r===void 0)r=this._getBounds;if(typeof r!=="function"){throw new Error("getBounds function is required to get the object bounds")}var n=Array.from(this._idToCode.keys());var i=this._min;var a=this._resolution;var o=this._cells;var s=new xg;var u=[];for(var l=0;l<n.length;l++){var d=0;var f=this._minCellSize;var h=this._occupied;var c=n[l];var g=r(c);var v=g[0];var p=g[1];var _=g[2];var m=g[3];var y=Math.max(_-v,m-p);for(d=0;f<y;d++){f*=2;h>>=1}v=a*(v-i);p=a*(p-i);_=a*(_-i);m=a*(m-i);for(var b=d;b<Eg;f*=2,h>>=1,b++){if(h===0){break}if((h&1)===0){continue}var x=1/f;var S=v*x-1>>0;var A=p*x-1>>0;var E=_*x+1>>0;var w=m*x+1>>0;for(var k=S;k<=E;k++){for(var C=A;C<=w;C++){var T=Lg(k,C,b);if(s.get(T)===l){continue}s.set(T,l);var L=o.getItems(T);if(L===undefined){continue}for(var M=0;M<L.length;M++){var I=L[M];if(I!==c){if(t(c,I)){u.push(c,I)}}}}}}}return Ng(u)};Ig.prototype.clear=function e(){this._occupied=0;this._cells.clear();this._idToCode.clear();this._objectsAtLevel=new Array(Eg).fill(0);this._bounds=new Array(Eg*4);for(var t=0;t<Eg;t++){this._bounds[t*4]=Infinity;this._bounds[t*4+1]=Infinity;this._bounds[t*4+2]=-Infinity;this._bounds[t*4+3]=-Infinity}return this};Ig.prototype.keyToBBox=function e(t){var r=Mg(t);var n=r[0];var i=r[1];var a=r[2];var o=this._minCellSize*(1<<a);var s=this._min;var u=this._resolution;return[n*o/u+s,i*o/u+s,(n+1)*o/u+s,(i+1)*o/u+s]};Ig.prototype.keys=function e(){return Object.keys(this._cells._idToIndex)};Fg.averageCellOccupancy.get=function(){return this._cells.averageSize};Fg.size.get=function(){return this._idToCode.size};Object.defineProperties(Ig.prototype,Fg);function Ng(e){var t=new Sg;var r=[];for(var n=0;n<e.length;n+=2){var i=e[n],a=e[n+1];var o=i<a?i*a+(a-i-1)*(a-i-1)/4:i*a+(i-a-1)*(i-a-1)/4;if(!t.has(o)){t.add(o);r.push(i,a)}}return r}Ig.code=Lg;Ig.decode=Mg;var zg=["x","y","radius"];var Rg=["width","curvature"];var Pg=function e(t){var r=this;var n=t.modules;var i=n.dom;var a=n.graph;var o=n.camera;var s=n.graphics;var u=n.settings;var l=n.events;this._dom=i;this._graph=a;this._camera=o;this._graphics=s;this._settings=u;this._events=l;this._minCellSize=8;this._index=new Ig(this._getIntersector(),this._boundsGetter(),this._minCellSize,1e6);this._elementsToUpdate=new Cr(t);this._removedNodes=a.getAttribute(true,"removed");this._removedEdges=a.getAttribute(false,"removed");this._queryResult={edges:[],nodes:[]};this._queryBounds=[0,0,0,0];l.on({"addNodes addEdges removeNodes removeEdges updateAttributes":function(e){if(e.nodes){if(!e.nodeAttributes||e.nodeAttributes.some(function(e){return zg.includes(e)})){var t=e.nodes.fastGetAdjacentElements().edges;r._elementsToUpdate.addElements(e.nodes);r._elementsToUpdate.addElements(t)}}if(e.edges){if(!e.edgeAttributes||e.edgeAttributes.some(function(e){return Rg.includes(e)})){r._elementsToUpdate.addElements(e.edges)}}},clear:function(){r._index.clear();r._elementsToUpdate.clear()}})};Pg.prototype._getIntersector=function e(){var t=this._graph;var r=t.getAttributes(true,["x","y","radius"]);var n=r[0];var i=r[1];var a=r[2];var o=t.getAttributes(false,["source","target","width","curvature"]);var s=o[0];var u=o[1];var l=o[2];var d=o[3];var f={};return function(e,t){if(e<0){e=-e;var r=s.get(e);var o=u.get(e);var h=d.get(e);var c=l.get(e)/2;var g=n.get(r),v=i.get(r);var p=n.get(o),_=i.get(o);if(r===o){Xi(g,v,h,a.get(r),0,f);return En(g,v,f.x1,f.y1,f.x2,f.y2,p,_,t[0]-c,t[1]-c,t[2]+c,t[3]+c)}else if(h===0){return rn(g,v,p,_,t[0]-c,t[1]-c,t[2]+c,t[3]+c)}else{Hi(g,v,p,_,h,f);return Sn(g,v,f.x,f.y,p,_,t[0]-c,t[1]-c,t[2]+c,t[3]+c)}}else{var m=n.get(e),y=i.get(e),b=a.get(e);return jr(m,y,b,t[0],t[1],t[2],t[3])}}};Pg.prototype._boundsGetter=function e(){var t=this._graph;var r=t.getAttributes(true,["x","y","radius"]);var n=r[0];var i=r[1];var a=r[2];var o=t.getAttributes(false,["source","target","curvature"]);var s=o[0];var u=o[1];var l=o[2];var d={};var f={};return function(e){if(e<0){e=-e;var t=s.get(e);var r=u.get(e);var o=l.get(e);var h=n.get(t),c=i.get(t);var g=n.get(r),v=i.get(r);if(t===r){Xi(h,c,o,a.get(t),0,d);$i(h,c,d.x1,d.y1,d.x2,d.y2,g,v,f)}else if(o===0){f.minX=Math.min(h,g);f.minY=Math.min(c,v);f.maxX=Math.max(h,g);f.maxY=Math.max(c,v)}else{Hi(h,c,g,v,o,d);Ji(h,c,d.x,d.y,g,v,f)}}else{var p=n.get(e);var _=i.get(e);var m=a.get(e);f.minX=p-m;f.minY=_-m;f.maxX=p+m;f.maxY=_+m}return[f.minX,f.minY,f.maxX,f.maxY]}};Pg.prototype.reindex=function e(){this._graphics.forceAttributesComputation();this._index.clear();this._elementsToUpdate.clear();this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)};Pg.prototype._updateIndex=function e(){if(!this._elementsToUpdate.isEmpty()){var t=this._elementsToUpdate.getElements();var r=t.nodes;var n=t.edges;this._updateItems(r._indexes,n._indexes);this._elementsToUpdate.clear()}};Pg.prototype._updateItems=function e(t,r){var n=this._index;var i=this._removedNodes;var a=this._removedEdges;var o=[];var s=[];for(var u=0;u<t.length;u++){var l=t[u];if(i.get(l)!==0){o.push(l)}else if(n.has(l)){o.push(l);s.push(l)}else{s.push(l)}}for(var d=0;d<r.length;d++){var f=-r[d];if(a.get(-f)!==0){o.push(f)}else if(n.has(f)){o.push(f);s.push(f)}else{s.push(f)}}for(var h=0,c=o;h<c.length;h+=1){var g=c[h];n.remove(g)}for(var v=0,p=s;v<p.length;v+=1){var _=p[v];n.insert(_)}};Pg.prototype.getNodesInScreenByDistance=function e(t){var r=t.getPositionOnScreen();var n=r.x;var i=r.y;return this._graph.getNodes().filter(function(e){return e.isInScreen()&&e!==t}).sort(function(e,t){var r=e.getPositionOnScreen(),a=t.getPositionOnScreen();return distance(r.x,r.y,n,i)-distance(a.x,a.y,n,i)})};Pg.prototype.getNearestNodesForNode=function e(t,r,n){if(r===void 0)r=240;var i=t.getPosition();var a=i.x;var o=i.y;return this.getNearestNodes(a,o,r,n,t)};Pg.prototype.getNearestNodes=function e(t,r,n,i,a){this._updateIndex();if(i){var o=this._camera.screenToGraphVector({x:n,y:n});n=distance(0,0,o.x,o.y)}return this._getNearestNodes(t,r,n,a)};Pg.prototype._getNearestNodes=function e(t,r,n,i){var a=[];var o=n*n;var s=i?i._index:0;var u=this._graph.getNodes()._indexes;var l=this._graph.getAttributes(true,["x","y"]);var d=l[0];var f=l[1];for(var h=0,c=u.length;h<c;h++){var g=u[h];if(g===s){continue}var v=t-d.get(g);var p=r-f.get(g);if(v*v+p*p<=o){a.push(g)}}return new this._graph.NodeList(a)};Pg.prototype.queryRaw=function e(t,r,n,i){this._updateIndex();var a=this._queryBounds;a[0]=t;a[1]=r;a[2]=n;a[3]=i;var o=this._index.query(a);var s=this._queryResult;var u=s.nodes;var l=s.edges;u.length=l.length=0;for(var d=0;d<o.length;d++){var f=o[d];if(f<0){l.push(-f)}else{u.push(f)}}return this._queryResult};Pg.prototype.queryRawProjected=function e(t,r,n,i){var a=this._queryBounds;a[0]=t;a[1]=r;a[2]=n;a[3]=i;this._camera.projectBounds(a);return this.queryRaw(a[0],a[1],a[2],a[3])};Pg.prototype.query=function e(t,r,n,i){var a=this._graph;var o=this.queryRaw(t,r,n,i);var s=o.nodes;var u=o.edges;return{nodes:new a.NodeList(s.slice()),edges:new a.EdgeList(u.slice())}};Pg.prototype.queryProjected=function e(t,r,n,i){var a=this._graph;var o=this.queryRawProjected(t,r,n,i);var s=o.nodes;var u=o.edges;return{nodes:new a.NodeList(s.slice()),edges:new a.EdgeList(u.slice())}};Pg.prototype.getNodesByBoundingBox=function e(t,r,n,i,a){this._updateIndex();if(a){var o;o=this._camera.screenToGraphVector({x:t,y:r});t=o.x;r=o.y;o=this._camera.screenToGraphVector({x:n,y:i});n=o.x;i=o.y}var s=this._graph;var u=s.getNodes()._indexes;var l=[];var d=s.getAttributes(true,["excluded","x","y"]);var f=d[0];var h=d[1];var c=d[2];for(var g=0,v=u.length;g<v;g++){var p=u[g];if(f.get(p)){continue}var _=h.get(p),m=c.get(p);if(_>=t&&_<=n&&m>=r&&m<=i){l.push(p)}}return new s.NodeList(l)};Pg.prototype.toggleDebug=function e(t){if(t){this._canvas=we();this._graphics.addCanvas(this._canvas);this._ctx=this._canvas.getContext("2d")}else if(this._canvas){this._graphics.removeCanvas(this._canvas);this._canvas=this._ctx=null}};Pg.prototype.renderDebug=function e(t){if(!this._ctx){this.toggleDebug(true)}Dg(this,t)};function Dg(e,t){if(t===void 0)t={};var r=t.cells;if(r===void 0)r=true;var n=t.boxes;if(n===void 0)n=true;var i=t.query;if(i===void 0)i=true;var a=Ogma.utils.getPixelRatio();var o=e._ctx;var s=e._canvas;var u=e._camera;var l=e._index;var d=-u.getAngle();var f=u.getZoom()*a;var h=u._x;var c=u._y;var g=u._dimensions.width*a/2;var v=u._dimensions.height*a/2;var p=function(e,t){return{x:(e-h)*f,y:(t-c)*f}};var _=l.keys().map(function(e){return l.keyToBBox(e)});var m=Array.from(l._idToCode.keys()).map(function(e){return l._getBounds(e)});o.clearRect(0,0,s.width,s.height);o.save();o.translate(g,v);o.rotate(d);if(r){o.beginPath();o.lineWidth=1;o.strokeStyle="#707070";_.forEach(function(e){var t=p(e[0],e[1]);var r=p(e[2],e[3]);o.rect(t.x,t.y,r.x-t.x,r.y-t.y)});o.stroke()}if(n){o.beginPath();o.lineWidth=1;o.strokeStyle="#ff7070";m.forEach(function(e){var t=p(e[0],e[1]);var r=p(e[2],e[3]);o.rect(t.x,t.y,r.x-t.x,r.y-t.y)});o.closePath();o.stroke()}if(i&&e._queryBounds){var y=e._queryBounds;o.beginPath();o.lineWidth=2;o.strokeStyle="#3030ff";var b=p(y[0],y[1]);var x=p(y[2],y[3]);o.rect(b.x,b.y,x.x-b.x,x.y-b.y);o.closePath();o.stroke()}o.restore()}Ogma.extend(function(e){return e.modules.spatial=new Pg(e)});Ogma.extend(function(e){var t=new Bg(e);e.modules.watcher=t;e.schema={watchNodeObjectProperty:function e(r){return t.watchNodeObjectProperty(r)},watchEdgeObjectProperty:function e(r){return t.watchEdgeObjectProperty(r)},watchNodeNonObjectProperty:function e(r){return t.watchNodeNonObjectProperty(r)},watchEdgeNonObjectProperty:function e(r){return t.watchEdgeNonObjectProperty(r)}}});function Og(e){if(typeof e!=="object"||e===null||Array.isArray(e)){return{path:jg(e),filter:"visible",unwindArrays:false}}else{return{path:jg(e.path),filter:Vg(e.filter),unwindArrays:!!e.unwindArrays}}}var Bg=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._graph=t.modules.graph;this._events=t.modules.events;this._propertyWatchers=[];this._objectPropertyWatchers=[];this._events.on({excludedStateChange:function(e){var t=e.elements;var value=e.value;var n=!value;for(var i=0,a=r._propertyWatchers.length;i<a;i++){var o=r._propertyWatchers[i];if(o.isNode===t.isNode&&o.filter==="visible"){if(n){Xg(o,t.getData(o.property))}else{qg(o,t.getData(o.property))}Ug(o)}}},"updateNodeData updateEdgeData":function(e){var t=e.isNode;var n=e.changes;for(var i=0;i<r._propertyWatchers.length;++i){var a=r._propertyWatchers[i],o=a.property,s=a.filter==="all";if(a.isNode!==t){continue}for(var u=0;u<n.length;++u){var l=n[u],d=l.property||[],f=Wg(d,o);if(f){var h=l.nodes||l.edges,c=[],g=[];for(var v=0;v<h.size;++v){var p=h.get(v);if(s||p.isVisible()){c.push(Ja(l.newValues[v],f));g.push(Ja(l.previousValues[v],f))}}if(c.length){Xg(a,c);qg(a,g);Ug(a)}}}}for(var _=0,m=r._objectPropertyWatchers.length;_<m;_++){var y=r._objectPropertyWatchers[_];var b=y._path;var x=function(e){var t=n[e];var r=t.property;var i=t.nodes;var a=t.edges;var o=i||a,s=o.isNode;if(!r||r.length<=b.length+1&&b.every(function(e,t){return e===r[t]})){y._updateSubPropertiesToWatch(s,o)}};for(var S=0;S<n.length;++S)x(S)}},"addNodes addEdges":function(e){var t=e.nodes;var n=e.edges;var i=t||n;for(var a=0;a<r._propertyWatchers.length;++a){var o=r._propertyWatchers[a];if(o.isNode===i.isNode){var s=i.getData(o.property);if(s.length){Xg(o,s);Ug(o)}}}for(var u=0;u<r._objectPropertyWatchers.length;u++){r._objectPropertyWatchers[u]._updateSubPropertiesToWatch(i.isNode,i)}},"removeNodes removeEdges":function(e){var t=e.nodes;var n=e.edges;var i=t||n;for(var a=0;a<r._propertyWatchers.length;++a){var o=r._propertyWatchers[a];var s=o.filter==="all";if(o.isNode===i.isNode&&s){var u=i.getData(o.property);if(u.length){qg(o,u);Ug(o)}}}},clear:function(){r._propertyWatchers.forEach(function(e){e.nbNumbers=0;e.nbAny=0;e.nbTotal=0;e.boundaries=null;e.values.clear()})}})};Bg.prototype.watchNodeObjectProperty=function e(t){return this._watchObjectProperty(true,Og(t))};Bg.prototype.watchEdgeObjectProperty=function e(t){return this._watchObjectProperty(false,Og(t))};Bg.prototype.watchNodeNonObjectProperty=function e(t){return this._watchNonObjectProperty(true,Og(t))};Bg.prototype.watchEdgeNonObjectProperty=function e(t){return this._watchNonObjectProperty(false,Og(t))};Bg.prototype._watchPropertyInformation=function e(t,r,n,i,a){var o=this._findWatcher(t,r,i,a);if(!o){o=this._createWatcher(t,r,i,a)}if(n){o.onChange.push(n)}return o.info};Bg.prototype._unwatchPropertyInformation=function e(t,r,n,i,a){var o=this._findWatcher(t,r,i,a);if(!o){return}var s=o.onChange,u=s.indexOf(n);if(u!==-1){s.splice(u,1);if(s.length===0){var l=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(l,1)}}};Bg.prototype._watchObjectProperty=function e(t,r){var n=new Kg(this,t,r);this._objectPropertyWatchers.push(n);n._updateSubPropertiesToWatch(t,this._graph[t?"getNodes":"getEdges"](r.filter));return n};Bg.prototype._watchNonObjectProperty=function e(t,r){return new Qg(this,t,r)};Bg.prototype._findWatcher=function e(t,r,n,i){for(var a=0;a<this._propertyWatchers.length;++a){var o=this._propertyWatchers[a];if(o.isNode===t&&o.filter===n&&o.unwindArrays===i&&Gg(o.property,r)){return o}}return null};Bg.prototype._createWatcher=function e(t,r,n,i){var a={isNode:t,property:r,nbNumbers:0,nbAny:0,nbTotal:0,values:new pt,boundaries:null,onChange:[],filter:n,unwindArrays:i,info:undefined};a.info=new Hg(a);Xg(a,this._ogma[t?"getNodes":"getEdges"](n).getData(r));this._propertyWatchers.push(a);return a};function jg(value){if(value===null||value===undefined){return[]}else{return z(value)}}function Vg(value){return value==="all"?"all":"visible"}function Ug(e){for(var t=0;t<e.onChange.length;++t){e.onChange[t](e.info)}}function Gg(e,t){if(e.length!==t.length){return false}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return false}}return true}function Wg(e,t){if(e.length>t.length){return null}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return null}}return t.slice(r)}var Hg=function e(t){this._watcher=t};Hg.prototype.isNode=function e(){return this._watcher.isNode};Hg.prototype.getPath=function e(){return this._watcher.property.slice()};Hg.prototype.getBoundaries=function e(){var t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null};Hg.prototype.getValues=function e(){return this._watcher.values.keys()};Hg.prototype.getValueCount=function e(value){return this._watcher.values.get(value)||0};Hg.prototype.getCount=function e(){return this._watcher.nbTotal};Hg.prototype.getType=function e(){if(this._watcher.nbAny>0){return"any"}else if(this._watcher.nbNumbers>0){return"number"}else{return"undefined"}};function Xg(e,t,r){var n=e.values,i=!r&&e.unwindArrays;for(var a=0;a<t.length;++a){var value=t[a];if(!r&&value!==undefined){e.nbTotal+=1}if(i&&Array.isArray(value)){Xg(e,value,true)}else{var o=n.get(value);if(o){n.set(value,o+1)}else{n.set(value,1);if(Zg(value)){if(!e.boundaries){e.boundaries={min:value,max:value}}else if(value<e.boundaries.min){e.boundaries.min=value}else if(value>e.boundaries.max){e.boundaries.max=value}e.nbNumbers+=1}else if(value!==undefined){e.nbAny+=1}}}}}function qg(e,t,r){var n=e.values,i=!r&&e.unwindArrays,a=e.boundaries,o=false;for(var s=0;s<t.length;++s){var value=t[s];if(!r&&value!==undefined){e.nbTotal-=1}if(i&&Array.isArray(value)){o|=qg(e,value,true)}else{var u=n.get(value);if(u>1){n.set(value,u-1)}else{n.delete(value);if(Zg(value)){e.nbNumbers-=1;if(a&&(a.min===value||a.max===value)){o=true}}else if(value!==undefined){e.nbAny-=1}}}}if(!r&&o){e.boundaries=Yg(n.keys())}return o}function Yg(e){var t=undefined,r=undefined;for(var n=0;n<e.length;++n){var value=e[n];if(Zg(value)){if(t===undefined||value<t){t=value}if(r===undefined||value>r){r=value}}}return t===undefined?null:{min:t,max:r}}function Zg(value){return typeof value==="number"&&isFinite(value)}var Kg=function e(t,r,n){var i=n.path;var a=n.filter;var o=n.unwindArrays;this._module=t;this._isNode=r;this._path=i;this._filter=a;this._unwindArrays=o;this._propertyList=[];this._properties={};this._onAddHandlers=[];this._onRemoveHandlers=[];this._onUpdateHandlers=[]};Kg.prototype.onPropertyAdded=function e(t){this._onAddHandlers.push(t);return this};Kg.prototype.onPropertyRemoved=function e(t){this._onRemoveHandlers.push(t);return this};Kg.prototype.onPropertyUpdated=function e(t){this._onUpdateHandlers.push(t);return this};Kg.prototype.getPath=function e(){return this._path.slice()};Kg.prototype.getProperties=function e(){return this._propertyList.slice()};Kg.prototype.getPropertyInfo=function e(t){var r=this._properties[t];return r?r.info:null};Kg.prototype.destroy=function e(){var t=this;U(this._properties,function(e,r){var n=e.handler;var i=t._path.concat([r]);t._module._unwatchPropertyInformation(t._isNode,i,n,t._filter,t._unwindArrays)});this._propertyList=undefined;this._properties=undefined;this._onAddHandlers=undefined;this._onRemoveHandlers=undefined;this._onUpdateHandlers=undefined;var r=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(r,1)};Kg.prototype.kill=function e(){return this.destroy()};Kg.prototype._updateSubPropertiesToWatch=function e(t,r){if(t!==this._isNode){return}var n=r.getData(this._path);for(var i=0;i<n.length;i++){var a=n[i];if(j(a)){var o=Object.keys(a);for(var s=0;s<o.length;s++){this._addSubPropertyToWatch(o[s])}}}};Kg.prototype._addSubPropertyToWatch=function e(t){var r=this;if(!this._properties[t]){var n=this._path.concat([t]);var i=function(){return r._triggerPropertyUpdate(t)};var a=this._unwindArrays;var o=this._isNode;var s=this._filter;var u=this._module._watchPropertyInformation(o,n,i,s,a);this._properties[t]={handler:i,info:u};this._triggerPropertyUpdate(t)}};Kg.prototype._triggerPropertyUpdate=function e(t){var r=this._properties[t];var n=r.info;var i=this._propertyList.indexOf(t),a=i!==-1,o=n.getType()!=="undefined";if(!a&&o){this._propertyList.push(t);this._triggerHandlers("_onAddHandlers",t,n);this._triggerHandlers("_onUpdateHandlers",t,n)}else if(a&&!o){this._propertyList.splice(i,1);this._triggerHandlers("_onUpdateHandlers",t,n);this._triggerHandlers("_onRemoveHandlers",t,n)}else if(a&&o){this._triggerHandlers("_onUpdateHandlers",t,n)}};Kg.prototype._triggerHandlers=function e(t,r,n){var i=this[t];for(var a=0,o=i.length;a<o;a++){i[a](r,n)}};var Qg=function e(t,r,n){var i=this;var a=n.path;var o=n.filter;var s=n.unwindArrays;this._module=t;this._isNode=r;this._path=a||[];this._filter=o;this._unwindArrays=s;this._onUpdateHandlers=[];this._triggerUpdate=function(e){for(var t=0;t<i._onUpdateHandlers.length;++t){i._onUpdateHandlers[t](e)}};this._info=t._watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)};Qg.prototype.onUpdate=function e(t){this._onUpdateHandlers.push(t)};Qg.prototype.getPropertyInfo=function e(){return this._info};Qg.prototype.getPath=function e(){return this._path.slice()};Qg.prototype.destroy=function e(){this._module._unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)};Qg.prototype.kill=function e(){return this.destroy()};var Jg=function e(t){var r=this;this._ogma=t;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._styleRules=t.modules.styleRules;this._watcher=t.modules.watcher;this._events=t.modules.events;this._mappingList=[];this._events.on({"addNodes addEdges updateNodeData updateEdgeData removeNodes removeEdges excludedStateChange clear":function(){if(r._mappingList.length){for(var e=0;e<r._mappingList.length;++e){r._mappingList[e].markAsInvalid()}r._styleRules.refreshAllRules();r._ogma.modules.legend.refresh()}}})};Jg.prototype.createMapping=function e(t){if(t===void 0)t={};var r=t.field;var n=t.values;if(n===void 0)n={};var i=t.fallback;r=z(r);if(!C(i)){i=[i]}else if(i.length===0){i=[undefined]}if(typeof n!=="object"||n===null||C(n)){throw new Error('"mapping" should be an object')}return this._createMappingFunction(ev,r,{values:n,fallback:i})};Jg.prototype.createSlices=function e(t){if(t===void 0)t={};var r=t.field;var n=t.fallback;var i=t.stops;if(i===void 0)i={};var a=t.values;if(a===void 0)a={nbSlices:7};var o=t.reverse;if(o===void 0)o=false;r=z(r);if(!a.nbSlices){a.nbSlices=7}if(C(i)&&C(a)&&i.length!==a.length-1){throw new Error("there should be exactly one more value that stops")}return this._createMappingFunction(tv,r,{fallback:n,stops:i,values:a,reverse:o})};Jg.prototype._createMappingFunction=function e(t,r,n){var i=new nv(this._ogma,t,r,n);this._mappingList.push(i);var a=function(e,t,r){return i.getValue(e,r)};a.mapping=i;return a};Jg.prototype.createTemplate=function e(t){if(typeof t!=="string"){throw new TypeError('"template" should be a string')}var r=[];var n=0;var i=false;while(!i){var a=-1;var o=t.indexOf("{{",n);if(o!==-1){a=t.indexOf("}}",o+2)}if(a!==-1){r.push(t.substring(n,o));r.push(t.substring(o+2,a));n=a+2}else{r.push(t.slice(n));i=true}}return function(e){var t=r[0];for(var n=1;n<r.length;n+=2){t+=e.getData(r[n]);t+=r[n+1]}return t}};function $g(e,t,r){var n=t?e.getNodes():e.getEdges();var i=n.getData(r);var a={};for(var o=0;o<i.length;++o){var value=i[o];if(Array.isArray(value)){for(var s=0;s<value.length;++s){a[value[s]]=1}}else{a[value]=1}}delete a.undefined;return Object.keys(a).sort()}function ev(e,t,r,n){var i=r.values;var a=r.fallback;var o=$g(e,n,t);var s={};var u=0;for(var l=0;l<o.length;++l){var value=o[l];if(value in i){s[value]=i[value]}else{s[value]=a[u];u=(u+1)%a.length}}return s}function tv(e,t,r,n){var i=r.fallback;var a=r.stops;var o=r.values;var s=r.reverse;var u=$g(e,n,t);var l=Infinity;var d=-Infinity;for(var f=0;f<u.length;++f){var value=+u[f];if(rv(value)){l=Math.min(l,value);d=Math.max(d,value);u[f]=value}}var h={};if(!isFinite(l)){for(var c=0;c<u.length;++c){h[u[c]]=i}}else{var g=C(o)?o.length:o.nbSlices,v,p;if(C(a)){v=a.slice()}else{var _=a.min;var m=a.max;if(_===undefined||m===undefined){_=l;m=d}var y=(m-_)/g;v=[];for(var b=1;b<g;++b){v.push(_+y*b)}}if(C(o)){p=o}else{var x=o.min;var S=o.max;var A=v.length+1,E=(S-x)/v.length;p=[];for(var w=0;w<A;++w){p.push(x+w*E)}}if(s){p.reverse()}for(var k=0;k<u.length;++k){var T=u[k];var L=+T;if(!isFinite(L)){h[T]=i}else{var M=0;while(M<v.length&&v[M]<=T){M+=1}h[T]=p[M]}}}return h}function rv(value){return typeof value==="number"&&isFinite(value)}var nv=function e(t,r,n,i){this._ogma=t;this._computeMapping=r;this._field=n;this._options=i;this._nodeMapping={valid:false,values:null};this._edgeMapping={valid:false,values:null}};nv.prototype.getValue=function e(t,r){var n=t.isNode;var i=n?this._nodeMapping:this._edgeMapping;if(!i.valid){i.values=this._computeMapping(this._ogma,this._field,this._options,n);i.valid=true}var a=t.getData(this._field);var o;if(C(a)){if(r==="color"){o=a.map(function(e){return i.values[e]})}else{o=i.values[a[0]]}}else{o=i.values[a]}return o};nv.prototype.markAsInvalid=function e(){this._nodeMapping.valid=false;this._edgeMapping.valid=false};nv.prototype.getValues=function e(t){return t?this._nodeMapping.values:this._edgeMapping.values};nv.prototype.getField=function e(){return this._field};Ogma.extend(function(e){var t=new Jg(e);e.modules.rules=t;e.rules={map:function e(r){return t.createMapping(r)},slices:function e(r){return t.createSlices(r)},template:function e(r){return t.createTemplate(r)}}});var iv={0:"left",1:"middle",2:"right"};Ogma.extend(function(e){e.modules.mouse=new lv(e)});var av=typeof window!=="undefined"&&("msLaunchUri"in navigator&&!("documentMode"in document));function ov(e){return av?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/ke():e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}if(typeof window!=="undefined"&&!window.__OGMA_HEADLESS){var sv=[];document.documentElement.addEventListener("mousemove",function(e){for(var t=0;t<sv.length;t++){sv[t](e)}})}var uv=6;var lv=function e(t){var r=this;this._dom=t.modules.dom;this._settings=t.modules.settings;this._events=t.modules.events;this._graphics=t.modules.graphics;this._domElt=this._graphics.getDomElement();this._x=0;this._y=0;this._px=0;this._py=0;this._pressX=0;this._pressY=0;this._left=false;this._middle=false;this._right=false;this._evt=null;this._bounds=null;this._clickCounter={left:0,middle:0,right:0};this._buttons={left:false,middle:false,right:false};this._button=null;this._skipNextMove=false;this._settings.register("mouse.enabled",true);this._settings.register("mouse.wheelEnabled",true);this._settings.register("mouse.disableWheelUntilMouseDown",false);this._settings.register("mouse.doubleClickTimer",500);this._events.register(["mouseDown","mouseUp","mouseMove","mouseWheel","mouseClick","mouseDoubleClick","mouseLeave","documentMouseMove","documentMouseUp"]);this._dom.afterNextFrame().then(function(){r._initializeListeners()})};var dv={x:{configurable:true},y:{configurable:true},left:{configurable:true},right:{configurable:true},middle:{configurable:true}};dv.x.get=function(){return this._x};dv.y.get=function(){return this._y};dv.left.get=function(){return this._left};dv.right.get=function(){return this._right};dv.middle.get=function(){return this._middle};lv.prototype._isEnabled=function e(){return this._settings.get("mouse.enabled")};lv.prototype._isWheelEnabled=function e(){return this._settings.get("mouse.wheelEnabled")};lv.prototype._disableWheelUntilMouseDown=function e(){return this._settings.get("mouse.disableWheelUntilMouseDown")};lv.prototype._getDoubleClickTimer=function e(){return this._settings.get("mouse.doubleClickTimer")};lv.prototype._resetClickCounter=function e(t,value){if(value===void 0)value=0;if(t){this._clickCounter[t]=value}else{this._clickCounter.left=value;this._clickCounter.middle=value;this._clickCounter.right=value}this._dom.clearTimeout(this._dbclickTimer)};lv.prototype._setXY=function e(t){var r=Ve(this._domElt);this._bounds=r;if(!r){return false}this._evt=t;this._button=iv[t.button];this._px=this._x;this._py=this._y;this._x=t.clientX-r.left;this._y=t.clientY-r.top;this._left=this._buttons.left;this._right=this._buttons.right;this._middle=this._buttons.middle;return true};lv.prototype._applyMouseWheelZoom=function e(t){if(this._setXY(t)){this._events.fire("mouseWheel",{delta:ov(t),x:this._x,y:this._y,domEvent:this._evt})}};lv.prototype._onMouseWheel=function e(t){if(this._isEnabled()&&this._isWheelEnabled()&&(!this._disableWheelUntilMouseDown()||this._dom.hasFocus())){t.preventDefault();t.stopPropagation();this._applyMouseWheelZoom(t)}};lv.prototype._onMouseMove=function e(t){if(!this._isEnabled()||!this._setXY(t)){return}var r=this._x,n=this._y;var i=r-this._px;var a=n-this._py;if(i===0&&a===0){return}if(this._skipNextMove){this._skipNextMove=false}else if(distance(r,n,this._pressX,this._pressY)>=uv){this._resetClickCounter();this._events.fire("mouseMove",{x:r,y:n,dx:i,dy:a,domEvent:this._evt})}};lv.prototype._onDocumentMouseMove=function e(t){if(!this._isEnabled()||!this._setXY(t)){return}var r=this._x,n=this._y,i=this._bounds;var a=r-this._px;var o=n-this._py;if(r<0||r>i.width||n<0||n>i.height){this._events.fire("documentMouseMove",{x:r,y:n,dx:a,dy:o,domEvent:this._evt})}};lv.prototype._onMouseUp=function e(t){if(!this._isEnabled()||!this._setXY(t)){return}var r=this._x,n=this._y,i=this._button,a=this._evt;this._buttons[i]=false;if(this._clickCounter[this._button]===1){this._events.fire("mouseClick",{button:i,x:r,y:n,domEvent:a})}else if(this._clickCounter[i]>1){this._events.fire("mouseDoubleClick",{button:i,x:r,y:n,domEvent:a});this._resetClickCounter(i)}this._events.fire("mouseUp",{button:i,x:r,y:n,domEvent:a})};lv.prototype._onDocumentMouseup=function e(t){if(!this._isEnabled()||!this._setXY(t)){return}var r=this._x,n=this._y,i=this._button,a=this._bounds;this._buttons[i]=false;if(r<0||r>a.width||n<0&&n>a.height){this._events.fire("documentMouseUp",{button:i,x:r,y:n,domEvent:this._evt})}this._dom.removeDocumentEventListener("mousemove",this.onDocumentMove);this._dom.removeDocumentEventListener("mouseup",this.onDocumentMouseup)};lv.prototype._onMouseDown=function e(t){var r=this;if(!this._isEnabled()||!this._setXY(t)){return}var n=this._x,i=this._y,a=this._button;this._skipNextMove=true;this._pressX=n;this._pressY=i;this._dom.focus();this._buttons[a]=true;this._clickCounter[a]+=1;var o=a;this._dbclickTimer=this._dom.setTimeout(function(){r._resetClickCounter(o,0)},this._getDoubleClickTimer());this._events.fire("mouseDown",{button:a,x:n,y:i,domEvent:this._evt});this._dom.addDocumentEventListener("mousemove",this.onDocumentMouseMove);this._dom.addDocumentEventListener("mouseup",this.onDocumentMouseup)};lv.prototype._initializeListeners=function e(){var t=this;var r=this._domElt;this.onMouseWheel=function(e){return t._onMouseWheel(e)};this.onMouseMove=function(e){return t._onMouseMove(e)};this.onDocumentMouseMove=function(e){return t._onDocumentMouseMove(e)};this.onMouseUp=function(e){return t._onMouseUp(e)};this.onDocumentMouseUp=function(e){return t._onDocumentMouseup(e)};this.onMouseDown=function(e){return t._onMouseDown(e)};this._dom.addElementEventListener(this._domElt,"contextmenu",function(e){t._setXY(e);if(t._dom.hasFocus()&&t._settings.get("mouse.enabled")){e.preventDefault()}},false);var n="onwheel"in this._domElt?"wheel":this._domElt.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";this._dom.addElementEventListener(r,n,this.onMouseWheel);this._dom.addElementEventListener(r,"mousemove",this.onMouseMove);this._dom.addElementEventListener(r,"mouseleave",function(){if(!t._isEnabled()){return}t._dom.blur();t._events.fire("mouseLeave",{domEvent:t._evt})});this._dom.addElementEventListener(r,"mousedown",this.onMouseDown);this._dom.addElementEventListener(r,"mouseup",this.onMouseUp)};Object.defineProperties(lv.prototype,dv);Ogma.extend(function(e){var t=new fv(e);e.modules.virtualMouse=t;e.mouse={move:function e(r){return t.move(r)},down:function e(r){return t.down(r)},up:function e(r){return t.up(r)},click:function e(r){return t.click(r)},doubleClick:function e(r){return t.doubleClick(r)},drag:function e(r,n){return t.drag(r,n)},wheel:function e(r){return t.wheel(r)}}});var fv=function e(t){this._ogma=t;this._dom=t.modules.dom;this._events=t.modules.events;this._events.register(["virtualDown","virtualUp","virtualMove","virtualClick","virtualDoubleClick","virtualWheel"])};var hv={x:{configurable:true},y:{configurable:true}};hv.x.get=function(){return this._ogma.modules.captor._x||0};hv.y.get=function(){return this._ogma.modules.captor._y||0};fv.prototype._later=function e(){return this._dom.afterNextFrame()};fv.prototype.move=function e(t){var r=this;var n=t.x;var i=t.y;if(n!==undefined&&i!==undefined){return this._dom.afterNextFrame().then(function(){var e=n-r.x;var t=i-r.y;r._events.fire("virtualMove",{x:n,y:i,dx:e,dy:t});return r._later()})}else{return Promise.resolve()}};fv.prototype.down=function e(t){var r=this;if(t===void 0)t={};var n=t.x;var i=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:n,y:i}).then(function(){r._events.fire("virtualDown",{x:r.x,y:r.y,button:a});r._events.fire("virtualMove",{x:r.x,y:r.y,dx:0,dy:0});return r._later()})};fv.prototype.up=function e(t){var r=this;if(t===void 0)t={};var n=t.x;var i=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:n,y:i}).then(function(){r._events.fire("virtualUp",{x:r.x,y:r.y,button:a});return r._later()})};fv.prototype.click=function e(t){var r=this;if(t===void 0)t={};var n=t.x;var i=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:n,y:i}).then(function(){r._events.fire("virtualClick",{x:r.x,y:r.y,button:a});return r._later()})};fv.prototype.doubleClick=function e(t){var r=this;if(t===void 0)t={};var n=t.x;var i=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:n,y:i}).then(function(){r._events.fire("virtualDoubleClick",{x:r.x,y:r.y,button:a});return r._later()})};fv.prototype.drag=function e(t,r){var n=this;return this.down(t).then(function(){return n.move(r)}).then(function(){return n.up()})};fv.prototype.wheel=function e(t){var r=this;var n=t.x;var i=t.y;var a=t.delta;return this.move({x:n,y:i}).then(function(){r._events.fire("virtualWheel",{x:r.x,y:r.y,delta:a});return r._later()})};Object.defineProperties(fv.prototype,hv);var cv={doubleTapTimer:500,touchEventRate:15};Ogma.extend(function(e){return e.modules.touch=new gv(e)});Ogma.onDestroy(function(e){return e.modules.touch.destroy()});var gv=function e(t){var r=this;this._dom=t.modules.dom;this._events=t.modules.events;this._settings=t.modules.settings;this._graphics=t.modules.graphics;this._x=0;this._y=0;this._pressed=false;this._domElt=this._graphics.getDomElement();this._settings.register("touch.enabled",true);this._events.register(["touchDown","touchUp","touchTap","touchDoubleTap","touchMove","touchStartGesture","touchProgressGesture","touchEndGesture","documentTouchMove","documentTouchUp"]);this._addEvent=function(e,t,n,i){r._dom.addElementEventListener(e,t,n,i)};this._addDocEvent=function(e,t,n,i){r._dom.addDocumentEventListener(t,n,i)};this._removeDocEvent=function(e,t,n){r._dom.removeDocumentEventListener(t,n)};this._dom.afterNextFrame().then(function(){r._initialize(r)})};var vv={x:{configurable:true},y:{configurable:true},pressed:{configurable:true}};vv.x.get=function(){return this._x};vv.y.get=function(){return this._y};vv.pressed.get=function(){return this._pressed};gv.prototype._isEnabled=function e(){return this._settings.get("touch.enabled")};gv.prototype.destroy=function e(){};gv.prototype._listen=function e(t,r,n){if(io){if(r==="touchstart"){return mo(this._addEvent,t,n)}else if(r==="touchmove"){return bo(this._addDocEvent,t,n)}else if(r==="touchend"){return xo(this._addDocEvent,t,n)}else if(r==="touchcancel"){return yo(this._addDocEvent,t,n)}else{return this._dom.addElementEventListener(t,r,n)}}else{return this._dom.addElementEventListener(t,r,n)}};gv.prototype._initialize=function e(){var t=this;var r=0,n=0;var i=0,a=0;var o=false;var s=0;var u=false;var l=false;var d=1;var f=0;var h=null;var c=null;var g=function(){t._x=r;t._y=n;t._pressed=o};var v=function(e,t,i,a){d=e;f=t;r=i;n=a;g()};var p=function(e){var i=Ve(t._domElt);if(!i){return null}var a=e.touches[0].clientX-i.left;var o=e.touches[0].clientY-i.top;var s=e.touches[1].clientX-i.left;var u=e.touches[1].clientY-i.top;var l=(a+s)/2;var h=(o+u)/2;var c=l-r;var g=h-n;var p=distance(a,o,s,u);var _=p/d;var m=Qr(a,o,s,u);var y=m-f;var b={dx:c,dy:g,rotation:y,scale:_};v(p,m,l,h);return b};var _=function(e){if(e.touches.length===2&&l){var i=p(e);if(i){var a=i.dx;var o=i.dy;var s=i.rotation;var u=i.scale;t._events.fire("touchProgressGesture",{dx:a,dy:o,rotation:s,scale:u,x:r,y:n,domEvent:h})}}};var m=function(e){if(e.touches.length!==1){o=false;if(e.touches.length>1){t._events.fire("touchUp",{x:r,y:n,domEvent:h})}return false}else{var s=Ve(t._domElt);if(s){i=r;a=n;r=e.touches[0].clientX-s.left|0;n=e.touches[0].clientY-s.top|0;o=true;h=e;g()}return true}};var y=function(){s=0;t._dom.clearTimeout(c)};this._listen(this._domElt,"touchstart",function(e){e.preventDefault();if(e.touches.length===2&&!l){if(p(e,true)){l=true;t._events.fire("touchStartGesture",{domEvent:h})}}if(m(e)){t._dom.focus();t._events.fire("touchDown",{x:r,y:n,domEvent:h});s+=1;c=t._dom.setTimeout(y,cv.doubleTapTimer);u=true}var i=de().documentElement;t._onMove=t._listen(i,"touchmove",x);t._onEnd=t._listen(i,"touchend",b)});var b=function(e){e.preventDefault();if(e.touches.length!==2&&l){l=false;t._events.fire("touchEndGesture",{domEvent:h})}m(e);if(e.touches.length===0){var i={x:r,y:n,domEvent:h};if(s===1){t._events.fire("touchTap",i)}else if(s>1){t._events.fire("touchDoubleTap",i);y()}t._events.fire("touchUp",i)}var a=de().documentElement;So(t._removeDocEvent,a,"touchmove",t._onMove);So(t._removeDocEvent,a,"touchend",t._onEnd)};var x=function(e){_(e);if(u){u=false;return}y();if(m(e)){t._events.fire("touchMove",{x:r,y:n,dx:r-i,dy:n-a,domEvent:h})}}};Object.defineProperties(gv.prototype,vv);var pv={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"};var _v={};(function(){var e=Object.keys(pv);e.forEach(function(e){var t=pv[e];if(!_v[t]){_v[t]=[]}_v[t].push(e)})})();Ogma.extend(function(e){var t=new mv(e);e.modules.keyboard=t;e.events.onKeyPress=function(r,n){t.onKeyPress(r,n);return e.events};e.keyboard={isKeyPressed:function e(r){return t.isPressed(r)},resetKeys:function e(){t.resetKeys()}}});var mv=function e(t){var r=this;this._dom=t.modules.dom;this._events=t.modules.events;this._events.register(["keyUp","keyDown"]);this._binds=[];this._pressed=[];this._onKeyDown=function(e){var t=e.keyCode||e.which,n=r._binds[t];if(r._pressed[t]){return}r._pressed[t]=true;if(n){for(var i=0;i<n.length;++i){var a=n[i],o=true;for(var s=0;s<a.keys.length;++s){var u=false,l=a.keys[s];for(var d=0;d<l.length;++d){if(r._pressed[l[d]]){u=true}}if(!u){o=false}}if(o){a.handler({domEvent:e})}}}r._events.fire("keyDown",{domEvent:e,key:pv[t],code:t})};this._onKeyUp=function(e){var t=e.keyCode||e.which;r._pressed[t]=false;r._events.fire("keyUp",{domEvent:e,key:pv[t],code:t})};this._onBlur=function(){return r._resetKeys()};this._dom.addWindowEventListener("keydown",this._onKeyDown);this._dom.addWindowEventListener("keyup",this._onKeyUp);this._dom.addWindowEventListener("visibilitychange",this._onBlur);this._dom.addWindowEventListener("blur",this._onBlur,false);this._idleTimeout=1e3;this._prevEventTimeStamp=$t();this._events.onAnyEvent(function(){var e=$t();if(e-r._prevEventTimeStamp>r._idleTimeout){r._resetKeys()}r._prevEventTimeStamp=e})};mv.prototype.setIdleTimeout=function e(t){if(isFinite(t)&&t>1){this._idleTimeout=t}else{throw new TypeError("Idle timeout must be a positive number > 1")}};mv.prototype.resetKeys=function e(){this._resetKeys()};mv.prototype._resetKeys=function e(){for(var t=0;t<this._pressed.length;++t){if(this._pressed[t]){this._pressed[t]=false;this._events.fire("keyUp",{key:pv[t],code:t})}}};mv.prototype.onKeyPress=function e(t,r){var n=this;if(typeof t==="number"){t=[t]}else if(typeof t==="string"){t=t.split(" ")}else if(!Array.isArray(t)){throw new TypeError(t+" is not a number, string or array")}else if(t.length===0){throw new Error("the array should contain at least one element")}var i=[];t.forEach(function(e){if(typeof e==="number"){i.push([e])}else if(typeof e==="string"){var t=_v[e];if(!t){throw new Error(e+" is not a valid key identifier")}i.push(t)}else{throw new TypeError(e+" is not a valid key identifier")}});var a=i.pop(),o={keys:i,handler:r};a.forEach(function(e){if(!n._binds[e]){n._binds[e]=[]}n._binds[e].push(o)})};mv.prototype.isPressed=function e(t){if(typeof t==="number"){return this._pressed[t]}else if(typeof t==="string"){var r=_v[t];if(r){for(var n=0;n<r.length;++n){if(this._pressed[r[n]]){return true}}}}return false};Ogma.extend(function(e){var t=new yv(e);var r=e.modules.events;e.modules.captor=t;e.getHoveredElement=function(){return t.getPointedElement()};e.view.getElementAt=function(e){return t.getElementAt(e)};e.getPointerInformation=function(){return t.getCursorInformation()};Object.assign(e.events,{onMouseMove:function t(n){r.on("move",n);return e.events},onMouseButtonDown:function t(n){r.on("down",n);return e.events},onMouseButtonUp:function t(n){r.on("up",n);return e.events},onClick:function t(n){r.on("click",n);return e.events},onDoubleClick:function t(n){r.on("doubleClick",n);return e.events},onMouseWheel:function t(n){r.on("wheel",n);return e.events},onHover:function t(n){r.on("hover",n);return e.events},onUnhover:function t(n){r.on("unhover",n);return e.events},onDragStart:function t(n){r.on("dragStart",n);return e.events},onDragProgress:function t(n){r.on("dragProgress",n);return e.events},onDragEnd:function t(n){r.on("dragEnd",n);return e.events},onGestureStart:function t(n){r.on("gestureStart",n);return e.events},onGestureProgress:function t(n){r.on("gestureProgress",n);return e.events},onGestureEnd:function t(n){r.on("gestureEnd",n);return e.events}})});var yv=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._camera=t.modules.camera;this._mouse=t.modules.mouse;this._events=t.modules.events;this._settings=t.modules.settings;this._spatial=t.modules.spatial;this._elt=null;this._hoveredElt=null;this._draggedElt=null;this._disabledCounter=0;this._x=0;this._y=0;this._accDx=0;this._accDy=0;this._timeout=null;this._buttons={left:{isPressed:false,isDragging:false},middle:{isPressed:false,isDragging:false},right:{isPressed:false,isDragging:false}};this._events.register(["move","down","up","click","doubleClick","hover","unhover","wheel","dragStart","dragProgress","dragEnd","gestureStart","gestureProgress","gestureEnd"]);this._settings.register("detect.nodes",true);this._settings.register("detect.edges",true);this._settings.register("detect.nodeTexts",true);this._settings.register("detect.edgeTexts",true);this._settings.register("detect.nodeErrorMargin",5);this._settings.register("detect.edgeErrorMargin",7);this._settings.register("detect.enableSpatialIndex",true);this._settings.register("detect.spatialIndexMarginRatio",3);this._events.on({"removeNodes removeEdges clear":function(){Lv(r,r._x,r._y);if(!r._timeout){r._timeout=r._dom.setTimeout(function(){Av(r,{x:r._x,y:r._y});r._timeout=null},0)}},"mouseMove touchMove virtualMove":function(e,t){var n=e.domEvent;var i=e.x;var a=e.y;Av(r,{domEvent:n,x:i,y:a,source:bv(t)})},"mouseDown touchDown virtualDown":function(e,t){var n=e.domEvent;var i=e.x;var a=e.y;var o=e.button;if(o===void 0)o="left";Sv(r,{domEvent:n,x:i,y:a,button:o,source:bv(t)})},"mouseUp touchUp virtualUp":function(e,t){var n=e.domEvent;var i=e.x;var a=e.y;var o=e.button;if(o===void 0)o="left";kv(r,{domEvent:n,x:i,y:a,button:o,source:bv(t)})},"mouseClick touchTap virtualClick":function(e,t){var n=e.domEvent;var i=e.x;var a=e.y;var o=e.button;if(o===void 0)o="left";Cv(r,{domEvent:n,x:i,y:a,button:o,source:bv(t)})},"mouseDoubleClick touchDoubleTap virtualDoubleClick":function(e,t){var n=e.domEvent;var i=e.x;var a=e.y;var o=e.button;if(o===void 0)o="left";Tv(r,{domEvent:n,x:i,y:a,button:o,source:bv(t)})},"mouseWheel virtualWheel":function(e){var t=e.domEvent;var n=e.x;var i=e.y;var a=e.delta;r._x=n;r._y=i;xv(r,"wheel",undefined,{domEvent:t,x:n,y:i,delta:a,source:"mouse",target:r._hoveredElt})},touchStartGesture:function(e){return r._events.fire("gestureStart",e)},touchProgressGesture:function(e){return r._events.fire("gestureProgress",e)},touchEndGesture:function(e){return r._events.fire("gestureEnd",e)},documentMouseMove:function(e,t){var n=e.domEvent;var i=e.x;var a=e.y;var o=bv(t);U(r._buttons,function(e,t){var s=e.isDragging;if(s){var u=r._setPointerPosition(i,a);var l=u.dx;var d=u.dy;xv(r,"dragProgress",r._draggedElt,{domEvent:n,x:i,y:a,dx:l,dy:d,button:t,source:o})}})},documentMouseUp:function(e,t){var n=e.domEvent;var i=e.x;var a=e.y;var o=e.button;if(o===void 0)o="left";var s=bv(t);if(r._buttons[o].isDragging){xv(r,"dragEnd",r._draggedElt,{domEvent:n,x:i,y:a,button:o,source:s});if(Ev(r)===0){r._draggedElt=null}var u=r._buttons[o];u.isDragging=false;u.isPressed=false}}})};yv.prototype._storeDXY=function e(t,r){this._accDx=t;this._accDy=r};yv.prototype._getStoredDXY=function e(){var t=this._accDx;var r=this._accDy;this._accDx=0;this._accDy=0;return{dx:t,dy:r}};yv.prototype._setPointerPosition=function e(t,r){var n=t-this._x;var i=r-this._y;this._x=t;this._y=r;this._accDx=0;this._accDy=0;return{dx:n,dy:i}};yv.prototype.triggerUnhover=function e(){this._hover=false;this._hoveredElt=null};yv.prototype.triggerDetection=function e(){Mv(this,this._x,this._y);if(this._elt){this._hoveredElt=this._elt;this._hover=true}};yv.prototype.getElementAt=function e(t,r){var n=t.x;var i=t.y;return Iv(this,n,i,r)};yv.prototype.getPointedElement=function e(){return this._hoveredElt};yv.prototype.getDraggedElement=function e(){return this._draggedElt};yv.prototype.isAnyButtonPressed=function e(){return wv(this)>0};yv.prototype.isButtonPressed=function e(t){return this._buttons[t].isPressed};yv.prototype.isLeftPressed=function e(){return this.isButtonPressed("left")};yv.prototype.getCursorPosition=function e(){return{x:this._x,y:this._y}};yv.prototype.getCursorInformation=function e(){return{x:this._x,y:this._y,target:this._hoveredElt}};yv.prototype.setDetectionEnabled=function e(value){this._disabledCounter=Math.max(0,this._disabledCounter+(value?-1:1))};function bv(e){if(e.indexOf("touch")===0){return"touch"}else{return"mouse"}}function xv(e,t,r,n){n.target=r||null;e._events.fire(t,n);return n}function Sv(e,t){var r=t.domEvent;var n=t.x;var i=t.y;var a=t.button;var o=t.source;Mv(e,n,i);if(e._elt!==e._hoveredElt){Lv(e,n,i)}var s=e._buttons[a];e._hoveredElt=e._elt;e._hoveredEltIsNode=e._elt&&e._elt.isNode;s.isPressed=true;xv(e,"down",e._hoveredElt,{domEvent:r,x:n,y:i,button:a,source:o})}function Av(e,t){var r=t.domEvent;var n=t.x;var i=t.y;var a=t.source;var o=e._setPointerPosition(n,i);var s=o.dx;var u=o.dy;e._events.fire("move",{domEvent:r,x:n,y:i,dx:s,dy:u,source:a});U(e._buttons,function(t,o){if(t.isPressed){if(!t.isDragging){t.isDragging=true;if(e._hoveredElt){if(e._hover){xv(e,"unhover",e._hoveredElt,{domEvent:r,x:n,y:i,source:a});e._hover=false}}if(!e._draggedElt){e._draggedElt=e._hoveredElt;e._draggedEltIsNode=e._hoveredEltIsNode}e._storeDXY(s,u);xv(e,"dragStart",e._draggedElt,{domEvent:r,x:n,y:i,button:o,source:a})}else{var l=e._getStoredDXY();s+=l.dx;u+=l.dy;xv(e,"dragProgress",e._draggedElt,{domEvent:r,x:n,y:i,dx:s,dy:u,button:o,source:a})}}});if(!r||e._graphics.getDomElement().contains(r.target)){Mv(e,n,i)}if(e._elt!==e._hoveredElt){if(e._hoveredElt&&e._hover){e._hover=true;xv(e,"unhover",e._hoveredElt,{domEvent:r,x:n,y:i,source:a})}e._hoveredElt=e._elt;e._hoveredEltIsNode=e._isNode;if(e._elt){e._hover=true;xv(e,"hover",e._hoveredElt,{domEvent:r,x:n,y:i,source:a})}}}function Ev(e){return V(e._buttons).reduce(function(e,t){var r=t.isDragging;if(r===void 0)r=false;return e+r},0)}function wv(e){return V(e._buttons).reduce(function(e,t){var r=t.isPressed;if(r===void 0)r=false;return e+r},0)}function kv(e,t){var r=t.domEvent;var n=t.x;var i=t.y;var a=t.button;var o=t.source;var s=e._buttons[a];if(!s.isPressed){return}if(s.isDragging){xv(e,"dragEnd",e._draggedElt,{domEvent:r,x:n,y:i,button:a,source:o});s.isDragging=false;if(Ev(e)===0){e._draggedElt=null}}s.isPressed=false;Mv(e,n,i);xv(e,"up",e._elt,{domEvent:r,x:n,y:i,button:a,source:o});if(!wv(e)&&!e._hover&&o!=="touch"){e._hoveredElt=e._elt;e._hoveredEltIsNode=e._isNode;if(e._hoveredElt){xv(e,"hover",e._hoveredElt,{domEvent:r,x:n,y:i,source:o});e._hover=true}}}function Cv(e,t){var r=t.domEvent;var n=t.x;var i=t.y;var a=t.button;var o=t.source;xv(e,"click",e._hoveredElt,{domEvent:r,x:n,y:i,button:a,source:o})}function Tv(e,t){var r=t.domEvent;var n=t.x;var i=t.y;var a=t.button;var o=t.source;xv(e,"doubleClick",e._hoveredElt,{domEvent:r,x:n,y:i,button:a,source:o})}function Lv(e,t,r){var n=null;U(e._buttons,function(i,a){var o=i.isDragging;if(o){xv(e,"dragEnd",e._draggedElt,{domEvent:n,x:t,y:r,button:a})}});if(e._hover&&e._hoveredElt){xv(e,"unhover",e._hoveredElt,{domEvent:n,x:t,y:r})}Object.keys(e._buttons).forEach(function(t){var r=e._buttons[t];r.isPressed=false;r.isDragging=false});e._hover=false;e._hoveredElt=null;e._draggedElt=null}function Mv(e,t,r,n){e._elt=Iv(e,t,r,n);e._isNode=!e._elt||e._elt.isNode}function Iv(e,t,r,n){if(e._disabledCounter!==0||t===undefined||r===undefined){return null}var i=e._settings;var a=i.get("detect.enableSpatialIndex");var o=i.get("detect.nodeErrorMargin");var s=i.get("detect.edgeErrorMargin");var u=i.get("detect.nodes");var l=i.get("detect.edges");var d={x:t,y:r};var f=null,h,c;if(!n&&a){if(u||l){var g=i.get("detect.spatialIndexMarginRatio");var v=Math.max(o*g,s*g);var p=e._spatial.queryRawProjected(t-v,r-v,t+v,r+v);h=p.nodes;c=p.edges}}if(u){f=e._graphics.detectNode({position:d,indexes:h,margin:o,texts:i.get("detect.nodeTexts")})}if(!f&&l){f=e._graphics.detectEdge({position:d,indexes:c,margin:s,texts:i.get("detect.edgeTexts")})}return f}Ogma.extend(function(e){e.modules.sync=new Fv(e)});var Fv=function e(t){var r=this;this._dom=t.modules.dom;this._events=t.modules.events;this._captor=t.modules.captor;this._delayedCalls=[];this._idIdle=function(){return!r._captor.isAnyButtonPressed()&&!r._dom.isPlayingFrame()};this._events.on({"down up beforeNewFrame newFrame":function(){r._delayedCalls.forEach(function(e){return e.reset()})}})};Fv.prototype._nextTimeIdle=function e(t){var r=this;var n=new Nv(this._dom,this._idIdle,t);this._delayedCalls.push(n);return n.whenDone().then(function(){r._delayedCalls.splice(r._delayedCalls.indexOf(n),1)})};Fv.prototype.debounceIdle=function e(t,r){var n=this;if(r===void 0)r=0;var i=false;var a=[];var o=function(){var e=a;i=false;a=[];t();e.forEach(function(e){return e()})};return function(){return new Promise(function(e){a.push(e);if(!i){i=true;n._nextTimeIdle(r).then(o)}})}};var Nv=function e(t,r,n){var i=this;this._dom=t;this._promise=new Promise(function(e){return i._resolve=e});this._isIdle=r;this._delay=n;this._timeout=null;this._done=false;this._startTimeout()};Nv.prototype._startTimeout=function e(){var t=this;this._timeout=this._dom.setTimeout(function(){if(t._isIdle()){t._done=true;t._resolve()}else{t._startTimeout()}},this._delay)};Nv.prototype.reset=function e(){if(!this._done){this._dom.clearTimeout(this._timeout);this._startTimeout()}};Nv.prototype.whenDone=function e(){return this._promise};var zv=40;var Rv="quadraticInOut";var Pv=200;Ogma.afterInit(function(e){e.modules.locate.locateGraph({},true)});Ogma.extend(function(e){var t=new Dv(e);var r=e.Node;var n=e.Edge;var i=e.NodeList;var a=e.EdgeList;e.modules.locate=t;r.prototype.locate=function(e){return t.locateElements(this,e)};i.prototype.locate=function(e){return t.locateElements(this,e)};n.prototype.locate=function(e){return t.locateElements(this,e)};a.prototype.locate=function(e){return t.locateElements(this,e)};r.prototype.getBoundingBox=function(){return t.getBoundingBox(this)};i.prototype.getBoundingBox=function(){return t.getBoundingBox(this)};n.prototype.getBoundingBox=function(e){return t.getBoundingBox(this,e)};a.prototype.getBoundingBox=function(e){return t.getBoundingBox(this,e)};e.view.locateGraph=function(e){return t.locateGraph(e)};e.view.locateRawGraph=function(e,r){return t.locateRawGraph(e,r)};e.view.getGraphBoundingBox=function(){return t.getGraphBoundingBox()}});var Dv=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._events=t.modules.events;this._camera=t.modules.camera;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._settings=t.modules.settings;this._sync=t.modules.sync;this._transformations=t.modules.transformations;this._cacheValid=true;this._cachedGraphBoundingBox=new Fr;this._scheduleCacheUpdate=this._sync.debounceIdle(function(){r._updateCache()},50);this._events.on({"addNodes removeNodes addEdges removeEdges excludedStateChange clear updateAttributes":function(){r._invalidCache()}})};Dv.prototype.locateGraph=function e(t,r){var n=this;if(r===void 0)r=false;if(r){return this._locateGraph(t)}else{return this._ogma.transformations.afterNextUpdate().then(function(){return n._locateGraph(t)})}};Dv.prototype._locateGraph=function e(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t)};Dv.prototype.locateElements=function e(t,r){var n=this;return this._ogma.transformations.afterNextUpdate().then(function(){return n._locateBoundingBox(n.getBoundingBox(t),r)})};Dv.prototype.locateRawGraph=function e(t,r){return this._locateBoundingBox(this._getRawGraphBoundingBox(t),r)};Dv.prototype.getGraphBoundingBox=function e(){if(!this._cacheValid){this._updateCache()}return Object.assign({},this._cachedGraphBoundingBox)};Dv.prototype.forceInvalidCache=function e(){this._invalidCache()};Dv.prototype._invalidCache=function e(){this._cacheValid=false};Dv.prototype._updateCache=function e(){this._cacheValid=true;this._cachedGraphBoundingBox=this.getBoundingBox(this._ogma.getNodes())};Dv.prototype.getBoundingBox=function e(t,r){if(t.isNode){return this._getNodesBoundingBox(t.toList())}else{return this._getEdgesBoundingBox(t.toList(),r)}};Dv.prototype._getNodesBoundingBox=function e(t){this._graphics.forceAttributesComputation();var r=this._graphics.getNodeAttributes();var n=[];var i=[];var a=[];var o=[];for(var s=0;s<t.size;++s){var u=t._indexes[s];if(r.excluded.get(u)===0){var l=r.x.get(u);var d=r.y.get(u);var f=r.radius.get(u)*2;if(r.scalingMethod.get(u)==="scaled"){a.push(f)}else{o.push(f)}n.push(l);i.push(d)}}return new Fr({xValues:n,yValues:i,scaledSizeValues:a,fixedSizeValues:o})};Dv.prototype._getEdgesBoundingBox=function e(t,r){if(r===void 0)r=false;this._graphics.forceAttributesComputation();var n=this._graphics.getEdgeAttributes();var i=this._graphics.getNodeAttributes();var a={x1:0,y1:0,x2:0,y2:0};var o={x:0,y:0};var s={minX:0,minY:0,maxX:0,maxY:0};var u=[];var l=[];var d=[];var f=[];for(var h=0;h<t.size;++h){var c=t._indexes[h];var g=n.source.get(c);var v=n.target.get(c);var p=n.curvature.get(c);var _=i.x.get(g);var m=i.y.get(g);var y=i.scalingMethod.get(g)==="scaled";var b=i.radius.get(g)*2;var x=i.x.get(v);var S=i.y.get(v);var A=i.scalingMethod.get(v)==="scaled";var E=i.radius.get(v)*2;if(y){d.push(b)}else{f.push(b)}if(A){d.push(E)}else{f.push(E)}if(r||p===0){u.push(_,x);l.push(m,S)}else if(g===v){var w=b/2;Xi(_,m,p,w,0,a);$i(_,m,a.x1,a.y1,a.x2,a.y2,x,S,s);u.push(s.minX,s.maxX);l.push(s.minY,s.maxY)}else{Hi(_,m,x,S,p,o);Ji(_,m,o.x,o.y,x,S,s);u.push(s.minX,s.maxX);l.push(s.minY,s.maxY)}}return new Fr({xValues:u,yValues:l,scaledSizeValues:d,fixedSizeValues:f})};Dv.prototype._getRawGraphBoundingBox=function e(t){return new Fr({xValues:t.nodes.map(function(e){return e.x||0}),yValues:t.nodes.map(function(e){return e.y||0}),scaledSizeValues:t.nodes.map(function(e){return+(e.attributes&&e.attributes.radius)||5})})};Dv.prototype._computeCameraConfig=function e(t,r,n){if(typeof r==="number"){r={left:r,right:r,top:r,bottom:r}}var i=qa(r.left,zv);var a=qa(r.right,zv);var o=qa(r.top,zv);var s=qa(r.bottom,zv);var u=this._dom.getDimensions();var l=i+a;var d=o+s;var f=t.width===0?t.maxFixedSize:t.width;var h=t.height===0?t.maxFixedSize:t.height;var c=(u.width-l)/(f+t.maxScaledSize);var g=(u.height-d)/(h+t.maxScaledSize);var v=(u.width-l-t.maxFixedSize)/f;var p=(u.height-d-t.maxFixedSize)/h;var _=n/t.maxScaledSize||NaN;var m=us([c,g,v,p,_]);return{x:t.cx+(a-i)/(m*2),y:t.cy+(s-o)/(m*2),zoom:m}};Dv.prototype._locateBoundingBox=function e(t,r){if(r===void 0)r={};if(isNaN(t.cx)){return Promise.resolve()}var n=r.padding;if(n===void 0)n={};var i=r.easing;if(i===void 0)i=Rv;var a=r.duration;if(a===void 0)a=0;var o=r.maxNodeSizeOnScreen;if(o===void 0)o=Pv;var s=r.ignoreZoomLimits;if(s===void 0)s=false;var u=this._computeCameraConfig(t,n,o);var l=u.x;var d=u.y;var f=u.zoom;var h=f/this._camera.getZoom();return this._moveCamera(l,d,f,a,i,h,s)};Dv.prototype._moveCamera=function e(t,r,n,i,a,o,s){if(o>1.01){this._camera.setCenter({x:t,y:r},{duration:i,easing:a,ignoreZoomLimits:s});return this._camera.setZoom(n,{duration:i,easing:a,ignoreZoomLimits:s,startAfter:.5})}else if(o<.99){this._camera.setCenter({x:t,y:r},{duration:i,easing:a,ignoreZoomLimits:s,startAfter:.5});return this._camera.setZoom(n,{duration:i,easing:a,ignoreZoomLimits:s})}else{return this._camera.setCenter({x:t,y:r},{duration:i,easing:a,ignoreZoomLimits:s})}};Dv.prototype.computeConfigForBounds=function e(t,r){if(r===void 0)r={};var n=r.padding;if(n===void 0)n={};var i=r.maxNodeSizeOnScreen;if(i===void 0)i=Pv;return this._computeCameraConfig(t,n,i)};Dv.prototype.layoutDataBoundingBox=function e(t){var r=t.x;var n=t.y;var i=t.indexes;var a=this._graphics.getNodeAttributes();var o=[];var s=[];var u=[];var l=[];for(var d=0;d<i.length;++d){var f=i[d];var h=r[d];var c=n[d];var g=a.radius.get(f)*2;var v=a.scalingMethod.get(f)==="scaled";o.push(h);s.push(c);if(v){u.push(g)}else{l.push(g)}}return new Fr({xValues:o,yValues:s,scaledSizeValues:u,fixedSizeValues:l})};Ogma.extend(function(e){e.modules.imports=new Ov(e);e.fetch=function(e){return Oe(e)}});var Ov=function e(t){this._ogma=t;this._dom=t.modules.dom;this._graph=t.modules.graph;this._locate=t.modules.locate;this._dom=t.modules.dom;this._camera=t.modules.camera;this._importers={}};Ov.prototype.from=function e(t,r){var n=this._importers[t];if(!n){throw new Error(t+" is not a valid importer.")}return new Promise(function(e,t){try{var i=n.translate(r);e(i)}catch(e){t(e)}})};Ov.prototype.register=function e(t,r){if(typeof r==="function"){r={translate:r,webWorkerCompatible:false}}Ka(this._importers,t,r,"importer")};var Bv=lp(" ");var jv=lp("<");var Vv=lp(">");var Uv=lp('"');var Gv=lp("\n");var Wv=lp("\r");var Hv=lp("/");var Xv=lp("\\");var qv=lp("a");var Yv=lp("z");var Zv=lp("A");var Kv=lp("Z");var Qv=lp("0");var Jv=lp("9");var $v=lp(":");var ep=-1,tp=-2,rp=-3,np=-4;function ip(e){var t=new Int32Array(e.length);for(var r=0,n=e.length;r<n;++r){t[r]=e.charCodeAt(r)}return t}function ap(e,t,r,n){var i=n.length;if(r-t!==i){return false}for(var a=0;a<i;++a){if(e[t+a]!==n[a]){return false}}return true}function op(e,t,r,n){return up(e.tags,t,r,n)}function sp(e,t,r,n){return up(e.attributes,t,r,n)}function up(e,t,r,n){var i=e.length;for(var a=0;a<i;++a){if(ap(t,r,n,e[a])){return a}}e.push(t.slice(r,n));return i}function lp(e){return e.charCodeAt(0)}function dp(e,t,r){var n,i,a;r=cp(t,r);n=t[r];if(n===Vv||n===Hv){return r}i=r;r=vp(t,r);a=sp(e,t,i,r);while(t[r]!==Uv){++r}++r;i=r;while((n=t[r])!==Uv){if(n===Xv){++r}++r}e.tokens.push(rp,a,i,r);return r+1}function fp(e,t){var r,n,i,a,o=e.length;var s={tags:[],attributes:[],tokens:[]};var u=s.tokens;t=cp(e,t);while(t<o){a=e[t];if(a===jv){t=cp(e,++t);if(e[t]===Hv){u.push(tp);while(e[++t]!==Vv){}}else{r=t;t=vp(e,r);i=op(s,e,r,t);u.push(ep,i);a=e[t];while(a!==Vv&&a!==Hv){t=dp(s,e,t);a=e[t]}if(a===Hv){u.push(tp);while(e[++t]!==Vv){}}}t+=1}else{r=t;while(e[++t]!==jv){}n=t-1;while(hp(e[n])){--n}u.push(np,r,n+1)}t=cp(e,t)}return s}function hp(e){return e===Bv||e===Gv||e===Wv}function cp(e,t){while(hp(e[t])){++t}return t}function gp(e){return e>=qv&&e<=Yv||e>=Zv&&e<=Kv||e===$v||e>=Qv&&e<=Jv}function vp(e,t){while(gp(e[t])){++t}return t}function pp(e,t){var r=["this.id = undefined;","this.attributes = {","  text: undefined,","  color: undefined,","  "+(e?"radius":"width")+": undefined",e?"  ,x: undefined":"",e?"  ,y: undefined":"","};"];if(!e){r.push("this.source = undefined;","this.target = undefined;")}var n=Object.keys(t);if(n.length){r.push("  this.data = {")}for(var i=0;i<n.length;++i){var a=n[i],o=t[a],s=o.title;r.push('  "'+s+'": '+(o.default!==undefined?JSON.stringify(o.default):undefined)+(i===n.length-1?"":","))}if(n.length){r.push("};")}return new Function(r.join("\n"))}function _p(e){if(e.indexOf("\\")===-1){return e}e=e.replace(/\\"/g,'"');return e}function mp(e){if(e.indexOf("<gexf")===-1){throw new Error("not a GEXF file")}var t=ip(e),r=fp(t,e.indexOf("<gexf ")),n={},i={};r.tags.forEach(function(e,t){var r=String.fromCharCode.apply(null,e);n[r]=t});r.attributes.forEach(function(e,t){var r=String.fromCharCode.apply(null,e);i[r]=t});var a=n.attributes;var o=n.attribute;var s=n.node;var u=n.edge;var l=n.default;var d=n["viz:position"];var f=n["viz:size"];var h=n["viz:color"];var c=n.attvalue;var g=i.class;var v=i.id;var p=i.type;var _=i.title;var m=i.label;var y=i.source;var b=i.target;var x=i.x;var S=i.y;var A=i.r;var E=i.g;var w=i.b;var k=i.a;var C=i.value;var T=i.for;var L=i.weight;var M=4;var I=5;var F=6;var N=1;var z=2;var R=3;var P=4;var D=5;var O={float:N,double:N,integer:z,boolean:R,string:P,"list-string":D};var B=0,j=r.tokens,V=j.length;var U=new Array(16);var G=0;var W=0;var H=0;var X=true;var q={};var Y={};var Z=null;var K=null;var Q=null;var J=undefined;var $=null;var ee=0,te=0,re=0,ne=1;var ie=null;var ae=undefined;var oe=false;var se=true;var ue=null;var le=null;var de=[];var fe=[];var he=0;var ce=null;while(B<V){var ge=j[B];if(ge===ep){W=G;G=j[B+1];U[H]=G;H+=1;if(G===s){if(!ue){ue=pp(true,q)}$=new ue;se=true;ce=q}else if(G===u){if(!le){le=pp(false,Y)}$=new le;se=false;ce=Y}B+=2}else if(ge===tp){if(Z&&G===o){ce=X?q:Y;var ve=O[K];var value=J;if(value){if(ve===N){value=+value}else if(ve===z){value=+value|0}else if(ve===R){value=value==="true"}else if(ve===D){value=value.split(" ").filter(function(e){return e})}}ce[Z]={title:Q||Z,type:ve,default:value};Z=null;Q=null;K=null;J=undefined}else if(G===s&&H===M){if(oe){$.attributes.color="rgba("+ee+", "+te+", "+re+", "+ne+")";ee=0;te=0;re=0;ne=1;oe=false}if(!$.id){$.id=++he}de.push($)}else if(G===u&&H===M){if(!$.id){$.id=++he}fe.push($)}else if(G===c&&H===F&&ie){var pe=(se?q:Y)[ie];if(pe){if(ae===undefined){ae=pe.default}else{ve=pe.type;if(ve){if(ve===N){ae=+ae}else if(ve===z){ae=+ae|0}else if(ve===R){ae=ae==="true"}else if(ve===D){ae=ae.split(" ").filter(function(e){return e}).map(function(e){return _p(e)})}else{ae=_p(ae)}}}$.data[ce[ie].title]=ae}ie=null;ae=null}H-=1;G=W;W=U[H-2];B+=1}else if(ge===rp){var _e=j[B+1];value=e.substring(j[B+2],j[B+3]);if(G===a){if(_e===g){X=value!=="edge"&&value!=="edges"}}else if(G===o){if(_e===v){Z=value}else if(_e===p){K=value}else if(_e===_){Q=value}}else if((G===s||G===u)&&H===M){if(_e===v){$.id=value}else if(_e===m){$.attributes.text=value}else if(_e===y){$.source=value}else if(_e===b){$.target=value}else if(_e===L){$.attributes.width=+value}}else if(G===d&&H===I){if(_e===x){$.attributes.x=+value}else if(_e===S){$.attributes.y=-value}}else if(G===h&&H===I){oe=true;if(_e===A){ee=value}else if(_e===E){te=value}else if(_e===w){re=value}else if(_e===k){ne=value}}else if(G===f&&H===I){if(_e===C){if(se){$.attributes.radius=+value}else{$.attributes.width=+value}}}else if(G===c&&H===F){if(_e===T||_e===v){ie=value}else if(_e===C){ae=value}}B+=4}else if(ge===np){value=e.substring(j[B+1],j[B+2]);if(G===l){J=value}B+=3}else{throw new Error("at index "+B+": token "+ge)}}return{nodes:de,edges:fe}}Ogma.extend(function(e){e.modules.imports.register("gexf",{translate:mp,webWorkerCompatible:true});e.parse.gexf=function(t){return e.modules.imports.from("gexf",t)};e.parse.gexfFromUrl=function(t){return Oe(t).then(function(t){return e.modules.imports.from("gexf",t)})}});function yp(e,t,r){r=r||t;if(t in e){if(!e.attributes){e.attributes={}}e.attributes[r]=e[t]}}function bp(e){var t=JSON.parse(e);var r=t.nodes||[];var n=t.edges||[];for(var i=0,a=r;i<a.length;i+=1){var o=a[i];if(typeof o.size==="string"){o.size=+o.size}if(typeof o.x==="string"){o.x=+o.x}if(typeof o.y==="string"){o.y=+o.y}yp(o,"x");yp(o,"y");yp(o,"size","radius");yp(o,"color");yp(o,"text")}for(var s=0,u=n;s<u.length;s+=1){var l=u[s];if(typeof l.size==="string"){l.size=+l.size}yp(l,"size","width");yp(l,"color");yp(l,"text")}return t}Ogma.extend(function(e){e.modules.imports.register("json",{translate:bp,webWorkerCompatible:true});e.parse.json=function(t){return e.modules.imports.from("json",t)};e.parse.jsonFromUrl=function(t){return Oe(t).then(function(t){return e.modules.imports.from("json",t)})}});var xp=function e(){this._decimalPowerOfTwo=new Uint8Array(20);this._binaryNumber=new Uint8Array(64);this._decimalNumber=new Uint8Array(20)};xp.prototype._addDecimalNumbers=function e(t,r){var n=0;for(var i=0;i<20;++i){var a=n+t[i]+r[i];n=+(a>=10);t[i]=a%10}};xp.prototype._loadNumberInBits=function e(t,r,n){for(var i=0;i<32;++i){n[i]=+!!(t&1<<i)}for(var a=0;a<32;++a){n[a+32]=+!!(r&1<<a)}return n};xp.prototype._negateBinaryNumber=function e(t){for(var r=0;r<64;++r){t[r]^=1}for(var n=0;n<64&&!(t[n]^=1);++n){}};xp.prototype.int64ToString=function e(t){var r=t.low;var n=t.high;if(r===0&&n===0){return"0"}this._loadNumberInBits(r,n,this._binaryNumber);this._decimalNumber.fill(0);this._decimalPowerOfTwo.fill(0);this._decimalPowerOfTwo[0]=1;var i=this._binaryNumber[63]===1;if(i){this._negateBinaryNumber(this._binaryNumber)}for(var a=0;a<64;++a){if(this._binaryNumber[a]){this._addDecimalNumbers(this._decimalNumber,this._decimalPowerOfTwo)}this._addDecimalNumbers(this._decimalPowerOfTwo,this._decimalPowerOfTwo)}var o=[];var s=this._decimalNumber.length-1;if(i){o.push("-")}while(!this._decimalNumber[s]){s-=1}for(var u=s;u>=0;--u){o.push(this._decimalNumber[u])}return o.join("")};Ogma.extend(function(e){e.modules.imports.register("neo4j",Mp);e.parse.neo4j=function(t){return e.modules.imports.from("neo4j",t)}});var Sp=new xp;function Ap(e){return Sp.int64ToString(e)}function Ep(e){return typeof e==="object"&&"high"in e&&"low"in e}function wp(e){if(typeof e!=="object"||e===null){throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. "+"Please make sure that your Cypher query returns nodes and edges, not values.")}var t=Object.keys(e.properties);for(var r=0,n=t;r<n.length;r+=1){var i=n[r];var a=e.properties[i];if(Ep(a)){e.properties[i]=Ap(a)}}if(e.identity!==undefined){if(Ep(e.identity)){e.identity=Ap(e.identity)}if("start"in e&&"end"in e){var o=e.start.identity||e.start;var s=e.end.identity||e.end;if(Ep(o)){e.start=Ap(o)}if(Ep(s)){e.end=Ap(s)}}}}var kp=function(e){return"start"in e&&"end"in e&&"type"in e};var Cp=function(e){return"segments"in e};function Tp(e,t,r,n){t.segments.forEach(function(t){Lp(e,t.start,r,n);Lp(e,t.end,r,n);Lp(e,t.relationship,r,n)})}function Lp(e,t,r,n){if(t){if(Array.isArray(t)){t.forEach(function(t){return Lp(e,t,r,n)})}else if(Cp(t)){Tp(e,t,r,n)}else{wp(t);if(kp(t)){if(!n.has(t.identity)){n.add(t.identity);e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})}}else{if(!r.has(t.identity)){r.add(t.identity);e.nodes.push({id:t.identity,attributes:{x:Math.random()*100,y:Math.random()*100},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}})}}}}}function Mp(e){var t={nodes:[],edges:[]};var r=new zt;var n=new zt;e.records.forEach(function(e){e._fields.forEach(function(e){Lp(t,e,r,n)})});return t}Ogma.extend(function(e){e.modules.imports.register("janus",Ip);e.parse.janus=function(t){return e.modules.imports.from("janus",t)}});function Ip(e){var t=[],r=[];var n=function(e){if(!e||typeof e!=="object"){return}if(e.type==="vertex"){var i={};if(e.properties){Object.keys(e.properties).forEach(function(t){i[t]=e.properties[t][0].value})}t.push({id:e.id+"",data:{id:e.id+"",categories:[e.label],properties:i}})}else if(e.type==="edge"){r.push({id:e.id+"",source:e.inV+"",target:e.outV+"",data:{id:e.id+"",type:e.label,properties:e.properties||{}}})}else if(Array.isArray(e)){e.forEach(function(e){return n(e)})}else{Object.keys(e).forEach(function(t){return n(e[t])})}};n(e);return{nodes:t,edges:r}}Ogma.extend(function(e,t){e.modules.labels=new Zp(e.modules,t)});var Fp=1.2;var Np=5;var zp=Math.PI/2;var Rp="topDown";var Pp="bottomUp";var Dp=.25;var Op=200;var Bp=6;var jp=5;var Vp={left:-1,right:1,top:0,bottom:0,center:0};var Up={left:0,right:0,top:-1,bottom:1,center:0};var Gp=4;var Wp={left:-1,right:0,top:-1/2,bottom:-1/2,center:-1/2};var Hp={left:-1/2,right:-1/2,top:-1,bottom:0,center:-1/2};var Xp={x1:0,y1:0,x2:0,y2:0};var qp={x:0,y:0};var Yp=["x","y","radius","width","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"];var Zp=function e(t,r){var n=this;var i=t.dom;var a=t.graph;var o=t.graphics;var s=t.camera;var u=t.events;var l=t.settings;var d=t.sync;var f=t.spatial;this._dom=i;this._graph=a;this._graphics=o;this._camera=s;this._events=u;this._settings=l;this._sync=d;this._spatial=f;this._engine=o.getGraphicsEngine();this._textBBoxes=[];this._textQuad=new Na(function(e){var t=Bp;var r=t*e;return n._textBBoxes.slice(r,r+t)},Np);this._enabled=false;this._forceEnabled=!!r.forceEnableTextOverlapRemoval;this._events.register(["labelCollisionsRemoved"]);this.setRate(Op);l.register("texts.preventOverlap",true,function(e){return n._onToggle(e)});l.register("texts.debug",false,function(e){return n._toggleDebug(e)});l.register("texts.removalStrategy",Rp);this._rects=[];this._events.on({"addNodes addEdges":function(e){var t=e.nodes||e.edges;if((n._enabled||n._forceEnabled)&&n._settings.get("texts.preventOverlap")){n._graphics.setTextHidden(t,true)}},viewChanged:function(){n._update()},updateAttributes:function(e){var t=e.nodeAttributes.concat(e.edgeAttributes);if(t.some(function(e){return Yp.includes(e)})){n._update()}},setContainer:function(e){var t=e.element;if(t){n._enable()}else{n._disable()}}})};Zp.prototype.getTextsBoundingBox=function e(){var t=this._rects;var r=new Fr;for(var n=0;n<t.length;n+=5){var i=t[n],a=t[n+1];var o=t[n+2],s=t[n+3];var u=t[n+4];var l=ra(i,a,o,s,u);var d=l[0];var f=l[1];var h=l[2];var c=l[3];r.addPoint(d,f).addPoint(h,c)}return r};Zp.prototype.setRate=function e(t){var r=this;this._updateDebounced=this._sync.debounceIdle(function(){return r._updateLabels()},t)};Zp.prototype._update=function e(){if(this._enabled||this._forceEnabled){this._updateDebounced()}};Zp.prototype._enable=function e(){this._enabled=true;this._update()};Zp.prototype._disable=function e(){this._enabled=false};Zp.prototype.forceEnable=function e(){this._forceEnabled=true};Zp.prototype._onToggle=function e(t){if(t){this._update()}else{this._reset()}};Zp.prototype._toggleDebug=function e(t){if(t){this._canvas=we();this._graphics.addCanvas(this._canvas);this._ctx=this._canvas.getContext("2d");this._update()}else if(this._canvas){this._graphics.removeCanvas(this._canvas);this._canvas=this._ctx=null}};Zp.prototype.update=function e(){this._update()};Zp.prototype._onCameraMove=function e(){this._update()};Zp.prototype.forceUpdate=function e(){this._updateLabels()};Zp.prototype._updateLabels=function e(){if(!this._settings.get("texts.preventOverlap")){return}this._intersects=[];var t=this._textQuad;t.clear();var r=this._textBBoxes=[];var n=this._rects=[];var i=this._camera.getAngle();var a=this._camera.getProjectedScreenBounds(Dp);var o=this._settings.get("texts.removalStrategy")===Pp;this._screen=a;var s={angle:i,zoom:this._camera.getZoom(),sin:Math.sin(i),cos:Math.cos(i),screen:a};var u={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]}};var l=this._spatial.queryRaw(a[0],a[1],a[2],a[3]);var d=l.nodes;var f=l.edges;this._fillNodeTexts(d,t,r,n,s,o,u);this._fillEdgeTexts(f,t,r,n,s,o,u);this._clearOverlaps(u);if(this._settings.get("texts.debug")){this.drawAll(s)}};Zp.prototype._fillNodeTexts=function e(t,r,n,i,a,o,s){var u=this._graph;var l=s.remove.nodes;var d=s.remove.edges;var f=s.redraw.nodes;var h=a.angle;var c=a.zoom;var g=a.sin;var v=a.cos;var p=u.getNodeAttribute("layer");w(t,p);var _=u.getAttributes(true,["x","y","radius","innerStroke.width","outerStroke.width","scalingMethod","text.content","text.position","text.size","text.font","text.style","text.maxLineLength","text.scaling","text.scale","text.minVisibleSize","text.padding","text.margin","animationDuration"]);var m=_[0];var y=_[1];var b=_[2];var x=_[3];var S=_[4];var A=_[5];var E=_[6];var k=_[7];var C=_[8];var T=_[9];var L=_[10];var M=_[11];var I=_[12];var F=_[13];var N=_[14];var z=_[15];var R=_[16];var P=_[17];var D,O;for(var B=0,j=t.length;B<j;B++){D=t[B];var V=P.get(D);var U=E.get(D);if(U===null||U===""||V){continue}var G=b.get(D);var W=N.get(D);if(G*2*c<W){continue}if(A.get(D)==="fixed"){G/=c}var H=m.get(D);var X=y.get(D);if(typeof U==="number"){U=U.toString()}var q=!I.get(D);var Y=k.get(D);var Z=z.get(D);var K=F.get(D);var Q=(q?C.get(D):K*G)*Fp;var J=L.get(D);var $=T.get(D);var ee=M.get(D);var te=Iu(U,ee);var re=te.lines;var ne=Z+x.get(D)+S.get(D)+R.get(D);var ie=Vp[Y];var ae=Up[Y];var oe=this._engine.measureText(U,$,J,Q).width/re;var se=re*Q*Fp;var ue=oe/2/c;var le=se/2/c;var de=ne/c;var fe=Wp[Y]*oe;var he=Hp[Y]*se;if(q){fe/=c;he/=c}fe=fe+ie*de+ue+ie*G;he=he+ae*de+le+ae*G;var ce=ra(H-ue,X-le,oe/c,se/c,-h,g,-v);var ge=[H-ue,X-le,oe/c,se/c,h];var ve=v*fe-g*he;var pe=g*fe+v*he;ce[0]+=ve;ce[1]+=pe;ce[2]+=ve;ce[3]+=pe;ge[0]+=ve;ge[1]+=pe;var _e=r.query(ce[0],ce[1],ce[2],ce[3]);if(_e.length!==0){var me=false;var ye=na(ge[0],ge[1],ge[2],ge[3],ge[4]);for(var be=0;be<_e.length;be++){var xe=_e[be];var Se=xe*jp;var Ae=na(i[Se],i[Se+1],i[Se+2],i[Se+3],i[Se+4]);if(gn(ye,Ae)){this._intersects.push(ye,Ae);me=true;if(o){r.remove(xe);if(n[xe*Bp+4]===1){l.push(n[xe*Bp+5])}else{d.push(n[xe*Bp+5])}}else{break}}}if(me&&!o){l.push(D);continue}}f.push(D);O=n.length/Bp;n.push(ce[0],ce[1],ce[2],ce[3],1,D);r.insert(O);i.push(ge[0],ge[1],ge[2],ge[3],ge[4])}};Zp.prototype._fillEdgeTexts=function e(t,r,n,i,a,o,s){var u=this._graph;var l,d;var f=s.remove.nodes;var h=s.remove.edges;var c=s.redraw.edges;var g=a.angle;var v=a.zoom;var p=u.getAttributes(true,["x","y","radius"]);var _=p[0];var m=p[1];var y=p[2];var b=u.getEdgeAttribute("layer");w(t,b);var x=Math.PI;var S=this._graph.getAttributes(false,["source","target","width","curvature","scalingMethod"]);var A=S[0];var E=S[1];var k=S[2];var C=S[3];var T=S[4];var L=this._graph.getAttributes(false,["text.content","text.scaling","text.size","text.font","text.style","text.scale","text.maxLineLength","text.padding","animationDuration","text.minVisibleSize"]);var M=L[0];var I=L[1];var F=L[2];var N=L[3];var z=L[4];var R=L[5];var P=L[6];var D=L[7];var O=L[8];var B=L[9];for(var j=0,V=t.length;j<V;j++){l=t[j];var U=O.get(l);var G=M.get(l);if(G===null||G===""||U){continue}var W=A.get(l);var H=E.get(l);var X=k.get(l);var q=C.get(l);var Y=B.get(l);if(X*v<Y){continue}if(T.get(l)==="fixed"){X/=v}var Z=(_.get(W)+_.get(H))/2;var K=(m.get(W)+m.get(H))/2;if(typeof G==="number"){G=G.toString()}var Q=!I.get(l);var J=R.get(l);var $=N.get(l);var ee=(Q?F.get(l):J*X)*Fp;var te=z.get(l);var re=P.get(l);var ne=D.get(l);var ie=_.get(W),ae=m.get(W);var oe=_.get(H),se=m.get(H);var ue=void 0;if(W===H){ue=x/4-g;Xi(ie,ae,q,y.get(W),0,Xp);Ki(.5,ie,ae,oe,se,Xp.x1,Xp.y1,Xp.x2,Xp.y2,qp);Z=qp.x;K=qp.y;ne*=-v}else if(q===0){ue=Qr(ie,ae,oe,se)-g}else{ue=Qr(ie,ae,oe,se)-g;Hi(ie,ae,oe,se,q,Xp);qi(.5,ie,ae,oe,se,Xp.x,Xp.y,qp);Z=qp.x;K=qp.y}var le=ne+Gp;var de=Iu(G,re);var fe=de.lines;var he=this._engine.measureText(G,$,te,ee).width*Fp/fe;var ce=fe*ee;var ge=he/v/2;var ve=ce/v/2;var pe=Math.abs(ue)<zp?1:-1;var _e=pe*(le/v+X/2+ve);var me=[Z-ge,K-ve,Z+ge,K+ve,ue+g];ia(me,-(ue+g),-_e,me);me[2]=me[2]-me[0];me[3]=me[3]-me[1];ue=x-ue-g;var ye=ra(Z-ge,K-ve,ge*2,ve*2,ue);ia(ye,ue,_e,ye);var be=r.query(ye[0],ye[1],ye[2],ye[3]);if(be.length){var xe=false;var Se=na(me[0],me[1],me[2],me[3],me[4]);for(var Ae=0;Ae<be.length;Ae++){var Ee=be[Ae];var we=Ee*jp;var ke=na(i[we],i[we+1],i[we+2],i[we+3],i[we+4]);if(gn(Se,ke)){xe=true;this._intersects.push(Se,ke);if(o){r.remove(Ee);if(n[Ee*Bp+4]===1){f.push(n[Ee*Bp+5])}else{h.push(n[Ee*Bp+5])}}else{break}}}if(xe&&!o){h.push(l);continue}}c.push(l);d=n.length/Bp;n.push(ye[0],ye[1],ye[2],ye[3],0,l);r.insert(d);i.push(me[0],me[1],me[2],me[3],me[4])}};Zp.prototype._clearOverlaps=function e(t){var r=this;var n=this._graph.NodeList;var i=this._graph.EdgeList;var a=new n(t.remove.nodes);var o=new i(t.remove.edges);var s=new n(t.redraw.nodes);var u=new i(t.redraw.edges);this._graphics.setTextHidden(a,true);this._graphics.setTextHidden(o,true);this._graphics.setTextHidden(s,false);this._graphics.setTextHidden(u,false);this._dom.setTimeout(function(){return r._events.fire("labelCollisionsRemoved",t)})};Zp.prototype._reset=function e(){this._graphics.resetTextHidden()};Zp.prototype.drawAll=function e(){var t=this;this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height);var r=this._textBBoxes;for(var n=0,i=r.length;n<i;n+=6){Kp(r.slice(n,n+4),this._ctx,this._camera,"#aaaaaa")}var a=this._rects;for(var o=0;o<a.length;o+=5){var s=na(a[o],a[o+1],a[o+2],a[o+3],a[o+4]);Qp(s,this._ctx,this._camera,"green")}this._intersects.forEach(function(e){return Qp(e,t._ctx,t._camera,"red")})};function Kp(e,t,r,n){if(n===void 0)n="#22ff00";return Qp([[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]].map(function(e){return{x:e[0],y:e[1]}}),t,r,n)}function Qp(e,t,r,n){if(n===void 0)n="#ff0000";t.strokeStyle=n;t.lineWidth=1;t.beginPath();var i=Ogma.utils.getPixelRatio();for(var a=0,o=e.length;a<o;a++){var s=r.graphToScreenCoordinates(e[a]);if(a===0){t.moveTo(s.x*i,s.y*i)}else{t.lineTo(s.x*i,s.y*i)}}t.closePath();t.stroke()}Ogma.extend(function(e){var t=new Jp(e);e.modules.interactions=t});var Jp=function e(t){var r=this;this._dom=t.modules.dom;this._captor=t.modules.captor;this._events=t.modules.events;this._settings=t.modules.settings;this._interactionsByStartEvent={};this._boundProgressEvents={};this._boundStopEvents={};this._onStartInteractionEvent=function(e,t){if(r._current){return}var n=r._interactionsByStartEvent[t];var i=null;for(var a=0,o=n;a<o.length;a+=1){var s=o[a];var u=s.check(e);if(u&&(!i||s.priority>=i.priority)){i=s}}if(i){r._startInteraction(i,e)}};this._onProgressInteractionEvent=function(e,t){if(r._current&&r._current.progressEventName===t){r._current.onProgress(e)}};this._onStopInteractionEvent=function(e,t){if(r._current&&r._current.stopEventName===t){r._stopCurrentInteraction()}}};Jp.prototype._startInteraction=function e(t,r){t.onStart(r);if(t.onStop){this._current=t;if(t.disableDetection){this._captor.setDetectionEnabled(false)}}};Jp.prototype._stopCurrentInteraction=function e(t){if(this._current.disableDetection){this._captor.setDetectionEnabled(true)}this._current.onStop(t);this._current=null};Jp.prototype._forceStartInteraction=function e(t,r){if(this._current){this._stopCurrentInteraction(r)}this._startInteraction(t,r)};Jp.prototype._createWrapper=function e(t){var r=this;return{start:function(e){return r._forceStartInteraction(t,e)}}};Jp.prototype._addInteraction=function e(t,r){var n=this._interactionsByStartEvent[t];if(n){n.push(r)}else{this._interactionsByStartEvent[t]=[r];this._events.on(t,this._onStartInteractionEvent)}return this._createWrapper(r)};Jp.prototype._createProgressiveInteraction=function e(t,r,n,i){var a={priority:$p(i.priority),check:i.check||function(){},onStart:i.onStart||function(){},onProgress:i.onProgress||function(){},onStop:i.onStop||function(){},disableDetection:!!i.disableDetection,progressEventName:r,stopEventName:n};if(!this._boundProgressEvents[r]){this._boundProgressEvents[r]=true;this._events.on(r,this._onProgressInteractionEvent)}if(!this._boundStopEvents[n]){this._boundStopEvents[n]=true;this._events.on(n,this._onStopInteractionEvent)}return this._addInteraction(t,a)};Jp.prototype._createNonProgressiveInteraction=function e(t,r){var n={priority:$p(r.priority),check:r.check||function(){},onStart:r.handler||function(){},onProgress:null,onStop:null,disableDetection:false,progressEventName:null,stopEventName:null};return this._addInteraction(t,n)};Jp.prototype.onDrag=function e(t){return this._createProgressiveInteraction("dragStart","dragProgress","dragEnd",t)};Jp.prototype.onGesture=function e(t){return this._createProgressiveInteraction("gestureStart","gestureProgress","gestureEnd",t)};Jp.prototype.onClick=function e(t){return this._createNonProgressiveInteraction("click",t)};Jp.prototype.onDoubleClick=function e(t){return this._createNonProgressiveInteraction("doubleClick",t)};Jp.prototype.onHover=function e(t){return this._createNonProgressiveInteraction("hover",t)};Jp.prototype.onUnhover=function e(t){return this._createNonProgressiveInteraction("unhover",t)};Jp.prototype.onMouseWheel=function e(t){return this._createNonProgressiveInteraction("wheel",t)};Jp.prototype.onMouseDown=function e(t){return this._createNonProgressiveInteraction("down",t)};Jp.prototype.onMouseUp=function e(t){return this._createNonProgressiveInteraction("up",t)};Jp.prototype.onMouseMove=function e(t){return this._createNonProgressiveInteraction("move",t)};function $p(e){if(typeof e==="string"){return Jl.indexOf(e)}else if(typeof e==="number"&&!isNaN(e)){return e}else{return 0}}var e_=function(){return{}},t_=function(){return undefined},r_=function(){return false},n_=function(){},i_=function(){},a_=function(){};var o_=function(e){function t(t,r,n){e.call(this);this._dependencies=r;this._dom=n;this.configure(t);this._complete=false}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.configure=function e(t){this._onStart=t.onStart||i_;this._onEnd=t.onEnd||a_;this._update=t.update||t_;this._onUpdate=t.onUpdate||n_;this._createContext=t.context||e_;this._isRunning=t.isRunning||r_};t.prototype.onStart=function e(){this.fire("start",{target:this});this._onStart.call(this);return this};return t}(zr);var s_=function(e){function t(t,r,n){var i=this;e.call(this,t,r,n);var a=[u_(t.imports),"","","var __CONTEXT = ("+this._createContext.toString()+")();","var __UPDATE_FUNC = "+this._update.toString()+";","var __IS_RUNNING_FUNC = "+this._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");this._worker=sr(a);this._sync=function(e){if(!i._dom.isDestroyed()){i.sync(e)}};this._worker.addEventListener("message",this._sync)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.sync=function e(t){var r=t.data.isRunning;var n=t.data.result;var i=this._onUpdate.call(this,n,this._dependencies,r);this.fire("update",{target:this,isRunning:r});if(r){this.send(i)}else{this.stop(n)}};t.prototype.stop=function e(t){if(!this._complete){this._onEnd.call(this,t,this._dependencies);this._worker.terminate();this.fire("stop",{target:this})}this._complete=true};t.prototype.send=function e(t){this._worker.postMessage(ar(t));return this};return t}(o_);function u_(e){if(!e||e.length===0){return""}var t=[];var r=Object.keys(e);for(var n=0,i=r.length;n<i;n++){var a=r[n];var o=e[a];if(typeof o!=="function"){throw new Error('Asynchronous task: dependency "'+a+'" is not found')}else{var s=l_(o);if(s){t.push(o.toString(),"var "+a+" = "+s+";")}else{t.push("var "+a+" = "+o.toString()+";")}}}return t.join("\n")}function l_(e){var t=e.toString();var r=t.startsWith("function ");if(!r){return null}else{return t.substring("function ".length,t.indexOf("("))}}var d_=function(e){function t(t,r,n){e.call(this,t,r,n);this._context=this._createContext()}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.sync=function e(t){var r=this._update(t,this._context),n=this._isRunning(this._context,t);t=this._onUpdate.call(this,r,this._dependencies,n);this.fire("update",{target:this,isRunning:n});if(n){this.send(t)}else{this.stop(r)}};t.prototype.send=function e(t){var r=this;if(!this._complete){this._dom.setTimeout(function(){return r.sync(t)},0)}return this};t.prototype.stop=function e(t){if(!this._complete){this._onEnd(t,this._dependencies);this._complete=true}};return t}(o_);Ogma.extend(function(e){return e.modules.tasks=new f_(e)});var f_=function e(t){this._ogma=t;this._dom=t.modules.dom};f_.prototype.run=function e(t,r,n,i){var a=qa(n,true),o=t.configure||function(e){return e};var s=h_(o,r,i);var u=a?s_:d_;var l=new u(t,i,this._dom);l.onStart();l.send(s);return l};function h_(e,t,r){var n=e(t,r);if(n===undefined){n=t}return n}Ogma.extend(function(e){e.modules.generators=new c_(e);e.generate={}});var c_=function e(t){this._ogma=t;this._graph=t.modules.graph;this._tasks=t.modules.tasks;this._generators={}};c_.prototype.register=function e(t,r){Ka(this._generators,t,r,"generator")};c_.prototype.load=function e(t,r){var n=Qa(this._generators,t,"generator"),i=n.configure(r);return Promise.resolve(n.generate(i))};function g_(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=10;var r=e.edges;if(r===void 0)r=10;var n=e.texts;if(n===void 0)n=false;return{nodes:t,edges:r,texts:n}}function v_(e){var t=e.nodes;var r=e.edges;var n=e.texts;var i=Math.max(t,200);var a=[];var o=[];for(var s=0;s<t;s++){a.push({id:s,attributes:{x:Math.random()*i,y:Math.random()*i,text:n?"Node "+s:undefined}})}for(var u=0;u<r;u++){o.push({id:u,source:Math.random()*t|0,target:Math.random()*t|0,attributes:{text:n?"Edge "+u:undefined}})}return{nodes:a,edges:o}}Ogma.extend(function(e){e.modules.generators.register("random",{configure:g_,generate:v_});e.generate.random=function(t){return e.modules.generators.load("random",t)}});function p_(e){if(e===void 0)e={};var t=e.rows;if(t===void 0)t=4;var r=e.columns;if(r===void 0)r=4;var n=e.columnDistance;if(n===void 0)n=20;var i=e.rowDistance;if(i===void 0)i=20;var a=e.xmin;if(a===void 0)a=0;var o=e.ymin;if(o===void 0)o=0;return{rows:t,columns:r,columnDistance:n,rowDistance:i,xmin:a,ymin:o}}function __(e){var t=e.rows;var r=e.columns;var n=e.columnDistance;var i=e.rowDistance;var a=e.xmin;var o=e.ymin;var s={nodes:[],edges:[]};var u=0;for(var l=0;l<t;++l){for(var d=0;d<r;++d){var f=l*r+d;s.nodes.push({id:f,attributes:{x:a+d*n,y:o+l*i}});if(d!==r-1){s.edges.push({id:u,source:f,target:l*r+d+1});u+=1}if(l!==t-1){s.edges.push({id:u,source:f,target:(l+1)*r+d});u+=1}}}return s}Ogma.extend(function(e){e.modules.generators.register("grid",{configure:p_,generate:__});e.generate.grid=function(t){return e.modules.generators.load("grid",t)}});function m_(e){if(e===void 0)e={};var t=e.length;if(t===void 0)t=5;return{length:t}}function y_(e){var t=e.length;var r={nodes:[],edges:[]};if(t<=0){return r}r.nodes.push({id:0,attributes:{x:Math.random()*100,y:Math.random()*100}});for(var n=1;n<t;++n){r.nodes.push({id:n,attributes:{x:Math.random()*100,y:Math.random()*100}});r.edges.push({id:n-1,source:n-1,target:n})}return r}Ogma.extend(function(e){e.modules.generators.register("path",{configure:m_,generate:y_});e.generate.path=function(t){return e.modules.generators.load("path",t)}});function b_(e){if(e===void 0)e={};var t=e.children;if(t===void 0)t=2;var r=e.height;if(r===void 0)r=3;if(!jd(t)){throw new TypeError('Invalid argument: "children" is not a positive number, was '+t)}if(!Bd(r)){throw new TypeError('Invalid argument: "height" is not a positive number, was '+r)}return{children:t,height:r}}function x_(e){var t=e.children;var r=e.height;r+=1;var n=Math.pow(t,r),i=[],a=[],o=1,s=0,u=0;for(var l=0;l<r;++l){var d=n/(o+1)/1.5;for(var f=0;f<o;++f){var h=s++;i.push({id:h,attributes:{x:(f+1)*d*10,y:l*20}});if(l!==r-1){for(var c=0;c<t;++c){a.push({id:u,source:h,target:h*t+c+1});u+=1}}}o*=t}return{nodes:i,edges:a}}Ogma.extend(function(e){e.modules.generators.register("balancedTree",{configure:b_,generate:x_});e.generate.balancedTree=function(t){return e.modules.generators.load("balancedTree",t)}});function S_(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=20;var r=e.edges;var n=e.p;if(!Od(t)||t<3){throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t)}if(r!==undefined&&n!==undefined){throw new TypeError("Invalid argument: choose between options.edges and options.p")}if(r===undefined&&n===undefined){n=.1}return{nodes:t,edges:r,p:n}}function A_(e){var t={nodes:[],edges:[]},r,n,i,a=0,o=e.nodes,s=e.p;if(e.p>=0){for(n=0;n<o;n++){t.nodes.push({id:n,attributes:{x:Math.random()*100,y:Math.random()*100}});for(i=0;i<n;i++){if(Math.random()<s){t.edges.push({id:a++,source:n,target:i})}}}}else{var u=[],l=e.edges;for(n=0;n<o;n++){t.nodes.push({id:n,x:Math.random()*100,y:Math.random()*100,size:1});for(i=n+1;i<o;i++){u.push({source:n,target:i})}}a=u.length-1;for(n=0;n<l;n++){r=u.splice(Math.floor(Math.random()*a),1)[0];r.id=n;t.edges.push(r);a--}}return t}Ogma.extend(function(e){e.modules.generators.register("erdosRenyi",{configure:S_,generate:A_});e.generate.erdosRenyi=function(t){return e.modules.generators.load("erdosRenyi",t)}});function E_(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=40;var r=e.m0;if(r===void 0)r=5;var n=e.m;if(n===void 0)n=1;var i=e.scale;if(i===void 0)i=100;if(!Od(t)||t<3){throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t)}if(!Od(r)||r>=t){throw new TypeError("Invalid argument: options.m0 is not a number < "+t+", was "+r)}if(!Od(r)||n>=r){throw new TypeError("Invalid argument: options.m is not a number <= "+r+", was "+n)}if(!Od(i)||i<0){throw new TypeError("Invalid argument: options.scale is not a number or is less than 0")}return{nodes:t,m0:r,m:n,scale:i}}function w_(e){var t={nodes:[],edges:[]},r={},n=[],i,a,o,s,u,l,d,f,h=e.scale,c=0,g=e.nodes,v=e.m0,p=e.m;var _=h/10;for(i=0;i<v;i++){t.nodes.push({id:i,attributes:{x:Math.random()*_,y:Math.random()*_}});n[i]=0}for(i=0;i<v;i++){for(a=i+1;a<v;a++){o={id:c++,source:i,target:a};r[o.source+"-"+o.target]=o;t.edges.push(o);n[i]++;n[a]++}}for(i=v;i<g;i++){t.nodes.push({id:i,attributes:{x:Math.random()*h,y:Math.random()*h}});n[i]=0;s=0;for(a=0;a<i;a++){s+=n[a]}u=0;for(l=0;l<p;l++){d=Math.random();f=0;for(a=0;a<i;a++){if(r[i+"-"+a]||r[a+"-"+i]){continue}if(i==1){f=1}else{f+=n[a]/s+u/(i-l)}if(d<=f){u+=n[a]/s;o={id:c++,source:i,target:a};r[o.source+"-"+o.target]=o;t.edges.push(o);n[i]++;n[a]++;break}}}}return t}Ogma.extend(function(e){e.modules.generators.register("barabasiAlbert",{configure:E_,generate:w_});e.generate.barabasiAlbert=function(t){return e.modules.generators.load("barabasiAlbert",t)}});function k_(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=50;var r=e.width;if(r===void 0)r=100;var n=e.height;if(n===void 0)n=100;var i=e.x;if(i===void 0)i=0;var a=e.y;if(a===void 0)a=0;if(!isFinite(t)||t<1){throw new RangeError("Tree generator: number of nodes must be a positive integer")}return{nodes:t,width:r,height:n,x:i,y:a}}function C_(e){var t=e.nodes;var r=e.x;var n=e.y;var i=e.width;var a=e.height;var o=r-i/2;var s=n-a/2;return{nodes:new Array(t).fill(0).map(function(e,t){return{id:t,attributes:{x:o+Math.random()*i,y:s+Math.random()*a}}}),edges:new Array(t-1).fill(0).map(function(e,t){return{id:t,source:Math.floor(Math.sqrt(t)),target:t+1}})}}Ogma.extend(function(e){e.modules.generators.register("randomTree",{configure:k_,generate:C_});e.generate.randomTree=function(t){return e.modules.generators.load("randomTree",t)}});var T_=5;var L_=10;var M_=10;var I_=2.7;var F_=1/5;function N_(e){var t=e.depth;if(t===void 0)t=3;var r=e.breadth;if(r===void 0)r=3;var n=e.nbNodes;if(n!==undefined){r=5;t=Math.ceil(Math.log(n)/Math.log(5))}return{depth:t,breadth:r,nbNodes:n}}function z_(e){var t=e.depth;var r=e.breadth;var n=e.nbNodes;var i={id:0,attributes:{x:0,y:0,radius:P_(t+1)}};var a={nodes:[i],edges:[]};D_(a,r,t,i,1);if(n!==undefined){a.nodes=a.nodes.slice(0,n);a.edges=a.edges.slice(0,Math.max(n-1,0))}return a}function R_(e){return Math.pow(I_,e)*L_}function P_(e){return T_+R_(e)/M_}function D_(e,t,r,n,i){if(r===0){return i}var distance=R_(r);var a=P_(r);var o=a*F_;var s=-Math.PI;var u=Math.PI*2/t;var l=n.attributes.x;var d=n.attributes.y;for(var f=0;f<t;++f){var h=Math.cos(s);var c=Math.sin(s);var g={id:i,attributes:{x:l+distance*h,y:d+distance*c,radius:a}};var v={id:i,source:n.id,target:i,attributes:{width:o}};e.nodes.push(g);e.edges.push(v);i=D_(e,t,r-1,g,i+1);s+=u}return i}Ogma.extend(function(e){e.modules.generators.register("flower",{configure:N_,generate:z_});e.generate.flower=function(t){return e.modules.generators.load("flower",t)}});var O_=40;var B_="layoutStart";var j_="layoutEnd";var V_="layoutComputed";var U_="complete";var G_={defaultSyncDuration:500,skipTextDrawing:true,useWebWorker:true,locate:false};Ogma.extend(function(e){var t=new W_(e);e.modules.layouts=t;e.layouts={stop:function(){return t.stop()}};e.events.onLayoutStart=function(t){e.modules.events.on(B_,t);return e.events};e.events.onLayoutComplete=function(t){e.modules.events.on(j_,t);return e.events};e.events.onLayoutComputed=function(t){e.modules.events.on(V_,t);return e.events}});var W_=function e(t){var r=this;this._modules=t.modules;this._dom=t.modules.dom;this._events=t.modules.events;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._tasks=t.modules.tasks;this._settings=t.modules.settings;this._locate=t.modules.locate;this._camera=t.modules.camera;this._layouts={};Object.keys(G_).forEach(function(e){r._settings.register("layouts."+e,G_[e])});this._events.register([B_,j_,V_]);this._currentLayout=null;this._events.on("clear",function(){return r.stop()})};W_.prototype.register=function e(t,r){Ka(this._layouts,t,r,"layout")};W_.prototype.getAvailableLayouts=function e(){return Object.keys(this._layouts)};W_.prototype.start=function e(t,r){var n=this;if(r===void 0)r={};var i=this._layouts[t];var a=this._settings;var o=this;return new Promise(function(e){if(!i){throw new Error("layout "+t+" does not exist")}if(n._currentLayout){n.stop()}var s=typeof r.duration==="number"?r.duration:a.get("layouts.defaultSyncDuration");var u=i.onSync;var l=r.onSync;var d=r.onEnd;var f=r.onUpdate;var h=r.dryRun;var c=-Infinity;var g=qa(r.skipTextDrawing,a.get("layouts.skipTextDrawing"));var v=r.locate||a.get("layouts.locate");r.name=t;r.skipTextDrawing=g;if(v&&typeof v==="boolean"){v={}}var p={update:i.update,isRunning:i.isRunning,configure:i.configure,context:i.context,imports:i.imports,onStart:function(){if(g){o._graphics.hideTexts()}o.onStart(i,r,this)},onUpdate:function(e,r,n){var i=this;var a=$t();if(n&&a-c<O_){return}c=a;if(l){o._dom.setTimeout(function(){return l(e,r,n)},s)}if(u){var d=u(e,r,n);o._events.fire(V_,{type:V_,name:t,positions:d});if(f){f(e,d,n)}var g=o._assignNodePositions(d,s,h);if(!n){if(v){o._animateCamera(d,v,s)}g.then(function(){return i.fire(U_,d)})}}else if(!n){this.fire(U_,e)}},onEnd:function(t,n){this.once(U_,function(a){o.onComplete(t,i,r,n,e,d,a)})}};delete r.onSync;delete r.onEnd;n._graphics.forceAttributesComputation();n._currentLayout=n._tasks.run(p,r,qa(r.useWebWorker,n._settings.get("layouts.useWebWorker")),n._modules)})};W_.prototype._animateCamera=function e(t,r,n){var i=this._locate.layoutDataBoundingBox(t);var a=this._locate.computeConfigForBounds(i,r);return this._camera.setView(a,{duration:n,easing:r.easing})};W_.prototype.onComplete=function e(t,r,n,i,a,o,s){var u=this;this._currentLayout=null;if(r.onEnd&&t){r.onEnd(t,i,null,false)}if(n.skipTextDrawing){this._dom.setTimeout(function(){return u._graphics.showTexts()},50)}var l=new this._graph.NodeList(n.nodeData.indexes);var d=s?X_(s,l):H_(l);var f=n.nodeData;this._events.fire(j_,{type:j_,name:n.name,positions:{current:d.positions,before:f.positions},ids:d.ids});this._dom.setTimeout(function(){if(o){o(t)}a({name:n.name,positions:{current:d.positions,before:f.positions},ids:d.ids})},0)};W_.prototype.onStart=function e(t,r,n){var i=this._graph.getNodes(r.nodes);var a=H_(i);var o=a.ids;r.nodeData=a;this._events.fire(B_,{type:B_,name:r.name,ids:o,task:n})};W_.prototype.stop=function e(){if(this._currentLayout){this._currentLayout.stop();this._currentLayout.fire(U_);this._currentLayout=null}return this};W_.prototype.isRunning=function e(){return!!this._currentLayout};W_.prototype._assignNodePositions=function e(t,r,n){if(!t||n){return Promise.resolve()}var i=t.indexes;var a=t.x;var o=t.y;var s=new this._graph.NodeList(i);var u=new Array(i.length);for(var l=0;l<u.length;++l){u[l]={x:a[l],y:o[l]}}return s.setAttributes(u,r)};function H_(e){return{size:e.size,ids:e.getId(),positions:e.getPosition(),indexes:e._indexes}}function X_(e,t){var r=e.indexes;var n=e.x;var i=e.y;var a={};for(var o=0;o<r.length;o++){a[r[o]]=o}var s=[];for(var u=0;u<t._indexes.length;u++){var l=a[t._indexes[u]];s.push({x:n[l],y:i[l]})}return{positions:s,indexes:t._indexes,ids:t.getId(),size:r.length}}var q_={configure:function(e,t){var r=t.graph;var n=t.camera;var i=t.graphics;if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&e.nodes instanceof r.NodeList){e.nodes=e.nodes.getId()}var a=r.getNodes(e.nodes);var o=a._indexes;var s,u={},l={};var d=o.length,f,h;var c=r._nodes,g=r._edges;if(e.nodes){e=G(e);delete e.nodes}var v=i._getAttributeArray(true,"innerStroke.width");var p=i._getAttributeArray(true,"outerStroke.width");var _=r._degrees(o);var m=r.getNodeAttributesArrays(["x","y","radius"],{ids:o,destArrays:[new Float32Array(d),new Float32Array(d),new Array(d)]});var y=m[0];var b=m[1];var x=m[2];v=v.getMultiple(o);p=p.getMultiple(o);var S=new r.NodeList(o).getAttribute("layoutable");var A=typeof e.nodeMass==="function"?e.nodeMass:function(e,t,r){return t+1};delete e.nodeMass;var E=typeof e.edgeWeight==="function"?e.edgeWeight:function(e){return 1};delete e.edgeWeight;if(!isFinite(e.scalingRatio)){delete e.scalingRatio}var w=o.reduce(function(e,t,r){if(!S[r]){e[t]=true}return e},{});var k=0,C=0,T=0;var L=n.getZoom();for(h=0;h<o.length;++h){var M=o[h];var I=y[h],F=b[h];var N=x[h]+(v[h]+p[h])/L;u[M]={id:M,x:I,y:F,degree:_[h],size:N,pinned:!!w[M],mass:A(c.get(M),_[h],h)};T=Math.max(N,T)}if(d>1){for(h=0;h<d;h++){var z=u[o[h]];k+=z.x;C+=z.y}}k/=d;C/=d;var R={x:k,y:C};var P=a.getAdjacentEdges();s=P._indexes;f=s.length;var D=P.getSource()._indexes;var O=P.getTarget()._indexes;for(h=0;h<f;h++){var B=s[h];var j=D[h];var V=O[h];if(u[j]&&u[V]){l[B]={source:j,target:V};l[B].weight=E(g.get(B))}}return{nodes:u,edges:l,maxSize:T,config:J(e),barycentre:R}},context:function(){return{}},update:function(e,t){var r;if(!t.W){r={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:false,settings:{linLogMode:false,outboundAttractionDistribution:false,adjustSizes:false,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:true,gravity:1,slowDown:1,barnesHutOptimize:false,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:true,alignNodeSiblings:true,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}};t.W=r;g(e,e.config);r.settings=o(e.config,r.settings);t.nodes=e.nodes;t.edges=e.edges;t.barycentre=e.barycentre}else{r=t.W}var n=t.NodeMatrix,i=t.EdgeMatrix,a;function o(){var e=arguments;var t,r,n={},i=arguments.length;for(t=i-1;t>=0;t--){for(r in arguments[t]){n[r]=e[t][r]}}return n}function s(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function u(value,e,t,r,n){return(n-r)*(value-e)/(t-e)+r}function l(e){return Math.acos(e.x/Math.sqrt(e.x*e.x+e.y*e.y))}function d(e,t,r,n){return{xi:-(n-t),yi:r-e,xiPrime:n-t,yiPrime:-(r-e)}}function f(e,t){return{x:(e.xiPrime-e.xi)/t,y:(e.yiPrime-e.yi)/t}}function h(e,t,r,n,i){return{x:e+(r-e)*i,y:t+(n-t)*i}}function c(e,t){var n=e.nodes,i=e.edges,a=e.maxSize,o=Object.keys(e.nodes),s=Object.keys(e.edges),u=o.length*r.ppn,l=s.length*r.ppe,d={},f,h,c;var g=Math.pow(10,Math.log(Math.max(a,1))-6);var v=g/2;var p=Math.random;var _=t.randomizeFactor||1;var m;if(t.randomize==="locally"){m=function(e){return e+p()*_}}else if(t.randomize==="globally"){m=function(e){return p()*_}}else{m=function(e){return e+p()*g-v}}var y=new Float32Array(u);var b=new Float32Array(l);for(f=h=0,c=o.length;f<c;f++){var x=o[f],S=n[x];var A=S.x;var E=S.y;if(!S.pinned){A=m(A);E=m(E)}d[x]=h;y[h]=A;y[h+1]=E;y[h+2]=0;y[h+3]=0;y[h+4]=0;y[h+5]=0;y[h+6]=S.mass;y[h+7]=1;y[h+8]=S.size;y[h+9]=S.pinned||0;h+=r.ppn}for(f=h=0,c=s.length;f<c;f++){x=s[f];var w=i[x];b[h]=d[w.source];b[h+1]=d[w.target];b[h+2]=w.weight||0;h+=r.ppe}return{nodes:y,edges:b}}function g(e,n){var i=c(e,n);t.NodeMatrix=i.nodes;t.EdgeMatrix=i.edges;r.nodesLength=t.NodeMatrix.length;r.edgesLength=t.EdgeMatrix.length}function v(){var e,t,o,c,g,v,p,_;var m,y,b,x,S,A,E,distance,w;for(o=0;o<r.nodesLength;o+=r.ppn){n[o+4]=n[o+2];n[o+5]=n[o+3];n[o+2]=0;n[o+3]=0}if(r.settings.outboundAttractionDistribution){m=0;for(o=0;o<r.nodesLength;o+=r.ppn){m+=n[o+6]}m/=r.nodesLength}if(r.settings.barnesHutOptimize){var k=Infinity,C=-Infinity,T=Infinity,L=-Infinity,M,I,F,N;a=[];for(o=0;o<r.nodesLength;o+=r.ppn){k=Math.min(k,n[o+0]);C=Math.max(C,n[o+0]);T=Math.min(T,n[o+1]);L=Math.max(L,n[o+1])}var z=C-k,R=L-T;if(z>R){T-=(z-R)/2;L=T+z}else{k-=(R-z)/2;C=k+R}a[0+0]=-1;a[0+1]=(k+C)/2;a[0+2]=(T+L)/2;a[0+3]=Math.max(C-k,L-T);a[0+4]=-1;a[0+5]=-1;a[0+6]=0;a[0+7]=0;a[0+8]=0;e=1;for(o=0;o<r.nodesLength;o+=r.ppn){t=0;F=r.MAX_SUBDIVISION_RETRIES;while(true){if(a[t+5]>=0){if(n[o+0]<a[t+1]){if(n[o+1]<a[t+2]){M=a[t+5]}else{M=a[t+5]+r.ppr}}else{if(n[o+1]<a[t+2]){M=a[t+5]+r.ppr*2}else{M=a[t+5]+r.ppr*3}}a[t+7]=(a[t+7]*a[t+6]+n[o+0]*n[o+6])/(a[t+6]+n[o+6]);a[t+8]=(a[t+8]*a[t+6]+n[o+1]*n[o+6])/(a[t+6]+n[o+6]);a[t+6]+=n[o+6];t=M;continue}else{if(a[t+0]<0){a[t+0]=o;break}else{a[t+5]=e*r.ppr;p=a[t+3]/2;_=a[t+5];a[_+0]=-1;a[_+1]=a[t+1]-p;a[_+2]=a[t+2]-p;a[_+3]=p;a[_+4]=_+r.ppr;a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;_+=r.ppr;a[_+0]=-1;a[_+1]=a[t+1]-p;a[_+2]=a[t+2]+p;a[_+3]=p;a[_+4]=_+r.ppr;a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;_+=r.ppr;a[_+0]=-1;a[_+1]=a[t+1]+p;a[_+2]=a[t+2]-p;a[_+3]=p;a[_+4]=_+r.ppr;a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;_+=r.ppr;a[_+0]=-1;a[_+1]=a[t+1]+p;a[_+2]=a[t+2]+p;a[_+3]=p;a[_+4]=a[t+4];a[_+5]=-1;a[_+6]=0;a[_+7]=0;a[_+8]=0;e+=4;N=t+0;if(n[a[N]+0]<a[t+1]){if(n[a[N]+1]<a[t+2]){M=a[t+5]}else{M=a[t+5]+r.ppr}}else{if(n[a[N]+1]<a[t+2]){M=a[t+5]+r.ppr*2}else{M=a[t+5]+r.ppr*3}}a[t+6]=n[a[N]+6];a[t+7]=n[a[N]+0];a[t+8]=n[a[N]+1];a[M+0]=a[t+0];a[t+0]=-1;if(n[o+0]<a[t+1]){if(n[o+1]<a[t+2]){I=a[t+5]}else{I=a[t+5]+r.ppr}}else{if(n[o+1]<a[t+2]){I=a[t+5]+r.ppr*2}else{I=a[t+5]+r.ppr*3}}if(M===I){if(F--){t=M;continue}else{F=r.MAX_SUBDIVISION_RETRIES;break}}a[I+0]=o;break}}}}}if(r.settings.barnesHutOptimize){y=r.settings.scalingRatio;for(o=0;o<r.nodesLength;o+=r.ppn){t=0;while(true){if(a[t+5]>=0){distance=Math.sqrt((n[o+0]-a[t+7])*(n[o+0]-a[t+7])+(n[o+1]-a[t+8])*(n[o+1]-a[t+8]));if(2*a[t+3]/distance<r.settings.barnesHutTheta){b=n[o+0]-a[t+7];x=n[o+1]-a[t+8];if(r.settings.adjustSizes){if(distance>0){w=y*n[o+6]*a[t+6]/distance/distance;n[o+2]+=b*w;n[o+3]+=x*w}else if(distance<0){w=-y*n[o+6]*a[t+6]/distance;n[o+2]+=b*w;n[o+3]+=x*w}}else{if(distance>0){w=y*n[o+6]*a[t+6]/distance/distance;n[o+2]+=b*w;n[o+3]+=x*w}}if(a[t+4]<0){break}t=a[t+4];continue}else{t=a[t+5];continue}}else{if(a[t+0]>=0&&a[t+0]!==o){b=n[o+0]-n[a[t+0]+0];x=n[o+1]-n[a[t+0]+1];distance=Math.sqrt(b*b+x*x);if(r.settings.adjustSizes){if(distance>0){w=y*n[o+6]*n[a[t+0]+6]/distance/distance;n[o+2]+=b*w;n[o+3]+=x*w}else if(distance<0){w=-y*n[o+6]*n[a[t+0]+6]/distance;n[o+2]+=b*w;n[o+3]+=x*w}}else{if(distance>0){w=y*n[o+6]*n[a[t+0]+6]/distance/distance;n[o+2]+=b*w;n[o+3]+=x*w}}}if(a[t+4]<0){break}t=a[t+4];continue}}}}else{y=r.settings.scalingRatio;for(c=0;c<r.nodesLength;c+=r.ppn){for(g=0;g<c;g+=r.ppn){b=n[c+0]-n[g+0];x=n[c+1]-n[g+1];if(r.settings.adjustSizes){distance=Math.sqrt(b*b+x*x)-n[c+8]-n[g+8];if(distance>0){w=y*n[c+6]*n[g+6]/distance/distance;n[c+2]+=b*w;n[c+3]+=x*w;n[g+2]+=b*w;n[g+3]+=x*w}else if(distance<0){w=100*y*n[c+6]*n[g+6];n[c+2]+=b*w;n[c+3]+=x*w;n[g+2]-=b*w;n[g+3]-=x*w}}else{distance=Math.sqrt(b*b+x*x);if(distance>0){w=y*n[c+6]*n[g+6]/distance/distance;n[c+2]+=b*w;n[c+3]+=x*w;n[g+2]-=b*w;n[g+3]-=x*w}}}}}_=r.settings.gravity/r.settings.scalingRatio;y=r.settings.scalingRatio;for(o=0;o<r.nodesLength;o+=r.ppn){w=0;b=n[o+0];x=n[o+1];distance=Math.sqrt(b*b+x*x);if(r.settings.strongGravityMode){if(distance>0){w=y*n[o+6]*_}}else{if(distance>0){w=y*n[o+6]*_/distance}}n[o+2]-=b*w;n[o+3]-=x*w}y=1*(r.settings.outboundAttractionDistribution?m:1);for(v=0;v<r.edgesLength;v+=r.ppe){c=i[v+0];g=i[v+1];p=i[v+2];E=Math.pow(p,r.settings.edgeWeightInfluence);b=n[c+0]-n[g+0];x=n[c+1]-n[g+1];if(r.settings.adjustSizes){distance=Math.sqrt(b*b+x*x)-n[c+8]-n[g+8];if(r.settings.linLogMode){if(r.settings.outboundAttractionDistribution){if(distance>0){w=-y*E*Math.log(1+distance)/distance/n[c+6]}}else{if(distance>0){w=-y*E*Math.log(1+distance)/distance}}}else{if(r.settings.outboundAttractionDistribution){if(distance>0){w=-y*E/n[c+6]}}else{if(distance>0){w=-y*E}}}}else{distance=Math.sqrt(b*b+x*x);if(r.settings.linLogMode){if(r.settings.outboundAttractionDistribution){if(distance>0){w=-y*E*Math.log(1+distance)/distance/n[c+6]}}else{if(distance>0){w=-y*E*Math.log(1+distance)/distance}}}else{if(r.settings.outboundAttractionDistribution){distance=1;w=-y*E/n[c+6]}else{distance=1;w=-y*E}}}if(distance>0){n[c+2]+=b*w;n[c+3]+=x*w;n[g+2]-=b*w;n[g+3]-=x*w}}var P,D,O,B,j=0;if(r.settings.adjustSizes){for(o=0;o<r.nodesLength;o+=r.ppn){if(!n[o+9]){P=Math.sqrt(n[o+2]*n[o+2]+n[o+3]*n[o+3]);if(P>r.maxForce){n[o+2]=n[o+2]*r.maxForce/P;n[o+3]=n[o+3]*r.maxForce/P}D=n[o+6]*Math.sqrt((n[o+4]-n[o+2])*(n[o+4]-n[o+2])+(n[o+5]-n[o+3])*(n[o+5]-n[o+3]));O=Math.sqrt((n[o+4]+n[o+2])*(n[o+4]+n[o+2])+(n[o+5]+n[o+3])*(n[o+5]+n[o+3]))/2;B=.1*Math.log(1+O)/(1+Math.sqrt(D));S=n[o+0];A=n[o+1];n[o+0]=n[o+0]+n[o+2]*(B/r.settings.slowDown);n[o+1]=n[o+1]+n[o+3]*(B/r.settings.slowDown);b=n[o+0];x=n[o+1];distance=Math.sqrt((b-S)*(b-S)+(x-A)*(x-A));j+=distance}}}else{for(o=0;o<r.nodesLength;o+=r.ppn){if(!n[o+9]){D=n[o+6]*Math.sqrt((n[o+4]-n[o+2])*(n[o+4]-n[o+2])+(n[o+5]-n[o+3])*(n[o+5]-n[o+3]));O=Math.sqrt((n[o+4]+n[o+2])*(n[o+4]+n[o+2])+(n[o+5]+n[o+3])*(n[o+5]+n[o+3]))/2;B=n[o+7]*Math.log(1+O)/(1+Math.sqrt(D));n[o+7]=Math.min(1,Math.sqrt(B*(n[o+2]*n[o+2]+n[o+3]*n[o+3])/(1+Math.sqrt(D))));S=n[o+0];A=n[o+1];n[o+0]=n[o+0]+n[o+2]*(B/r.settings.slowDown);n[o+1]=n[o+1]+n[o+3]*(B/r.settings.slowDown);b=n[o+0];x=n[o+1];distance=Math.sqrt((b-S)*(b-S)+(x-A)*(x-A));j+=distance}}}r.iterations++;if(r.settings.autoStop){r.converged=r.iterations>r.settings.maxIterations||j/r.nodesLength<r.settings.avgDistanceThreshold;if(r.converged&&r.settings.alignNodeSiblings){var V={},U={},G,W;for(v=0;v<r.edgesLength;v+=r.ppe){c=i[v+0];g=i[v+1];if(c===g){continue}V[c]=V[c]||{};V[g]=V[g]||{};V[c][g]=true;V[g][c]=true}Object.keys(V).forEach(function(e){e=~~e;W=Object.keys(V[e]);if(W.length==2){G=W[0]+";"+W[1];if(G in U){U[G].push(e)}else{G=W[1]+";"+W[0];if(!U[G]){U[G]=[~~W[1],~~W[0]]}U[G].push(e)}}});var H,X,q,Y,Z,K,Q,J,$,ee,te,re,ne,ie,ae,oe=r.settings.nodeSiblingsAngleMin;Object.keys(U).forEach(function(e){X=U[e].shift();q=U[e].shift();H=U[e].filter(function(e){return!n[e+9]});if(H.length==1){return}K=n[X+0];Q=n[X+1];J=n[q+0];$=n[q+1];Y=Object.keys(V[X]).length;Z=Object.keys(V[q]).length;ee=u(Y/(Y+Z),0,1,1/4,3/4);re=h(K,Q,J,$,ee);ne=d(K,Q,J,$);te=s(K,Q,J,$);ie=f(ne,te);ae=l(ie);if(2*oe>Math.PI){throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.")}if(oe>0){if(ae<oe||ae>Math.PI-oe&&ae<=Math.PI){ie={x:Math.cos(Math.PI-oe)*2,y:Math.sin(Math.PI-oe)*2}}else if(ae>2*Math.PI-oe||ae>=Math.PI&&ae<Math.PI+oe){ie={x:Math.cos(oe)*2,y:Math.sin(oe)*2}}}var t=0,i=1,a=1;if(H.length%2==1){a=0;t=1}for(var o=0;o<H.length;o++){n[H[o]+0]=re.x+i*ie.x*a*(t||o>=2?r.settings.nodeSiblingsScale:r.settings.nodeSiblingsScale*2/3);n[H[o]+1]=re.y+i*ie.y*a*(t||o>=2?r.settings.nodeSiblingsScale:r.settings.nodeSiblingsScale*2/3);i=-i;a+=(o+t)%2}})}}}function p(){if(r.settings.autoStop){while(!r.converged){v()}}else{var e=r.iterations===0?r.settings.startingIterations:r.iterations+r.settings.iterationsPerRender;while(r.iterations!==e){v()}}return{nodes:_(t.nodes),barycentre:t.barycentre}}function _(e){var t=Object.keys(e);var i={};for(var a=0;a<n.length;a+=r.ppn){var o=t[a/r.ppn];i[o]={id:o,x:n[a+0],y:n[a+1],pinned:n[a+9]}}return i}return p()},isRunning:function(e){return!e.W.settings.autoStop},onSync:function(e,t){var r=e.nodes;var n=e.barycentre;var i=t.graph;var a=Object.keys(r);var o=a.length;var s=0,u=0;var l,d,f,h,c,g,v,p;var _=new Array(o);var m=new Array(o);var y=new Array(o);var b=new Array(o);var x=i.getAttributes(true,["x","y"]);var S=x[0];var A=x[1];for(l=0;l<o;l++){d=a[l];f=r[d];p=parseInt(d);_[l]=p;b[l]=f.pinned;if(f.pinned){h=S.get(p);c=A.get(p)}else{h=f.x;c=f.y}m[l]=h;y[l]=c;s+=h;u+=c}g=s/o-n.x;v=u/o-n.y;for(l=0;l<o;l++){if(!b[l]){m[l]-=g;y[l]-=v}}return{indexes:_,x:m,y:y}}};Ogma.extend(function(e){e.layouts.forceLink=function(t){if(t===void 0)t={};return e.modules.layouts.start("forceLink",t)};e.modules.layouts.register("forceLink",q_)});var Y_={configure:function(e,t){var r=t.graph;var n=t.camera;var i=e.sortBy;var a=e.rows;var o=e.cols;if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&!(e.nodes instanceof r.NodeList)){e.nodes=r.getNodes(e.nodes)}function s(e){return e===undefined||typeof e==="number"&&isFinite(e)&&e>0}if(!s(a)){throw new TypeError('"rows" should be a positive integer')}if(!s(o)){throw new TypeError('"cols" should be a positive integer')}var u=e.nodes;var l=e.nodes._indexes;var d=l.length;if(a){o=Math.ceil(d/a)}else if(o){a=Math.ceil(d/o)}else{o=Math.ceil(Math.sqrt(d));a=Math.ceil(d/o)}var f,h;var c;var g=e.sortFallbackValue;if(typeof i==="string"){if(i==="radius"){c=r.getAttribute(true,"radius").getMultiple(l)}else if(i==="random"){c=new Array(d);for(f=0;f<d;f++){c[f]=Math.random()}}else{c=u.getData(i);if(g!==undefined){for(f=0;f<d;f++){if(c[f]===undefined){c[f]=g}}}}}else{c=new Array(d);for(f=0;f<d;f++){c[f]=f}}var v=[];var p=u.getAttribute("layoutable");for(f=0;f<d;++f){h=l[f];if(p[f]){v.push({id:h,attr:c[f]})}}var _=u.getBoundingBox();var m=Math.max(_.maxScaledSize,_.maxFixedSize/n.getZoom())*.65;var y=_.minX+m;var b=_.maxX-m;var x=_.minY+m;var S=_.maxY-m;if(_.width<m*o*2){y=_.cx-m*o+m;b=_.cx+m*o-m}if(_.height<m*a*2){x=_.cy-m*a+m;S=_.cy+m*a-m}return{sort:!!i,nodes:v,reverse:!!e.reverse,cols:o,rows:a,minX:y,maxX:b,minY:x,maxY:S}},update:function(e){if(e.sort){e.nodes.sort(function(e,t){var r=e.attr,n=t.attr;if(r<n){return-1}else if(r>n){return 1}else{return 0}})}if(e.reverse){e.nodes.reverse()}var t=(e.maxX-e.minX)/(e.cols-1),r=(e.maxY-e.minY)/(e.rows-1),n=0,i=0,a=e.minX,o=e.minY;if(!isFinite(t)){t=0}if(!isFinite(r)){r=0}for(var s=0;s<e.nodes.length;++s){var u=e.nodes[s];u.x=a+n*t;u.y=o+i*r;n+=1;if(n===e.cols){i+=1;n=0}}return e.nodes},onSync:function(e){var t=e.length;var r=new Uint32Array(t);var n=new Array(t);var i=new Array(t);for(var a=0;a<e.length;++a){var o=e[a];r[a]=o.id;n[a]=o.x;i[a]=o.y}return{indexes:r,x:n,y:i}}};Ogma.extend(function(e){e.layouts.grid=function(t){if(t===void 0)t={};return e.modules.layouts.start("grid",t)};e.modules.layouts.register("grid",Y_)});var Z_={configure:function(e,t){var r=t.graph;var n=t.data;if(e.centralNode===undefined){throw new Error('concentric layout: missing parameter "centralNode"')}else if(!(e.centralNode instanceof r.Node)){e.centralNode=r.getNode(e.centralNode)}if(!e.nodes){e.nodes=r.getNodes()}else if(!(e.nodes instanceof r.NodeList)){e.nodes=r.getNodes(e.nodes)}var i=r.getNode(e.centralNode)._index;var a=e.centralNode.getPosition();var o=a.x,s=a.y;var u=null,l,d;var f=r.getNodes(e.nodes)._indexes;var h=[];var c=f.length;var g=r.getNodeAttributesArrays(["radius"],{ids:f,destArrays:[new Array(c)]});var v=g[0];var p=e.nodes.getAttribute("layoutable");for(l=0;l<c;l++){d=f[l];if(d===i||p[l]){h.push(d)}}if(h.indexOf(i)===-1){h.push(i)}c=h.length;var _={};var m=new Array(c);for(l=0;l<c;l++){_[h[l]]=l;m[l]=l}var y=new Array(c);for(l=0;l<c;l++){var b=r._getAdjacentElements(true,[h[l]]);for(var x=0,S=b.length;x<S;x++){b[x]=_[b[x]]}y[l]=b}if(e.sortBy){if(e.sortBy==="random"){u="random"}else if(e.sortBy==="radius"){u=v.slice()}else if(e.sortBy==="degree"){u=e.nodes.getDegree()}else{u=n.getProperty(e.nodes,e.sortBy)}}return{sourceNodeIndex:h.indexOf(i),centerX:e.centerX==="number"?e.centerX:o,centerY:e.centerY==="number"?e.centerY:s,list:h,indexes:m,size:c,totalSize:c,attributes:{adjacentNodes:y,size:v},sortAttr:u,clockwise:e.clockwise===undefined?true:e.clockwise,circleHopRatio:e.circleHopRatio||5,allowOverlap:!!e.allowOverlap}},context:function(){return{dijkstra:function(e,t,r,n,i){var a=Math.pow(2,31)-1,o=new Int32Array(n),s=new Int32Array(n),u=new Int8Array(n),l,d,f;for(f=0;f<n+1;++f){o[f]=a;s[f]=-1}for(f=0;f<n;++f){l=t[f];if(l!==undefined){o[l]=a;s[l]=-1}}o[i]=0;while(true){var h=a,c=-1;for(f=0;f<r;++f){l=t[f];d=o[l];if(!u[l]&&d<h){h=d;c=l;u[l]=true}}if(c===-1){break}var g=e[c],v=g.length,p=h+1;for(f=0;f<v;++f){l=g[f];d=o[l];if(p<d){o[l]=p;s[l]=c}}}return o},determinePropertyType:function(e,t,r){for(var n=0;n<r;++n){if(typeof e[t[n]]!=="number"){return"string"}}return"number"}}},update:function(e,t){var r=e.attributes.adjacentNodes;var n=e.attributes.size;var i=e.indexes;var a=e.size;var o=e.sourceNodeIndex;var s=e.centerX;var u=e.centerY;var l=e.sortAttr;var d=new Array(e.totalSize);var f=new Array(e.totalSize);var h=t.dijkstra(r,i,e.size,e.totalSize,o);var c=0;var g={};var v;for(v=0;v<a;++v){var p=n[i[v]];if(p>c){c=p}}var _=c*e.circleHopRatio,m=0,y=0,b=Math.PI/9;for(v=0;v<a;++v){var x=i[v],distance=h[x],S=g[distance];if(!S){S=[];g[distance]=S}S.push(x)}var A=null,E=true;if(l==="random"){A=function(){return Math.random()-.5}}else if(l){var w=t.determinePropertyType(l,i,p);A=w==="number"?function(e,t){return l[e]-l[t]}:function(e,t){return l[e]<l[t]?-1:1}}else{E=false}var k=Object.keys(g).sort(function(e,t){return parseInt(e)-parseInt(t)});for(v=0;v<k.length;++v){var C=g[k[v]],T=C.length,L=y,M=Math.PI*2/T;if(v!==0&&!e.allowOverlap){var I=Math.PI*2*m,F=0,N=0;for(z=0;z<T;++z){F+=n[C[z]]}N=F*2*Math.SQRT2;if(N>I){m+=N/(2*Math.PI)-m}}if(E){C.sort(A);if(!e.clockwise){C.reverse()}}for(var z=0;z<T;++z){x=C[z];d[x]=Math.cos(L)*m+s;f[x]=Math.sin(L)*m+u;p=n[x];var R=e.allowOverlap?1:p/F*T;L+=M*R}m+=_;y+=b}return{x:d,y:f,indexes:e.list}},isRunning:function(){return false},onSync:function(e){var t=e.indexes;var r=e.x;var n=e.y;return{indexes:t,x:r,y:n}}};Ogma.extend(function(e){e.layouts.concentric=function(t){if(t===void 0)t={};return e.modules.layouts.start("concentric",t)};e.modules.layouts.register("concentric",Z_)});var K_={defaultDirected:true,defaultMultigraph:true,defaultCompound:false,defaultRankDir:"TB",maxNbEdges:500,maxNbNodes:500};Ogma.extend(function(e){e.layouts.hierarchical=function(t){if(t===void 0)t={};t.useWebWorker=false;return e.modules.layouts.start("hierarchical",t)};e.modules.layouts.register("hierarchical",Q_)});var Q_={configure:function(e,t){if(e===void 0)e={};var r=t.graph;A("dagre",{throwOnError:true});if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&e.nodes instanceof r.NodeList){e.nodes=e.nodes.getId()}var n=Za(e,K_);var i=r.getEdges();var a=r.getNodes(e.nodes);e.directed=qa(e.directed,n.defaultDirected);e.multigraph=qa(e.multigraph,n.defaultMultigraph);e.compound=qa(e.compound,n.defaultCompound);e.rankdir=qa(e.rankdir,n.defaultRankDir);if(e.nodeDistance!==undefined){e.nodesep=e.nodeDistance;delete e.nodeDistance}if(e.levelDistance!==undefined){e.ranksep=e.levelDistance;delete e.levelDistance}if(e.edgeDistance!==undefined){e.edgesep=e.edgeDistance;delete e.edgeDistance}if(["TB","BT","LR","RL"].indexOf(e.rankdir)===-1){throw new Error('defaultRankDir should be one of the "TB", "BT", "LR", "RL"')}var o=a.getId();var s=a.getAttribute("layoutable").reduce(function(e,value,t){e[o[t]]=value;return e},{});return{nodes:o,edges:i.map(function(e){return{id:e.getId(),source:e.getSource().getId(),target:e.getTarget().getId()}}),options:J(e),layoutable:s}},context:function(){},update:function(e){var t=e.nodes;var r=e.edges;var n=e.options;var i=e.layoutable;var a=A("dagre");var o=new a.graphlib.Graph({directed:n.directed,multigraph:n.multigraph,compound:n.compound});o.setGraph(n);t.forEach(function(e){if(i[e]){o.setNode(e,{})}});r.forEach(function(e){var t=e.source;var r=e.target;var n=e.id;if(o.node(t)&&o.node(r)){o.setEdge(t,r,{id:n})}});a.layout(o);var s=o.nodes();return{ids:s,positions:s.map(function(e){return o.node(e)})}},isRunning:function(){return false},onSync:function(e,t){var r=e.ids;var n=e.positions;var i=t.graph;var a=new Array(r.length);var o=new Array(r.length);var s=new Array(r.length);for(var u=0;u<r.length;++u){var l=n[u];var d=l.x;var f=l.y;a[u]=i.getNode(r[u])._index;o[u]=d;s[u]=f}return{indexes:a,x:o,y:s}}};function J_(e,t,r,n,i){return{x:e+i*(r-e),y:t+i*(n-t)}}var $_=10;function em(e,t,r){var n=Infinity;var i,a;for(var o=0,s=t.length;o<s;o++){var u=t[o],l=t[(o+1)%s];var d=an(e[0],e[1],u[0],u[1],l[0],l[1]);if(d<n){n=d;i=u;a=l}}return tm(e[0],e[1],i[0],i[1],a[0],a[1],r)}function tm(e,t,r,n,i,a,o){var s=un(e,t,r,n,i,a);var u=r-i,l=n-a;var d=-l,f=u;var h=Math.sqrt(d*d+f*f);d/=h;f/=h;return[s.x-o*d,s.y-o*f]}function rm(e,t,r,n){var i=Math.abs;for(var a=0,o=e.length;a<o;a++){var s=e[a];var u=s[0];var l=s[1];var d=i(u-t),f=i(l-r);if(d+f<=n){return true}if(d>n||f>n){continue}if(d*d+f*f<=n*n){return true}}return false}function nm(e,t,r){var n=en(r.cx,r.cy,e,t,r.minX,r.minY,r.maxX,r.maxY);var i=+Infinity,a,o;for(var s=0,u=n;s<u.length;s+=1){var l=u[s];a=distance(e,t,l.x,l.y);if(a<i){i=a;o=l}}return o}function im(e,t,r){var n=t.nodes;var i=t.margin;if(i===void 0)i=5;var a=t.duration;if(a===void 0)a=0;var o=n.inverse();var s=o.getPosition().map(function(e){return[e.x,e.y]});var u=r;var l=n.getBoundingBox();var d=o.getBoundingBox();d.pad(d.maxScaledSize);var f=minDisk(u.map(function(e){return e.x}),u.map(function(e){return e.y}),n.getAttribute("radius"));var h=f[0];var c=f[1];var g=f[2]+d.maxScaledSize+i;var v=0,p=0,_,m;if(rm(s,h,c,g)){if(o.size<=3){if(jr(h,c,f[2],d.minX,d.minY,d.maxX,d.maxY)){m=nm(h,c,d);_=distance(d.cx,d.cy,m.x,m.y);var y=J_(d.cx,d.cy,m.x,m.y,(_+g)/_);v=y.x-h;p=y.y-c}}else{var b=new la(s.slice()).triangulate();var convexhull=ha(s);var x=ca(o,$_,g,b,convexhull);m=em([h,c],convexhull,g);if(x.length>0){var S=Math.pow(h-m[0],2)+Math.pow(c-m[1],2);for(var A=0,E=x;A<E.length;A+=1){var w=E[A];v=h-w[0];p=c-w[1];_=v*v+p*p;if(_<S){S=_;m=w}}v=m[0]-h;p=m[1]-c}else{v=m[0]-l.cx;p=m[1]-l.cy}}}if(v||p){var k=u.map(function(e){e.x+=v;e.y+=p;return e});if(t.locate){if(typeof t.locate==="boolean"){t.locate={}}var C=e.modules.locate.layoutDataBoundingBox({x:s.map(function(e){return e[0]}).concat(k.map(function(e){return e.x})),y:s.map(function(e){return e[1]}).concat(k.map(function(e){return e.y})),indexes:e.getNodes()._indexes});var T=e.modules.locate.computeConfigForBounds(C,t.locate);e.modules.camera.setView(T,{duration:a,easing:t.locate.easing,ignoreZoomLimits:true})}return n.setAttributes(k,a)}else{return Promise.resolve()}}function am(e,t){var r=G(t);r.duration=0;r.dryRun=true;r.locate=false;return e.layouts.forceLink(r).then(function(r){return im(e,t,r.positions.current)})}function om(e,t){var r=t.nodes;var n=t.duration;var i=t.centralNode;var a=r;var o=a.reduce(function(e,t){e[t._index]=true;return e},{});var s=e.getNodes();if(t.focusOnGroupShape){return e.layouts.forceLink({nodes:a,duration:0}).then(function(){var t=a.concat(i);var r=t.getAttribute("layoutable");t.setAttributes({layoutable:false});return e.layouts.forceLink({nodes:e.getNodes(),duration:n}).then(function(){return t.setAttributes(r)})})}else{var u=G(t);delete u.centralNode;u.nodes=s;u.nodeMass=function(e,t){var r=o[e._index]?1:2;return(t+1)*r};return e.layouts.forceLink(u)}}Ogma.extend(function(e){e.layouts.incremental=function(t){if(t===void 0)t={};var r=t.nodes;var n=t.centralNode;if(!r){throw new Error("Incremental ForceLink layout: no nodes are selected")}if("margin"in t&&!isFinite(t.margin)){throw new Error("Incremental ForceLink layout: margin has to be a positive number")}if(n&&!n.getAttribute("layoutable")){return om(e,t)}else{return am(e,t)}}});var sm=function(e,t){return e-t};var um={imports:{minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,distance:distance,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,removeRadialOverlap:removeRadialOverlap},configure:function(e,t){if(e===void 0)e={};var r=t.graph;var n=null,i,a,o,s=-1;var u=null;if(e.centralNode!==undefined&&e.centralNode!==null){n=r.getNode(e.centralNode,true);o=n.getPosition();i=isFinite(e.centerX)?parseFloat(e.centerX):o.x;a=isFinite(e.centerY)?parseFloat(e.centerY):o.y;s=n._index}else{throw new Error('concentric layout: missing parameter "centralNode"')}if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&!(e.nodes instanceof r.NodeList)){e.nodes=r.getNodes(e.nodes)}if(!e.nodes.includes(n)){e.nodes=e.nodes.concat(n)}var l=r.getNodes(e.nodes);var d=l._indexes;var f=l.getAttribute("layoutable");d=d.filter(function(e,t){return f[t]||e===s});d.sort(sm);var h=d.length;var c=r.getConnectedComponents(l,{internalIndexes:true});var g=fm(d,c,s);c=g;var v=r._degrees(d);var p=r.getNodeAttributesArrays(["x","y","radius"],{ids:d,destArrays:[new Float32Array(h),new Float32Array(h),new Float32Array(h)]});var _=p[0];var m=p[1];var y=p[2];var b=r.getEdgeAttributesArrays(["source","target","width"]);var x=b[0];var S=b[1];var A=r.getAdjacencyList({internalIndexes:true,weight:1,indexes:d});var E=isFinite(e.radiusRatio)?parseFloat(e.radiusRatio):Math.SQRT2;var w=isFinite(e.radiusDelta)?parseFloat(e.radiusDelta):0;var k=isFinite(e.nodeGap)?parseInt(e.nodeGap):10;var C=h*(isFinite(e.repulsion)?parseFloat(e.repulsion):1);var T=isFinite(e.maxIterations)?parseInt(e.maxIterations):100;if(T<1){throw new RangeError("maxIterations must be a positive integer")}var L=isFinite(e.iterationsPerRender)?parseInt(e.iterationsPerRender):20;if(L<1){throw new RangeError("iterationsPerRender must be a positive integer")}var M=isFinite(e.epsilon)?parseFloat(e.epsilon):.001;if(M<=0){throw new RangeError("epsilon has to be a positive number")}return{centerIndex:s,centerX:i,centerY:a,list:d,components:g,X:_,Y:m,degree:v,size:h,currStress:Number.POSITIVE_INFINITY,epsilon:M,maxSteps:T,iterationsPerRender:L,attributes:{size:y,adjacency:A,weights:S.map(function(){return 1}),sources:x,targets:S},sortAttr:u,allowOverlap:!!e.allowOverlap,nodeGap:k,radiusRatio:E,radiusDelta:w,repulsion:C,randomize:"randomize"in e?!!e.randomize:true,renderSteps:!!e.renderSteps}},context:function(){return{getHighestNodeSize:function e(t,r){var n=0;for(var i=0,a=r.length;i<a;i++){var o=t[r[i]];if(o>n){n=o}}return n},grid:function e(t,r){if(r===void 0)r=8;var n=t.size;var i=new Float32Array(n);var a=new Float32Array(n);var o,s,u=this.getHighestNodeSize(t.attributes.size,t.list,n);var l=u*r;var d=Math.ceil(Math.sqrt(n));var f=Math.ceil(n/d);var h=-Math.floor((f-1)*l/2);var c=-Math.floor((d-1)*l/2);for(o=0;o<d;o++){for(s=0;s<f;s++){i[o*f+s]=h+s*l;a[o*f+s]=c+o*l}}return{x:i,y:a}},connectSubgraphs:function e(t,r,n,i,a,o){var s,u;function l(e,value){var t=new Uint32Array(e.length+1);t.set(e);t[e.length]=value;return t}var d=function(e){s=t[e];var d=0,f=0;s.forEach(function(e,t){if(a[e]>d){f=t;d=a[e]}});u=s[f];var h=r[o[u]];h.nodes=l(h.nodes,n);h.weights.push(i);h=r[n];h.nodes=l(h.nodes,u);h.weights.push(i)};for(var f=1;f<t.length;f++)d(f)},correctSubgraphsDistances:function e(t,r,n,i,a){var o=Array.prototype.reduce.call(t[n],function(e,t,r){if(r!==n&&t<i&&t>e){e=t}return e},0);var s=i-o-1;for(var u=1;u<r.length;u++){var l=r[u];for(var d=0,f=l.length;d<f;d++){var h=a[l[d]];t[n][h]-=s;t[h][n]-=s}}},establishRadii:function e(t,r,n,i,a,o,s,u){var l=Object.create(null);var d=a[r];var f=d,h=0;var c=d;for(var g in i){var v=i[g];var p=0;var _=0,m=void 0;for(var y=0,b=v.length;y<b;y++){m=a[v[y]];_=Math.max(_,m);p+=m*2+o}var x=p/(2*Math.PI)+_;var S=_+f;var A=u?h+Math.max(u,S):h*s;h=Math.max(h,x,c,A);l[g]=h;f=_}l[0]=0;l[Number.POSITIVE_INFINITY]=h;return l},initData:function e(t,r){t.step=0;t.data=r;t.totalSteps=r.totalSteps;t.currStress=Number.POSITIVE_INFINITY;t.prevStress=0;t.epsilon=t.data.epsilon;var n={},i={};t.normIndexes=r.list.reduce(function(e,a,o){e[o]=n[a]=o;i[a]=r.degree[o];if(a===r.centerIndex){t.centerIndexPos=o}return e},new Uint32Array(r.list.length));var a=t.centerIndexPos;var o=r.components[0].length;this.connectSubgraphs(r.components,r.attributes.adjacency,r.centerIndex,o,i,n);var s=johnson({sources:r.attributes.sources,targets:r.attributes.targets,weights:r.attributes.weights,indexes:r.list,adjacency:r.attributes.adjacency,undirected:true});this.correctSubgraphsDistances(s,r.components,a,o,n);t.D=s;t.rings=this.groupRings(s,a,t.normIndexes);t.radii=this.establishRadii(s,a,t.normIndexes,t.rings,r.attributes.size,r.nodeGap,r.radiusRatio,r.radiusDelta)},groupRings:function e(t,r,n){var i=t[r];var a=Object.create(null);for(var o=0,s=n.length;o<s;o++){if(o!==r){var u=i[o];a[u]=a[u]||[];a[u].push(n[o])}}return a},removeOverlaps:function e(t,r){var n=t.centerIndexPos;var i=r.attributes.size;var a=t.rings;var o=r.X[n];var s=r.Y[n];for(var u in a){var l=a[u];var d=distance(o,s,r.X[l[0]],r.Y[l[0]]);removeRadialOverlap({X:r.X,Y:r.Y,sizes:i,indexes:l,center:[o,s],R:d,gap:r.nodeGap,inPlace:true})}},easingQuadraticInOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)}}},update:function(e,t){e=e||t.data;var r=e.list;var n=e.centerIndex;var i=e.X||new Float32Array(e.size);var a=e.Y||new Float32Array(e.size);var o=null;var s;if(t.step===undefined){t.initData(t,e)}else{t.step++}var u=e.repulsion;var l=function(e){return t.radii[e]||1};if(t.step===0){if(e.randomize){s=t.grid(e);e.X=s.x;e.Y=s.y}e.spent=0}else if(!t.converged){var d=e.maxSteps;var f=e.iterationsPerRender;var h=t.step;var c=Math.min(h+f,d+1);while(h<=c||!t.converged){var g=t.easingQuadraticInOut(Math.min(h,d)/d);t.step=h++;s=stressMinimizationStep(t.D,i,a,e.size,t.centerIndexPos,u,g,t.normIndexes,l);e.X=s.X;e.Y=s.Y;t.prevStress=t.currStress;t.currStress=constrainedStress(t.D,e.X,e.Y,e.size,t.centerIndexPos,u,g,t.normIndexes,r,n);t.converged=t.converged||Math.abs(t.currStress-t.prevStress)<=t.epsilon}}if(t.converged){if(t.overlapRemoved||t.data.allowOverlap){t.done=true;o=Object.keys(t.rings).reduce(function(e,n){e[n]=t.rings[n].map(function(e){return r[e]});return e},{})}else{t.removeOverlaps(t,e,n);t.overlapRemoved=true}}return{x:e.X,y:e.Y,indexes:e.list,components:t.overlapRemoved?e.components:undefined,rings:o,centerIndex:t.centerIndexPos,cx:e.centerX,cy:e.centerY,step:t.step,renderSteps:e.renderSteps,converged:t.converged,overlapRemoved:t.overlapRemoved,stress:t.currStress,done:t.done}},isRunning:function(e){if(!e.converged){return true}else{return e.data.allowOverlap?false:!e.done}},onSync:function(e,t){if(e.renderSteps||e.done){return lm(e,t)}},onEnd:function(e,t){return lm(e,t)}};function lm(e){var t=e.x,r=e.y;var n=e.indexes.length;var i=t[e.centerIndex]-e.cx;var a=r[e.centerIndex]-e.cy;for(var o=0;o<n;o++){t[o]-=i;r[o]-=a}return{indexes:e.indexes,x:t,y:r}}function dm(e,t){var r=0,n=e.length-1,i;var a;while(r<=n){i=(r+n)/2|0;a=e[i];if(a<t){r=i+1}else if(a>t){n=i-1}else{return i}}return-1}function fm(e,t,r){var n=e.slice().sort(sm),i=[];for(var a=0,o=t.length;a<o;a++){var s=[],u=t[a];var l=false;for(var d=0,f=u.length;d<f;d++){var h=u[d];var c=dm(n,h);if(c!==-1){if(h===r){l=true}s.push(h)}}if(s.length!==0){i[l?"unshift":"push"](s.sort(sm))}}return i}Ogma.extend(function(e){e.layouts.radial=function(t){if(t===void 0)t={};return e.modules.layouts.start("radial",t)};e.modules.layouts.register("radial",um)});var hm=function e(t,r){var n=this;this._module=t;this._id=r;this._whenApplied=t.whenApplied().then(function(){return n})};hm.prototype.getName=function e(){return this._module.getName(this._id)};hm.prototype.getId=function e(){return this._id};hm.prototype.whenApplied=function e(){return this._whenApplied};hm.prototype.isEnabled=function e(){return this._module.isEnabled(this._id)};hm.prototype.enable=function e(t){return this._module.enable(this._id,t)};hm.prototype.disable=function e(t){return this._module.disable(this._id,t)};hm.prototype.toggle=function e(t){return this._module.toggle(this._id,t)};hm.prototype.getIndex=function e(){return this._module.getIndex(this._id)};hm.prototype.setIndex=function e(t){return this._module.setIndex(this._id,t)};hm.prototype.destroy=function e(t){return this._module.remove(this._id,t)};hm.prototype.refresh=function e(){return this._module.refresh(this._id)};hm.prototype.delete=function e(t){return this.destroy(t)};var cm=function e(t){var r=this;this._ogma=t;this._settings=t.modules.settings;this._dom=t.modules.dom;this._events=t.modules.events;this._graph=t.modules.graph;this._captor=t.modules.captor;this._list=[];this._currentPipeline=[];this._idCounter=0;this._mustRefresh=false;this._resolvers=[];this._safeGuard=false;this._afterCurrentUpdate=Promise.resolve();this._ogma.styles.createClass({name:Hl,isBuiltin:true,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}});this._ogma.styles.createClass({name:Xl,isBuiltin:true,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}});this._nodeTransformationIdList=this._graph.createNodeAttribute({storage:16,default:0});this._edgeTransformationIdList=this._graph.createEdgeAttribute({storage:16,default:0});this._settings.register("transformations.updateOnDataChange",true);this._events.on({"addNodes addEdges removeNodes removeEdges":function(e){var t=e.virtual;if(!t){r._invalidState()}},"updateNodeData updateEdgeData":function(){if(r._settings.get("transformations.updateOnDataChange")&&!r._safeGuard){r._invalidState()}},afterNewFrame:function(){r._computeTransformations()}})};cm.prototype._invalidState=function e(){var t=this;this._afterCurrentUpdate.then(function(){if(t._list.length||t._currentPipeline.length){t._mustRefresh=true;t._dom.refresh()}})};cm.prototype._onUpdate=function e(){var t=this;return this._afterCurrentUpdate.then(function(){t._dom.refresh();return new Promise(function(e){return t._resolvers.push(e)})})};cm.prototype._resetEltTransformationIds=function e(){this._nodeTransformationIdList.reset();this._edgeTransformationIdList.reset()};cm.prototype._assignTransformationIds=function e(t){this._assignTransformationIdsToElements(true,t);this._assignTransformationIdsToElements(false,t)};cm.prototype._assignTransformationIdsToElements=function e(t,r){var n=t?this._graph.getNodes("all"):this._graph.getEdges("all");var i=this._graph.getAttribute(t,"virtual");var a=this._graph.getAttribute(t,"excluded");var o=t?this._nodeTransformationIdList:this._edgeTransformationIdList;for(var s=0,u=n._indexes;s<u.length;s+=1){var l=u[s];var d=o.get(l);if(!d){var f=a.get(l);var h=i.get(l);if(!f&&h){o.set(l,r)}}}};cm.prototype._resolveTransformations=function e(t,r,n){var i=this;if(!n){t.forEach(function(e){return e.duration=0});r.forEach(function(e){return e.duration=0})}this._resetEltTransformationIds();var a=this._ogma.getSelectedNodes().getId();var o=this._ogma.getSelectedEdges().getId();var s=Promise.resolve();var u=function(e){var n=t[e];if(n.context!==null){s=s.then(function(){return n.methods.undo(n)})}if(!r.some(function(e){return e.id===n.id})){s=s.then(function(){return n.methods.cleanup(n)}).then(function(){n.context=null})}};for(var l=t.length-1;l>=0;--l)u(l);var d=function(e){var t=r[e];var n=null;s=s.then(function(){return t.methods.run(t)}).then(function(e){n=e;if(t.context){return t.methods.cleanup(t)}}).then(function(){i._assignTransformationIds(t.id);t.context=n})};for(var f=0;f<r.length;++f)d(f);s=s.then(function(){i._ogma.getNodes(a).setSelected(true);i._ogma.getEdges(o).setSelected(true)});return s};cm.prototype._computeTransformations=function e(){var t=this;if(this._safeGuard){return}this._safeGuard=true;this._afterCurrentUpdate=Promise.resolve();if(this._mustRefresh){this._captor.setDetectionEnabled(false);var r=this._currentPipeline.filter(function(e){var t=e.enabled;return t});var n=this._list.filter(function(e){var t=e.enabled;return t});var i;var a;var o;if(r.length===n.length+1&&gm(r,n,n.length)){i=[r.pop()];a=[];o=true}else if(n.length===r.length+1&&gm(r,n,r.length)){i=[];a=[n.pop()];o=true}else{i=r;a=n;o=false}this._afterCurrentUpdate=this._afterCurrentUpdate.then(function(){return t._resolveTransformations(i,a,o)}).then(function(){t._captor.setDetectionEnabled(true);t._currentPipeline=t._list.map(function(e){return Object.assign({},e)});t._mustRefresh=false;return t._ogma.view.afterNextFrame()})}this._afterCurrentUpdate=this._afterCurrentUpdate.then(function(){t._safeGuard=false;t._resolvers.forEach(function(e){return e()});t._resolvers=[]})};cm.prototype.getList=function e(){return this._list.map(function(e){var t=e.wrapper;return t})};cm.prototype.clear=function e(){this._list=[];this._invalidState();return this._onUpdate()};cm.prototype._get=function e(t,r){if(r===void 0)r=true;for(var n=0;n<this._list.length;++n){var i=this._list[n];if(i.id===t){i.index=n;return i}}if(r){throw new Error("calling a method on a destroyed transformation")}return null};cm.prototype.getName=function e(t){return this._get(t).methods.getName()};cm.prototype.enable=function e(t,r){var n=this;return this._afterCurrentUpdate.then(function(){var e=n._get(t);if(!e.enabled){e.enabled=true;e.duration=r;n._invalidState()}return n._onUpdate()})};cm.prototype._setRemovalDuration=function e(t,r){for(var n=0;n<this._currentPipeline.length;++n){var i=this._currentPipeline[n];if(i.id===t){i.duration=r}}};cm.prototype.disable=function e(t,r){var n=this;return this._afterCurrentUpdate.then(function(){var e=n._get(t);if(e.enabled){e.enabled=false;n._setRemovalDuration(t,r);n._invalidState()}return n._onUpdate()})};cm.prototype.remove=function e(t,r){var n=this;return this._afterCurrentUpdate.then(function(){var e=n._get(t);n._list.splice(e.index,1);n._setRemovalDuration(t,r);n._invalidState();return n._onUpdate()})};cm.prototype.toggle=function e(t,r){var n=this;return this._afterCurrentUpdate.then(function(){var e=n._get(t);if(e.enabled){return n.disable(t,r)}else{return n.enable(t,r)}})};cm.prototype.setIndex=function e(t,r){var n=this;return this._afterCurrentUpdate.then(function(){var e=n._get(t);n._list.splice(e.index,1);n._list.splice($e(r,0,n._list.length),0,e);n._invalidState();return n._onUpdate()})};cm.prototype.getIndex=function e(t){return this._get(t).index};cm.prototype.add=function e(t,r){if(r===void 0)r={};var n=r.duration;if(n===void 0)n=0;var i=r.enabled;if(i===void 0)i=true;if(!t.cleanup){t.cleanup=function(){}}var a={ogma:this._ogma,id:++this._idCounter,methods:t,duration:n,enabled:i,context:null,wrapper:new hm(this,this._idCounter),index:-1};this._list.push(a);this._invalidState();return a.wrapper};cm.prototype.whenApplied=function e(){return this._onUpdate()};cm.prototype.refresh=function e(){this._invalidState();return this._onUpdate()};cm.prototype.isEnabled=function e(t){return this._get(t).enabled};cm.prototype._getElementTransformationId=function e(t){var r=t.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList;return r.get(t._index)};cm.prototype.isElementVirtual=function e(t){return!!this._getElementTransformationId(t)};cm.prototype.getElementTransformation=function e(t){var r=this._get(this._getElementTransformationId(t),false);return r&&r.wrapper};function gm(e,t,r){for(var n=0;n<r;++n){if(e[n].id!==t[n].id){return false}}return true}Ogma.extend(function(e){var t=e.Node;var r=e.Edge;var n=new cm(e);e.modules.transformations=n;Object.assign(e.transformations,{getList:function e(){return n.getList()},clear:function e(){return n.clear()},afterNextUpdate:function e(){return n.whenApplied()}});t.prototype.isVirtual=function(){return n.isElementVirtual(this)};r.prototype.isVirtual=function(){return n.isElementVirtual(this)};t.prototype.getTransformation=function(){return n.getElementTransformation(this)};r.prototype.getTransformation=function(){return n.getElementTransformation(this)}});Ogma.extend(function(e){var t=new vm(e);e.modules.pathfinding=t;e.pathfinding={astar:function e(r,n,i){if(i===void 0)i={};return t.astar(r,n,i)},dijkstra:function e(r,n,i){if(i===void 0)i={};return t.dijkstra(r,n,i)},dijkstraBig:function e(r,n,i){if(i===void 0)i={};return t.dijkstraBig(r,n,i)}}});var vm=function e(t){this._graph=t.modules.graph;this._objectList=this._graph.getAttribute(true,"object")};vm.prototype.astar=function e(t,r,n){return xm(this,t,r,Za(n,pm))};vm.prototype.dijkstra=function e(t,r,n){return xm(this,t,r,Za(n,_m))};vm.prototype.dijkstraBig=function e(t,r,n){var i=dijkstra(this._graph.getAdjacencyList({directed:n.directed,ids:true,weight:1,nodes:this._graph.getNodes()}),t._index,r._index,this._graph.getNodes()._indexes,undefined,false);return i.path?new this._graph.NodeList(i.path):null};var pm={pathLengthFunction:mm,heuristicLengthFunction:mm};var _m={pathLengthFunction:ym,heuristicLengthFunction:bm};function mm(e,t){var r=e.getPosition(),n=t.getPosition();return distance(r.x,r.y,n.x,n.y)}function ym(){return 1}function bm(){return 0}function xm(e,t,r,n){if(n===void 0)n={};var i=e._graph.getNode(t)._index,a=e._graph.getNode(r)._index,o=n.pathLengthFunction,s=n.heuristicLengthFunction,u=n.filter,l=n.directed?"out":"both",d=e._objectList,f=d.get(i),h=d.get(a),c=null;if(i===a){c=[i]}else{var g=e._graph.getNodeMaxIndex()+1,v=new mt(Uint32Array),p=new mt(Uint32Array),_=new Int32Array(g),m=new Float32Array(g),y=new Float32Array(g);for(var b=0;b<g;++b){_[b]=-1;m[b]=Infinity;y[b]=Infinity}p.add(i);m[i]=0;y[i]=s(f,h);while(p.length!==0){var x=p.length,S=p.get(0),A=0,E=y[S];for(var w=1;w<x;++w){var k=p.get(w),C=y[k];if(C<E){E=C;S=k;A=w}}if(S===a){c=Sm(_,i,a);break}var T=d.get(S);p.removeByPosition(A);v.add(S);var L=new e._graph.Node(S).getAdjacentNodes({direction:l,filter:u})._indexes;for(var M=0;M<L.length;++M){var I=L[M],F=d.get(I);if(v.has(I)){continue}var N=m[S]+o(T,F);if(!p.add(I)&&N>=m[I]){continue}_[I]=S;m[I]=N;y[I]=N+s(F,h)}}}return c?new e._graph.NodeList(c):null}function Sm(e,t,r){var n=[r],i=r;while(i!==t){i=e[i];n.push(i)}n.reverse();return n}Ogma.extend(function(e){e.modules.cameraInteractions=new wm(e)});var Am=function(e){var t=e.graphWidth;var r=e.graphHeight;var n=e.viewWidth;var i=e.viewHeight;return Math.min(n/t,i/r)*.2};var Em=function(e){var t=e.smallestNodeSize;var r=e.viewWidth;var n=e.viewHeight;if(t===Infinity){return Infinity}return Math.min(r,n)/t*.5};var wm=function e(t){var r=this;this._ogma=t;this._locate=t.modules.locate;this._dom=t.modules.dom;this._camera=t.modules.camera;this._settings=t.modules.settings;this._interactions=t.modules.interactions;this._graphics=t.modules.graphics;this._settings.register("interactions.zoom.enabled",true);this._settings.register("interactions.zoom.onDoubleClick",false);this._settings.register("interactions.zoom.duration",150);this._settings.register("interactions.zoom.modifier",1.8);this._settings.register("interactions.zoom.easing","quadraticOut");this._settings.register("interactions.zoom.minValue",t._debug?null:Am);this._settings.register("interactions.zoom.maxValue",t._debug?null:Em);this._settings.register("interactions.zoom.hideNodes",false);this._settings.register("interactions.zoom.hideEdges",false);this._settings.register("interactions.zoom.hideNodeTexts",false);this._settings.register("interactions.zoom.hideEdgeTexts",false);this._settings.register("interactions.pan.enabled",true);this._settings.register("interactions.pan.hideNodes",false);this._settings.register("interactions.pan.hideEdges",false);this._settings.register("interactions.pan.hideNodeTexts",false);this._settings.register("interactions.pan.hideEdgeTexts",false);this._settings.register("interactions.rotation.enabled",true);this._settings.register("interactions.rotation.hideNodes",false);this._settings.register("interactions.rotation.hideEdges",false);this._settings.register("interactions.rotation.hideNodeTexts",false);this._settings.register("interactions.rotation.hideEdgeTexts",false);this._settings.register("interactions.gesture.enabled",true);this._settings.register("interactions.gesture.hideNodes",false);this._settings.register("interactions.gesture.hideEdges",false);this._settings.register("interactions.gesture.hideNodeTexts",false);this._settings.register("interactions.gesture.hideEdgeTexts",false);this._interactions.onMouseWheel({priority:"zoom",check:function(){return r._settings.get("interactions.zoom.enabled")},handler:R(function(e){var t=e.x;var n=e.y;var i=e.delta;return Cm(r,i,t,n)},50)});this._interactions.onDoubleClick({priority:"zoom",check:function(){var e=r._settings.get("interactions.zoom.enabled");var t=r._settings.get("interactions.zoom.onDoubleClick");return e&&t},handler:function(e){var t=e.x;var n=e.y;return Cm(r,1,t,n)}});this._interactions.onDrag({priority:"panning",disableDetection:true,check:function(e){var t=e.button;var n=r._settings.get("interactions.pan.enabled");return t==="left"&&n},onStart:function(){km(r,"pan",true)},onProgress:function(e){var t=e.dx;var n=e.dy;r._camera.move({x:-t,y:-n})},onStop:function(){km(r,"pan",false)}});this._interactions.onDrag({priority:"rotation",disableDetection:true,check:function(e){var t=e.button;var n=e.domEvent;return(t==="right"||n&&n.buttons===2)&&r._settings.get("interactions.rotation.enabled")},onStart:function(e){var t=e.x;var n=e.y;r._rotationStart={x:t,y:n};km(r,"rotation",true)},onProgress:function(e){var t=e.x;var n=e.y;r._rotate({x:t,y:n})},onStop:function(){km(r,"rotation",false)}});this._interactions.onGesture({priority:"gesture",disableDetection:true,check:function(){return r._settings.get("interactions.gesture.enabled")},onStart:function(){km(r,"gesture",true)},onProgress:function(e){var t=e.dx;var n=e.dy;var i=e.rotation;var a=e.scale;var o=e.x;var s=e.y;if(r._settings.get("interactions.rotation.enabled")){r._camera.rotate(-i)}r._camera.zoomIn(a,undefined,{x:o,y:s});r._camera.move({x:-t,y:-n})},onStop:function(){km(r,"gesture",true)}})};wm.prototype._rotate=function e(t){var r=t.x;var n=t.y;var i=this._ogma.view.getSize();var a=i.width;var o=i.height;var s=a/2;var u=o/2;var l=this._rotationStart.x-s;var d=this._rotationStart.y-u;var f=r-s;var h=n-u;var c=Math.atan2(d,l)-Math.atan2(h,f);this._rotationStart={x:r,y:n};this._camera.rotate(c)};function km(e,t,r){var value=!r;var n=e._settings.get("interactions."+t+".hideNodes");var i=e._settings.get("interactions."+t+".hideEdges");var a=e._settings.get("interactions."+t+".hideNodeTexts");var o=e._settings.get("interactions."+t+".hideEdgeTexts");if(n){e._ogma.styles.setNodesVisibility(value)}if(a){e._ogma.styles.setNodeTextsVisibility(value)}if(i){e._ogma.styles.setEdgesVisibility(value)}if(o){e._ogma.styles.setEdgeTextsVisibility(value)}}function Cm(e,t,r,n){var i=e._settings.get("interactions.zoom.modifier");var a=e._settings.get("interactions.zoom.duration");var o=e._settings.get("interactions.zoom.easing");var s=e._ogma.view.getZoom();var u=s*(t>0?i:1/i);var l={duration:a,easing:o};km(e,"zoom",true);e._camera.setZoom(u,l,{refX:r,refY:n}).then(function(){km(e,"zoom",false)})}var Tm={layer:Zl,outline:true,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}};var Lm={layer:Zl,outline:true,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}};var Mm=100;var Im=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._settings=t.modules.settings;this._captor=t.modules.captor;this._events=t.modules.events;this._delay=Mm;this._manualTriggerDetection=false;this._settings.register("cursor.node","pointer",function(value,e){if(r._hovered&&r._hovered.isNode){r._graphics.removeCursorStyle(e);r._graphics.addCursorStyle(value)}});this._settings.register("cursor.edge","pointer",function(value,e){if(r._hovered&&!r._hovered.isNode){r._graphics.removeCursorStyle(e);r._graphics.addCursorStyle(value)}});this._settings.register("nodeHover",true,function(value){if(!value&&r._hovered&&r._hovered.isNode){r._unhoverElement(r._hovered)}});this._settings.register("edgeHover",true,function(value){if(!value&&r._hovered&&!r._hovered.isNode){r._unhoverElement(r._hovered)}});this._hoverExtremityHighlightedClass=this._ogma.styles.createClass({name:Bl,isBuiltin:true,nodeAttributes:Tm});this._hoverClass=this._ogma.styles.createClass({name:Ol,isBuiltin:true,nodeAttributes:Tm,edgeAttributes:Lm});var n=function(){r._hoverExtremityHighlightedClass.clearNodes();r._hoverClass.getEdges().getExtremities().addClass(Bl)};this._ogma.events.onEdgesClassAdded(Ol,n);this._ogma.events.onEdgesClassRemoved(Ol,n);this._timeout=null;this._hovered=null;this._events.on({hover:function(e){var t=e.target;return r._hoverElement(t)},unhover:function(e){var t=e.target;return r._unhoverElement(t)},animate:function(e){var t=e.duration;if(t){r._manualTriggerDetection=true;r._resetHover()}},beforeNewFrame:function(){if(r._manualTriggerDetection&&!r._graphics.isAnimating()){r._manualTriggerDetection=false;r._captor.triggerDetection();var e=r._captor.getPointedElement();if(e){r._hoverElement(e)}}},mouseLeave:function(){r._resetHover()},clear:function(){r._hovered=null;if(r._timeout){r._dom.clearTimeout(r._timeout)}}})};Im.prototype._resetHover=function e(){if(this._hovered){this._unhoverElement(this._hovered);this._captor.triggerUnhover()}if(this._timeout){this._dom.clearTimeout(this._timeout);this._timeout=null}};Im.prototype.updateNodeAttributes=function e(t,r){this._hoverClass.update({nodeAttributes:t,fullOverwrite:r});this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:r});this._updateExtremityHighlightLayer()};Im.prototype.updateEdgeAttributes=function e(t,r){this._hoverClass.update({edgeAttributes:t,fullOverwrite:r});this._updateExtremityHighlightLayer()};Im.prototype._updateExtremityHighlightLayer=function e(){var t=this._hoverClass.getDefinition().edgeAttributes;var r=t?t.layer:undefined;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:r},fullOverwrite:false})};Im.prototype.setRate=function e(t){this._delay=t};Im.prototype._removeTimeout=function e(){if(this._timeout){this._dom.clearTimeout(this._timeout);this._timeout=null}};Im.prototype._isAnimating=function e(){return this._graphics.isAnimating()};Im.prototype._hoverElement=function e(t){var r=this;var n=t.isNode?"nodeHover":"edgeHover";var i=this._settings.get(n);if(!i||this._isAnimating()){return}this._removeTimeout();this._timeout=this._dom.setTimeout(function(){if(!r._isAnimating()){r._setElementHighlight(true,t);r._hovered=t}r._timeout=null},this._delay)};Im.prototype._unhoverElement=function e(t){this._removeTimeout();if(this._hovered===t){this._setElementHighlight(false,t);this._hovered=null}};Im.prototype._setElementHighlight=function e(t,r){var n=this._settings.get(r.isNode?"cursor.node":"cursor.edge");if(t){this._graphics.addCursorStyle(n);r.addClass(Ol)}else{this._graphics.removeCursorStyle(n);r.removeClass(Ol)}if(r.isNode&&t){this._graph.getAttribute(r.isNode,"textHidden").set(r._index,false)}};Ogma.extend(function(e){e.modules.hover=new Im(e);e.styles.setHoveredNodeAttributes=function(t,r){return e.modules.hover.updateNodeAttributes(t,r)};e.styles.setHoveredEdgeAttributes=function(t,r){return e.modules.hover.updateEdgeAttributes(t,r)}});var Fm={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2};var Nm={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2};Ogma.extend(function(e){var t=e.Node;var r=e.Edge;var n=e.NodeList;var i=e.EdgeList;var a=new zm(e);e.modules.pulses=a;t.prototype.pulse=function(e){a.pulse(this,e)};n.prototype.pulse=function(e){a.pulse(this,e)};r.prototype.pulse=function(e){a.pulse(this,e)};i.prototype.pulse=function(e){a.pulse(this,e)}});var zm=function e(t){var r=this;this._graph=t.modules.graph;this._dom=t.modules.dom;this._graphics=t.modules.graphics;this._events=t.modules.events;this._events.on("updateAttributes",function(e){return r._onAttributeChange(e)});this._events.on("newFrame",function(){return r._refreshPulses()});this._events.on("beforeRemoveEdges beforeRemoveNodes",function(e){var t=e.nodes;var r=e.edges;(t||r).setAttribute("pulse.enabled",false)});this._events.on("clear",function(){return r._hasPulses.clear()});this._engine=this._graphics.getGraphicsEngine();this._block=this._engine.createBlock();var n=this._graph;this._nodePulses=n.createNodeAttribute({storage:"any"});this._edgePulses=n.createEdgeAttribute({storage:"any"});this._nodeNbPulsesRemaining=n.createNodeAttribute({storage:"int16",default:-1});this._edgeNbPulsesRemaining=n.createEdgeAttribute({storage:"int16",default:-1});this._nodeDurationList=n.getAttribute(true,"pulse.duration");this._nodeIntervalList=n.getAttribute(true,"pulse.interval");this._nodeStartColorList=n.getAttribute(true,"pulse.startColor");this._nodeEndColorList=n.getAttribute(true,"pulse.endColor");this._nodePulseWidthList=n.getAttribute(true,"pulse.width");this._nodeStartRatioList=n.getAttribute(true,"pulse.startRatio");this._nodeEndRatioList=n.getAttribute(true,"pulse.endRatio");this._nodeXList=n.getAttribute(true,"x");this._nodeYList=n.getAttribute(true,"y");this._nodeRadiusList=n.getAttribute(true,"radius");this._nodeColorList=n.getAttribute(true,"color");this._nodeLayerList=n.getAttribute(true,"layer");this._nodeScalingMethodList=n.getAttribute(true,"scalingMethod");this._edgeDurationList=n.getAttribute(false,"pulse.duration");this._edgeIntervalList=n.getAttribute(false,"pulse.interval");this._edgeStartColorList=n.getAttribute(false,"pulse.startColor");this._edgeEndColorList=n.getAttribute(false,"pulse.endColor");this._edgePulseWidthList=n.getAttribute(false,"pulse.width");this._edgeStartRatioList=n.getAttribute(false,"pulse.startRatio");this._edgeEndRatioList=n.getAttribute(false,"pulse.endRatio");this._edgeWidthList=n.getAttribute(false,"width");this._edgeColorList=n.getAttribute(false,"color");this._edgeLayerList=n.getAttribute(false,"layer");this._edgeSourceList=n.getAttribute(false,"source");this._edgeTargetList=n.getAttribute(false,"target");this._edgeCurvatureList=n.getAttribute(false,"curvature");this._edgeScalingMethodList=n.getAttribute(false,"scalingMethod");this._hasPulses=new Cr(t)};zm.prototype._onAttributeChange=function e(t){var r=t.nodes;var n=t.edges;var i=t.nodeAttributes;var a=t.edgeAttributes;this._onElementsAttributeChange(r,i);this._onElementsAttributeChange(n,a)};zm.prototype._onElementsAttributeChange=function e(t,r){if(r.includes("pulse.enabled")){var n=this._graph.splitElements(t,function(e){return e.getAttribute("pulse.enabled")});var i=n.valid;var a=n.invalid;this._hasPulses.removeElements(a);this._hasPulses.addElements(i);this._removePulses(a)}};zm.prototype._removePulses=function e(t){var r=t.isNode?this._nodePulses:this._edgePulses;for(var n=0,i=t._indexes;n<i.length;n+=1){var a=i[n];var o=r.get(a);if(o){for(var s=0,u=o;s<u.length;s+=1){var l=u[s];this._graphics.releaseGraphicsEngineBlockId(l.blockId)}r.set(a,null)}}};zm.prototype._refreshPulses=function e(){var t=this._hasPulses.getElements();var r=t.nodes;var n=t.edges;if(r.size!==0||n.size!==0){var i=this._engine.getCurrentTime();this._refreshElementsPulses(r,i);this._refreshElementsPulses(n,i);this._dom.refresh()}};zm.prototype._refreshElementsPulses=function e(t,r){var n=t.isNode;var i=n?this._nodePulses:this._edgePulses;var a=n?this._nodeDurationList:this._edgeDurationList;var o=n?"_createNodePulseBlock":"_createEdgePulseBlock";var s=n?this._nodeIntervalList:this._edgeIntervalList;var u=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;for(var l=0,d=t._indexes;l<d.length;l+=1){var f=d[l];var h=i.get(f);if(!h){h=[];i.set(f,h)}for(var c=0;c<h.length;c++){var g=h[c];var v=g.startTime;var p=g.duration;var _=g.blockId;if(r>=v+p){this._graphics.releaseGraphicsEngineBlockId(_);h.splice(c--,1)}}var m=h[h.length-1];if(!m||r>=m.startTime+s.get(f)){var y=a.get(f);var b=u.get(f);if(b!==0){h.push({blockId:this[o](f,r,y),startTime:r,duration:y})}if(b>0){u.set(f,b-1)}}}};zm.prototype._createNodePulseBlock=function e(t,r,n){var i=this._nodeColorList.get(t);var a=this._nodeLayerList.get(t);var o=this._nodeXList.get(t);var s=this._nodeYList.get(t);var u=this._nodeRadiusList.get(t);var l=this._nodeScalingMethodList.get(t)==="scaled";var d=this._nodeStartRatioList.get(t);var f=this._nodeEndRatioList.get(t);var h=this._nodePulseWidthList.get(t);var c=u*2*d;var g=u*2*f;var v=Hd(a).nodeBody;var p=this._nodeStartColorList.get(t);var _=this._nodeEndColorList.get(t);var m=this._graphics.allocateGraphicsEngineBlockId();var y=this._block.reset(ls,true,v);var b=y.nextAndReset();var x=wd(p,i);var S=wd(_,i);b.end.shape="circle";b.end.pieceId=ys;b.end.x1=o;b.end.y1=s;b.end.x2=o;b.end.y2=s;b.end.rectWidthOrSourceRadiusScaled=l?g:0;b.end.rectHeightTargetRadiusScaled=l?g:0;b.end.rectWidthOrSourceRadiusFixed=!l?g:0;b.end.rectHeightTargetRadiusFixed=!l?g:0;b.end.strokeWidthFixed=h;b.end.strokeColor=S;b.start.shape="circle";b.start.pieceId=ys;b.start.x1=o;b.start.y1=s;b.start.x2=o;b.start.y2=s;b.start.rectWidthOrSourceRadiusScaled=l?c:0;b.start.rectHeightTargetRadiusScaled=l?c:0;b.start.rectWidthOrSourceRadiusFixed=!l?c:0;b.start.rectHeightTargetRadiusFixed=!l?c:0;b.start.strokeWidthFixed=h;b.start.strokeColor=x;b.animation.duration=n;b.animation.beginTime=r;this._engine.storeBlock(m,y);return m};zm.prototype._createEdgePulseBlock=function e(t,r,n){var i=this._edgeStartRatioList.get(t);var a=this._edgeEndRatioList.get(t);var o=this._edgeStartColorList.get(t);var s=this._edgeEndColorList.get(t);var u=this._edgeLayerList.get(t);var l=Hd(u).edgeBody;var d=this._edgeSourceList.get(t);var f=this._edgeTargetList.get(t);var h=this._edgeCurvatureList.get(t);var c=h!==0;var g=this._graphics.allocateGraphicsEngineBlockId();var v=this._block.reset(c?fs:ls,true,l);var p=v.nextAndReset();var _={isSelfLoop:d===f,curvature:h,sourceX:this._nodeXList.get(d),sourceY:this._nodeYList.get(d),targetX:this._nodeXList.get(f),targetY:this._nodeYList.get(f),sourceRadius:this._nodeRadiusList.get(d),targetRadius:this._nodeRadiusList.get(f),isSourceRadiusScaled:this._nodeScalingMethodList.get(d)==="scaled",isTargetRadiusScaled:this._nodeScalingMethodList.get(f)==="scaled",width:this._edgeWidthList.get(t),isWidthScaled:this._edgeScalingMethodList.get(t)==="scaled",strokeWidth:this._edgePulseWidthList.get(t)};Rm(p.start,_);Rm(p.end,_);p.start.strokeColor=o;p.end.strokeColor=s;p.start.thicknessOrFontSizeScaled*=i;p.start.thicknessOrFontSizeFixed*=i;p.end.thicknessOrFontSizeScaled*=a;p.end.thicknessOrFontSizeFixed*=a;p.animation.duration=n;p.animation.beginTime=r;this._engine.storeBlock(g,v);return g};zm.prototype.pulse=function e(t,r){var n=t.isNode;var i=Za(r,n?Fm:Nm);var a=i.number;var o=i.interval;var s=i.duration;var u=n?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining;var l=(a-1)*o+s;delete i.number;i.enabled=true;t.setAttributes({pulse:i});u.setMultiple(t._indexes,a);this._dom.setTimeout(function(){t.setAttribute("pulse.enabled",false);u.setMultiple(t._indexes,-1)},l)};function Rm(e,t){e.pieceId=bs;e.shape="line";e.x1=t.sourceX;e.y1=t.sourceY;e.x2=t.targetX;e.y2=t.targetY;e.rectWidthOrSourceRadiusScaled=t.isSourceRadiusScaled?t.sourceRadius:0;e.rectWidthOrSourceRadiusFixed=t.isSourceRadiusScaled?0:t.sourceRadius;e.rectHeightTargetRadiusScaled=t.isTargetRadiusScaled?t.targetRadius:0;e.rectHeightTargetRadiusFixed=t.isTargetRadiusScaled?0:t.targetRadius;e.thicknessOrFontSizeScaled=t.isWidthScaled?t.width:0;e.thicknessOrFontSizeFixed=t.isWidthScaled?0:t.width;e.strokeWidthFixed=t.strokeWidth;e.curvature=t.curvature;e.isSelfLoop=t.isSelfLoop}var Pm={layer:Yl,outline:true,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}};var Dm={layer:Yl,color:"red",outline:true,text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}};var Om=function e(t){var r=this;this._ogma=t;this._events=t.modules.events;this._settings=t.modules.settings;this._graph=t.modules.graph;this._keyboard=t.modules.keyboard;this._graphics=t.modules.graphics;this._interactions=t.modules.interactions;this._selectionExtremityHighlightedClass=this._ogma.styles.createClass({name:Vl,isBuiltin:true,nodeAttributes:Pm});this._selectedClass=this._ogma.styles.createClass({name:jl,isBuiltin:true,nodeAttributes:Pm,edgeAttributes:Dm});var n=function(){r._selectionExtremityHighlightedClass.clearNodes();r._selectedClass.getEdges().getExtremities().addClass(Vl)};this._ogma.events.onEdgesClassAdded(jl,n);this._ogma.events.onEdgesClassRemoved(jl,n);this._settings.register("interactions.selection.enabled",true);this._settings.register("interactions.selection.multiSelectionKey","ctrl");this._interactions.onClick({priority:"selection",check:function(e){var t=e.button;var n=r._settings.get("interactions.selection.enabled");return t==="left"&&n&&!r._graphics.isAnimating()},handler:function(e){var t=e.target;if(!t){r._selectedClass.clearNodes();r._selectedClass.clearEdges()}else{var n=r._settings.get("interactions.selection.multiSelectionKey");var i=n&&r._keyboard.isPressed(n);if(t.isNode){r._selectedClass.clearEdges()}else{r._selectedClass.clearNodes()}if(!i){var a=t.isNode?r._selectedClass.getNodes():r._selectedClass.getEdges();a.filter(function(e){return e!==t}).removeClass(jl);if(!t.hasClass(jl)){t.addClass(jl)}}else if(t.hasClass(jl)){t.removeClass(jl)}else{t.addClass(jl)}}}});this._events.on("beforeRemoveEdges",function(e){var t=e.edges;return t.setSelected(false)})};Om.prototype.setNodeAttributes=function e(t,r){this._selectedClass.update({nodeAttributes:t,fullOverwrite:r});this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:r});this._updateExtremityHighlightLayer()};Om.prototype.setEdgeAttributes=function e(t,r){this._selectedClass.update({edgeAttributes:t,fullOverwrite:r});this._updateExtremityHighlightLayer()};Om.prototype._updateExtremityHighlightLayer=function e(){var t=this._selectedClass.getDefinition().edgeAttributes;var r=t?t.layer:undefined;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:r},fullOverwrite:false})};Om.prototype.setActive=function e(t,r){if(C(r)){var n=function(e,t){return r[t]?"toSelect":"toUnselect"};var i=n.toSelect;var a=n.toUnselect;if(i){i.addClass(jl)}if(a){i.removeClass(jl)}}else{t[r?"addClass":"removeClass"](jl)}};Om.prototype.areActive=function e(t){return t.hasClass(jl)};Om.prototype.getSelectedNodes=function e(){return this._selectedClass.getNodes()};Om.prototype.getSelectedEdges=function e(){return this._selectedClass.getEdges()};Om.prototype.getNonSelectedNodes=function e(){return this._graph.getNodes().filter(function(e){return!e.hasClass(jl)})};Om.prototype.getNonSelectedEdges=function e(){return this._graph.getEdges().filter(function(e){return!e.hasClass(jl)})};Om.prototype.clear=function e(){this._selectedClass.clearNodes();this._selectedClass.clearEdges()};Ogma.extend(function(e){var t=new Om(e);var r=e.Node;var n=e.Edge;var i=e.NodeList;var a=e.EdgeList;e.modules.selection=t;e.events.onNodesSelected=function(t){return e.events.onNodesClassAdded(jl,t)};e.events.onNodesUnselected=function(t){return e.events.onNodesClassRemoved(jl,t)};e.events.onEdgesSelected=function(t){return e.events.onEdgesClassAdded(jl,t)};e.events.onEdgesUnselected=function(t){return e.events.onEdgesClassRemoved(jl,t)};e.styles.setSelectedNodeAttributes=function(e,r){return t.setNodeAttributes(e,r)};e.styles.setSelectedEdgeAttributes=function(e,r){return t.setEdgeAttributes(e,r)};e.clearSelection=function(){return t.clear()};e.getSelectedNodes=function(){return t.getSelectedNodes()};e.getNonSelectedNodes=function(){return t.getNonSelectedNodes()};e.getSelectedEdges=function(){return t.getSelectedEdges()};e.getNonSelectedEdges=function(){return t.getNonSelectedEdges()};r.prototype.setSelected=function(e){t.setActive(this,e)};r.prototype.isSelected=function(){return t.areActive(this)};i.prototype.setSelected=function(e){t.setActive(this,e)};i.prototype.isSelected=function(){return t.areActive(this)};n.prototype.setSelected=function(e){t.setActive(this,e)};n.prototype.isSelected=function(){return t.areActive(this)};a.prototype.setSelected=function(e){t.setActive(this,e)};a.prototype.isSelected=function(){return t.areActive(this)}});Ogma.extend(function(e){e.modules.drag=new Bm(e);e.events.onNodeDragStart=function(t){e.modules.events.on("startMoveNodesByDragging",t);return e.events};e.events.onNodeDragProgress=function(t){e.modules.events.on("progressMoveNodesByDragging",t);return e.events};e.events.onNodeDragEnd=function(t){e.modules.events.on("endMoveNodesByDragging",t);return e.events}});var Bm=function e(t){var r=this;this._graph=t.modules.graph;this._camera=t.modules.camera;this._graphics=t.modules.graphics;this._selection=t.modules.selection;this._events=t.modules.events;this._settings=t.modules.settings;this._captor=t.modules.captor;t.styles.createClass({name:Ul,isBuiltin:true,nodeAttributes:{layer:Kl}});this._events.register(["startMoveNodesByDragging","progressMoveNodesByDragging","endMoveNodesByDragging"]);this._settings.register("interactions.drag.enabled",true);this._settings.register("interactions.drag.cursor","move");this._settings.register("interactions.drag.onBeforeDrag",null);this._settings.register("interactions.drag.applyResult",true);this._dragged=null;this._start=null;this._end=null;this._startDrag=null;t.modules.interactions.onDrag({priority:"drag",disableDetection:true,check:function(e){var t=e.target;var n=e.button;var i=n==="left";var a=r._settings.get("interactions.drag.enabled");var o=t&&t.isNode&&t.getAttribute("draggable");return i&&a&&o},onStart:function(e){var t=e.x;var n=e.y;var i=e.target;if(i.isSelected()){r._dragged=r._selection.getSelectedNodes().filter(function(e){return e.getAttribute("draggable")})}else{r._dragged=i.toList()}r._start=r._dragged.getPosition();r._end=G(r._start);r._onBeforeDrag=r._settings.get("interactions.drag.onBeforeDrag");r._startDrag=r._camera.screenToGraphCoordinates({x:t,y:n});r._dragged.addClass(Ul);r._events.fire("startMoveNodesByDragging",{nodes:r._dragged});r._graphics.addCursorStyle(r._settings.get("interactions.drag.cursor"))},onProgress:function(){var e=r._captor.getCursorInformation();var t=e.x;var n=e.y;var i=r._dragged._indexes;var a=r._camera.screenToGraphCoordinates({x:t,y:n});var o=a.x-r._startDrag.x;var s=a.y-r._startDrag.y;for(var u=0;u<i.length;++u){var l=r._start[u];var d=r._end[u];d.x=l.x+o;d.y=l.y+s}if(r._onBeforeDrag){r._onBeforeDrag(r._dragged,t,n,r._end)}if(r._settings.get("interactions.drag.applyResult")){r._dragged.setAttributes(r._end,null,["x","y"])}r._events.fire("progressMoveNodesByDragging",{nodes:r._dragged,dx:o,dy:s})},onStop:function(){r._dragged.removeClass(Ul);r._graphics.removeCursorStyle(r._settings.get("interactions.drag.cursor"));r._events.fire("endMoveNodesByDragging",{nodes:r._dragged,start:r._start,end:r._end});r._dragged=null;r._start=null;r._end=null}})};Ogma.extend(function(e){var t=new Vm(e);e.modules.filters=t;Object.assign(e.transformations,{addNodeFilter:function e(r){return t.addNodeFilter(r)},addEdgeFilter:function e(r){return t.addEdgeFilter(r)}});Object.assign(e,{addNodeFilter:function t(r){return e.transformations.addNodeFilter(r)},addEdgeFilter:function t(r){return e.transformations.addEdgeFilter(r)},getNodeFilters:function t(){return e.transformations.getList().filter(function(e){return e.getName()==="node-filter"})},getEdgeFilters:function t(){return e.transformations.getList().filter(function(e){return e.getName()==="edge-filter"})},clearNodeFilters:function t(){return Promise.all(e.getNodeFilters().map(function(e){return e.destroy()}))},clearEdgeFilters:function t(){return Promise.all(e.getEdgeFilters().map(function(e){return e.destroy()}))}})});function jm(e){if(typeof e!=="object"){return{criteria:e,enabled:true,duration:0}}else{return e}}var Vm=function e(t){this._transformations=t.modules.transformations};Vm.prototype.addNodeFilter=function e(t){var r=jm(t);var n=r.criteria;var i=r.enabled;var a=r.duration;return this._transformations.add(new Gm(n),{enabled:i,duration:a})};Vm.prototype.addEdgeFilter=function e(t){var r=jm(t);var n=r.criteria;var i=r.enabled;var a=r.duration;return this._transformations.add(new Wm(n),{enabled:i,duration:a})};var Um=function e(t){this._getNodesToFilter=t.getNodesToFilter;this._getEdgesToFilter=t.getEdgesToFilter};Um.prototype.run=function e(t){var r=t.ogma;var n=t.duration;var i=this._getNodesToFilter(r);var a=this._getEdgesToFilter(r,i);return Promise.all([i.addClass(Xl,n),a.addClass(Xl,n)]).then(function(){i.setExcluded(true);a.setExcluded(true);return{nodes:i,edges:a}})};Um.prototype.undo=function e(t){var r=t.duration;var n=t.context;var i=n.nodes;var a=n.edges;i.setExcluded(false);a.setExcluded(false);i.addClass(Xl);a.addClass(Xl);return Promise.all([i.removeClass(Xl,r),a.removeClass(Xl,r)])};var Gm=function(e){function t(t){e.call(this,{getNodesToFilter:function(e){return e.getNodes().filter(function(e){return!t(e)})},getEdgesToFilter:function(e,t){return t.getAdjacentEdges()}})}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getName=function e(){return"node-filter"};return t}(Um);var Wm=function(e){function t(t){e.call(this,{getNodesToFilter:function(e){return e.createNodeList()},getEdgesToFilter:function(e){return e.getEdges().filter(function(e){return!t(e)})}})}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getName=function e(){return"edge-filter"};return t}(Um);var Hm=function e(t){this._nodeSelector=t.nodeSelector;this._nodeGroupIdFunction=t.nodeGroupIdFunction;this._nodeGenerator=t.nodeGenerator;this._edgeSelector=t.edgeSelector;this._edgeGroupIdFunction=t.edgeGroupIdFunction;this._edgeGenerator=t.edgeGenerator;this._edgeSource=t.edgeSource;this._edgeTarget=t.edgeTarget;this._separateEdgesByDirection=t.separateEdgesByDirection;this._groupSelfLoopEdges=t.groupSelfLoopEdges;this._groupEdges=t.groupEdges};Hm.prototype._computeNodeGroupId=function e(t){return this._nodeSelector(t)?this._nodeGroupIdFunction(t):undefined};Hm.prototype._computeEdgeGroupId=function e(t){return this._edgeSelector(t)?this._edgeGroupIdFunction(t):undefined};Hm.prototype._addMetaNodes=function e(t,r){var n=r.getId();var i=t.getNodes();var a=new pt;for(var o=0;o<i.size;++o){var s=i.get(o);var u=this._computeNodeGroupId(s);if(u!==undefined){var l=a.get(u);if(!l){l={id:u,nodes:[]};a.set(u,l)}l.nodes.push(s)}}var d=a.values();var f=d.map(function(e){var r=e.nodes;return t.getNodes(r)});var h=[];for(var c=0;c<d.length;++c){var g=d[c].id;var v=f[c];var p=this._nodeGenerator(v,g,r);if(p.id===undefined){p.id=Zm(g,n)}p.position=qr(v.getPosition());h.push(p)}return t.addNodes(h.map(function(e){return{id:e.id,attributes:e.position}}),{virtual:true}).then(function(){var e=t.getNodes(h.map(function(e){return e.id}));e.replaceOriginalAttributes(h.map(function(e){return e.attributes}),["x","y"]);e.setData(null,h.map(function(e){return e.data}));e.setVisible(true);t.modules.grouping.setSubElements(e,f);f.forEach(function(r,n){t.modules.grouping.setMetaElement(r,e.get(n))});return e})};Hm.prototype._addMetaEdges=function e(t,r){var n=r.getId();var i=t.getEdges();var a=new pt;var o=t.modules.graphics.getAttributesManager().getUsedEdgeAttributes();for(var s=0;s<i.size;++s){var u=i.get(s);var l=this._computeEdgeGroupId(u);if(l!==undefined){var d=this._edgeSource(u);var f=this._edgeTarget(u);var h=this._groupEdges?qm(l,d.getId(),f.getId(),this._separateEdgesByDirection):u.getId();var c=a.get(h);if(!c){c={id:h,source:d,target:f,edges:[]};a.set(h,c)}c.edges.push(u)}}var g=a.values();var v=g.map(function(e){var r=e.edges;return t.getEdges(r)});var p=[];for(var _=0;_<g.length;++_){var m=g[_];var y=m.id;var b=v[_];var x=this._groupEdges?this._edgeGenerator(b,y,r):Ym(b,o);if(x.id===undefined){x.id=Zm(y,n)}x.source=m.source;x.target=m.target;p.push(x)}return t.addEdges(Xm(p),{virtual:true}).then(function(){var e=t.getEdges(p.map(function(e){return e.id}));e.replaceOriginalAttributes(p.map(function(e){return e.attributes}));e.setData(null,p.map(function(e){return e.data}));e.setVisible(true);t.modules.grouping.setSubElements(e,v);v.forEach(function(r,n){t.modules.grouping.setMetaElement(r,e.get(n))});return e})};function Xm(e){return e.map(function(e){var t=e.id;var r=e.source;var n=e.target;return{id:t,source:r,target:n}})}function qm(e,t,r,n){var i=t;var a=r;if(!n&&i.toString()>a.toString()){i=r;a=t}return e+"["+i+"-"+a+"]"}function Ym(e,t){var r=e.get(0);return{data:r.getData(),attributes:r.getAttributes(t)}}function Zm(e,t){return"gen_grp_"+t+"_"+e}var Km=function(e){function t(t){var r=t.selector;if(r===void 0)r=function(){return true};var n=t.groupIdFunction;if(n===void 0)n=function(){return""};var i=t.nodeGenerator;if(i===void 0)i=function(){return{}};var a=t.edgeGenerator;if(a===void 0)a=function(){return{}};var o=t.separateEdgesByDirection;if(o===void 0)o=false;var s=t.groupSelfLoopEdges;if(s===void 0)s=false;var u=t.groupEdges;if(u===void 0)u=true;var l=t.restorePositions;if(l===void 0)l=true;e.call(this,{nodeSelector:r,nodeGroupIdFunction:n,nodeGenerator:i,edgeSelector:function(e){return e.getSource().getMetaNode()||e.getTarget().getMetaNode()},edgeGroupIdFunction:function(){return""},edgeGenerator:a,edgeSource:function(e){return Qm(e.getSource())},edgeTarget:function(e){return Qm(e.getTarget())},separateEdgesByDirection:o,groupEdges:u});this._groupSelfLoopEdges=s;this._restorePositions=l}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getName=function e(){return"node-grouping"};t.prototype.run=function e(t){var r=this;var n=t.ogma;var i=t.duration;var a=t.wrapper;var o,s,u,l,d;return this._addMetaNodes(n,a).then(function(e){o=e;o.setVisible(false);return r._addMetaEdges(n,a)}).then(function(e){s=e;s.setVisible(false);u=o.getSubNodes().reduce(function(e,value){return e.concat(value)},n.createNodeList());l=s.getSubEdges().reduce(function(e,value){return e.concat(value)},n.createEdgeList());var t=n.getNodes(u.getMetaNode()).getPosition();d=u.getPosition().map(function(e,r){var n=t[r];return{x:e.x-n.x,y:e.y-n.y}});return u.setAttributes(t,i)}).then(function(){u.setVisible(false);l.setVisible(false);o.setVisible(true);s.filter(function(e){return r._groupSelfLoopEdges||e.getSource()!==e.getTarget()}).setVisible(true);return{metaNodes:o,metaEdges:s,subNodes:u,subEdges:l,offsets:d}})};t.prototype.undo=function e(t){var r=this;var n=t.ogma;var i=t.duration;var a=t.context;var o=a.metaNodes;var s=a.metaEdges;var u=a.subNodes;var l=a.subEdges;var d=a.offsets;var f=n.getNodes(u.getMetaNode()).getPosition();var h=f.map(function(e,t){return Jm(e,d[t])});u.setVisible(true);l.setVisible(true);n.modules.grouping.setMetaElement(u,null);n.modules.grouping.setMetaElement(l,null);o.setVisible(false);s.setVisible(false);return u.setAttributes(f).then(function(){if(r._restorePositions){return u.setAttributes(h,i)}})};t.prototype.cleanup=function e(t){var r=t.ogma;var n=t.context;var i=n.metaNodes;var a=n.metaEdges;var o=i.filter(function(e){return!e.isVisible()});var s=a.filter(function(e){return!e.isVisible()});return Promise.all([r.removeEdges(s,{virtual:true}),r.removeNodes(o,{virtual:true})])};return t}(Hm);function Qm(e){return e.getMetaNode()||e}function Jm(e,t){return{x:e.x+t.x,y:e.y+t.y}}var $m=function(e){function t(t){var r=t.selector;if(r===void 0)r=function(){return true};var n=t.groupIdFunction;if(n===void 0)n=function(){return""};var i=t.generator;if(i===void 0)i=function(){return{}};var a=t.separateEdgesByDirection;if(a===void 0)a=false;e.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:r,edgeGroupIdFunction:n,edgeGenerator:i,edgeSource:function(e){return e.getSource()},edgeTarget:function(e){return e.getTarget()},separateEdgesByDirection:a,groupEdges:true})}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.getName=function e(){return"edge-grouping"};t.prototype.run=function e(t){var r=t.ogma;var n=t.wrapper;var i,a;return this._addMetaEdges(r,n).then(function(e){i=e;a=i.getSubEdges().reduce(function(e,value){return e.concat(value)},r.createEdgeList());a.setVisible(false);return{metaEdges:i,subEdges:a}})};t.prototype.undo=function e(t){var r=t.context;var n=r.metaEdges;var i=r.subEdges;i.setVisible(true);n.setVisible(false)};t.prototype.cleanup=function e(t){var r=t.ogma;var n=t.context;var i=n.metaEdges;return r.removeEdges(i.filter(function(e){return!e.isVisible()}),{virtual:true})};return t}(Hm);Ogma.extend(function(e){var t=e.Node;var r=e.NodeList;var n=e.Edge;var i=e.EdgeList;var a=new ey(e);e.modules.grouping=a;e.transformations.addNodeGrouping=function(e){return a.addNodeGrouping(e)};e.transformations.addEdgeGrouping=function(e){return a.addEdgeGrouping(e)};t.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]};r.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)};t.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]};r.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)};n.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]};i.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)};n.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]};i.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)}});var ey=function e(t){this._ogma=t;this._graph=t.modules.graph;this._transformations=t.modules.transformations;this._subNodesList=this._graph.createNodeAttribute({storage:"any",default:null});this._subEdgesList=this._graph.createEdgeAttribute({storage:"any",default:null});this._metaNodeList=this._graph.createNodeAttribute({storage:"any",default:null});this._metaEdgeList=this._graph.createEdgeAttribute({storage:"any",default:null})};ey.prototype._fetchSubEltsList=function e(t){return t.isNode?this._subNodesList:this._subEdgesList};ey.prototype._fetchMetaEltList=function e(t){return t.isNode?this._metaNodeList:this._metaEdgeList};ey.prototype.setSubElements=function e(t,r){this._fetchSubEltsList(t).setMultiple(t._indexes,r)};ey.prototype.setMetaElement=function e(t,r){this._fetchMetaEltList(t).setMultiple(t._indexes,r)};ey.prototype.getSubElements=function e(t){return this._fetchSubEltsList(t).getMultiple(t._indexes)};ey.prototype.getMetaElement=function e(t){return this._fetchMetaEltList(t).getMultiple(t._indexes)};ey.prototype.addNodeGrouping=function e(t){if(t===void 0)t={};return this._transformations.add(new Km(t),t)};ey.prototype.addEdgeGrouping=function e(t){if(t===void 0)t={};return this._transformations.add(new $m(t),t)};var ty=function e(t){this._transformations=t.modules.transformations};ty.prototype.addNodeCollapsing=function e(t){if(t===void 0)t={};return this._transformations.add(new ry(t),t)};var ry=function e(t){var r=t.selector;if(r===void 0)r=function(){return false};var n=t.edgeGenerator;if(n===void 0)n=function(){return{}};this._selector=r;this._edgeGenerator=n};ry.prototype.getName=function e(){return"node-collapsing"};ry.prototype.run=function e(t){var r=this;var n=t.ogma;var i=t.duration;var a=n.getNodes().filter(this._selector);var o=a.getAdjacentEdges();var s=[];for(var u=0;u<a.size;++u){var l=a.get(u);var d=l.getAdjacentNodes().filter(function(e){return!r._selector(e)});for(var f=0;f<d.size-1;++f){var h=d.get(f);var c=n.modules.graph.getEdgesBetweenTwoNodes(l,h);if(h===l){continue}for(var g=f+1;g<d.size;++g){var v=d.get(g);var p=n.modules.graph.getEdgesBetweenTwoNodes(l,v);var _=this._edgeGenerator(l,h,v,c,p);if(_){var m=T(_);for(var y=0;y<m.length;++y){var b=m[y];ny(n,b,y,l,h,v,c,p);s.push(b)}}}}}return n.addEdges(s,{virtual:true}).then(function(e){return e.addClass(Hl)}).then(function(e){return Promise.all([e.removeClass(Hl,i),a.addClass(Hl,i),o.addClass(Hl,i)])}).then(function(e){var t=e[0];a.setVisible(false);o.setVisible(false);return{virtualEdges:t,hiddenNodes:a,hiddenEdges:o}})};ry.prototype.undo=function e(t){var r=t.duration;var n=t.context;var i=n.virtualEdges;var a=n.hiddenNodes;var o=n.hiddenEdges;a.setVisible(true);o.setVisible(true);return Promise.all([a.addClass(Hl),o.addClass(Hl)]).then(function(){return Promise.all([a.removeClass(Hl,r),o.removeClass(Hl,r),i.addClass(Hl,r)])}).then(function(){i.setVisible(false)})};ry.prototype.cleanup=function e(t){var r=t.ogma;var n=t.context;return r.removeEdges(n.virtualEdges.filter(function(e){return!e.isVisible()}),{virtual:true})};function ny(e,t,r,n,i,a,o,s){var u=null;var l=null;if(t.source!==undefined){u=e.getNode(t.source);if(u!==i&&u!==a){throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+t.source+"]","expected to be ["+i.getId()+"] or ["+a.getId()+"]"].join("; "))}}if(t.target!==undefined){l=e.getNode(t.target);if(l!==i&&l!==a){throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+t.target+"]","expected to be ["+i.getId()+"] or ["+a.getId()+"]"].join("; "))}}if(u&&l&&u===l){throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+u.getId()+"]")}if(u&&!l){l=u===i?a:i}else if(l&&!u){u=l===i?a:i}else if(!u&&!l){var d=true;for(var f=0;f<o.size;++f){var h=o.get(f);if(h.getSource()===i){d=false}}for(var c=0;c<s.size;++c){var g=s.get(c);if(g.getTarget()===a){d=false}}if(d){u=a;l=i}else{u=i;l=a}}t.id="_gen_"+n.getId()+"_"+u.getId()+"_"+l.getId()+"_"+r;t.source=u;t.target=l}Ogma.extend(function(e){e.modules.nodeCollapsing=new ty(e);Object.assign(e.transformations,{addNodeCollapsing:function t(r){return e.modules.nodeCollapsing.addNodeCollapsing(r)}})});var iy=function e(t){var r=t.nodeSelector;if(r===void 0)r=function(){return true};var n=t.edgeSelector;if(n===void 0)n=function(){return true};var i=t.nodeDataFunction;if(i===void 0)i=null;var a=t.edgeDataFunction;if(a===void 0)a=null;this._nodeSelector=r;this._edgeSelector=n;this._nodeDataFunction=i;this._edgeDataFunction=a};iy.prototype.getName=function e(){return"virtual-properties"};iy.prototype.run=function e(t){var r=t.ogma;var n={nodes:null,oldNodesData:null,edges:null,oldEdgesData:null};if(this._nodeDataFunction){n.nodes=r.getNodes().filter(this._nodeSelector);n.oldNodesData=ay(n.nodes,this._nodeDataFunction)}if(this._edgeDataFunction){n.edges=r.getEdges().filter(this._edgeSelector);n.oldEdgesData=ay(n.edges,this._edgeDataFunction)}return n};iy.prototype.undo=function e(t){var r=t.context;var n=r.nodes;var i=r.oldNodesData;var a=r.edges;var o=r.oldEdgesData;if(n){n.setData(i)}if(a){a.setData(o)}};iy.prototype.cleanup=function e(){};function ay(e,t){var r=[];for(var n=0;n<e.size;++n){var i=e.get(n);var a=i.getData();var o=t(i);var s=te(a,o);r.push(a);i.setData(s)}return r}Ogma.extend(function(e){Object.assign(e.transformations,{addVirtualProperties:function t(r){return e.modules.transformations.add(new iy(r),r)}})});var oy=function e(t){var r=t.selector;if(r===void 0)r=function(){return false};var n=t.dataFunction;if(n===void 0)n=function(){return undefined};this._selector=r;this._dataFunction=n};oy.prototype.run=function e(t){var r=t.ogma;var n=t.duration;var i=r.getNodes().filter(this._selector);var a=[];var o=new pt;for(var s=0;s<i.size;++s){var u=i.get(s);var l=u.getAdjacentEdges();var d=this._dataFunction(u);for(var f=0;f<l.size;++f){var h=l.get(f);var c=h.getSource();var g=h.getTarget();if(c!==g&&d!==undefined){var v=c===u?g:c;var p=o.get(v);if(!p){p=[];o.set(v,p)}p.push(d)}a.push(h)}}var _=r.getEdges(a);var m=r.getNodes(o.keys());var y=o.values();var b=m.getData();var x=new Array(m.size);for(var S=0;S<x.length;++S){var A=y[S];var E=b[S];for(var w=0;w<A.length;++w){E=te(E,A[w])}x[S]=E}return Promise.all([i.addClass(Hl,n),_.addClass(Hl,n)]).then(function(){i.setVisible(false);_.setVisible(false);m.setData(x);return{hiddenNodes:i,hiddenEdges:_,nodesWithDataChange:m,oldDataList:b}})};oy.prototype.undo=function e(t){var r=t.duration;var n=t.context;var i=n.hiddenNodes;var a=n.hiddenEdges;var o=n.nodesWithDataChange;var s=n.oldDataList;i.setVisible(true);a.setVisible(true);i.addClass(Hl);a.addClass(Hl);return Promise.all([i.removeClass(Hl,r),a.removeClass(Hl,r)]).then(function(){o.setData(s)})};oy.prototype.cleanup=function e(){};Ogma.extend(function(e){Object.assign(e.transformations,{addNeighborMerging:function t(r){return e.modules.transformations.add(new oy(r),r)}})});var sy=function e(t){var r=t.selector;if(r===void 0)r=function(){return true};var n=t.neighborIdFunction;if(n===void 0)n=function(){return null};var i=t.nodeGenerator;if(i===void 0)i=function(){return{}};var a=t.edgeGenerator;if(a===void 0)a=function(){return{}};this._generateIds=function(e){return r(e)&&n(e)};this._nodeGenerator=i;this._edgeGenerator=a};sy.prototype.run=function e(t){var r=this;var n=t.ogma;var i=t.duration;var a=t.wrapper;var o=a.getId();var s=n.getNodes();var u=new pt;for(var l=0;l<s.size;++l){var d=s.get(l);var f=uy(this._generateIds(d));if(f){for(var h=0;h<f.length;++h){var c=f[h];var g=u.get(c);if(!g){g=[];u.set(c,g)}g.push(d)}}}var v=new Array(u.size);var p=u.keys();var _=u.values().map(function(e){return n.getNodes(e)});for(var m=0;m<v.length;++m){var y=p[m];var b=_[m];var x=this._nodeGenerator(y,b);x.id="_gen_"+o+"_"+y;x.position=qr(b.getPosition());v[m]=x}var S,A;return n.addNodes(v.map(function(e){return{id:e.id,attributes:e.position}}),{virtual:true}).then(function(e){S=e;S.replaceOriginalAttributes(v.map(function(e){return e.attributes}),["x","y"]);S.setData(null,v.map(function(e){return e.data}));var t=[];for(var i=0;i<e.size;++i){var a=e.get(i);var o=_[i];for(var s=0;s<o.size;++s){var u=o.get(s);var l=r._edgeGenerator(u,a);if(!l.source&&!l.target){l.source=u;l.target=a}t.push(l)}}return n.addEdges(t,{virtual:true})}).then(function(e){A=e;S.setVisible(true);A.setVisible(true);S.addClass(Hl);A.addClass(Hl);return Promise.all([S.removeClass(Hl,i),A.removeClass(Hl,i)])}).then(function(){return{virtualNodes:S,virtualEdges:A}})};sy.prototype.undo=function e(t){var r=t.context;var n=t.duration;var i=r.virtualNodes;var a=r.virtualEdges;return Promise.all([i.addClass(Hl,n),a.addClass(Hl,n)]).then(function(){i.setVisible(false);a.setVisible(false)})};sy.prototype.cleanup=function e(t){var r=t.ogma;var n=t.context;var i=n.virtualNodes.filter(function(e){return!e.isVisible()});var a=n.virtualEdges.filter(function(e){return!e.isVisible()});r.removeNodes(i,{virtual:true});r.removeEdges(a,{virtual:true})};function uy(value){return Array.isArray(value)?value:value?[value]:null}Ogma.extend(function(e){Object.assign(e.transformations,{addNeighborGeneration:function t(r){return e.modules.transformations.add(new sy(r),r)}})});var ly=function e(t){this._ogma=t;this._graph=t.modules.graph;this._nodeList=this._graph.getNodeAttribute("object");this._edgeList=this._graph.getEdgeAttribute("object");this._sourceList=this._graph.getEdgeAttribute("source");this._targetList=this._graph.getEdgeAttribute("target");this._excludedList=this._graph.getEdgeAttribute("excluded");this._virtualList=this._graph.getEdgeAttribute("virtual")};ly.prototype.shortestPath=function e(t){if(t===void 0)t={};var r=t.source;var n=t.target;var i=t.directed;if(i===void 0)i=false;var a=t.filter;if(a===void 0)a="visible";var o=t.edgeCostFunction;if(o===void 0)o=function(){return 1};var s=t.heuristicFunction;if(s===void 0)s=function(){return 0};var u=this._ogma.getNode(r);var l=this._ogma.getNode(n);if(!u){throw new Error("the source is not a node")}if(!l){throw new Error("the target is not a node")}var d=u._index;var f=l._index;var h=null;if(d===f){h={nodes:u.toList(),edges:this._ogma.createEdgeList()}}else{var c=this._graph.getNodeMaxIndex()+1;var g=new Int32Array(c);var v=new Float32Array(c);var p=new Float32Array(c);var _=new zt;var m=new kr(p);v.fill(Infinity);p.fill(Infinity);g.fill(-1);m.add(d);v[d]=0;p[d]=s(u,l);while(!m.isEmpty()){var y=m.removeMin();if(y===f){h=this._constructPath(g,d,f);break}_.add(y);var b=this._graph.getAdjacentDirections(y);if(!b){continue}for(var x=0;x<b.length;++x){var S=b[x];var A=this._graph.getEdgeIndexesInDirection(S);var E=-1;var w=0;var k=-1;for(var C=0;C<A.length;++C){var T=A[C];var L=this._sourceList.get(T);var M=this._targetList.get(T);if(L===M){continue}if(i&&y!==L){continue}if(a==="visible"&&this._excludedList.get(T)){continue}if(a==="raw"&&this._virtualList.get(T)){continue}var I=this._edgeList.get(T);var F=o(I);if(E===-1||F<w){E=T;w=F;k=L===y?M:L}}if(k!==-1||_.has(k)){var N=v[y]+w;if(!m.has(k)||N<v[k]){var z=this._nodeList.get(y);g[k]=E;v[k]=N;p[k]=N+s(z,l);m.add(k)}}}}}return Promise.resolve(h)};ly.prototype._constructPath=function e(t,r,n){var i=[n];var a=[];var o=n;while(o!==r){var s=t[o];var u=this._sourceList.get(s);var l=this._targetList.get(s);o=o===u?l:u;i.push(o);a.push(s)}i.reverse();a.reverse();return{nodes:new this._ogma.NodeList(i),edges:new this._ogma.EdgeList(a)}};ly.prototype.detectCycle=function e(t,r){var n=r.getSource();var i=r.getTarget();var a=ja(t._indexes,n._indexes,i._indexes);return a?this._graph.createNodeList(a).dedupe():null};ly.prototype.getAllSimpleCycles=function e(t,r){var n=this;var i=r.getSource();var a=r.getTarget();var o=new Ga(t._indexes,i._indexes,a._indexes);return o.getCycles().map(function(e){return n._graph.createNodeList(e)})};Ogma.extend(function(e){var t=new ly(e);e.modules.algorithms=t;Object.assign(e.algorithms,{shortestPath:function e(r){return t.shortestPath(r)},hasCycle:function e(t){if(t===void 0)t={};var r=t.nodes;var n=t.edges;return this.detectCycle({nodes:r,edges:n})!==null},getAllSimpleCycles:function r(n){if(n===void 0)n={};var i=n.nodes;var a=n.edges;if(!i){i=e.getNodes()}if(!a){a=i.getAdjacentEdges({bothExtremities:true})}return t.getAllSimpleCycles(i,a)},detectCycle:function r(n){if(n===void 0)n={};var i=n.nodes;var a=n.edges;if(!i){i=e.getNodes()}if(!a){a=i.getAdjacentEdges({bothExtremities:true})}return t.detectCycle(i,a)}})});var dy={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"};var fy={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"};Ogma.extend(function(e){var t=new cy(e);e.modules.brand=t;e.tools.brand={set:function e(r,n){return t.set(r,n)},remove:function e(){t.remove()}}});var hy={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:null};var cy=function e(t){this._dom=t.modules.dom;this._brand=null};cy.prototype.set=function e(t,r){var n=Za(r,hy);var i=n.position;var a=n.horizontalMargin;var o=n.verticalMargin;var s=n.className;if(!dy[i]){i=hy.position}this.remove();var u=document.createElement("div");u.innerHTML=t;u.style.position="absolute";u.style[dy[i]]=a+"px";u.style[fy[i]]=o+"px";u.style.padding="0px 0px 0px 0px";u.style.zIndex="10";if(s){u.setAttribute("class",s)}this._brand=u;this._dom.setLayer("brand",this._brand);return u};cy.prototype.remove=function e(){this._dom.setLayer("brand",null);this._brand=null};var gy="geo.latitude";var vy="geo.longitude";var py={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:17,wrapCoordinates:true,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:undefined,backgroundColor:"silver",opacity:1,duration:0,detectRetina:false,disableNodeDragging:true,tileBuffer:1,sizeRatio:1};var _y=256;var my=300;var yy=100;var by=150;var xy=0;var Sy=10;function Ay(e){if(e===void 0)e={};var t=e.tileUrlSubdomains;var r=e.tileUrlTemplate;var n=e.attribution;var i=e.attributionOptions;var a=e.latitudePath;var o=e.longitudePath;var s=e.sizeRatio;if(r&&typeof r!=="string"){throw new TypeError("Geo mode: tileUrlTemplate must be a URL string")}if(t&&typeof t!=="string"){throw new TypeError("Geo mode: tileUrlTemplate must be a string")}if(n&&typeof n!=="string"){throw new TypeError("Geo mode: Map attribution must be a string")}if(i&&typeof i!=="object"){throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object")}if(a&&typeof a!=="string"&&!Array.isArray(a)){throw new TypeError("Geo mode: Latitude path must be a valid property path: "+"a string or an array of strings.")}if(o&&typeof o!=="string"&&!Array.isArray(o)){throw new TypeError("Geo mode: Longitude path must be a valid property path: "+"a string or an array of strings.")}if(typeof s!=="undefined"&&(!isFinite(s)||s<=0)){throw new TypeError("Geo mode: sizeRatio must be a positive number.")}}Ogma.onDestroy(function(e){return e.modules.geo._cancelAnimationFrame()});var Ey=function e(t){var r=this;this._dom=t.modules.dom;this._graphics=t.modules.graphics;this._graph=t.modules.graph;this._data=t.modules.data;this._camera=t.modules.camera;this._events=t.modules.events;this._settingsModule=t.modules.settings;this._locate=t.modules.locate;this._brand=t.modules.brand;this._filters=t.modules.filters;this._settings=Object.assign({},py);this._animationFrame=null;this._screen=this._dom.getDimensions();this._tiles={};this._tileSize=_y*ke();this._enableMapBackground=false;this._initialized=false;this._enabled=false;this._sIndex=0;this._lat=0;this._lng=0;this._zoom=1;this._zoomOffset=0;this._loadingTiles=0;this._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"});this._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"});this._graph.createNodeAttribute({name:gy,storage:"float"});this._graph.createNodeAttribute({name:vy,storage:"float"});this._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]);this._events.on({addNodes:function(e){return r._onNodesAdded(e.nodes)},setContainer:function(e){if(e&&r._enabled){r._initializeCanvas(e)}},progressMoveNodesByDragging:function(e){return r._onNodesDragged(e)},startMoveNodesByDragging:function(){return r._onNodesDragStart()},cameraMove:function(e){return r._setViewFromCamera(e)},resize:function(){return r._onResize()},viewChanged:function(){return r._onMoveend()}})};Ey.prototype._requestAnimationFrame=function e(t){var r=this;this._cancelAnimationFrame();this._animationFrame=_(function(){r._animationFrame=null;t()})};Ey.prototype._cancelAnimationFrame=function e(){if(this._animationFrame){m(this._animationFrame);this._animationFrame=null}};Ey.prototype._onMoveend=function e(){if(this._enabled&&!this._transition){var t=this._camera.zoom;if(t!==this._prevZoom){this._updateSizes()}this._prevZoom=t}};Ey.prototype._updateSizes=function e(){if(this._enabled){this._projection.updateAll()}};Ey.prototype._onResize=function e(){this._resize();this._setViewFromCamera()};Ey.prototype._resize=function e(){if(this._initialized){var t=this._screen=this._dom.getDimensions();var r=t.width;var n=t.height;this._tileSize=_y*ke();Fe(this._canvas,r,n);Fe(this._rcanvas,r,n)}};Ey.prototype._setViewFromCamera=function e(){if(this._enabled){var t=this._camera;var r=Math.max(0,Math.log2(t.zoom));var n=ib(t.x,t.y);this._setView(n[0],n[1],r)}};Ey.prototype._setCameraFromView=function e(){var t=nb(this._lat,this._lng);var r=t[0];var n=t[1];var i=Math.pow(2,this._zoom);this._camera.setView({x:r,y:n,zoom:i})};Ey.prototype._readNodesCoordinates=function e(t){var r=this._graph;var n=this._settings;var i=n.longitudePath;var a=n.latitudePath;var o=n.wrapCoordinates;var s=r.getAttributes(true,[gy,vy]);var u=s[0];var l=s[1];var d=t._indexes;var f=t.getId();var h=d.length;var c=t.getData(a);var g=t.getData(i);var v,p,_,m;for(var y=0;y<h;y++){p=g[y];v=c[y];m=d[y];_=f[y];if(v!==undefined&&p!==undefined){wy(_,p);ky(_,v);if(o){p=p%180;v=$e(+v,-Zy,Zy)}l.set(m,p);u.set(m,v)}}};Ey.prototype._onNodesAdded=function e(t){this._readNodesCoordinates(t);if(this._enabled){this._filter.refresh();Gy(this,t)}};Ey.prototype._onNodesDragStart=function e(){if(this._enabled){this._nodeDragOffsetX=this._nodeDragOffsetY=0}};Ey.prototype._onNodesDragged=function e(t){var r=t.nodes;var n=t.dx;var i=t.dy;if(this._enabled){var a=r.getAttributes(["x","y"]);var o=r.getGeoCoordinates();var s=[];var u=this._nodeDragOffsetX,l=this._nodeDragOffsetY;for(var d=0;d<r.size;d++){var f=a[d];var h=o[d];ib(f.x+n-u,f.y+i-l,s);h.latitude=s[0];h.longitude=s[1]}this._nodeDragOffsetX=n;this._nodeDragOffsetY=i;r.setGeoCoordinates(o)}};Ey.prototype._onSettingsChanged=function e(t,r){if(this._enabled){if(t.tileUrlTemplate!==r.tileUrlTemplate){this._dom.clearTimeout(this._redrawTimer);My(this);this._setViewFromCamera()}if(t.sizeRatio!==r.sizeRatio){this._updateSizes()}if(t.attribution!==r.attribution){this.setAttribution()}if(t.maxZoomLevel!==r.maxZoomLevel){this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,r.maxZoomLevel)})}if(t.disableNodeDragging!==r.disableNodeDragging){this._setDragging(!r.disableNodeDragging)}}if(t.wrapCoordinates!==r.wrapCoordinates){this._readNodesCoordinates(this._graph.getNodes("all"))}if(t.latitudePath!==r.latitudePath||t.longitudePath!==r.longitudePath){this._readNodesCoordinates(this._graph.getNodes("all"))}};Ey.prototype._setDragging=function e(t,r){if(r===void 0)r=false;var n=this._settingsModule;n.update({interactions:{drag:{enabled:t,applyResult:r}}})};Ey.prototype._nodeIsVisible=function e(t){var r=this._settings;var n=r.longitudePath;var i=r.latitudePath;var a=r.wrapCoordinates;var o=t.getData(n);var s=t.getData(i);if(o===undefined||s===undefined){return false}else if(a){return true}else{return Math.abs(s)<=Zy&&Math.abs(o)<=180}};Ey.prototype._transformToGeoSpace=function e(t,r){var n=r.X;var i=r.Y;var a=r.indexes;var o=this._graph;var s=this._camera;var u=o.getAttributes(true,["x","y","radius"]);var l=u[0];var d=u[1];var f=u[2];var h=l.getMultiple(a);var c=d.getMultiple(a);var g=f.getMultiple(a);var v=new Fr({xValues:h,yValues:c,scaledSizeValues:g});var p=new Fr({xValues:n,yValues:i});if(h.length===0||c.length===0){v.cx=v.cy=0;v.width=v.height=0}if(!isFinite(p.width)||!isFinite(p.height)){p.cx=p.cy=0;p.width=p.height=0}var _=p.cx-v.cx;var m=p.cy-v.cy;var y=1;if(h.length>1){y=Math.max(p.width,p.height)/Math.max(v.width,v.height)/ke()}var b=f.getMultiple(a).reduce(function(e,t){e[0]=Math.min(e[0],t*y);e[1]=Math.max(e[1],t*y);return e},[Infinity,0]);var x=b[0];var S=b[1];p.pad(S);p.minScaledSize=x;p.maxScaledSize=S;var A=this._locate.computeConfigForBounds(p);A.zoom=ub(A.zoom);var E=s.zoom/A.zoom;_+=(v.cx-s.x)*E;m+=(v.cy-s.y)*E;var w=v.cx+_;var k=v.cy+m;this._transformation=this._graphics.addAttributeLayer({name:"geo-transformation",priority:Rl,nodeSelector:function(e){return e.isVisible()},nodeAttributes:{radius:function(e){return e.getAttribute("radius")*E},x:function(e){return(e.getAttribute("x")+_-w)*E+w},y:function(e){return(e.getAttribute("y")+m-k)*E+k}},edgeSelector:function(e){return e.isVisible()},edgeAttributes:{width:function(e){return e.getAttribute("width")*E}}});this._scaleInfo={ratio:E,sizeRatio:y,dx:_,dy:m,tx:w,ty:k,zoom:s.zoom,x:s.x,y:s.y};this._scaleInfo.cameraConfig={zoom:s.zoom/E,x:(s.x+_-w)*E+w,y:(s.y+m-k)*E+k,angle:0}};Ey.prototype._show=function e(){var t=this;var r=this._dom.getContainer();var n=this._settings.duration;if(r){if(!this._initialized){this._initializeCanvas(r)}this._dom.setLayer("geo",this._rcanvas)}this._enableTime=$t();this._enableMapBackground=false;this._filter=this._filters.addNodeFilter(function(e){return t._nodeIsVisible(e)});return this._filter.whenApplied().then(function(){var e=t._graph.getNodes("all");var r=t._graph.getEdges("all");t._graphics.hideTexts();var n=Wy(t,e);t._transformToGeoSpace(e,n);return t._camera.setView(t._scaleInfo.cameraConfig,{ignoreZoomLimits:true}).then(function(){return{projected:n,nodes:e,edges:r,targetZoom:t._scaleInfo.cameraConfig.zoom}})}).then(function(e){var r=e.nodes;var i=e.edges;Gy(t,r);return t._graphics.animate({nodes:r,edges:i},function(){t.setProjection(true)},n)}).then(function(){t._transformation.destroy();t._transformation=null;t._scaleInfo.ratio=1;t._enableMapBackground=true;t.setAttribution();t._graphics.showTexts();var e=t._graphics.getGraphicsEngine().parseColor(t._settings.backgroundColor);e[3]=0;t._prevSettings=t._settingsModule.update({backgroundColor:yr(e),minZoom:1,maxZoom:Math.pow(2,t._settings.maxZoomLevel),"interactions.rotation.enabled":false,"interactions.zoom.minValue":function(){return 0},"interactions.zoom.maxValue":function(){return Math.pow(2,t._settings.maxZoomLevel)},"interactions.zoom.onDoubleClick":true});if(t._graph.getNodes().size===0){t.setCenter(0,0)}Fy(t,t._settings.opacity,t._settings.backgroundColor)})};Ey.prototype._transformToGraphSpace=function e(t){var r=t.getAttributes(["x","y","radius"]);var n=t.getBoundingBox();var i=this._camera;var a=t.reduce(function(e,t,r){var n=t._index;return e[n]=r,e},{});this.setProjection(false);var o=t.getAttribute("x");var s=t.getAttribute("y");var u=t.getAttribute("radius");var l=new Fr({xValues:o,yValues:s,scaledSizeValues:u.map(function(e){return e*2})});var d=l.cx-n.cx;var f=l.cy-n.cy;var h=this._settings.sizeRatio;var c=0,g=0;var v=this._locate.computeConfigForBounds(l);var p=this._camera.zoom/v.zoom;var _=i.zoom/p;var m,y;if(isNaN(n.cx)||isNaN(n.cy)){n.cx=i.x;n.cy=i.y;m=v.x;y=v.y}else{d+=(n.cx-i.x)*p;f+=(n.cy-i.y)*p;c=n.cx+d;g=n.cy+f;m=(i.x+d-c)*p+c;y=(i.y+f-g)*p+g}this._projection=this._graphics.addAttributeLayer({name:"geo-projection-1",priority:Rl,nodeSelector:function(e){return e.isVisible()},nodeAttributes:{x:function(e){return(r[a[e._index]].x+d-c)*p+c},y:function(e){return(r[a[e._index]].y+f-g)*p+g}},edgeSelector:function(e){return e.isVisible()}});this._scaleInfo={ratio:p,sizeRatio:h,dx:d,dy:f,tx:c,ty:g,zoom:i.zoom,x:i.x,y:i.y,cameraConfig:{zoom:_,x:m,y:y}};this._settingsModule.update({minZoom:this._prevSettings.minZoom});return this._camera.setView(this._scaleInfo.cameraConfig,{ignoreZoomLimits:true})};Ey.prototype._hide=function e(){var t=this;var r=this._dom.getContainer();var n=this._settings.duration;var i=n/2;var a=$t();var o=function(){var e=$t();var r=(e-a)/i;if(r<1&&r>=0){Fy(t,1-r,t._prevBgColor);t._dom.afterNextFrame().then(o)}};this._dom.clearTimeout(this._redrawTimer);if(i!==0){this._dom.afterNextFrame().then(o)}else{o()}var s=this._graph.getNodes("all");var u=this._graph.getEdges("all");return this._transformToGraphSpace(s,u).then(function(){return t._graphics.hideTexts()}).then(function(){return t._graphics.animate({nodes:s,edges:u},function(){return t._projection.destroy()},n)}).then(function(){return t._filter.delete()}).then(function(){return t._dom.afterNextFrame()}).then(function(){t._projection=null;t.setAttribution(null);t._graphics.showTexts()}).then(function(){s.setAttribute("scalingMethod","scaling");u.setAttribute("scalingMethod","scaling");if(r){t._dom.setLayer("geo",null)}My(t)}).then(function(){return t._settingsModule.update(t._prevSettings)})};Ey.prototype.setProjection=function e(t){var r=this;if(t){this._projection=this._graphics.addAttributeLayer({name:"geo-projection-2",priority:Rl,nodeSelector:function(e){return e.isVisible()},nodeAttributes:{scalingMethod:"fixed",radius:function(e){return e.getAttribute("radius")*r._settings.sizeRatio},x:function(e){var t=e.getData(r._settings.longitudePath);return t!==undefined?Ky*($y*(Yy*t*Qy)+eb):0},y:function(e){var t=e.getData(r._settings.latitudePath);var n=Math.max(Math.min(Zy,t),-Zy);var i=Math.sin(n*Qy);return t!==undefined?Ky*(tb*(Yy*Math.log((1+i)/(1-i))/2)+rb):0}},edgeSelector:function(e){return e.isVisible()},edgeAttributes:{scalingMethod:"fixed",width:function(e){return e.getAttribute("width")*r._settings.sizeRatio}}})}else{this._projection.destroy()}};Ey.prototype.enable=function e(t){return this.setEnabled(true,t)};Ey.prototype.disable=function e(t){return this.setEnabled(false,t)};Ey.prototype.isEnabled=function e(){return this._enabled};Ey.prototype.toggle=function e(t){return this.setEnabled(!this._enabled,t)};Ey.prototype.setOptions=function e(t){if(t===void 0)t={};Ay(t);var r=this._settings;this._settings=Object.assign({},this._settings,py,t);this._onSettingsChanged(r,this._settings)};Ey.prototype.setAttribution=function e(t){if(t===void 0)t=this._settings.attribution;if(!this._enabled){return}if(t===null){this._brand.remove()}if(t){this._brand.set(t,this._settings.attributionOptions)}else{this._brand.remove()}};Ey.prototype.setEnabled=function e(value,t){var r=this;if(t===void 0)t={};this.setOptions(t);if(value!==this._enabled&&!this._transition){var n=this._settingsModule;var i=this._settings;this._enabled=value;this._transition=true;if(value){this._nodeDraggingSetting=n.get("interactions.drag.enabled");this._setDragging(!i.disableNodeDragging);this._show().then(function(){r._transition=false;r._events.fire("geoEnabled");r._events.fire("geoReady")})}else{this._hide().then(function(){r._transition=false;r._events.fire("geoDisabled");r._setDragging(r._nodeDraggingSetting,true);r._cancelAnimationFrame()})}}return new Promise(function(e){if(r._transition){r._events.once(value?"geoEnabled":"geoDisabled",e)}else{e()}})};Ey.prototype.resetCoordinates=function e(){if(!this._enabled){return}var t=this._graph.getNodes();Xy(this,t,"geo.prevLat",gy);Xy(this,t,"geo.prevLng",vy)};Ey.prototype.updateCoordinates=function e(){Hy(this,this._graph.getNodes())};Ey.prototype._redrawNodes=function e(t,r){if(this._enabled){this._projection.updateAll()}return Promise.resolve(r)};Ey.prototype._setView=function e(t,r,n){if(!this._enabled){return}this._lat=t;this._lng=r;this._zoom=n;Fy(this)};Ey.prototype._initializeCanvas=function e(t){var r=this;this._rcanvas=document.createElement("canvas");this._rctx=this._rcanvas.getContext("2d");this._canvas=document.createElement("canvas");this._ctx=this._canvas.getContext("2d");this._rcanvas.style.position="absolute";this._rcanvas.style.zIndex=+(t.style.zIndex||0)-1;this._rcanvas.className="ogma-geo-container";this._initialized=true;this._drawFromBuffer=function(){return r._rctx.drawImage(r._canvas,0,0)};this._resize()};Ey.prototype.setView=function e(t,r,n){if(!this._enabled){throw new Error("Geo mode is not enabled")}ob(this,n);sb(t,r);this._setView(t,r,n);this._setCameraFromView()};Ey.prototype.setCenter=function e(t,r){this.setView(t,r,this._zoom)};Ey.prototype.setZoom=function e(t){this.setView(this._lat,this._lng,t)};Ey.prototype.getView=function e(){return{latitude:this._lat,longitude:this._lng,zoom:this._zoom}};Ey.prototype.getCenter=function e(){return{latitude:this._lat,longitude:this._lng}};Ey.prototype.getZoom=function e(){return this._zoom};Ey.prototype.exportBackground=function e(t,r){var n=this;r=r||this._camera.getView();return new Promise(function(e){var i=Math.log2(r.zoom);var a=ib(r.x,r.y);var o=a[0];var s=a[1];var u=r.pixelRatio||ke();n._tileSize=_y*u;if(!Cy(n,t.getContext("2d"),t.width,t.height,i,o,s,false)){n._dom.setTimeout(function(){n.exportBackground(t,r).then(function(){n._tileSize=_y*ke()}).then(e)},yy)}else{n._tileSize=_y*ke();e()}})};Ey.prototype.whenReady=function e(){var t=this;return new Promise(function(e){var r=function(){return t.whenReady().then(e)};if(t.isEnabled()){if(t._transition){t._events.once("geoReady",r)}else if(!Iy(t)){t._dom.setTimeout(r,50)}else{e()}}else{t._events.once("geoEnabled",r)}})};function wy(e,t){if(isNaN(t)){throw new TypeError("node "+e+": "+t+" is not a valid longitude")}}function ky(e,t){if(isNaN(t)){throw new TypeError("node "+e+": "+t+" is not a valid latitude")}}function Cy(e,t,r,n,i,a,o,s){t=t||e._ctx;var u=Math.ceil(i);var l=1/Math.pow(2,u-i);var d=e._settings.tileBuffer;var f=e._tileSize*l;var h=u;var c=ke();var g=e._camera.animationInProgress();if(e._settings.detectRetina){f/=c;h+=Math.log2(c);d*=c}r+=d*2*f;n+=d*2*f;var v=ab(a,o,h);var p=v.x|0;var _=v.y|0;var m=r/2-(v.x-p)*f;var y=n/2-(v.y-_)*f;while(m>0){m-=f;p-=1}while(y>0){y-=f;_-=1}var b=true;m-=d*f;y-=d*f;var x=[];var S,A,E,w,k;for(S=m,A=p;S<r;S+=f,++A){for(E=y,w=_;E<n;E+=f,++w){x.push([A,w,S,E])}}e._tileBounds=[p-d,_-d,A+d,w+d];var C=p+(A-p)/2;var T=_+(w-_)/2;x.sort(function(e,t){return Wr(e[0],e[1],C,T)-Wr(t[0],t[1],C,T)});for(S=0,k=x.length;S<k;S++){var L=x[S];b&=zy(e,t,L[2],L[3],h,L[0],L[1],f,s,g)}e._dom.clearTimeout(e._pruneTimer);e._pruneTimer=e._dom.setTimeout(function(){return Ty(e,h)},my);return b}function Ty(e,t){var r={};var n=e._settings.tileBuffer;var i=e._tileBounds;var a,o,s,u,l,d;for(var f in e._tiles){var h=f.split("/");d=parseInt(h[0]);u=parseInt(h[1]);l=parseInt(h[2]);r[d]=r[d]||[];r[d].push([u,l])}var c=[];for(d in r){var g=parseInt(d);var v=Math.pow(2,g-t);var p=r[d];for(a=0,o=p.length;a<o;a++){s=p[a];u=s[0];l=s[1];if(u<i[0]*v-n||u>i[2]*v+n||l<i[1]*v-n||l>i[3]*v+n){c.push(Vy(g,s[0],s[1]))}}}Ly(e,c);return c.length}function Ly(e,t){for(var r=0,n=t.length;r<n;r++){var i=t[r];var a=e._tiles[i];if(a){if(!a.img.complete){xy--}if(a.img){jy(a.img)}}delete e._tiles[i]}}function My(e){Ly(e,Object.keys(e._tiles));e._tiles={}}function Iy(e){var t=Object.keys(e._tiles);for(var r=0;r<t.length;r++){var n=e._tiles[t[r]];if(n&&!n.img.complete){return false}}return true}function Fy(e,t,r){if(!e._enableMapBackground||!e._ctx){return}e._requestAnimationFrame(function(){var n=e._ctx;var i=ke();var a=e._screen.width*i;var o=e._screen.height*i;n.fillStyle=r||e._settings.backgroundColor;n.fillRect(0,0,a,o);if(typeof t==="number"&&t!==e._opacity){e._opacity=t;e._rcanvas.style.opacity=t}if(!Cy(e,e._ctx,a,o,e._zoom,e._lat,e._lng,true)){e._dom.clearTimeout(e._redrawTimer);if(e._enabled){e._redrawTimer=e._dom.setTimeout(function(){return Fy(e,t,r)},by)}}else{e._events.fire("geoLoaded")}e._drawFromBuffer()})}function Ny(e){return typeof e!=="number"}function zy(e,t,r,n,i,a,o,s,u,l){var d=Uy(e,i,a,o,true,l);if(Ny(d)){t.drawImage(d,r,n,s,s);return true}else if(d===Ry.LOADING){if(u){var f;d=Uy(e,i-1,a/2|0,o/2|0,false,l);if(Ny(d)){f=d.naturalWidth/2;var h=a&1?f:0;var c=o&1?f:0;t.drawImage(d,h,c,f,f,r,n,s,s)}else{var g=Uy(e,i+1,a*2,o*2,false,l);var v=Uy(e,i+1,a*2+1,o*2,false,l);var p=Uy(e,i+1,a*2,o*2+1,false,l);var _=Uy(e,i+1,a*2+1,o*2+1,false,l);if(Ny(g)&&Ny(v)&&Ny(p)&&Ny(_)){f=s/2;t.drawImage(g,r,n,f,f);t.drawImage(v,r+f,n,f,f);t.drawImage(p,r,n+f,f,f);t.drawImage(_,r+f,n+f,f,f)}}}return false}else{return true}}var Ry={INVALID:1,LOADING:2,MISSING:3};function Py(e,t){var r=e._sIndex;if(t.length>0){r=(r+1)%t.length;e._sIndex=r;return r}return 0}function Dy(e,t,r,n){var i=e._settings.tileUrlSubdomains;var a=Py(e,i);return e._settings.tileUrlTemplate.replace("{z}",n).replace("{x}",t).replace("{y}",r).replace("{s}",i.charAt(a))}function Oy(){xy--;this.error=true;jy(this)}function By(){xy--;jy(this)}function jy(e){e.onload=e.onerror=null}function Vy(e,t,r){return e+"/"+t+"/"+r}function Uy(e,t,r,n,i,a){var o=Math.pow(2,t)-1;if(t<0||r<0||r>o||n<0||n>o){return Ry.INVALID}var s=Vy(t,r,n);var u=e._tiles[s];if(!u){if(!i){return Ry.MISSING}else{if(!a&&xy<Sy){var l=new Image;u={img:l,err:false,loaded:false};l.setAttribute("crossOrigin","anonymous");l.onerror=Oy;l.onload=By;l.src=Dy(e,r,n,Math.floor(t));xy++}e._tiles[s]=u;return Ry.LOADING}}else if(u.img.error){return Ry.MISSING}else if(!u.img.complete){return Ry.LOADING}else{return u.img}}function Gy(e,t){Xy(e,t,gy,"geo.prevLat");Xy(e,t,vy,"geo.prevLng")}function Wy(e,t){var r=e._graph.getAttributes(true,[gy,vy]);var n=r[0];var i=r[1];var a=new Array(2),o,s,u;var l=t._indexes;var d=n.getMultiple(l);var f=i.getMultiple(l);var h=l.length;var c=[];var g=[];var v=[];for(var p=0,_=h;p<_;++p){u=l[p];o=d[p],s=f[p];if(e._nodeIsVisible(t.get(p))){nb(o,s,a);g.push(a[0]);v.push(a[1]);c.push(u)}}return{X:g,Y:v,indexes:c}}function Hy(e,t){var r=e._graph.getAttributes(true,["x","y",gy,vy]);var n=r[0];var i=r[1];var a=r[2];var o=r[3];var s=new Array(2),u,l,d;var f=t._indexes;var h=[],c=[],g=[];for(var v=0,p=f.length;v<p;v++){d=f[v];u=a.get(d);l=o.get(d);if(l!==undefined&&u!==undefined){ib(n.get(d),i.get(d),s);g.push(d);h.push(s[0]);c.push(s[1])}}a.setMultiple(g,h);o.setMultiple(g,c)}function Xy(e,t,r,n){qy(e,true,t,r,n)}function qy(e,t,r,n,i){var a=e._graph;var o=a.getAttribute(t,n);var s=a.getAttribute(t,i);var u=r._indexes;s.setMultiple(u,o.getMultiple(u))}var Yy=6378137;var Zy=85.0511287798;var Ky=256;var Qy=Math.PI/180;var Jy=180/Math.PI;var $y=.5/(Math.PI*Yy),eb=.5,tb=-$y,rb=.5;function nb(e,t,r){if(r===void 0)r=[];var n=Math.max(Math.min(Zy,e),-Zy);var i=Math.max(Math.min(Math.sin(n*Qy),.9999),-.9999);r[0]=Ky*($y*(Yy*t*Qy)+eb);r[1]=Ky*(tb*(Yy*Math.log((1+i)/(1-i))/2)+rb);return r}function ib(e,t,r){if(r===void 0)r=[];e=(e/Ky-eb)/$y;t=(t/Ky-rb)/tb;r[0]=(2*Math.atan(Math.exp(t/Yy))-Math.PI/2)*Jy;r[1]=e*Jy/Yy;return r}function ab(e,t,r){var n=1<<r;e=e*Qy;return{x:n*((t+180)/360),y:n*(1-Math.log(Math.tan(e)+1/Math.cos(e))/Math.PI)/2}}function ob(e,t){var r=e._settings.maxZoomLevel;if(typeof t!=="number"||!(t>=0&&t<=r)){throw new Error("invalid zoom value "+t+": expected value between 0 and "+r)}}function sb(e,t){if(typeof e!=="number"){throw new Error("invalid latitude "+e+": expected number")}if(typeof t!=="number"){throw new Error("invalid longitude "+t+": expected number")}}function ub(e){return Math.pow(2,Math.floor(Math.log2(e)))}Ogma.extend(function(e){var t=new Ey(e);var r=e.modules;var n=r.graph;e.modules.geo=t;e.geo={enable:function(e){return t.enable(e)},disable:function(e){return t.disable(e)},setOptions:function(e){return t.setOptions(e)},enabled:function(){return t.isEnabled()},getCenter:function(){return t.getCenter()},getView:function(){return t.getView()},getZoom:function(){return t.getZoom()},setZoom:function(e){return t.setZoom(e)},setView:function(e,r,n){return t.setView(e,r,n)},setCenter:function(e,r){return t.setCenter(e,r)},toggle:function(e){return t.toggle(e)},resetCoordinates:function(){return t.resetCoordinates()},updateCoordinates:function(){return t.updateCoordinates()},getUnprojectedCoordinates:function(e){t.setProjection(false);var r=t._graph.getNodes(e).getAttributes(["x","y"]);t.setProjection(true);return r}};n.Node.prototype.getGeoCoordinates=function(){return{latitude:n.getAttribute(true,gy).get(this._index),longitude:n.getAttribute(true,vy).get(this._index)}};n.Node.prototype.setGeoCoordinates=function(e,t){var r=this;return this.toList().setGeoCoordinates([e],t).then(function(){return r})};n.NodeList.prototype.getGeoCoordinates=function(){var e=new Array(this._indexes.length);var t=n.getAttribute(true,gy).getMultiple(this._indexes);var r=n.getAttribute(true,vy).getMultiple(this._indexes);for(var i=0,a=this._indexes.length;i<a;i++){e[i]={latitude:t[i],longitude:r[i]}}return e};n.NodeList.prototype.setGeoCoordinates=function(r,i){var a=this;var o=this.getId();var s=this._indexes;var u=new Array(s.length);var l=new Array(s.length);var d=t.isEnabled();if(r===null){r=new Array(s.length).fill(null)}if(r.length!==s.length){throw new RangeError("You must provide coordinates for each node in the NodeList")}var f=this.isVisible();for(var h=0,c=s.length;h<c;h++){var g=r[h];var v=o[h];var p=void 0,_=void 0;var m=f[h];if(g===null||g.latitude===null&&g.longitude===null){p=_=undefined;i=0}else{p=g.latitude;_=g.longitude;ky(v,p);wy(v,_)}u[h]=p;l[h]=_}this.setData(t._settings.latitudePath,u);this.setData(t._settings.longitudePath,l);n.getAttribute(true,gy).setMultiple(s,u);n.getAttribute(true,vy).setMultiple(s,l);return Promise.all([t._redrawNodes(i,this),e.modules.transformations.refresh()]).then(function(){return a})};e.events.onGeoModeEnabled=function(t){e.modules.events.on("geoEnabled",t);return e.events};e.events.onGeoModeDisabled=function(t){e.modules.events.on("geoDisabled",t);return e.events};e.events.onGeoModeLoaded=function(t){e.modules.events.on("geoLoaded",t);return e.events}});var lb={strokeColor:"black",strokeWidth:5,dashed:true,cursorStyle:"cell",createNodes:true,condition:function(){return true},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}};Ogma.extend(function(e){var t=new db(e);e.modules.connectNodes=t;e.tools.connectNodes={enable:function e(r){t.enable(r);return this},disable:function e(){t.disable();return this},enabled:function e(){return t.enabled()}};e.events.onNodesConnected=function(t){e.modules.events.on("connectedNodes",t);return e.events}});var db=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._camera=t.modules.camera;this._captor=t.modules.captor;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._interactions=t.modules.interactions;this._events=t.modules.events;this._settings=t.modules.settings;this._engine=this._graphics.getGraphicsEngine();this._block=this._engine.createBlock();this._depth=Hd(0).edgeBody;this._enabled=false;this._options=null;this._blockId=null;this._startNode=null;this._startPos=null;this._endPos=null;this._cursorEnabled=false;this._events.register(["connectNodes"]);this._interaction=this._interactions.onDrag({priority:"connectNodes",check:function(e){var t=e.target;var n=e.button;if(n===void 0)n="left";return r._enabled&&n==="left"&&t&&t.isNode},onStart:function(e){var t=e.target;r._cursorEnabled=true;r._startNode=t;r._startPos=t.getPosition();r._graphics.addCursorStyle(r._options.cursorStyle);r._blockId=r._graphics.allocateGraphicsEngineBlockId()},onProgress:function(e){var t=e.x;var n=e.y;r._endPos=r._camera.screenToGraphCoordinates({x:t,y:n});r._drawLine()},onStop:function(){var e=r._options;var t=e.condition;var n=e.onNodeCreated;var i=e.onEdgeCreated;var a=e.onComplete;var o=r._captor.getPointedElement();var s=null;var u=null;r._graphics.releaseGraphicsEngineBlockId(r._blockId);if(!o&&r._options.createNodes){o=r._ogma.addNode({attributes:{x:r._endPos.x,y:r._endPos.y}});u=o;if(n){n(u)}}if(o&&(u||!t||t(o))){s=r._ogma.addEdge({source:r._startNode,target:o});if(i){i(s)}}if(a){a({source:r._startNode,target:o,edge:s})}r.disable()}});this._events.on({clear:function(){return r.disable()}})};db.prototype._drawLine=function e(){this._block.reset(ls,false,this._depth);var t=this._block.nextAndReset();var r=t.end;r.pieceId=bs;r.shape="line";r.x1=this._startPos.x;r.y1=this._startPos.y;r.x2=this._endPos.x;r.y2=this._endPos.y;r.fillColor=this._options.strokeColor;r.thicknessOrFontSizeFixed=this._options.strokeWidth;if(this._options.dashed){r.dashLength=3;r.gapLength=1}this._engine.storeBlock(this._blockId,this._block);this._dom.refresh()};db.prototype.enable=function e(t){if(this._enabled){return}this._options=Za(t,lb);this._enabled=true;this._cursorEnabled=false;this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":false});if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorInformation())}return this};db.prototype.disable=function e(){if(!this._enabled){return}this._enabled=false;this._settings.update(this._prevSettings);if(this._cursorEnabled){this._graphics.removeCursorStyle(this._options.cursorStyle)}};db.prototype.enabled=function e(){return this._enabled};var fb=[{name:"color",isNode:true},{name:"shape",isNode:true},{name:"radius",isNode:true},{name:"icon.content",isNode:true},{name:"image.url",isNode:true},{name:"image",isNode:true},{name:"color",isNode:false},{name:"shape",isNode:false},{name:"width",isNode:false}];var hb=Math.PI;var cb=2*Math.PI;var gb=1.6;var vb=3;var pb=.9;var _b={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(e){return e[e.length-1]}};Ogma.extend(function(e){var t=new yb(e);e.modules.legend=t;e.tools.legend={enable:function e(r){return t.enable(r)},disable:function e(){return t.disable()},enabled:function e(){return t.enabled()}}});var mb=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];var yb=function e(t){var r=this;this._ogma=t;this._graphics=t.modules.graphics;this._dom=t.modules.dom;this._settings=null;this._enabled=false;this._mustRefresh=false;this._canvas=we();this._ctx=this._canvas.getContext("2d");this._promises=[];t.modules.events.on({newFrame:function(){if(r._enabled&&r._mustRefresh){r._ctx.clearRect(0,0,r._canvas.width,r._canvas.height);r._drawOnCanvas(r._settings,r._canvas,ke());var e=r._promises;r._promises=[];e.forEach(function(e){return e()})}},"resize reloadFonts":function(){r._mustRefresh=true}})};yb.prototype.enable=function e(t){if(!this._enabled){this._enabled=true;this._mustRefresh=true;this._settings=t;this._graphics.addCanvas(this._canvas);return this.refresh()}return Promise.resolve()};yb.prototype._afterNextUpdate=function e(){var t=this;return new Promise(function(e){return t._promises.push(e)})};yb.prototype._formatSettings=function e(t,r){var n=Za(t,_b);mb.forEach(function(e){return n[e]*=r});return n};yb.prototype.disable=function e(){if(this._enabled){this._enabled=false;this._graphics.removeCanvas(this._canvas)}};yb.prototype.enabled=function e(){return this._enabled};yb.prototype.refresh=function e(){this._mustRefresh=true;this._dom.refresh();return this._afterNextUpdate()};yb.prototype.getCurrentOptions=function e(){return this._settings};yb.prototype._drawOnCanvas=function e(t,r,n){var i=this._formatSettings(t,n);var a=this._computeWidgetList(i);xb(i,r,a)};yb.prototype.exportOnCanvas=function e(t,r){return this._drawOnCanvas(r,t,1)};yb.prototype._computeWidgetList=function e(t){var r=this;var n=[];fb.forEach(function(e){var i=e.name;var a=e.isNode;var o=r._computeWidget(t,i,a);if(o){n.push(o)}});return n};yb.prototype._computeWidget=function e(t,r,n){var i=this._computePropertyMapping(t,r,n);if(i){if(r==="icon.content"){var a=this._getRulesForAttribute(n,"icon.font");var o=null;if(!a.length){o="Arial"}else if(typeof a[0]==="string"){o=a[0]}if(o){i.iconFont=o;return i}}else{return i}}return null};yb.prototype._computePropertyMapping=function e(t,r,n){var i=this._getRulesForAttribute(n,r);var a=i[0];var o=a&&a.mapping;var s=o&&o.getValues(n);if(o&&s){var u=o.getField();var l={};U(s,function(e,t){if(e===undefined||t==="undefined"){return}if(e in l){l[e].push(t)}else{l[e]=[t]}});if(Object.keys(l).length===0){return null}return{isNode:n,title:t.titleFunction(u),styleProperty:r,dataProperty:u,mapping:l,height:bb(l,r,n,t)}}else{return null}};yb.prototype._getRulesForAttribute=function e(t,r){return this._ogma.modules.styleRules.getRuleList().map(function(e){var n=e.getDefinition();var i=t?n.nodeAttributes:n.edgeAttributes;return Ja(i,r)}).filter(function(e){return e})};function bb(e,t,r,n){var i=n.outerMargin+Xb(n);var a=n.fontSize*gb;var o=i-n.innerMargin*.8;if(t!=="radius"&&t!=="width"){o+=Object.keys(e).length*a}else{o+=a*(r?3:2)}return o}function xb(e,t,r){var n={width:t.width,height:t.height};var i=false;if(!n.width||!n.height||!r){return false}if(e.position==="top"||e.position==="bottom"){i=Ub(n,e,r,e.position==="bottom")}else{i=Bb(n,e,r,e.position==="left")}if(i){r.forEach(function(r){return Sb(e,t,r)})}return i}function Sb(e,t,r){var n=t.getContext("2d");var i=r.x;var a=r.y;var o=r.height;var s=r.isNode;var u=r.styleProperty;var l=r.title;var d=r.mapping;var f=r.iconFont;kb(n,e,i,a,o);Cb(n,e,l,i,a);var h=e.fontSize*gb,c=e.fontSize/2*gb*pb,g=e.fontSize*vb,v=e.fontSize,p=wb(e,s),_=a+Xb(e),m=i+e.innerMargin+p/2,y=i+e.innerMargin*2+p,b=V(d),x=qb(b),S=e.fontColor,A=e.shapeColor,E=Object.keys(d);if(x){E.sort(function(e,t){return nt(d[t])-nt(d[e])})}if(u!=="radius"&&u!=="width"){E.forEach(function(t){var r=d[t];if(u==="color"){if(s){Lb(n,m,_,c,t)}else{Mb(n,m,_,g,v,t)}}else if(u==="shape"){if(s){zb(n,m,_,c,t,A)}else{Pb(n,m,_,g,v,t,A)}}else if(u==="icon.content"){Ib(n,m,_,t,f,c,S)}else if(u==="image.url"){Fb(n,m,_,c,t)}else if(u==="image"){Fb(n,m,_,c,t)}Tb(n,e,y,_,r,x);_+=h})}else if(x){var w=Yb(b),k=Zb(b),C=(w+k)/2;if(w%2===0||k%2===0){C=Math.round(C)}if(s){var T=e.fontSize*.7,L=T*3,M=(T+L)/2,I=i+e.innerMargin+L,F=I+L+e.innerMargin,N=_+L*2-e.innerMargin*.5,z=e.circleStrokeWidth;Ab(n,I,N-T,T,A,z);Ab(n,I,N-M,M,A,z);Ab(n,I,N-L,L,A,z);Eb(n,e.fontFamily,e.fontSize,e.fontColor,"left");n.fillText(Kb(w),F,N+T-T*2);n.fillText(Kb(C),F,N+T-M*2);n.fillText(Kb(k),F,N+T-L*2)}else{var R=(e.widgetWidth-2*e.innerMargin)/3,P=e.fontSize,D=_-e.innerMargin/2,O=D+P*2,B=i+e.innerMargin;n.fillStyle=A;n.fillRect(B,D-P/2,R+1,P);n.fillRect(B+R,D-P/3,R+1,P/1.5);n.fillRect(B+R*2,D-P/6,R,P/3);Eb(n,e.fontFamily,e.fontSize,e.fontColor,"center");n.fillText(Kb(k),B+R*.5,O);n.fillText(Kb(C),B+R*1.5,O);n.fillText(Kb(w),B+R*2.5,O)}}}function Ab(e,t,r,n,i,a){e.beginPath();e.arc(t,r,n,0,cb);e.strokeStyle=i;e.lineWidth=a;e.stroke()}function Eb(e,t,r,n,i,a){if(i===void 0)i="left";if(a===void 0)a="middle";e.textAlign=i;e.textBaseline=a;e.fillStyle=n;e.font=r+'px "'+t+'"'}function wb(e,t){return t?e.fontSize:e.fontSize*vb}function kb(e,t,r,n,i){Db(e,r,n,t.widgetWidth,i,t.borderRadius,t.backgroundColor,t.borderColor,t.borderWidth)}function Cb(e,t,r,n,i){Eb(e,t.fontFamily,t.titleFontSize,t.titleFontColor,t.titleTextAlign);var a=t.titleTextAlign==="center",o=t.widgetWidth-t.innerMargin*2,s=e.measureText(r).width,u=n+(a?t.widgetWidth/2:t.innerMargin),l=i+t.titleFontSize/2+t.innerMargin;if(s>o){var d=o/s,f=(r.length*d|0)-2;r=r.substr(0,f)+""}e.fillText(r,u,l)}function Tb(e,t,r,n,i,a){var o;if(a){if(i.length===1){o=Kb(i[0])}else{var s=nt(i),u=rt(i);o=Kb(s)+" - "+Kb(u)}}else{o=i.join()}Eb(e,t.fontFamily,t.fontSize,t.fontColor);e.fillText(o,r,n)}function Lb(e,t,r,n,i){e.beginPath();e.arc(t,r,n,0,2*hb);e.fillStyle=i;e.fill()}function Mb(e,t,r,n,i,a){e.fillStyle=a;e.fillRect(t-n/2,r-i/2,n,i)}function Ib(e,t,r,n,i,a,o){Eb(e,i,a*2,o,"center");e.fillText(n,t,r)}function Fb(e,t,r,n,i){if(!e._imgStore){e._imgStore={}}var a=e._imgStore[i];if(!a){a=new Image;a.src=i;a.onload=function(){e.drawImage(a,t-n,r-n,n*2,n*2)};e._imgStore[i]=a}else{e.drawImage(a,t-n,r-n,n*2,n*2)}}var Nb=.31;function zb(e,t,r,n,i,a){e.fillStyle=a;if(i==="circle"){Lb(e,t,r,n,a)}else if(i==="square"){e.fillRect(t-n,r-n,n*2,n*2)}else if(i==="cross"){e.fillRect(t-n,r-n*Nb,n*2,n*2*Nb);e.fillRect(t-n*Nb,r-n,n*2*Nb,n*2)}else if(i==="diamond"){e.beginPath();e.moveTo(t-n,r);e.lineTo(t,r-n);e.lineTo(t+n,r);e.lineTo(t,r+n);e.fill()}else if(i==="equilateral"){e.beginPath();e.moveTo(t,r-n);e.lineTo(t+Math.cos(hb/2-cb/5)*n,r+Math.sin(-hb/2+cb/5)*n);e.lineTo(t+Math.cos(hb/2-cb/5*2)*n,r+Math.sin(-hb/2+cb/5*2)*n);e.lineTo(t+Math.cos(hb/2-cb/5*3)*n,r+Math.sin(-hb/2+cb/5*3)*n);e.lineTo(t+Math.cos(hb/2-cb/5*4)*n,r+Math.sin(-hb/2+cb/5*4)*n);e.fill()}else if(i==="star"){e.beginPath();e.moveTo(t,r-n);e.lineTo(t+Math.cos(hb/2-cb/5*2)*n,r+Math.sin(-hb/2+cb/5*2)*n);e.lineTo(t+Math.cos(hb/2-cb/5*4)*n,r+Math.sin(-hb/2+cb/5*4)*n);e.lineTo(t+Math.cos(hb/2-cb/5)*n,r+Math.sin(-hb/2+cb/5)*n);e.lineTo(t+Math.cos(hb/2-cb/5*3)*n,r+Math.sin(-hb/2+cb/5*3)*n);e.fill()}}var Rb=1/3;function Pb(e,t,r,n,i,a,o){e.fillStyle=o;if(a==="line"){e.fillRect(t-n/2,r-i/4,n,i/2)}else if(a==="arrow"){e.fillRect(t-n/2,r-i/4,n*(1-Rb),i/2);e.beginPath();e.moveTo(t+n*(1-Rb-.5),r-i/2);e.lineTo(t+n*(1-Rb-.5),r+i/2);e.lineTo(t+n/2,r);e.fill()}else if(a==="dashed"||a==="dotted"){e.beginPath();e.moveTo(t-n/2,r);e.lineTo(t+n/2,r);e.strokeStyle=o;e.lineWidth=i/2;e.setLineDash(a==="dashed"?[8,3]:[3,3]);e.stroke()}else if(a==="tapered"){e.beginPath();e.moveTo(t-n/2,r-i/2);e.lineTo(t-n/2,r+i/2);e.lineTo(t+n/2,r);e.fill()}}function Db(e,t,r,n,i,a,o,s,u){e.setLineDash([]);e.beginPath();e.moveTo(t+a,r);e.lineTo(t+n-a,r);e.quadraticCurveTo(t+n,r,t+n,r+a);e.lineTo(t+n,r+i-a);e.quadraticCurveTo(t+n,r+i,t+n-a,r+i);e.lineTo(t+a,r+i);e.quadraticCurveTo(t,r+i,t,r+i-a);e.lineTo(t,r+a);e.quadraticCurveTo(t,r,t+a,r);e.closePath();e.fillStyle=o;e.fill();e.strokeStyle=s;e.lineWidth=u;e.stroke()}function Ob(e,t){if(e.isNode!==t.isNode){return e.isNode?e:t}else{return e.title<=t.title?-1:1}}function Bb(e,t,r,n){var i=t.widgetWidth+t.outerMargin,a=Math.floor((e.width-t.outerMargin)/i),o=e.height,s=t.outerMargin,u=n?t.outerMargin:e.width-i,l=1;r=r.slice().sort(Ob);for(var d=0;d<r.length;++d){var f=r[d];if(s+f.height>o){if(s===t.outerMargin){return false}else{s=t.outerMargin;l+=1;if(n){u+=i}else{u-=i}}}f.x=u;f.y=s;s+=f.height}return l<=a}function jb(e,t,r){var n=null;for(var i=0;i<t.length;++i){var a=t[i];if((a.isNode===e.isNode||t.length===1)&&(n===null||a.height<t[n].height)){n=i}}a=t[n];a.content.push(e);a.height+=e.height+r.outerMargin}function Vb(e){var t=0;for(var r=1;r<e.length;++r){if(e[r].height>e[t].height){t=r}}return t}function Ub(e,t,r,n){r=r.slice();var i=t.widgetWidth+t.outerMargin,a=Math.floor((e.width-t.outerMargin)/i),o=e.height-t.outerMargin,s=new Array(Math.min(a,r.length)),u=r.length,l=0,d=0,f=0,h=0;for(var c=0;c<u;++c){var g=r[c];if(g.isNode){l+=1;d+=g.height}else{f+=1;h+=g.height}}var v=d+h,p=d/v,_=h/v,m=Math.round(p*a),y=Math.round(_*a);if(m>l){m=l}else if(y>f){m=a-f}if(a===0){return false}for(var b=0;b<s.length;++b){s[b]={content:[],height:0,isNode:b<m}}for(b=0;b<u;++b){var x=Vb(r);jb(r[x],s,t);r.splice(x,1)}if(s.every(function(e){var t=e.content;return t.length===1})){s.sort(Hb)}else{s.sort(Wb)}var S=t.outerMargin;for(b=0;b<s.length;++b){var A=s[b];if(A.height>o){return false}A.content.sort(Gb);var E=0;for(var w=0;w<A.content.length;++w){var k=A.content[w];k.x=S;k.y=n?e.height-E-k.height-t.outerMargin:E+t.outerMargin;E+=k.height+t.outerMargin}S+=i}return true}function Gb(e,t){return e.height-t.height}function Wb(e,t){if(e.isNode!==t.isNode){return e.isNode?e:t}else{return t.height-e.height}}function Hb(e,t){if(e.isNode!==t.isNode){return e.isNode?e:t}else{return e.content[0].title<=t.content[0].title?-1:1}}function Xb(e){return e.innerMargin+(e.titleFontSize+e.fontSize)*gb}function qb(e){if(C(e)){return e.reduce(function(e,t){return e&&qb(t)},true)}else{return e==="undefined"||!isNaN(+e)}}function Yb(e){if(C(e)){return e.reduce(function(e,t){return Math.min(e,Yb(t))},Infinity)}else{return isNaN(e)?Infinity:+e}}function Zb(e){if(C(e)){return e.reduce(function(e,t){return Math.max(e,Zb(t))},-Infinity)}else{return isNaN(e)?-Infinity:+e}}function Kb(e,t){e=+e;var r=["K","M","B","T","P","E","Z","Y"];if(e>9999){var n=0;while(n<r.length&&e>999){e/=1e3;++n}return Qb(e)+r[n-1]}else if(t){return Math.round(e).toString()}else if(e<10){return(Math.round(e*1e3)/1e3).toString()}else if(e<100){return(Math.round(e*100)/100).toString()}else if(e<1e3){return(Math.round(e*10)/10).toString()}else{return Math.round(e).toString()}}function Qb(e){if(e<10){return Math.round(e*100)/100}else if(e<100){return Math.round(e*10)/10}else if(e<1e3){return Math.round(e)}}var Jb={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes;return t.setSelected(true)}};Ogma.extend(function(e){var t=new $b(e);e.modules.lasso=t;e.tools.lasso={enable:function(e){return t.enable(e)},disable:function(){return t.disable()},enabled:function(){return t.enabled()}}});var $b=function e(t){var r=this;this._ogma=t;this._camera=t.modules.camera;this._graphics=t.modules.graphics;this._graph=t.modules.graph;this._captor=t.modules.captor;this._interactions=t.modules.interactions;this._spatial=t.modules.spatial;this._options=G(Jb);this._enabled=false;this._points=[];this._bbox=new Fr;this._canvas=we();this._ctx=this._canvas.getContext("2d");this._interaction=this._interactions.onDrag({priority:"lasso",check:function(){return r._enabled},onStart:function(e){var t=e.x;var n=e.y;r._bbox.reset();ex(r,t,n,false)},onProgress:function(e){var t=e.x;var n=e.y;return ex(r,t,n,true)},onStop:function(){var e=r._bbox;var t=e.minX;var n=e.minY;var i=e.maxX;var a=e.maxY;var o=r._spatial.queryProjected(t,n,i,a);var s=o.nodes;var u=o.edges;var l=s.filter(function(e){var t=e.isVisible();var n=e.getAttribute("detectable");return t&&n&&r._camera.isNodeInPolygon(e,r._points)});var d=u.filter(function(e){var t=e.isVisible();var n=e.getAttribute("detectable");return t&&n&&r._camera.isEdgeInPolygon(e,r._points)});r._ctx.clearRect(0,0,r._canvas.width,r._canvas.height);r._points=[];r.disable();r._options.callback({nodes:l,edges:d})}})};$b.prototype.enable=function e(t){if(this._enabled){return}this._enabled=true;this._captor.setDetectionEnabled(false);this._options=Za(t,Jb);this._graphics.addCanvas(this._canvas);je(this._canvas,this._options.cursorStyle);if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorPosition())}};$b.prototype.disable=function e(){if(!this._enabled){return}this._enabled=false;this._captor.setDetectionEnabled(true);this._graphics.removeCanvas(this._canvas)};$b.prototype.enabled=function e(){return this._enabled};function ex(e,t,r,n){var i=ke();var a=e._ctx;var o=e._options;var s=e._points;e._bbox.addPoint(t,r);a.clearRect(0,0,e._canvas.width,e._canvas.height);s.push({x:t,y:r});if(n){var u=s[0];a.lineWidth=o.strokeWidth;a.lineJoin="bevel";a.strokeStyle=o.strokeColor;a.fillStyle=o.fillColor;a.beginPath();a.moveTo(u.x*i,u.y*i);for(var l=1;l<s.length;++l){var d=s[l];a.lineTo(d.x*i,d.y*i)}a.stroke();if(o.fillColor){a.fill()}}}var tx={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes;var r=e.edges;if(t.size){t.setSelected(true)}else{r.setSelected(true)}}};Ogma.extend(function(e){var t=new rx(e);e.modules.rectangleSelect=t;e.tools.rectangleSelect={enable:function(e){return t.enable(e)},disable:function(){return t.disable()},enabled:function(){return t.enabled()}}});var rx=function e(t){var r=this;this._ogma=t;this._graph=t.modules.graph;this._selection=t.modules.selection;this._camera=t.modules.camera;this._dom=t.modules.dom;this._graphics=t.modules.graphics;this._interactions=t.modules.interactions;this._keyboard=t.modules.keyboard;this._captor=t.modules.captor;this._spatial=t.modules.spatial;this._options=G(tx);this._canvas=we();this._ctx=this._canvas.getContext("2d");this._enabled=false;this._start=null;this._rectangle=new Fr;this._interaction=this._interactions.onDrag({priority:"lasso",disableDetection:true,check:function(){return r._enabled},onStart:function(e){var t=e.x;var n=e.y;r._rectangle.reset();r._start={x:t,y:n};r._ctx.fillStyle=r._options.fillColor;r._ctx.strokeStyle=r._options.strokeColor;r._ctx.lineWidth=r._options.strokeWidth},onProgress:function(e){var t=e.x;var n=e.y;return r._refreshRectangle({x:t,y:n})},onStop:function(){var e=r._captor.getCursorPosition();var t=r._formatRectangle(e);var n=r._spatial.queryProjected(t.minX,t.minY,t.maxX,t.maxY);var i=n.nodes;var a=n.edges;var o=i.filter(function(e){var n=e.isVisible();var i=e.getAttribute("detectable");return n&&i&&r._camera.isNodeInRectangle(e,t)});var s=a.filter(function(e){var n=e.isVisible();var i=e.getAttribute("detectable");return n&&i&&r._camera.isEdgeInRectangle(e,t)});r._clearCanvas();r.disable();r._options.callback({nodes:o,edges:s})}})};rx.prototype.enable=function e(t){if(this._enabled){return}this._enabled=true;this._options=Za(t,tx);this._graphics.addCanvas(this._canvas);je(this._canvas,this._options.cursorStyle);if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorPosition())}};rx.prototype.disable=function e(){if(!this._enabled){return}this._enabled=false;this._graphics.removeCanvas(this._canvas)};rx.prototype.enabled=function e(){return this._enabled};rx.prototype._clearCanvas=function e(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)};rx.prototype._formatRectangle=function e(t){var r=this._start.x;var n=this._start.y;var i=t.x;var a=t.y;var o=Math.abs(r-i);var s=Math.abs(n-a);var u=r<i?r:i;var l=n<a?n:a;return this._rectangle.reset().addPoint(u,l).addPoint(u+o,l+s)};rx.prototype._refreshRectangle=function e(t){var r=this._formatRectangle(t);var n=r.minX;var i=r.minY;var a=r.width;var o=r.height;var s=ke();this._clearCanvas();this._ctx.strokeRect(n*s,i*s,a*s,o*s);if(this._options.fillColor){this._ctx.fillRect(n*s,i*s,a*s,o*s)}};var nx={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1};Ogma.extend(function(e){var t=new ix(e);e.modules.resizing=t;e.tools.resize={enable:function e(r){return t.enable(r)},disable:function e(){return t.disable()},enabled:function e(){return t.enabled()}}});var ix=function e(t){var r=this;this._dom=t.modules.dom;this._interactions=t.modules.interactions;this._events=t.modules.events;this._camera=t.modules.camera;this._dom=t.modules.dom;this._spatial=t.modules.spatial;this._graphics=t.modules.graphics;this._engine=this._graphics.getGraphicsEngine();this._canvas=we();this._ctx=this._canvas.getContext("2d");this._init();this._interactions.onDrag({priority:"resizing",disableDetection:true,check:function(){return r._enabled&&r._pointedNode},onStart:function(e){var t=e.x;var n=e.y;r._x=t;r._y=n;r._nodeBeingResized=r._pointedNode},onProgress:function(e){var t=e.x;var n=e.y;r._x=t;r._y=n;r._displayHandles()},onStop:function(){r._nodesToHighlight.forEach(function(e,t){var n=r._additionalRadiuses[t]/r._camera.zoom;e.setAttributes({radius:e.getAttribute("radius")+n,x:e.getPosition().x+n,y:e.getPosition().y-n})});r._pointedNode=null;r._nodeBeingResized=null;r._displayHandles()}});this._onSelectionChange=function(){if(!r._enabled){return}r._nodesToHighlight=t.getSelectedNodes();r._displayHandles()};this._displayHandlesHandler=function(){return r._displayHandles()};this._moveHandler=function(e){var t=e.x;var n=e.y;r._dom.setTimeout(function(){return r._detectBoundingBoxes(t,n)})};t.events.onNodesSelected(this._onSelectionChange);t.events.onNodesUnselected(this._onSelectionChange)};ix.prototype._init=function e(){this._enabled=false;this._nodesToHighlight=null;this._options=null;this._nodeBeingResized=null;this._pointedNode=null;this._cursorEnabled=false;this._x=0;this._y=0;this._additionalRadiuses=[]};ix.prototype._enableCursor=function e(){if(!this._cursorEnabled){this._graphics.addCursorStyle(this._options.cursor);this._cursorEnabled=true}};ix.prototype._disableCursor=function e(){if(this._cursorEnabled){this._graphics.removeCursorStyle(this._options.cursor);this._cursorEnabled=false}};ix.prototype._detectBoundingBoxes=function e(t,r){var n=this;if(!this._enabled||this._nodeBeingResized||!this._nodesToHighlight){return}var i=this._options.handleSize/2;var a=this._options.detectionMargin;this._pointedNode=null;this._forEachNodeToHighlight(function(e,o,s){var u=o.x+s-i-a;var l=o.x+s+i+a;var d=o.y-s-i-a;var f=o.y-s+i+a;if(t>=u&&t<=l&&r>=d&&r<=f){n._pointedNode=e}});if(this._pointedNode){this._enableCursor()}else{this._disableCursor()}};ix.prototype._forEachNodeToHighlight=function e(t){var r=this;this._nodesToHighlight.forEach(function(e){var n=e.getPositionOnScreen();var i=r._getTotalOnScreenRadius(e);t(e,n,i)})};ix.prototype._displayHandles=function e(){var t=this;if(!this._enabled||!this._nodesToHighlight){return}var r=this._canvas;var n=this._ctx;var i=r.width;var a=r.height;var o=ke();var s=this._options;var u=s.color;var l=s.lineWidth;var d=s.handleSize;var f=0;n.clearRect(0,0,i,a);if(this._nodeBeingResized){var h=this._getTotalOnScreenRadius(this._nodeBeingResized),c=this._nodeBeingResized.getPositionOnScreen();f=Math.max(this._x-(c.x+h),-(this._y-(c.y-h)))/2}this._additionalRadiuses=[];this._forEachNodeToHighlight(function(e,r,i){var a=0;if(t._nodeBeingResized){a=f;var s=-i+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")+l/2+1;if(a<s){a=s}else{a=t._snap(e,a)}t._additionalRadiuses.push(a);var h=e.getAttribute("shape"),c=t._engine.getShapePoints(h),g=r.x+a,v=r.y-a,p=i+a;t._displayNodePreview(n,o,g,v,p,c)}n.strokeStyle=u;n.fillStyle=u;n.lineWidth=l;n.strokeRect((r.x-i)*o,(r.y-i-a*2)*o,(a+i)*2*o,(a+i)*2*o);n.fillRect((r.x+i+a*2-d/2)*o,(r.y-i-a*2-d/2)*o,d*o,d*o)})};ix.prototype._displayNodePreview=function e(t,r,n,i,a,o){n*=r;i*=r;a*=r;t.beginPath();if(o.length===1){t.arc(n,i,a,0,Math.PI*2)}else{for(var s=0;s<o.length;++s){var u=o[s],l=n+u.x*a,d=i+u.y*a;if(s===0){t.moveTo(l,d)}else{t.lineTo(l,d)}}}t.fillStyle=this._options.previewColor;t.fill()};ix.prototype._getTotalOnScreenRadius=function e(t){return t.getAttribute("radius")*this._camera.zoom+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")+this._options.lineWidth/2};ix.prototype._snap=function e(t,r){var n=this;var i=this._spatial.getNodesInScreenByDistance(t).filter(function(e){return!e.isSelected()}).slice(0,this._options.nbNodesToSnapTo);var a=this._ctx;var o=this._getTotalOnScreenRadius(t);var s=o+r;var u=this._options.snappingRatio;var l=s/o;var d=Math.round(it(l,u));var f=o*Math.pow(u,d);var h=null;i.forEach(function(e){var t=n._getTotalOnScreenRadius(e);if(Math.abs(t-s)<=Math.abs(f-s)){f=t;h=e}});if(h){a.save();a.strokeStyle=this._options.sizeIndicatorColor;a.lineWidth=this._options.sizeIndicatorThickness;var c=h.getAttribute("radius");this._displaySizeIndicator(t,f);i.filter(function(e){return e.getAttribute("radius")===c}).forEach(function(e){return n._displaySizeIndicator(e)});a.restore()}return f-o};ix.prototype._displaySizeIndicator=function e(t,r){var n=this._ctx;var i=ke();var a=t.getPositionOnScreen();var o=this._getTotalOnScreenRadius(t);var s=r||o;var u=r?r-o:0;var l=u-this._options.sizeIndicatorOffset-(r?t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width"):0);var d=a.x-s+l|0;var f=a.y-s-u|0;var h=a.y+s-u|0;var c=this._options.sizeIndicatorWidth;n.beginPath();n.moveTo((d-c)*i,f*i);n.lineTo((d+c)*i,f*i);n.moveTo(d*i,f*i);n.lineTo(d*i,h*i);n.moveTo((d-c)*i,h*i);n.lineTo((d+c)*i,h*i);n.stroke()};ix.prototype.enable=function e(t){if(this._enabled){return}this._options=Za(t,nx);this._graphics.addCanvas(this._canvas);this._ctx=this._canvas.getContext("2d");this._events.on({"cameraMove progressMoveNodesByDragging":this._displayHandlesHandler,"move down":this._moveHandler});this._enabled=true};ix.prototype.disable=function e(){if(!this._enabled){return}this._events.removeListener(this._displayHandlesHandler);this._events.removeListener(this._moveHandler);this._graphics.removeCanvas(this._canvas);this._disableCursor();this._init()};ix.prototype.enabled=function e(){return this._enabled};var ax={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"};var ox=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._captor=t.modules.captor;this._graph=t.modules.graph;this._camera=t.modules.camera;this._graphics=t.modules.graphics;this._selection=t.modules.selection;this._events=t.modules.events;this._settings=t.modules.settings;this._interactions=t.modules.interactions;this._rewirableClass=t.styles.createClass({name:Gl,isBuiltin:true,edgeAttributes:{layer:Ql}});this._enabled=false;this._canvas=we();this._ctx=this._canvas.getContext("2d");this._nodesToHighlight=null;this._movedEdges=null;this._startNode=null;this._hoverHandle=false;this._grabHandle=false;this._prevSettings=null;this._x=0;this._y=0;this._refreshHandles=function(){if(!r._enabled||r._movedEdges){return}var e=r._ogma.getSelectedEdges();r._nodesToHighlight=e.getExtremities().dedupe();r._rewirableClass.clearEdges();r._rewirableClass.add(e);fx(r)};this._events.on({cameraMove:function(){return fx(r)},move:function(){return fx(r)},progressMoveNodesByDragging:function(){return fx(r)},down:function(){if(r._hoverHandle){r._grabHandle=true}},up:function(){r._grabHandle=false}});t.events.onEdgesSelected(this._refreshHandles);t.events.onEdgesUnselected(this._refreshHandles);this._interaction=this._interactions.onDrag({priority:"rewiring",check:function(e){var t=e.target;if(!r._enabled||!t||!t.isNode||!r._hoverHandle){return false}var n=t.getAdjacentEdges().filter(function(e){return e.isSelected()});if(n.size){r._movedEdges=n;r._edgeColors=r._movedEdges.getAttribute("color");r._startNode=t;return true}else{return false}},onStart:function(){r._nodesToHighlight=r._nodesToHighlight.filter(function(e){return e!==r._startNode});lx(r,true);var e=r._options.cursorOnDrag;r._prevSettings=r._settings.update({edgeHover:false,cursor:{default:e,node:e,edge:e}})},onProgress:function(e){var t=e.x;var n=e.y;r._x=t;r._y=n},onStop:function(){r._restoreSettings();var e=ux(r);if(e){r._movedEdges.forEach(function(t){if(t.getTarget()===r._startNode){t.setTarget(e)}else{t.setSource(e)}})}lx(r,false);r._movedEdges.setSelected(true);r._movedEdges=null;r._refreshHandles(r)}})};ox.prototype.enable=function e(t){if(this._enabled){return}this._options=Za(t,ax);this._enabled=true;this._graphics.addCanvas(this._canvas);this._refreshHandles()};ox.prototype.disable=function e(){if(!this._enabled){return}this._interaction.stop();this._graphics.removeCursorStyle(this._options.cursorOnDrag);this._disableCursorOnHover();this._restoreSettings();this._graphics.removeCanvas(this._canvas);this._rewirableClass.clearEdges();this._enabled=false};ox.prototype.enabled=function e(){return this._enabled};ox.prototype._restoreSettings=function e(){if(this._prevSettings){this._settings.update(this._prevSettings);this._prevSettings=null}};ox.prototype._disableCursorOnHover=function e(){if(this._hoverHandle&&!this._grabHandle){this._hoverHandle=false;this._graphics.removeCursorStyle(this._options.cursorOnHover)}};ox.prototype._enableCursorOnHover=function e(){if(!this._hoverHandle){this._hoverHandle=true;this._graphics.addCursorStyle(this._options.cursorOnHover)}};function sx(e){if(!e._movedEdges){return}var t=e._x;var r=e._y;var n=e._ctx;var i=ke();var a={x:t,y:r};var o=e._camera.getZoom();var s=e._movedEdges;s.forEach(function(t,r){var s=e._edgeColors[r];var u=t.getSource();var l=t.getTarget();var d=ux(e);var f=l===e._startNode?u:l;var h=t.getAttribute("width")*o;var c=f.getPositionOnScreen();var g=d?d.getPositionOnScreen():a;f.addClass(Vl);n.beginPath();n.moveTo(c.x*i,c.y*i);n.lineTo(g.x*i,g.y*i);n.strokeStyle=s;n.lineWidth=h*i;n.stroke()})}function ux(e){var t=e._captor.getPointedElement();return t&&t.isNode?t:null}function lx(e,value){e._movedEdges.setExcluded(value)}function dx(e){e._canvas.getContext("2d").clearRect(0,0,e._canvas.width,e._canvas.height)}function fx(e){if(!e._enabled||!e._nodesToHighlight){return}var t=e._captor.getCursorPosition();var r=ux(e);var n=e._camera.zoom;var i=e._canvas.getContext("2d");var a=ke();var o=e._options.color;var s=e._options.radius;var u=s*2*a;dx(e);sx(e);i.fillStyle=o;i.strokeStyle=o;var l=false;e._nodesToHighlight.forEach(function(e){var r=e.getPositionOnScreen();var o=r.x;var d=r.y;var f=e.getAttribute("radius")*(e.getAttribute("scalingMethod")==="fixed"?1:n);if(f>s){i.fillRect((o-s)*a,(d-s)*a,u,u);if(distance(o,d,t.x,t.y)<s){l=true}}});if(e._movedEdges){var d=t;if(r){d=r.getPositionOnScreen()}i.fillRect((d.x-s)*a,(d.y-s)*a,u,u)}if(l){e._enableCursorOnHover()}else{e._disableCursorOnHover()}}Ogma.extend(function(e){var t=new ox(e);e.modules.rewiring=t;e.tools.rewire={enable:function e(r){return t.enable(r)},disable:function e(){return t.disable()},enabled:function e(){return t.enabled()}}});var hx={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:true,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:true,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};var cx={NONE:0,CENTER:1,LEFT:2,RIGHT:3,TOP:4,BOTTOM:5};var gx=function e(t){this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._spatial=t.modules.spatial;this._settings=t.modules.settings;this._events=t.modules.events;this._camera=t.modules.camera;this._options=G(hx);this._enabled=false;this._canvas=we();this._ctx=this._canvas.getContext("2d");this._ysnap=cx.NONE;this._xsnap=cx.NONE;this._node=null;this._r=0;this._viewport=null;this._horizontalGuideLine=null;this._verticalGuideLine=null;this._vguideline={start:{x:0,y:0},end:{x:0,y:0}};this._hguideline={start:{x:0,y:0},end:{x:0,y:0}};this._distanceGuidelines=[-1,-1];this._neighbourGuidelines=[]};gx.prototype.enable=function e(t){var r=this;if(this._enabled){return}var n=this._events;this._options=Za(t,hx);this._enabled=true;this._graphics.addCanvas(this._canvas);this._dragStartListener=n.on("startMoveNodesByDragging",function(e){return r._onNodeDragStart(e)});this._dragEndListener=n.on("endMoveNodesByDragging",function(e){return r._onNodeDragEnd(e)});this._settings.update({"interactions.drag.onBeforeDrag":function(e,t,n,i){return r._onBeforeDrag(t,n,i)}})};gx.prototype.disable=function e(){if(!this._enabled){return}var t=this._events;t.removeListener(this._dragStartListener);t.removeListener(this._dragEndListener);this._graphics.removeCanvas(this._canvas);this._settings.update({"interactions.drag.onBeforeDrag":null});this._enabled=false};gx.prototype.enabled=function e(){return this._enabled};gx.prototype._onNodeDragStart=function e(t){var r=t.nodes;if(r.size===1){this._node=r.get(0);this._cacheViewport();this._r=this._node.getAttribute("radius")}};gx.prototype._onBeforeDrag=function e(t,r,n){if(this._node){var i=n[0];this._scan(i);this._node.setAttributes(i)}};gx.prototype._onNodeDragEnd=function e(){this._node=null;this._clearCanvas()};gx.prototype._cacheViewport=function e(){var t=this._camera;var r=t.screenToGraphCoordinates({x:0,y:0});var n=t.screenToGraphCoordinates({x:t.width,y:t.height});this._viewport={xmin:r.x,ymin:r.y,xmax:n.x,ymax:n.y};this._nodes=this._spatial.getNodesByBoundingBox(r.x,r.y,n.x,n.y);var i=this._node._index;var a=this._nodes._indexes.slice();a.splice(a.indexOf(i),1);var o=this._graphics._getAttributeArray(true,"radius");var s=this._graph.getNodeAttribute("x");var u=this._graph.getNodeAttribute("y");var l=s._buffer;var d=u._buffer;var f=E(a.slice(),s);var h=E(a.slice(),u);var c={},g={};var v={},p={};var _=this._gridResolution=this._node.getAttribute("radius");for(var m=0,y=a.length;m<y;m++){var b=f[m],x=h[m];var S=l[b]/_|0,A=d[x]/_|0;if(!c[S]){c[S]=[]}if(!g[A]){g[A]=[]}c[S].push(b);g[A].push(x);v[b]=p[x]=m}this._nodesByX=f;this._nodesByY=h;this._nodesByXIndex=v;this._nodesByYIndex=p;this._xGrid=c;this._yGrid=g;this._xList=s;this._yList=u;this._X=l;this._Y=d;this._R=o};gx.prototype._clearCanvas=function e(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)};gx.prototype._drawLine=function e(t,r,n,i){var a=this._ctx,o=ke(),s=this._camera.graphToScreenCoordinates(t),u=this._camera.graphToScreenCoordinates(r);a.beginPath();a.moveTo(s.x*o,s.y*o);a.lineTo(u.x*o,u.y*o);a.strokeStyle=i;a.lineWidth=n;a.stroke()};gx.prototype._scan=function e(t){this._clearCanvas();var r=this._node._index;var n=t.x,i=t.y,a=this._r;var o=this._options;var s=this._xList;var u=this._yList;var l=this._R;var d=this._X;var f=this._Y;var h=this._camera.zoom;var c=Math.min(a,this._options.tolerance/h);var g=a*2*o.sideSnapDistanceFactor;var v=o.guidelineWidth;var p=o.guidelineColor;var _,m;var y=r;var b=r;var x,S,A,w,k,C,T;var L=false,M=false;y=vx(this._nodesByX,d,n);b=vx(this._nodesByY,f,i);if(Math.abs(d[y]-n)>o.centerSnapDistance){y=r}if(Math.abs(f[b]-i)>o.centerSnapDistance){b=r}this._xsnap=cx.NONE;if(y!==r){_=this._vguideline.start;m=this._vguideline.end;T=y;x=d[T];S=f[T];A=l.get(T);C=Math.abs(n-x);var I=Math.abs(n-a-(x-A));var F=Math.abs(n+a-(x+A));if(C<Math.max(a,A)){if(S<i){_.y=S-A;m.y=i+a}else{_.y=S+A;m.y=i-a}var N=Math.min(I,C,F);if(N===C){_.x=m.x=x;m.y=i;_.y=S;this._xsnap=cx.CENTER}else if(Math.abs(i-S)<A+a+g){if(N===I){_.x=m.x=x-A;this._xsnap=cx.LEFT}else{_.x=m.x=x+A;this._xsnap=cx.RIGHT}}if(N<c){L=true}}if(this._xsnap!==cx.NONE){this._drawLine(_,m,v,p)}}this._ysnap=cx.NONE;if(b!==r){_=this._hguideline.start;m=this._hguideline.end;T=b;x=d[T];S=f[T];A=l.get(T);C=Math.abs(i-S);var z=Math.abs(i-a-(S-A));var R=Math.abs(i+a-(S+A));if(C<Math.max(a,A)){if(x<n){_.x=x-A;m.x=n+a}else{_.x=x+A;m.x=n-a}var P=Math.min(z,C,R);if(P===C){_.y=m.y=S;m.x=n;_.x=x;this._ysnap=cx.CENTER}else if(Math.abs(n-x)<A+a+g){if(P===z){_.y=m.y=S-A;this._ysnap=cx.TOP}else{_.y=m.y=S+A;this._ysnap=cx.BOTTOM}}if(P<c){M=true}}if(this._ysnap!==cx.NONE){this._drawLine(_,m,v,p)}}if(o.preferredDistance.enabled){var D=o.preferredDistance.ratio;var O=Math.min(o.preferredDistance.tolerance/h,a);var B=Math.max(a,A);if(y!==r&&(this._xsnap===cx.NONE||!L)){T=y;x=d[T];S=f[T];A=l.get(T);w=Math.abs(n-x)-(a+A)*(1+D);if(w<=O&&w>=-O){var j=n<x?-1:1;_=this._vguideline.start;m=this._vguideline.end;_.x=m.x=x+j*(1+D)*(a+A);_.y=S-B;m.y=S+B;_.x=m.x=x;this._drawLine(_,m,v,p);_.y=i-B;m.y=i+B;_.x=m.x=x+j*(1+D)*(a+A);this._drawLine(_,m,v,p);this._xsnap=cx.CENTER;L=true}}else if(b!==r&&(this._ysnap===cx.NONE||!M)){T=b;x=d[T];S=f[T];A=l.get(T);k=Math.abs(i-S)-(a+A)*(1+D);if(k<=O&&k>=-O){var V=i<S?-1:1;_=this._hguideline.start;m=this._hguideline.end;_.x=x-B;m.x=x+B;_.y=m.y=S;this._drawLine(_,m,v,p);_.x=n-B;m.x=n+B;_.y=m.y=S+V*(1+D)*(a+A);this._drawLine(_,m,v,p);this._ysnap=cx.CENTER;M=true}}}if(o.neighbours.enabled){var U=this._gridResolution;var G=n/U|0,W=i/U|0;var H=this._xGrid,X=this._yGrid,q=[];var Y=[].concat(X[W-1]||q,X[W]||q,X[W+1]||q);var Z=[].concat(H[G-1]||q,H[G]||q,H[G+1]||q);var K;if(Y.length>1){E(Y,s);K=this.findNeighboursToAlign(Y,d,r,n,a,l,c);if(K){this.drawNeighbourGuidelines(K,t);L=false}}if(Z.length>1&&!K){E(Z,u);K=this.findNeighboursToAlign(Z,f,r,i,a,l,c);if(K){this.drawNeighbourGuidelines(K,t,true);M=false}}}if(L||M){this._snap(t,!L,!M)}};gx.prototype.findNeighboursToAlign=function e(t,r,n,i,a,o,s){var u,l,d,f=false,h,c,g;var v=Math.abs;for(var p=0,_=t.length;!f&&p<_;p++){for(var m=0;!f&&m<_;m++){if(p===m){continue}var y=t[p],b=t[m];if(m<p){h=b;b=y;y=h}var x=r[y],S=r[b];var A=o.get(y),E=o.get(b);if(x+A<i-a&&S-E>i+a&&v(v(x+A-(i-a))-v(S-E-(i+a)))<=s){u=y;l=n,d=b;g=x+A+Math.abs(S-E-(x+A))/2;c=[x+A,g-a,g+a,S-E];f=true}else if(x+A<i-a&&S+E<i-a&&v(v(x+A-(S-E))-v(Math.max(x+A,S+E)-(i-a)))<=s){u=y;l=b;d=n;g=S+A+v(v(x+A-(S-E)))+a;c=[x+A,S-E,S+E,g-a];f=true}else if(x-A>i+a&&S-E>i+a&&v(v(x+A-(S-E))-v(Math.min(x-A,S-E)-(i+a)))<=s){u=n;l=y;d=b;g=x-A-v(v(x+A-(S-E)))-a;c=[g+a,x-A,x+A,S-E];f=true}}}return f?{a:u,b:l,c:d,current:n,target:g,points:c}:null};gx.prototype.drawNeighbourGuidelines=function e(t,r,n){var i=t.a;var a=t.b;var o=t.c;var s=t.points;var u=t.target;var l={x:0,y:0};var d={x:0,y:0};var f=this._R,h=this._X,c=this._Y;var g=f.getMultiple([i,a,o]);var v=g[0];var p=g[1];var _=g[2];var m=this._options.neighbours;var y=m.offset;var b=m.lineWidth;var x=m.lineColor;var S,A;if(n){r.y=u;v=-v;p=-p;_=-_;S=d.x=l.x=Math.min(h[i]+v,h[a]+p,h[o]+_)-y;A=h}else{r.x=u;S=d.y=l.y=Math.max(c[i]+v,c[a]+p,c[o]+_)+y;A=c}var E=n?"y":"x";var w=n?"x":"y";l[E]=s[0];d[E]=s[1];this._drawLine(l,d,b,x);l[E]=s[2];d[E]=s[3];this._drawLine(l,d,b,x);l[E]=s[0];l[w]=S-y/2;d[E]=s[0];l[w]=A[i]+v;this._drawLine(l,d,b,x);l[E]=s[1];l[w]=S-y/2;d[E]=s[1];l[w]=A[a]+p;this._drawLine(l,d,b,x);l[E]=s[2];l[w]=S-y/2;d[E]=s[2];l[w]=A[a]+p;this._drawLine(l,d,b,x);l[E]=s[3];l[w]=S-y/2;d[E]=s[3];l[w]=A[o]+_;this._drawLine(l,d,b,x)};gx.prototype._snap=function e(t,r,n){var i=this._xsnap;var a=this._ysnap;var o;if(!r&&i!==cx.NONE){o=this._vguideline.end;if(i===cx.LEFT){t.x=o.x+this._r}else if(i===cx.RIGHT){t.x=o.x-this._r}else{t.x=o.x}}if(!n&&a!==cx.NONE){o=this._hguideline.end;if(a===cx.TOP){t.y=o.y+this._r}else if(a===cx.BOTTOM){t.y=o.y-this._r}else{t.y=o.y}}};function vx(e,t,r,n){var i=0,a=e.length-1;var o,s,u;var l=Math.abs;while(i<a){o=(i+a)/2|0;s=l(t[e[o]]-r);u=l(t[e[o+1]]-r);if(u<=s){i=o+1}else{a=o}}return n?a:e[a]}Ogma.extend(function(e){var t=new gx(e);e.modules.snapping=t;e.tools.snapping={enable:function(e){return t.enable(e)},disable:function(){return t.disable()}}});Ogma.extend(function(e){var t=new _x(e);e.modules.tooltip=t;e.tools.tooltip={};e.tools.tooltip.onNodeHover=function(e,r){wx(t,"hover.node",e,r)};e.tools.tooltip.onNodeClick=function(e,r){wx(t,"click.left.node",e,r)};e.tools.tooltip.onNodeRightClick=function(e,r){wx(t,"click.right.node",e,r)};e.tools.tooltip.onNodeDoubleClick=function(e,r){wx(t,"doubleClick.left.node",e,r)};e.tools.tooltip.onEdgeHover=function(e,r){wx(t,"hover.edge",e,r)};e.tools.tooltip.onEdgeClick=function(e,r){wx(t,"click.left.edge",e,r)};e.tools.tooltip.onEdgeRightClick=function(e,r){wx(t,"click.right.edge",e,r)};e.tools.tooltip.onEdgeDoubleClick=function(e,r){wx(t,"doubleClick.left.edge",e,r)};e.tools.tooltip.onBackgroundClick=function(e,r){wx(t,"click.left.background",e,r)};e.tools.tooltip.onBackgroundRightClick=function(e,r){wx(t,"click.right.background",e,r)};e.tools.tooltip.onBackgroundDoubleClick=function(e,r){wx(t,"doubleClick.left.background",e,r)};e.tools.tooltip.refresh=function(){return t.refresh()};e.tools.tooltip.isShown=function(){return t.isShown()};e.tools.tooltip.hide=function(){return t.hide()};e.events.onTooltipShown=function(t){e.modules.events.on("showTooltip",t);return e.events};e.events.onTooltipHidden=function(t){e.modules.events.on("hideTooltip",t);return e.events};e.tools.tooltip.show=function(e,r){return t.show(e,r)}});var px=["top","bottom","left","right","cssDefined"];var _x=function e(t){var r=this;this._dom=t.modules.dom;this._connectNodes=t.modules.connectNodes;this._interactions=t.modules.interactions;this._camera=t.modules.camera;this._events=t.modules.events;this._handlers={};this._currentHandlerName=null;this._tooltip=null;this._isHover=false;this._events.register(["showTooltip","hideTooltip"]);this._events.on({"up dragStart":function(){if(!r._isHover){Tx(r)}},unhover:function(){if(r._isHover){Tx(r)}},clear:function(){Tx(r)}});this._interactions.onHover(bx(this,"hover",true));this._interactions.onClick(bx(this,"click"));this._interactions.onDoubleClick(bx(this,"doubleClick"))};_x.prototype.hide=function e(){Tx(this,true)};_x.prototype.isShown=function e(){return!!this._tooltip};_x.prototype.refresh=function e(){xx(this)};_x.prototype.show=function e(t,r){if(r===void 0)r={};var n=r.position;if(n===void 0)n="top";var i=r.autoAdjust;if(i===void 0)i=true;var a=r.className;if(a===void 0)a=null;var o=r.x;if(o===void 0)o=0;var s=r.y;if(s===void 0)s=0;Cx(this,t,{position:n,autoAdjust:i,className:a},{x:o,y:s})};function mx(e,t,r){if(e._timeout){e._dom.clearTimeout(e._timeout)}e._timeout=e._dom.setTimeout(function(){e._timeout=null;t()},r)}function yx(e,t){var r=t.button;var n=t.target;var i=[];i.push(e);if(r){i.push(r)}i.push(n?n.isNode?"node":"edge":"background");return i.join(".")}function bx(e,t,r){if(r===void 0)r=false;return{priority:"tooltip",check:function(n){var i=yx(t,n);var a=e._handlers[i];if(r&&e._connectNodes.enabled()){return false}if(a&&a.condition(n)){return true}if(!r&&e._currentHandlerName&&!e._isHover){return!!e._tooltip}return false},handler:function n(i){var a=i.target;var o=i.x;var s=i.y;var u=e._tooltip;Tx(e);if(!u){e._isHover=r;e._elt=a;e._x=o;e._y=s;e._currentHandlerName=yx(t,i);xx(e)}}}}function xx(e){if(!e._currentHandlerName){Tx(e);return}var t=e._handlers[e._currentHandlerName];if(!t){return}var r=t.settings;var n=t.handler;var i=e._elt;if(i){var a=i.isNode?"node":"edge";if(e._currentHandlerName.indexOf(a)===-1){return}}var o=n(i);var s=o instanceof Promise?o:Promise.resolve(o);s.then(function(t){mx(e,function(){Cx(e,t,r)},r.delay)})}var Sx={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}};var Ax={position:"top",autoAdjust:true,delay:100,className:null};var Ex={hover:{node:function(e){var t=e.target;return t&&t.isNode},edge:function(e){var t=e.target;return t&&!t.isNode}},click:{left:{node:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="left"&&!t}},right:{node:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="right"&&!t}}},doubleClick:{left:{node:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="left"&&!t}},right:{node:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="right"&&!t}}}};function wx(e,t,r,n){var i=Za(n,Ax,"position");if(px.indexOf(i.position)===-1){i.position="top"}e._handlers[t]={handler:r,condition:Ja(Ex,t),settings:i}}function kx(e){return typeof document==="object"?document.createElement(e):{style:{},offsetWidth:10,offsetHeight:10}}function Cx(e,t,r,n){Tx(e,false);var i=r.position;var a=r.className;var o=r.autoAdjust;var s=e._x;var u=e._y;var l=e._elt;var d=e._dom.getDimensions();var f=0;var h=0;if(n){s=n.x;u=n.y;l=null}if(typeof t==="string"){e._tooltip=kx("div");e._tooltip.innerHTML=t}else if(Be(t)){e._tooltip=t}else{throw new Error("invalid tooltip "+t+", expected HTML string or HTML element")}e._tooltip.__isOgmaTooltip=true;if(a){e._tooltip.className+=e._tooltip.className?" "+a:a}if(i!=="cssDefined"){e._tooltip.style.position="absolute"}e._dom.setLayer("tooltip",e._tooltip);if(l&&l.isNode){var c=e._camera.graphToScreenCoordinates(l.getPosition()),g=l.getAttribute("radius")*e._camera.getZoom()+l.getAttribute("innerStroke.width")+l.getAttribute("outerStroke.width")+1;s=c.x;u=c.y;f=g;h=g}var v=e._tooltip.offsetWidth;var p=e._tooltip.offsetHeight;var _=v/2;var m=p/2;f+=_;h+=m;if(i!=="cssDefined"){var y=Sx[i],b=y.x,x=y.y;if(o){var S=s+f*y.x,A=u+h*y.y;if(S-_<0||S+_>=d.width){if(i==="left"||i==="right"){b*=-1}else{if(S-_<0){b=(_-S+1)/f}else{b=(d.width-(S+_)-1)/f}}}if(A-m<0||A+m>=d.height){if(i==="top"||i==="bottom"){x*=-1}else{if(A-m<0){x=(m-A+1)/h}else{x=(d.height-(A+m)-1)/h}}}}e._tooltip.style.left=s+f*b-_+"px";e._tooltip.style.top=u+h*x-m+"px"}e._events.fire("showTooltip",{tooltip:e._tooltip})}function Tx(e,t){if(e._timeout){e._dom.clearTimeout(e._timeout);e._timeout=null}if(t){e._currentHandlerName=null}if(e._tooltip){var r=e._tooltip;e._dom.setLayer("tooltip",null);e._tooltip=null;e._events.fire("hideTooltip",{tooltip:r})}}Ogma.extend(function(e){e.debug={wait:function e(t){return new Promise(function(e){return setTimeout(e,t)})},initRandomGraph:function t(r){return e.generate.random(r).then(function(t){e.setGraph(t);e.view.locateGraph();return e.view.afterNextFrame()})},initGrid:function t(r){var n=Math.ceil(Math.sqrt(r));return e.generate.grid({rows:n,columns:n}).then(function(t){e.setGraph(t);e.view.locateGraph()})},initLine:function t(r){e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:r?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]});return e.view.locateGraph()},initSingleNode:function t(){e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}]});return e.view.locateGraph()},initContinuousRenderLoop:function t(r){if(r===void 0)r={};var n=r.triggerKey;if(n===void 0)n="r";var i=r.start;if(i===void 0)i=true;var a=i;document.addEventListener("keydown",function(e){var t=e.key;if(t===n){a=!a;o()}});var o=function(){if(a){e.modules.dom.beforeNextFrame().then(o)}};o()},appendToBody:function t(){var r=document.createElement("div");r.style.position="absolute";r.style.top="0";r.style.left="0";r.style.bottom="0";r.style.right="0";document.body.appendChild(r);e.setContainer(r)},loadFile:function t(r){var n=r.endsWith(".gexf")?e.parse.gexfFromUrl(r):e.parse.jsonFromUrl(r);return n.then(function(t){return e.setGraph(t)}).then(function(){return e.view.locateGraph()}).then(function(){return e.view.afterNextFrame()})},enableLasso:function t(r){e.events.onDragStart(function(){if(e.keyboard.isKeyPressed("ctrl")){e.tools.lasso.enable(r)}})}}});function Lx(e,t){var r=t.styles;var n=t.nodes;var i=t.edges;var a=t.filter;var o={nodes:Ix(true,e,r,n,a),edges:Ix(false,e,r,i,a)};return o}var Mx={get:function(){return undefined}};function Ix(e,t,r,n,i){var a=t.modules.graph;var o=n?n:i;var s=(e?a.getNodes(o):a.getEdges(o))._indexes;var u=new Array(s.length);var l=a.getNodeAttribute("id");var d=e?"radius":"width";var f=e?"shape":"shape.type";var h=a.getAttributes(e,["id","source","target","data","x","y","text.content","color",f,d]).map(function(e){return e||Mx});var c=h[0];var g=h[1];var v=h[2];var p=h[3];var _=h[4];var m=h[5];var y=h[6];var b=h[7];var x=h[8];var S=h[9];if(r==="none"){y=Mx;b=Mx;x=Mx;S=Mx}else if(r==="original"){var A=t.modules.individualAttributes.getOriginalAttributes()[e?"nodes":"edges"];y=A.text.content;b=A.color;x=q(A,f);S=A[d]}for(var E=0;E<s.length;++E){var w=s[E];var k={id:c.get(w),data:p.get(w),x:_.get(w),y:m.get(w),color:b.get(w),size:S.get(w),shape:x.get(w),text:y.get(w)};if(!e){k.source=l.get(g.get(w));k.target=l.get(v.get(w))}if(Array.isArray(k.color)){k.color=k.color[0]}u[E]=k}return u}function Fx(e,t){for(var r=0;r<t.length;++r){if(e===undefined||e===null){return undefined}e=e[t[r]]}return e}function Nx(e,t,value){for(var r=0;r<t.length-1;++r){var n=t[r],i=e[n];if(i===undefined){i={};e[n]=i}e=i}e[t[t.length-1]]=value}function zx(e,t,r){var n=new wt,i=t?1:3,a=[];var o=function(o){var s=e[o],u=new Array(i),l=s.data;if(r){var d={};r.forEach(function(e){var t=z(e),value=Fx(l,t);Nx(d,t,value)});l=d}var f=Et(l);u[0]=s.id;if(!t){u[1]=s.source;u[2]=s.target}for(var h=0;h<f.length;++h){var c=f[h];var g=c.path;var value=c.value;if(g.length){if(n.has(g)){u[n.get(g)]=value}else{n.set(g,i);u[i]=value;i++}}}a.push(u)};for(var s=0;s<e.length;++s)o(s);var u=[];u.push("id");if(!t){u.push("source");u.push("target")}n.keys().forEach(function(e){return u.push(e[e.length-1])});a.unshift(u);a.forEach(function(e){return e.length=i});return a}var Rx={what:undefined,dataProperties:undefined,separator:",",textSeparator:'"',download:true,filename:"graph.csv",filter:"visible",nodes:undefined,edges:undefined};Ogma.extend(function(e){e.export.csv=function(t){var r=Za(t,Rx,"what");var n=r.what;var i=r.dataProperties;var a=r.nodes;var o=r.edges;var s=r.separator;var u=r.textSeparator;var l=r.download;var d=r.filename;var f=r.filter;var h=Lx(e,{styles:"none",nodes:a,edges:o,filter:f}),c=Px(h,{what:n,separator:s,textSeparator:u,dataProperties:i});if(l){Ie(c,d,"text")}return Promise.resolve(c)}});function Px(e,t){var r=t.what;var n=t.separator;var i=t.textSeparator;var a=t.dataProperties;var o=new RegExp(""+i,"g");function s(e){e=Dx(e);e=i+e.replace(o,"\\$&")+i;return e}if(i&&i!=='"'&&i!=="'"){throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+i)}if(r!=="nodes"&&r!=="edges"){throw new TypeError('missing argument: "what": should have value "nodes" or "edges"')}var u=r==="nodes",l=u?e.nodes:e.edges,d=zx(l,u,a).map(function(e){return e.map(function(value){return s(value)})});return d.map(function(e){return e.join(n)}).join("\n")}function Dx(e){if(e instanceof Date){return e.toISOString()}else{return""+e}}var Ox={creator:undefined,description:undefined,styles:"all",download:true,filename:"graph.gexf",nodes:undefined,edges:undefined,filter:"visible"};Ogma.extend(function(e){e.export.gexf=function(t){if(t===void 0)t={};var r=Za(t,Ox);var n=r.styles;var i=r.nodes;var a=r.edges;var o=r.download;var s=r.filename;var u=r.creator;var l=r.description;var d=r.filter;var f=Lx(e,{styles:n,nodes:i,edges:a,filter:d});var h=Bx(f,{creator:u,description:l});if(o){Ie(h,s,"text")}return Promise.resolve(h)}});function Bx(e,t){var r=new Pr;var n=wr();var i;var a={};var o=0;var s={};var u=0;var l;var d;var f;var h;var c;var g;var v;var p;var _;var m;var y;var b;var x;var S;var A;var E;var w;var k;A=n.createElement("gexf");A.setAttribute("xmlns","http://www.gexf.net/1.2draft");A.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz");A.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");A.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd");A.setAttribute("version","1.2");b=n.createElement("meta");b.setAttribute("lastmodifieddate",er());if(t.creator){v=n.createElement("creator");k=n.createTextNode(""+t.creator);v.appendChild(k);b.appendChild(v)}if(t.description){p=n.createElement("description");k=n.createTextNode(""+t.description);p.appendChild(k);b.appendChild(p)}y=n.createElement("graph");y.setAttribute("mode","static");x=n.createElement("nodes");e.nodes.forEach(function(e){S=n.createElement("node");S.setAttribute("id",e.id);if(e.text){S.setAttribute("label",e.text)}if(Ux(e.data)){i=Gx(e.data);d=n.createElement("attvalues");Object.keys(i).forEach(function(e){if(!(e in a)){a[e]={id:o,type:"integer"};o++}var t=i[e];a[e].type=Vx(t,a[e].type);f=n.createElement("attvalue");f.setAttribute("for",a[e].id);f.setAttribute("value",t);d.appendChild(f)});S.appendChild(d)}if(e.color){var t=r.parseColor(e.color);g=n.createElement("viz:color");g.setAttribute("r",jx(t[0]));g.setAttribute("g",jx(t[1]));g.setAttribute("b",jx(t[2]));g.setAttribute("a",t[3]);S.appendChild(g)}E=n.createElement("viz:position");E.setAttribute("x",e.x);E.setAttribute("y",-parseInt(e.y,10));S.appendChild(E);if(e.size){w=n.createElement("viz:size");w.setAttribute("value",e.size);S.appendChild(w)}x.appendChild(S)});h=n.createElement("attributes");h.setAttribute("class","node");Object.keys(a).forEach(function(e){l=n.createElement("attribute");l.setAttribute("id",a[e].id);l.setAttribute("title",e);l.setAttribute("type",a[e].type);h.appendChild(l)});_=n.createElement("edges");e.edges.forEach(function(e){m=n.createElement("edge");m.setAttribute("id",e.id);m.setAttribute("source",e.source);m.setAttribute("target",e.target);if(e.size){m.setAttribute("weight",e.size)}if(e.text){m.setAttribute("label",e.text)}if(Ux(e.data)){i=Gx(e.data);d=n.createElement("attvalues");Object.keys(i).forEach(function(e){if(!(e in s)){s[e]={id:u,type:"integer"};u++}var t=i[e];s[e].type=Vx(t,s[e].type);f=n.createElement("attvalue");f.setAttribute("for",s[e].id);f.setAttribute("value",t);d.appendChild(f)});m.appendChild(d)}if(e.color){var t=r.parseColor(e.color);g=n.createElement("viz:color");g.setAttribute("r",jx(t[0]));g.setAttribute("g",jx(t[1]));g.setAttribute("b",jx(t[2]));g.setAttribute("a",t[3]);m.appendChild(g)}if(e.size){w=n.createElement("viz:size");w.setAttribute("value",e.size);m.appendChild(w)}_.appendChild(m)});c=n.createElement("attributes");c.setAttribute("class","edge");Object.keys(s).forEach(function(e){l=n.createElement("attribute");l.setAttribute("id",s[e].id);l.setAttribute("title",e);l.setAttribute("type",s[e].type);c.appendChild(l)});y.appendChild(h);y.appendChild(c);y.appendChild(x);y.appendChild(_);A.appendChild(b);A.appendChild(y);n.appendChild(A);return'<?xml version="1.0" encoding="UTF-8"?>'+n.serialize()}function jx(value){return Math.round(value*255)}function Vx(e,t){if(t==="integer"&&typeof e==="number"){if(e%1!==0){t="float"}}else if(typeof e!=="number"){t="string";if(typeof e==="boolean"){t="boolean"}}return t}function Ux(value){return typeof value==="object"&&value!==null&&value.constructor===Object}function Gx(e,t){if(t===void 0)t={};U(e,function(value,e){if(Ux(value)){Gx(value,t)}else{t[e]=value}});return t}var Wx={graphId:"G",directedEdges:true,styles:"all",download:true,filename:"graph.graphml",nodes:undefined,edges:undefined,filter:"visible"};Ogma.extend(function(e){e.export.graphml=function(t){if(t===void 0)t={};var r=Za(t,Wx);var n=r.styles;var i=r.nodes;var a=r.edges;var o=r.download;var s=r.filename;var u=r.graphId;var l=r.directedEdges;var d=r.filter;var f=Lx(e,{styles:n,nodes:i,edges:a,filter:d}),h=Hx(f,{graphId:u,directedEdges:l});if(o){Ie(h,s,"text")}return Promise.resolve(h)}});function Hx(e,t){var r=new Pr;var n=Ae();function i(e){return r.parseColor(e)}function a(e){return r.toHexa(e)}function o(e,t){var r=i(t);e.r=r[0];e.g=r[1];e.b=r[2]}function s(e,t,r,i,a){r=r||{};var o=n.createElement(t);for(var s in r){if(!r.hasOwnProperty(s)){continue}var value=r[s];if(value!==undefined){o.setAttribute(s,value)}}if(i!==undefined||a){if(Object.prototype.toString.call(i)==="[object Object]"){i=JSON.stringify(i)}var u=n.createTextNode(i);o.appendChild(u)}e.appendChild(o);return o}var u=["id","source","target"];var l=["size","x","y","shape","color","text"];var d={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}},f=[],h=[];function c(e,t){var r={id:e.id};l.forEach(function(n){var value=e[n];if(n==="y"&&value){value=-parseFloat(value)}if(value!==undefined){r[(t==="edge"?"edge_":"")+n]=value;if(n==="color"){o(r,value)}}});var n=e.data||{};U(n,function(value,e){if(l.indexOf(e)!==-1||u.indexOf(e)!==-1){return}if(!d[e]){d[e]={for:t,type:"string"}}else if(d[e].for!==t){d[e].for="all"}r[e]=value});if(t==="edge"){r.source=e.source;r.target=e.target;h.push(r)}else{f.push(r)}}e.nodes.forEach(function(e){c(e,"node")});e.edges.forEach(function(e){c(e,"edge")});var g=s(n,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns "+"http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});U(d,function(value,e){if(value.for==="node"||value.for==="all"){s(g,"key",{"attr.name":e,"attr.type":value.type,for:"node",id:e})}if(value.for==="edge"||value.for==="all"){s(g,"key",{"attr.name":e,"attr.type":value.type,for:"edge",id:"edge_"+e})}});s(g,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"});s(g,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var v=s(g,"graph",{edgedefault:t.directedEdges||t.directedEdges===undefined?"directed":"undirected",id:t.graphId?t.graphId:"G","parse.nodes":e.nodes.length,"parse.edges":e.edges.length,"parse.order":"nodesfirst"});function p(e,t){var r=s(e,"data",{key:"nodegraphics"});var n=s(r,"y:ShapeNode");s(n,"y:Geometry",{x:t.x,y:t.y,width:t.size,height:t.size});s(n,"y:Fill",{color:a(t.color),transparent:false});s(n,"y:NodeLabel",null,t.text||"");s(n,"y:Shape",{type:t.shape})}function _(e,t){var r=s(e,"data",{key:"edgegraphics"});var n=s(r,"y:PolyLineEdge");s(n,"y:LineStyle",{type:t.edge_type,color:a(t.edge_color),width:t.edge_size});s(n,"y:EdgeLabel",null,t.edge_label)}f.forEach(function(e){var t=s(v,"node",{id:e.id});p(t,e);U(e,function(value,e){if(u.indexOf(e)!==-1){return}s(t,"data",{key:e},value,true)})});h.forEach(function(e){var t=s(v,"edge",{id:e.id,source:e.source,target:e.target});_(t,e);U(e,function(value,e){if(u.indexOf(e)!==-1){return}s(t,"data",{key:e},value,true)})});var m=Ee(n);return'<?xml version="1.0" encoding="UTF-8"?>\n'+m}var Xx={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible",pretty:false,download:true,filename:"graph.json"};Ogma.extend(function(e){e.export.json=function(t){if(t===void 0)t={};var r=Za(t,Xx);var n=r.nodeAttributes;var i=r.edgeAttributes;var a=r.nodeData;var o=r.edgeData;var s=r.filter;var u=r.pretty;var l=r.download;var d=r.filename;var f={nodes:e.getNodes(typeof s==="object"?s.nodes:s).toJSON({attributes:n,data:a}),edges:e.getEdges(typeof s==="object"?s.edges:s).toJSON({attributes:i,data:o})};var h=u?JSON.stringify(f,null," "):JSON.stringify(f);if(l){Ie(h,d,"text")}return Promise.resolve(h)}});Ogma.afterInit(function(e){return e.styles.createClass({name:Wl,isBuiltin:true})});function qx(e,t){var r=e.view.get();var n=typeof t.margin==="number"?t.margin:0;var i={pixelRatio:1,backgroundColor:r.backgroundColor};if(t.width&&t.height){i.width=t.width;i.height=t.height}else{i.width=r.width;i.height=r.height}if(t.clip){i.zoom=r.zoom;i.x=r.x;i.y=r.y}else{var a=e.getNodes(t.filter);var o=a.getBoundingBox().computeForZoom(r.zoom).extend(Fr.fromValues(a.getAttribute("x"),a.getAttribute("y"),a.map(function(e){return e.getAttribute("radius")+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")})));if(t.texts){var s=e.modules.labels.getTextsBoundingBox();if(s.isValid()){o.extend(s)}}if(!isFinite(t.width)||!isFinite(t.height)){var u=e.view.graphToScreenCoordinates(o.bottomLeft());var l=e.view.graphToScreenCoordinates(o.topRight());var d=l.x-u.x,f=l.y-u.y;var h=Math.min(i.width/d,i.height/f);i.width=d*h;i.height=f*h}i.x=o.cx;i.y=o.cy;i.width=Math.max(i.width,n*2+1);i.height=Math.max(i.height,n*2+1);i.zoom=Math.min((i.width-n*2)/o.width,(i.height-n*2)/o.height)}if(e.modules.geo.isEnabled()){i.backgroundColor=null}else if(t.background!==undefined){i.backgroundColor=t.background}return i}function Yx(e,t,r,n,i){if(i===void 0)i=false;r.hideImages=i;r.isBufferDisplayable=function(e){return t.texts||!Md(e)};var a={};if(t.badges===false){var o={text:null,image:null};a.badges={topLeft:o,topRight:o,bottomRight:o,bottomLeft:o}}e.styles.getClass(Wl).update({nodeAttributes:a});return e.modules.graphics.export(n,r,t.filter,t)}Ogma.extend(function(e){e.export.png=function(t){return rS(e,t,"png")};e.export.jpg=function(t){return rS(e,t,"jpg")};e.export.tiff=function(t){return rS(e,t,"tiff")};e.export.gif=function(t){return rS(e,t,"gif")}});function Zx(e){return{download:true,filter:"visible",filename:"graph."+e,clip:false,margin:10,width:undefined,height:undefined,background:null,badges:true,legend:undefined,texts:true,images:true,map:true,textWatermark:{content:null,fontFamily:"Arial",fontSize:48,fontStyle:null,fontColor:"red",repeat:false,angle:0,alpha:.65,space:50,x:undefined,y:undefined},imageWatermark:{url:null,width:undefined,height:undefined,repeat:false,angle:0,alpha:.65,space:50,x:undefined,y:undefined},imageCrossOrigin:undefined}}var Kx={png:Zx("png"),jpg:Zx("jpg"),tiff:Zx("tiff"),gif:Zx("gif")};function Qx(e){var t=e.canvas;var r=e.parameters;if(r.textWatermark.content){sS(t,r.textWatermark,nS,iS)}if(r.imageWatermark.url){return Pe(r.imageWatermark.url).then(function(n){if(n){r.imageWatermark.content=n;sS(t,r.imageWatermark,oS,aS)}return e})}else{return e}}function Jx(e){var t=e.ogma;var r=e.canvas;var n=e.parameters;var i=t.modules.legend;var a=n.legend;if(a===undefined){a=i.enabled()?i.getCurrentOptions():false}else if(a===true){a={}}if(a){i.exportOnCanvas(r,a)}return e}function $x(e){var t=e.canvas;var r=e.ogma;var n=e.view;if(r.modules.geo.isEnabled()){return r.modules.geo.whenReady().then(function(){return r.modules.geo.exportBackground(t,n)}).then(function(){return e})}else{return e}}function eS(e){var t=e.ogma;var r=e.parameters;var n=e.canvas;var i=e.view;var a=n.getContext("2d");return Yx(t,r,i,"canvas",!r.images).then(function(n){try{n.getContext("2d").getImageData(0,0,1,1);a.drawImage(n,0,0);return e}catch(n){Xa(n);return Yx(t,r,i,"canvas",true).then(function(t){a.drawImage(t,0,0);return e})}})}function tS(e){var t=e.canvas;var r=e.parameters;var n=e.type;var i=t.toDataURL("image/"+n);if(r.download){Ie(i,r.filename,"dataURL")}return i}function rS(e,t,r){t=Za(t,Kx[r]);if(t.background===null){t.background=e.modules.graphics.getTransparentBackgroundColor()}var n=qx(e,t);var i=we();var a={ogma:e,parameters:t,canvas:i,view:n,type:r};i.width=n.width;i.height=n.height;return Promise.resolve(a).then($x).then(eS).then(Qx).then(Jx).then(tS)}function nS(e,t,r,n){e.textAlign="center";e.textBaseline="middle";e.fillText(t,r,n)}function iS(e,t,r){return{width:e.measureText(t).width,height:r}}function aS(e,t,r,n,i){return{width:n===undefined?t.width:n,height:i===undefined?t.height:i}}function oS(e,t,r,n,i,a){e.drawImage(t,r-i/2,n-a/2,i,a)}function sS(e,t,r,n){if(!t){return}if(typeof t!=="object"){t={content:t}}else if(!t.content){return}var i=t.fontFamily;var a=t.fontSize;var o=t.fontStyle;var s=t.fontColor;var u=t.repeat;var l=t.angle;var d=t.alpha;var f=t.space;var h=t.content;var c=e.getContext("2d");var g=e.width;var v=e.height;var p=t.x===undefined?g/2:t.x;var _=t.y===undefined?v/2:t.y;var m=t.height;var y=t.width;l=l/180*Math.PI;We(c,i,a,o);c.fillStyle=s;c.globalAlpha=d;var b=n(c,h,a,y,m);if(!u){c.save();c.translate(p,_);c.rotate(l);r(c,h,0,0,b.width,b.height);c.restore()}else{var x=b.width+f,S=b.height+f,A=Math.sqrt(g*g+v*v);c.save();c.translate(0,0);c.rotate(l);for(var E=0;E<A;E+=x){for(var w=0;w<A;w+=S){r(c,h,E,w,b.width,b.height);if(w!==0){r(c,h,E,-w,b.width,b.height)}}}c.restore()}}Ogma.extend(function(e){e.export.svg=function(t){return lS(e,t)}});var uS={download:true,filename:"graph.svg",width:undefined,height:undefined,background:null,texts:true,images:true,badges:true,embedFonts:false,clip:false,margin:10,prefix:"ogma"};function lS(e,t){t=Za(t,uS);if(t.background===null){t.background=e.modules.graphics.getTransparentBackgroundColor()}var r=qx(e,t);return Yx(e,t,r,"svg",!t.images).then(function(e){e.removeAttribute("pointer-events");e.setAttribute("version","1.1");e.setAttribute("xmlns","http://www.w3.org/2000/svg");e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");return e}).then(function(r){return dS(e,r,t)}).then(function(r){return hS(e,r,t)}).then(function(e){var r='<?xml version="1.0" encoding="utf-8"?>'+Ee(e);if(t.download){Ie(r,t.filename)}return r})}function dS(e,t,r){var n=t.childNodes[2];var i=n.childNodes;var a={};var o=r.prefix;for(var s=0;s<i.length;s++){var u=i[s];var l=u.getAttribute(fl);a[l]=a[l]||[];a[l].push(u)}var d=Object.keys(a);var f=e.modules.graph;var h=f.getNodeAttribute("id");var c=f.getEdgeAttribute("id");var g=ze("g",{class:o+"-edges"});var v=ze("g",{class:o+"-nodes"});for(var p=0;p<d.length;p++){var _=d[p];var m=_.charAt(0)==="n";var y=parseInt(_.substring(1));var b=a[_];var x=He((m?h:c).get(y));var S=ze("g");S.setAttribute("data-"+(m?"node":"edge")+"-id",x);S.setAttribute("class",o+"-"+(m?"node":"edge"));for(var A=0;A<b.length;A++){var E=b[A];S.appendChild(E);E.removeAttribute(fl)}(m?v:g).appendChild(S)}n.appendChild(g);n.appendChild(v);return t}function fS(e){var t=[].concat(Array.prototype.slice.call(e.getElementsByTagName("text")||[]),Array.prototype.slice.call(e.getElementsByTagName("tspan")||[]));var r=[];var n={};for(var i=0;i<t.length;i++){var a=t[i];var o=a.getAttribute("font-family");if(typeof o==="string"){var s=o.split(",");for(var u=0;u<s.length;u++){var l=s[u].replace(/['"]/g,"");if(l!==""&&!n[l]){n[l]=true;r.push(l)}}}}return{list:r,map:n}}function hS(e,t,r){var n=fS(t).map;return Xe().then(function(e){return e.filter(function(e){return n[e.name]})}).then(function(e){return qe(e,!!r.embedFonts)}).then(function(e){if(e.length!==0){var r=ze("style");for(var n=0;n<e.length;n++){r.appendChild(Re(e[n]))}t.childNodes[0].appendChild(r)}return t})}var cS={what:undefined,dataProperties:undefined,download:true,filename:"graph.xlsx",nodes:undefined,edges:undefined,filter:"visible"};Ogma.extend(function(e){e.export.xlsx=function(t){var r=Za(t,cS,"what");var n=r.what;var i=r.nodes;var a=r.edges;var o=r.download;var s=r.filename;var u=r.dataProperties;var l=r.filter;var d=Lx(e,{styles:"none",nodes:i,edges:a,filter:l}),f=gS(d,{what:n,dataProperties:u});if(o){Ie(f,s,"blob")}return Promise.resolve(f)}});function gS(e,t){var r=t.what;var n=t.dataProperties;var i=A("XLSX")||A("xlsx",{throwOnError:true}),a=new _S,o,s;if(!r){o=pS(i,zx(e.nodes,true,n));s=pS(i,zx(e.edges,false,n))}else{if(r==="nodes"){o=pS(i,zx(e.nodes,true,n))}else if(r==="edges"){s=pS(i,zx(e.edges,false,n))}else{throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+r)}}if(o){a.SheetNames.push("Nodes");a.Sheets.Nodes=o}if(s){a.SheetNames.push("Edges");a.Sheets.Edges=s}var u=i.write(a,{bookType:"xlsx",bookSST:false,type:"binary"});var l=Le([mS(u)]);return l}function vS(e){if(e===undefined){return""}else if(e instanceof Date){return e.toISOString()}else{return""+e}}function pS(e,t){var r={};var n={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(var i=0;i!==t.length;++i){var a=t[i];for(var o=0;o!==a.length;++o){var value=a[o];if(n.s.r>i){n.s.r=i}if(n.s.c>o){n.s.c=o}if(n.e.r<i){n.e.r=i}if(n.e.c<o){n.e.c=o}var s={v:vS(value)},u=e.utils.encode_cell({c:o,r:i});r[u]=s}}if(n.s.c<1e7){r["!ref"]=e.utils.encode_range(n)}return r}function _S(){if(!(this instanceof _S)){return new _S}this.SheetNames=[];this.Sheets={}}function mS(e){var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var n=0;n!==e.length;++n){r[n]=e.charCodeAt(n)&255}return t}Ogma.default=Ogma;Ogma.geometry=ua;Ogma.algorithms=Wa;Ogma.utils=Dr;return Ogma});